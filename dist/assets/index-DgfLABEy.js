var WX=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports);var lHe=WX((AHe,DC)=>{function jX(t,e){for(var n=0;n<e.length;n++){const i=e[n];if(typeof i!="string"&&!Array.isArray(i)){for(const r in i)if(r!=="default"&&!(r in t)){const o=Object.getOwnPropertyDescriptor(i,r);o&&Object.defineProperty(t,r,o.get?o:{enumerable:!0,get:()=>i[r]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const a of o.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerPolicy&&(o.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?o.credentials="include":r.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function i(r){if(r.ep)return;r.ep=!0;const o=n(r);fetch(r.href,o)}})();var EB=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function _I(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var o_={exports:{}},vp={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var TB;function zX(){if(TB)return vp;TB=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function n(i,r,o){var a=null;if(o!==void 0&&(a=""+o),r.key!==void 0&&(a=""+r.key),"key"in r){o={};for(var u in r)u!=="key"&&(o[u]=r[u])}else o=r;return r=o.ref,{$$typeof:t,type:i,key:a,ref:r!==void 0?r:null,props:o}}return vp.Fragment=e,vp.jsx=n,vp.jsxs=n,vp}var _B;function UX(){return _B||(_B=1,o_.exports=zX()),o_.exports}var Io=UX(),s_={exports:{}},ot={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var MB;function YX(){if(MB)return ot;MB=1;var t=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.consumer"),a=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),g=Symbol.for("react.lazy"),m=Symbol.for("react.activity"),v=Symbol.iterator;function y(V){return V===null||typeof V!="object"?null:(V=v&&V[v]||V["@@iterator"],typeof V=="function"?V:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},C=Object.assign,T={};function O(V,le,ye){this.props=V,this.context=le,this.refs=T,this.updater=ye||b}O.prototype.isReactComponent={},O.prototype.setState=function(V,le){if(typeof V!="object"&&typeof V!="function"&&V!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,V,le,"setState")},O.prototype.forceUpdate=function(V){this.updater.enqueueForceUpdate(this,V,"forceUpdate")};function A(){}A.prototype=O.prototype;function N(V,le,ye){this.props=V,this.context=le,this.refs=T,this.updater=ye||b}var x=N.prototype=new A;x.constructor=N,C(x,O.prototype),x.isPureReactComponent=!0;var $=Array.isArray;function L(){}var P={H:null,A:null,T:null,S:null},Q=Object.prototype.hasOwnProperty;function ue(V,le,ye){var S=ye.ref;return{$$typeof:t,type:V,key:le,ref:S!==void 0?S:null,props:ye}}function X(V,le){return ue(V.type,le,V.props)}function me(V){return typeof V=="object"&&V!==null&&V.$$typeof===t}function re(V){var le={"=":"=0",":":"=2"};return"$"+V.replace(/[=:]/g,function(ye){return le[ye]})}var Se=/\/+/g;function we(V,le){return typeof V=="object"&&V!==null&&V.key!=null?re(""+V.key):le.toString(36)}function _e(V){switch(V.status){case"fulfilled":return V.value;case"rejected":throw V.reason;default:switch(typeof V.status=="string"?V.then(L,L):(V.status="pending",V.then(function(le){V.status==="pending"&&(V.status="fulfilled",V.value=le)},function(le){V.status==="pending"&&(V.status="rejected",V.reason=le)})),V.status){case"fulfilled":return V.value;case"rejected":throw V.reason}}throw V}function ie(V,le,ye,S,E){var M=typeof V;(M==="undefined"||M==="boolean")&&(V=null);var F=!1;if(V===null)F=!0;else switch(M){case"bigint":case"string":case"number":F=!0;break;case"object":switch(V.$$typeof){case t:case e:F=!0;break;case g:return F=V._init,ie(F(V._payload),le,ye,S,E)}}if(F)return E=E(V),F=S===""?"."+we(V,0):S,$(E)?(ye="",F!=null&&(ye=F.replace(Se,"$&/")+"/"),ie(E,le,ye,"",function(_){return _})):E!=null&&(me(E)&&(E=X(E,ye+(E.key==null||V&&V.key===E.key?"":(""+E.key).replace(Se,"$&/")+"/")+F)),le.push(E)),1;F=0;var q=S===""?".":S+":";if($(V))for(var J=0;J<V.length;J++)S=V[J],M=q+we(S,J),F+=ie(S,le,ye,M,E);else if(J=y(V),typeof J=="function")for(V=J.call(V),J=0;!(S=V.next()).done;)S=S.value,M=q+we(S,J++),F+=ie(S,le,ye,M,E);else if(M==="object"){if(typeof V.then=="function")return ie(_e(V),le,ye,S,E);throw le=String(V),Error("Objects are not valid as a React child (found: "+(le==="[object Object]"?"object with keys {"+Object.keys(V).join(", ")+"}":le)+"). If you meant to render a collection of children, use an array instead.")}return F}function de(V,le,ye){if(V==null)return V;var S=[],E=0;return ie(V,S,"","",function(M){return le.call(ye,M,E++)}),S}function Te(V){if(V._status===-1){var le=V._result;le=le(),le.then(function(ye){(V._status===0||V._status===-1)&&(V._status=1,V._result=ye)},function(ye){(V._status===0||V._status===-1)&&(V._status=2,V._result=ye)}),V._status===-1&&(V._status=0,V._result=le)}if(V._status===1)return V._result.default;throw V._result}var Pe=typeof reportError=="function"?reportError:function(V){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var le=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof V=="object"&&V!==null&&typeof V.message=="string"?String(V.message):String(V),error:V});if(!window.dispatchEvent(le))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",V);return}console.error(V)},De={map:de,forEach:function(V,le,ye){de(V,function(){le.apply(this,arguments)},ye)},count:function(V){var le=0;return de(V,function(){le++}),le},toArray:function(V){return de(V,function(le){return le})||[]},only:function(V){if(!me(V))throw Error("React.Children.only expected to receive a single React element child.");return V}};return ot.Activity=m,ot.Children=De,ot.Component=O,ot.Fragment=n,ot.Profiler=r,ot.PureComponent=N,ot.StrictMode=i,ot.Suspense=h,ot.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=P,ot.__COMPILER_RUNTIME={__proto__:null,c:function(V){return P.H.useMemoCache(V)}},ot.cache=function(V){return function(){return V.apply(null,arguments)}},ot.cacheSignal=function(){return null},ot.cloneElement=function(V,le,ye){if(V==null)throw Error("The argument must be a React element, but you passed "+V+".");var S=C({},V.props),E=V.key;if(le!=null)for(M in le.key!==void 0&&(E=""+le.key),le)!Q.call(le,M)||M==="key"||M==="__self"||M==="__source"||M==="ref"&&le.ref===void 0||(S[M]=le[M]);var M=arguments.length-2;if(M===1)S.children=ye;else if(1<M){for(var F=Array(M),q=0;q<M;q++)F[q]=arguments[q+2];S.children=F}return ue(V.type,E,S)},ot.createContext=function(V){return V={$$typeof:a,_currentValue:V,_currentValue2:V,_threadCount:0,Provider:null,Consumer:null},V.Provider=V,V.Consumer={$$typeof:o,_context:V},V},ot.createElement=function(V,le,ye){var S,E={},M=null;if(le!=null)for(S in le.key!==void 0&&(M=""+le.key),le)Q.call(le,S)&&S!=="key"&&S!=="__self"&&S!=="__source"&&(E[S]=le[S]);var F=arguments.length-2;if(F===1)E.children=ye;else if(1<F){for(var q=Array(F),J=0;J<F;J++)q[J]=arguments[J+2];E.children=q}if(V&&V.defaultProps)for(S in F=V.defaultProps,F)E[S]===void 0&&(E[S]=F[S]);return ue(V,M,E)},ot.createRef=function(){return{current:null}},ot.forwardRef=function(V){return{$$typeof:u,render:V}},ot.isValidElement=me,ot.lazy=function(V){return{$$typeof:g,_payload:{_status:-1,_result:V},_init:Te}},ot.memo=function(V,le){return{$$typeof:d,type:V,compare:le===void 0?null:le}},ot.startTransition=function(V){var le=P.T,ye={};P.T=ye;try{var S=V(),E=P.S;E!==null&&E(ye,S),typeof S=="object"&&S!==null&&typeof S.then=="function"&&S.then(L,Pe)}catch(M){Pe(M)}finally{le!==null&&ye.types!==null&&(le.types=ye.types),P.T=le}},ot.unstable_useCacheRefresh=function(){return P.H.useCacheRefresh()},ot.use=function(V){return P.H.use(V)},ot.useActionState=function(V,le,ye){return P.H.useActionState(V,le,ye)},ot.useCallback=function(V,le){return P.H.useCallback(V,le)},ot.useContext=function(V){return P.H.useContext(V)},ot.useDebugValue=function(){},ot.useDeferredValue=function(V,le){return P.H.useDeferredValue(V,le)},ot.useEffect=function(V,le){return P.H.useEffect(V,le)},ot.useEffectEvent=function(V){return P.H.useEffectEvent(V)},ot.useId=function(){return P.H.useId()},ot.useImperativeHandle=function(V,le,ye){return P.H.useImperativeHandle(V,le,ye)},ot.useInsertionEffect=function(V,le){return P.H.useInsertionEffect(V,le)},ot.useLayoutEffect=function(V,le){return P.H.useLayoutEffect(V,le)},ot.useMemo=function(V,le){return P.H.useMemo(V,le)},ot.useOptimistic=function(V,le){return P.H.useOptimistic(V,le)},ot.useReducer=function(V,le,ye){return P.H.useReducer(V,le,ye)},ot.useRef=function(V){return P.H.useRef(V)},ot.useState=function(V){return P.H.useState(V)},ot.useSyncExternalStore=function(V,le,ye){return P.H.useSyncExternalStore(V,le,ye)},ot.useTransition=function(){return P.H.useTransition()},ot.version="19.2.0",ot}var AB;function MI(){return AB||(AB=1,s_.exports=YX()),s_.exports}var Ee=MI();const bn=_I(Ee),AI=jX({__proto__:null,default:bn},[Ee]);var a_={exports:{}},wp={},l_={exports:{}},u_={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var OB;function GX(){return OB||(OB=1,(function(t){function e(ie,de){var Te=ie.length;ie.push(de);e:for(;0<Te;){var Pe=Te-1>>>1,De=ie[Pe];if(0<r(De,de))ie[Pe]=de,ie[Te]=De,Te=Pe;else break e}}function n(ie){return ie.length===0?null:ie[0]}function i(ie){if(ie.length===0)return null;var de=ie[0],Te=ie.pop();if(Te!==de){ie[0]=Te;e:for(var Pe=0,De=ie.length,V=De>>>1;Pe<V;){var le=2*(Pe+1)-1,ye=ie[le],S=le+1,E=ie[S];if(0>r(ye,Te))S<De&&0>r(E,ye)?(ie[Pe]=E,ie[S]=Te,Pe=S):(ie[Pe]=ye,ie[le]=Te,Pe=le);else if(S<De&&0>r(E,Te))ie[Pe]=E,ie[S]=Te,Pe=S;else break e}}return de}function r(ie,de){var Te=ie.sortIndex-de.sortIndex;return Te!==0?Te:ie.id-de.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,u=a.now();t.unstable_now=function(){return a.now()-u}}var h=[],d=[],g=1,m=null,v=3,y=!1,b=!1,C=!1,T=!1,O=typeof setTimeout=="function"?setTimeout:null,A=typeof clearTimeout=="function"?clearTimeout:null,N=typeof setImmediate<"u"?setImmediate:null;function x(ie){for(var de=n(d);de!==null;){if(de.callback===null)i(d);else if(de.startTime<=ie)i(d),de.sortIndex=de.expirationTime,e(h,de);else break;de=n(d)}}function $(ie){if(C=!1,x(ie),!b)if(n(h)!==null)b=!0,L||(L=!0,re());else{var de=n(d);de!==null&&_e($,de.startTime-ie)}}var L=!1,P=-1,Q=5,ue=-1;function X(){return T?!0:!(t.unstable_now()-ue<Q)}function me(){if(T=!1,L){var ie=t.unstable_now();ue=ie;var de=!0;try{e:{b=!1,C&&(C=!1,A(P),P=-1),y=!0;var Te=v;try{t:{for(x(ie),m=n(h);m!==null&&!(m.expirationTime>ie&&X());){var Pe=m.callback;if(typeof Pe=="function"){m.callback=null,v=m.priorityLevel;var De=Pe(m.expirationTime<=ie);if(ie=t.unstable_now(),typeof De=="function"){m.callback=De,x(ie),de=!0;break t}m===n(h)&&i(h),x(ie)}else i(h);m=n(h)}if(m!==null)de=!0;else{var V=n(d);V!==null&&_e($,V.startTime-ie),de=!1}}break e}finally{m=null,v=Te,y=!1}de=void 0}}finally{de?re():L=!1}}}var re;if(typeof N=="function")re=function(){N(me)};else if(typeof MessageChannel<"u"){var Se=new MessageChannel,we=Se.port2;Se.port1.onmessage=me,re=function(){we.postMessage(null)}}else re=function(){O(me,0)};function _e(ie,de){P=O(function(){ie(t.unstable_now())},de)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(ie){ie.callback=null},t.unstable_forceFrameRate=function(ie){0>ie||125<ie?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Q=0<ie?Math.floor(1e3/ie):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(ie){switch(v){case 1:case 2:case 3:var de=3;break;default:de=v}var Te=v;v=de;try{return ie()}finally{v=Te}},t.unstable_requestPaint=function(){T=!0},t.unstable_runWithPriority=function(ie,de){switch(ie){case 1:case 2:case 3:case 4:case 5:break;default:ie=3}var Te=v;v=ie;try{return de()}finally{v=Te}},t.unstable_scheduleCallback=function(ie,de,Te){var Pe=t.unstable_now();switch(typeof Te=="object"&&Te!==null?(Te=Te.delay,Te=typeof Te=="number"&&0<Te?Pe+Te:Pe):Te=Pe,ie){case 1:var De=-1;break;case 2:De=250;break;case 5:De=1073741823;break;case 4:De=1e4;break;default:De=5e3}return De=Te+De,ie={id:g++,callback:de,priorityLevel:ie,startTime:Te,expirationTime:De,sortIndex:-1},Te>Pe?(ie.sortIndex=Te,e(d,ie),n(h)===null&&ie===n(d)&&(C?(A(P),P=-1):C=!0,_e($,Te-Pe))):(ie.sortIndex=De,e(h,ie),b||y||(b=!0,L||(L=!0,re()))),ie},t.unstable_shouldYield=X,t.unstable_wrapCallback=function(ie){var de=v;return function(){var Te=v;v=de;try{return ie.apply(this,arguments)}finally{v=Te}}}})(u_)),u_}var xB;function qX(){return xB||(xB=1,l_.exports=GX()),l_.exports}var c_={exports:{}},sr={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var HB;function KX(){if(HB)return sr;HB=1;var t=MI();function e(h){var d="https://react.dev/errors/"+h;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var g=2;g<arguments.length;g++)d+="&args[]="+encodeURIComponent(arguments[g])}return"Minified React error #"+h+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var i={d:{f:n,r:function(){throw Error(e(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},r=Symbol.for("react.portal");function o(h,d,g){var m=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:r,key:m==null?null:""+m,children:h,containerInfo:d,implementation:g}}var a=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,d){if(h==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return sr.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=i,sr.createPortal=function(h,d){var g=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return o(h,d,null,g)},sr.flushSync=function(h){var d=a.T,g=i.p;try{if(a.T=null,i.p=2,h)return h()}finally{a.T=d,i.p=g,i.d.f()}},sr.preconnect=function(h,d){typeof h=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,i.d.C(h,d))},sr.prefetchDNS=function(h){typeof h=="string"&&i.d.D(h)},sr.preinit=function(h,d){if(typeof h=="string"&&d&&typeof d.as=="string"){var g=d.as,m=u(g,d.crossOrigin),v=typeof d.integrity=="string"?d.integrity:void 0,y=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;g==="style"?i.d.S(h,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:m,integrity:v,fetchPriority:y}):g==="script"&&i.d.X(h,{crossOrigin:m,integrity:v,fetchPriority:y,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},sr.preinitModule=function(h,d){if(typeof h=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var g=u(d.as,d.crossOrigin);i.d.M(h,{crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&i.d.M(h)},sr.preload=function(h,d){if(typeof h=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var g=d.as,m=u(g,d.crossOrigin);i.d.L(h,g,{crossOrigin:m,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},sr.preloadModule=function(h,d){if(typeof h=="string")if(d){var g=u(d.as,d.crossOrigin);i.d.m(h,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:g,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else i.d.m(h)},sr.requestFormReset=function(h){i.d.r(h)},sr.unstable_batchedUpdates=function(h,d){return h(d)},sr.useFormState=function(h,d,g){return a.H.useFormState(h,d,g)},sr.useFormStatus=function(){return a.H.useHostTransitionStatus()},sr.version="19.2.0",sr}var IB;function V3(){if(IB)return c_.exports;IB=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),c_.exports=KX(),c_.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var PB;function XX(){if(PB)return wp;PB=1;var t=qX(),e=MI(),n=V3();function i(s){var l="https://react.dev/errors/"+s;if(1<arguments.length){l+="?args[]="+encodeURIComponent(arguments[1]);for(var c=2;c<arguments.length;c++)l+="&args[]="+encodeURIComponent(arguments[c])}return"Minified React error #"+s+"; visit "+l+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function r(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function o(s){var l=s,c=s;if(s.alternate)for(;l.return;)l=l.return;else{s=l;do l=s,(l.flags&4098)!==0&&(c=l.return),s=l.return;while(s)}return l.tag===3?c:null}function a(s){if(s.tag===13){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function u(s){if(s.tag===31){var l=s.memoizedState;if(l===null&&(s=s.alternate,s!==null&&(l=s.memoizedState)),l!==null)return l.dehydrated}return null}function h(s){if(o(s)!==s)throw Error(i(188))}function d(s){var l=s.alternate;if(!l){if(l=o(s),l===null)throw Error(i(188));return l!==s?null:s}for(var c=s,f=l;;){var p=c.return;if(p===null)break;var w=p.alternate;if(w===null){if(f=p.return,f!==null){c=f;continue}break}if(p.child===w.child){for(w=p.child;w;){if(w===c)return h(p),s;if(w===f)return h(p),l;w=w.sibling}throw Error(i(188))}if(c.return!==f.return)c=p,f=w;else{for(var R=!1,H=p.child;H;){if(H===c){R=!0,c=p,f=w;break}if(H===f){R=!0,f=p,c=w;break}H=H.sibling}if(!R){for(H=w.child;H;){if(H===c){R=!0,c=w,f=p;break}if(H===f){R=!0,f=w,c=p;break}H=H.sibling}if(!R)throw Error(i(189))}}if(c.alternate!==f)throw Error(i(190))}if(c.tag!==3)throw Error(i(188));return c.stateNode.current===c?s:l}function g(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s;for(s=s.child;s!==null;){if(l=g(s),l!==null)return l;s=s.sibling}return null}var m=Object.assign,v=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),C=Symbol.for("react.fragment"),T=Symbol.for("react.strict_mode"),O=Symbol.for("react.profiler"),A=Symbol.for("react.consumer"),N=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),$=Symbol.for("react.suspense"),L=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),Q=Symbol.for("react.lazy"),ue=Symbol.for("react.activity"),X=Symbol.for("react.memo_cache_sentinel"),me=Symbol.iterator;function re(s){return s===null||typeof s!="object"?null:(s=me&&s[me]||s["@@iterator"],typeof s=="function"?s:null)}var Se=Symbol.for("react.client.reference");function we(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===Se?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case C:return"Fragment";case O:return"Profiler";case T:return"StrictMode";case $:return"Suspense";case L:return"SuspenseList";case ue:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case b:return"Portal";case N:return s.displayName||"Context";case A:return(s._context.displayName||"Context")+".Consumer";case x:var l=s.render;return s=s.displayName,s||(s=l.displayName||l.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case P:return l=s.displayName||null,l!==null?l:we(s.type)||"Memo";case Q:l=s._payload,s=s._init;try{return we(s(l))}catch{}}return null}var _e=Array.isArray,ie=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,de=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Te={pending:!1,data:null,method:null,action:null},Pe=[],De=-1;function V(s){return{current:s}}function le(s){0>De||(s.current=Pe[De],Pe[De]=null,De--)}function ye(s,l){De++,Pe[De]=s.current,s.current=l}var S=V(null),E=V(null),M=V(null),F=V(null);function q(s,l){switch(ye(M,l),ye(E,s),ye(S,null),l.nodeType){case 9:case 11:s=(s=l.documentElement)&&(s=s.namespaceURI)?GV(s):0;break;default:if(s=l.tagName,l=l.namespaceURI)l=GV(l),s=qV(l,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}le(S),ye(S,s)}function J(){le(S),le(E),le(M)}function _(s){s.memoizedState!==null&&ye(F,s);var l=S.current,c=qV(l,s.type);l!==c&&(ye(E,s),ye(S,c))}function I(s){E.current===s&&(le(S),le(E)),F.current===s&&(le(F),fp._currentValue=Te)}var k,W;function D(s){if(k===void 0)try{throw Error()}catch(c){var l=c.stack.trim().match(/\n( *(at )?)/);k=l&&l[1]||"",W=-1<c.stack.indexOf(`
    at`)?" (<anonymous>)":-1<c.stack.indexOf("@")?"@unknown:0:0":""}return`
`+k+s+W}var z=!1;function Z(s,l){if(!s||z)return"";z=!0;var c=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var f={DetermineComponentFrameRoot:function(){try{if(l){var ve=function(){throw Error()};if(Object.defineProperty(ve.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ve,[])}catch(he){var ae=he}Reflect.construct(s,[],ve)}else{try{ve.call()}catch(he){ae=he}s.call(ve.prototype)}}else{try{throw Error()}catch(he){ae=he}(ve=s())&&typeof ve.catch=="function"&&ve.catch(function(){})}}catch(he){if(he&&ae&&typeof he.stack=="string")return[he.stack,ae.stack]}return[null,null]}};f.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var p=Object.getOwnPropertyDescriptor(f.DetermineComponentFrameRoot,"name");p&&p.configurable&&Object.defineProperty(f.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var w=f.DetermineComponentFrameRoot(),R=w[0],H=w[1];if(R&&H){var B=R.split(`
`),se=H.split(`
`);for(p=f=0;f<B.length&&!B[f].includes("DetermineComponentFrameRoot");)f++;for(;p<se.length&&!se[p].includes("DetermineComponentFrameRoot");)p++;if(f===B.length||p===se.length)for(f=B.length-1,p=se.length-1;1<=f&&0<=p&&B[f]!==se[p];)p--;for(;1<=f&&0<=p;f--,p--)if(B[f]!==se[p]){if(f!==1||p!==1)do if(f--,p--,0>p||B[f]!==se[p]){var ge=`
`+B[f].replace(" at new "," at ");return s.displayName&&ge.includes("<anonymous>")&&(ge=ge.replace("<anonymous>",s.displayName)),ge}while(1<=f&&0<=p);break}}}finally{z=!1,Error.prepareStackTrace=c}return(c=s?s.displayName||s.name:"")?D(c):""}function j(s,l){switch(s.tag){case 26:case 27:case 5:return D(s.type);case 16:return D("Lazy");case 13:return s.child!==l&&l!==null?D("Suspense Fallback"):D("Suspense");case 19:return D("SuspenseList");case 0:case 15:return Z(s.type,!1);case 11:return Z(s.type.render,!1);case 1:return Z(s.type,!0);case 31:return D("Activity");default:return""}}function K(s){try{var l="",c=null;do l+=j(s,c),c=s,s=s.return;while(s);return l}catch(f){return`
Error generating stack: `+f.message+`
`+f.stack}}var ne=Object.prototype.hasOwnProperty,ee=t.unstable_scheduleCallback,ce=t.unstable_cancelCallback,Re=t.unstable_shouldYield,Ae=t.unstable_requestPaint,Le=t.unstable_now,it=t.unstable_getCurrentPriorityLevel,bt=t.unstable_ImmediatePriority,Ze=t.unstable_UserBlockingPriority,Je=t.unstable_NormalPriority,Ct=t.unstable_LowPriority,Gn=t.unstable_IdlePriority,Zi=t.log,Qi=t.unstable_setDisableYieldValue,Rn=null,un=null;function Mt(s){if(typeof Zi=="function"&&Qi(s),un&&typeof un.setStrictMode=="function")try{un.setStrictMode(Rn,s)}catch{}}var nt=Math.clz32?Math.clz32:Ds,Lt=Math.log,Lr=Math.LN2;function Ds(s){return s>>>=0,s===0?32:31-(Lt(s)/Lr|0)|0}var wr=256,qn=262144,pi=4194304;function Wi(s){var l=s&42;if(l!==0)return l;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:return s&261888;case 262144:case 524288:case 1048576:case 2097152:return s&3932160;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Ls(s,l,c){var f=s.pendingLanes;if(f===0)return 0;var p=0,w=s.suspendedLanes,R=s.pingedLanes;s=s.warmLanes;var H=f&134217727;return H!==0?(f=H&~w,f!==0?p=Wi(f):(R&=H,R!==0?p=Wi(R):c||(c=H&~s,c!==0&&(p=Wi(c))))):(H=f&~w,H!==0?p=Wi(H):R!==0?p=Wi(R):c||(c=f&~s,c!==0&&(p=Wi(c)))),p===0?0:l!==0&&l!==p&&(l&w)===0&&(w=p&-p,c=l&-l,w>=c||w===32&&(c&4194048)!==0)?l:p}function pa(s,l){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&l)===0}function Tn(s,l){switch(s){case 1:case 2:case 4:case 8:case 64:return l+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return l+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function kr(){var s=pi;return pi<<=1,(pi&62914560)===0&&(pi=4194304),s}function cl(s){for(var l=[],c=0;31>c;c++)l.push(s);return l}function Uo(s,l){s.pendingLanes|=l,l!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function Yo(s,l,c,f,p,w){var R=s.pendingLanes;s.pendingLanes=c,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=c,s.entangledLanes&=c,s.errorRecoveryDisabledLanes&=c,s.shellSuspendCounter=0;var H=s.entanglements,B=s.expirationTimes,se=s.hiddenUpdates;for(c=R&~c;0<c;){var ge=31-nt(c),ve=1<<ge;H[ge]=0,B[ge]=-1;var ae=se[ge];if(ae!==null)for(se[ge]=null,ge=0;ge<ae.length;ge++){var he=ae[ge];he!==null&&(he.lane&=-536870913)}c&=~ve}f!==0&&Go(s,f,0),w!==0&&p===0&&s.tag!==0&&(s.suspendedLanes|=w&~(R&~l))}function Go(s,l,c){s.pendingLanes|=l,s.suspendedLanes&=~l;var f=31-nt(l);s.entangledLanes|=l,s.entanglements[f]=s.entanglements[f]|1073741824|c&261930}function Cu(s,l){var c=s.entangledLanes|=l;for(s=s.entanglements;c;){var f=31-nt(c),p=1<<f;p&l|s[f]&l&&(s[f]|=l),c&=~p}}function zd(s,l){var c=l&-l;return c=(c&42)!==0?1:Wt(c),(c&(s.suspendedLanes|l))!==0?0:c}function Wt(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function $r(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function Gc(){var s=de.p;return s!==0?s:(s=window.event,s===void 0?32:vB(s.type))}function _n(s,l){var c=de.p;try{return de.p=s,l()}finally{de.p=c}}var tn=Math.random().toString(36).slice(2),Kt="__reactFiber$"+tn,kt="__reactProps$"+tn,Vr="__reactContainer$"+tn,Ru="__reactEvents$"+tn,qc="__reactListeners$"+tn,Eu="__reactHandles$"+tn,Kc="__reactResources$"+tn,je="__reactMarker$"+tn;function Y(s){delete s[Kt],delete s[kt],delete s[Ru],delete s[qc],delete s[Eu]}function be(s){var l=s[Kt];if(l)return l;for(var c=s.parentNode;c;){if(l=c[Vr]||c[Kt]){if(c=l.alternate,l.child!==null||c!==null&&c.child!==null)for(s=tB(s);s!==null;){if(c=s[Kt])return c;s=tB(s)}return l}s=c,c=s.parentNode}return null}function ke(s){if(s=s[Kt]||s[Vr]){var l=s.tag;if(l===5||l===6||l===13||l===31||l===26||l===27||l===3)return s}return null}function nn(s){var l=s.tag;if(l===5||l===26||l===27||l===6)return s.stateNode;throw Error(i(33))}function Vn(s){var l=s[Kc];return l||(l=s[Kc]={hoistableStyles:new Map,hoistableScripts:new Map}),l}function yt(s){s[je]=!0}var Ji=new Set,qo={};function Br(s,l){va(s,l),va(s+"Capture",l)}function va(s,l){for(qo[s]=l,s=0;s<l.length;s++)Ji.add(l[s])}var Ii=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Am={},Om={};function N9(s){return ne.call(Om,s)?!0:ne.call(Am,s)?!1:Ii.test(s)?Om[s]=!0:(Am[s]=!0,!1)}function ny(s,l,c){if(N9(l))if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":s.removeAttribute(l);return;case"boolean":var f=l.toLowerCase().slice(0,5);if(f!=="data-"&&f!=="aria-"){s.removeAttribute(l);return}}s.setAttribute(l,""+c)}}function iy(s,l,c){if(c===null)s.removeAttribute(l);else{switch(typeof c){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(l);return}s.setAttribute(l,""+c)}}function hl(s,l,c,f){if(f===null)s.removeAttribute(c);else{switch(typeof f){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(c);return}s.setAttributeNS(l,c,""+f)}}function Ko(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function VL(s){var l=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(l==="checkbox"||l==="radio")}function D9(s,l,c){var f=Object.getOwnPropertyDescriptor(s.constructor.prototype,l);if(!s.hasOwnProperty(l)&&typeof f<"u"&&typeof f.get=="function"&&typeof f.set=="function"){var p=f.get,w=f.set;return Object.defineProperty(s,l,{configurable:!0,get:function(){return p.call(this)},set:function(R){c=""+R,w.call(this,R)}}),Object.defineProperty(s,l,{enumerable:f.enumerable}),{getValue:function(){return c},setValue:function(R){c=""+R},stopTracking:function(){s._valueTracker=null,delete s[l]}}}}function QR(s){if(!s._valueTracker){var l=VL(s)?"checked":"value";s._valueTracker=D9(s,l,""+s[l])}}function BL(s){if(!s)return!1;var l=s._valueTracker;if(!l)return!0;var c=l.getValue(),f="";return s&&(f=VL(s)?s.checked?"true":"false":s.value),s=f,s!==c?(l.setValue(s),!0):!1}function ry(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var L9=/[\n"\\]/g;function Xo(s){return s.replace(L9,function(l){return"\\"+l.charCodeAt(0).toString(16)+" "})}function JR(s,l,c,f,p,w,R,H){s.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?s.type=R:s.removeAttribute("type"),l!=null?R==="number"?(l===0&&s.value===""||s.value!=l)&&(s.value=""+Ko(l)):s.value!==""+Ko(l)&&(s.value=""+Ko(l)):R!=="submit"&&R!=="reset"||s.removeAttribute("value"),l!=null?eE(s,R,Ko(l)):c!=null?eE(s,R,Ko(c)):f!=null&&s.removeAttribute("value"),p==null&&w!=null&&(s.defaultChecked=!!w),p!=null&&(s.checked=p&&typeof p!="function"&&typeof p!="symbol"),H!=null&&typeof H!="function"&&typeof H!="symbol"&&typeof H!="boolean"?s.name=""+Ko(H):s.removeAttribute("name")}function FL(s,l,c,f,p,w,R,H){if(w!=null&&typeof w!="function"&&typeof w!="symbol"&&typeof w!="boolean"&&(s.type=w),l!=null||c!=null){if(!(w!=="submit"&&w!=="reset"||l!=null)){QR(s);return}c=c!=null?""+Ko(c):"",l=l!=null?""+Ko(l):c,H||l===s.value||(s.value=l),s.defaultValue=l}f=f??p,f=typeof f!="function"&&typeof f!="symbol"&&!!f,s.checked=H?s.checked:!!f,s.defaultChecked=!!f,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(s.name=R),QR(s)}function eE(s,l,c){l==="number"&&ry(s.ownerDocument)===s||s.defaultValue===""+c||(s.defaultValue=""+c)}function Ud(s,l,c,f){if(s=s.options,l){l={};for(var p=0;p<c.length;p++)l["$"+c[p]]=!0;for(c=0;c<s.length;c++)p=l.hasOwnProperty("$"+s[c].value),s[c].selected!==p&&(s[c].selected=p),p&&f&&(s[c].defaultSelected=!0)}else{for(c=""+Ko(c),l=null,p=0;p<s.length;p++){if(s[p].value===c){s[p].selected=!0,f&&(s[p].defaultSelected=!0);return}l!==null||s[p].disabled||(l=s[p])}l!==null&&(l.selected=!0)}}function WL(s,l,c){if(l!=null&&(l=""+Ko(l),l!==s.value&&(s.value=l),c==null)){s.defaultValue!==l&&(s.defaultValue=l);return}s.defaultValue=c!=null?""+Ko(c):""}function jL(s,l,c,f){if(l==null){if(f!=null){if(c!=null)throw Error(i(92));if(_e(f)){if(1<f.length)throw Error(i(93));f=f[0]}c=f}c==null&&(c=""),l=c}c=Ko(l),s.defaultValue=c,f=s.textContent,f===c&&f!==""&&f!==null&&(s.value=f),QR(s)}function Yd(s,l){if(l){var c=s.firstChild;if(c&&c===s.lastChild&&c.nodeType===3){c.nodeValue=l;return}}s.textContent=l}var k9=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function zL(s,l,c){var f=l.indexOf("--")===0;c==null||typeof c=="boolean"||c===""?f?s.setProperty(l,""):l==="float"?s.cssFloat="":s[l]="":f?s.setProperty(l,c):typeof c!="number"||c===0||k9.has(l)?l==="float"?s.cssFloat=c:s[l]=(""+c).trim():s[l]=c+"px"}function UL(s,l,c){if(l!=null&&typeof l!="object")throw Error(i(62));if(s=s.style,c!=null){for(var f in c)!c.hasOwnProperty(f)||l!=null&&l.hasOwnProperty(f)||(f.indexOf("--")===0?s.setProperty(f,""):f==="float"?s.cssFloat="":s[f]="");for(var p in l)f=l[p],l.hasOwnProperty(p)&&c[p]!==f&&zL(s,p,f)}else for(var w in l)l.hasOwnProperty(w)&&zL(s,w,l[w])}function tE(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var $9=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),V9=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function oy(s){return V9.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}function dl(){}var nE=null;function iE(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var Gd=null,qd=null;function YL(s){var l=ke(s);if(l&&(s=l.stateNode)){var c=s[kt]||null;e:switch(s=l.stateNode,l.type){case"input":if(JR(s,c.value,c.defaultValue,c.defaultValue,c.checked,c.defaultChecked,c.type,c.name),l=c.name,c.type==="radio"&&l!=null){for(c=s;c.parentNode;)c=c.parentNode;for(c=c.querySelectorAll('input[name="'+Xo(""+l)+'"][type="radio"]'),l=0;l<c.length;l++){var f=c[l];if(f!==s&&f.form===s.form){var p=f[kt]||null;if(!p)throw Error(i(90));JR(f,p.value,p.defaultValue,p.defaultValue,p.checked,p.defaultChecked,p.type,p.name)}}for(l=0;l<c.length;l++)f=c[l],f.form===s.form&&BL(f)}break e;case"textarea":WL(s,c.value,c.defaultValue);break e;case"select":l=c.value,l!=null&&Ud(s,!!c.multiple,l,!1)}}}var rE=!1;function GL(s,l,c){if(rE)return s(l,c);rE=!0;try{var f=s(l);return f}finally{if(rE=!1,(Gd!==null||qd!==null)&&(Yy(),Gd&&(l=Gd,s=qd,qd=Gd=null,YL(l),s)))for(l=0;l<s.length;l++)YL(s[l])}}function xm(s,l){var c=s.stateNode;if(c===null)return null;var f=c[kt]||null;if(f===null)return null;c=f[l];e:switch(l){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(f=!f.disabled)||(s=s.type,f=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!f;break e;default:s=!1}if(s)return null;if(c&&typeof c!="function")throw Error(i(231,l,typeof c));return c}var fl=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),oE=!1;if(fl)try{var Hm={};Object.defineProperty(Hm,"passive",{get:function(){oE=!0}}),window.addEventListener("test",Hm,Hm),window.removeEventListener("test",Hm,Hm)}catch{oE=!1}var Tu=null,sE=null,sy=null;function qL(){if(sy)return sy;var s,l=sE,c=l.length,f,p="value"in Tu?Tu.value:Tu.textContent,w=p.length;for(s=0;s<c&&l[s]===p[s];s++);var R=c-s;for(f=1;f<=R&&l[c-f]===p[w-f];f++);return sy=p.slice(s,1<f?1-f:void 0)}function ay(s){var l=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&l===13&&(s=13)):s=l,s===10&&(s=13),32<=s||s===13?s:0}function ly(){return!0}function KL(){return!1}function Fr(s){function l(c,f,p,w,R){this._reactName=c,this._targetInst=p,this.type=f,this.nativeEvent=w,this.target=R,this.currentTarget=null;for(var H in s)s.hasOwnProperty(H)&&(c=s[H],this[H]=c?c(w):w[H]);return this.isDefaultPrevented=(w.defaultPrevented!=null?w.defaultPrevented:w.returnValue===!1)?ly:KL,this.isPropagationStopped=KL,this}return m(l.prototype,{preventDefault:function(){this.defaultPrevented=!0;var c=this.nativeEvent;c&&(c.preventDefault?c.preventDefault():typeof c.returnValue!="unknown"&&(c.returnValue=!1),this.isDefaultPrevented=ly)},stopPropagation:function(){var c=this.nativeEvent;c&&(c.stopPropagation?c.stopPropagation():typeof c.cancelBubble!="unknown"&&(c.cancelBubble=!0),this.isPropagationStopped=ly)},persist:function(){},isPersistent:ly}),l}var Xc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},uy=Fr(Xc),Im=m({},Xc,{view:0,detail:0}),B9=Fr(Im),aE,lE,Pm,cy=m({},Im,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:cE,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Pm&&(Pm&&s.type==="mousemove"?(aE=s.screenX-Pm.screenX,lE=s.screenY-Pm.screenY):lE=aE=0,Pm=s),aE)},movementY:function(s){return"movementY"in s?s.movementY:lE}}),XL=Fr(cy),F9=m({},cy,{dataTransfer:0}),W9=Fr(F9),j9=m({},Im,{relatedTarget:0}),uE=Fr(j9),z9=m({},Xc,{animationName:0,elapsedTime:0,pseudoElement:0}),U9=Fr(z9),Y9=m({},Xc,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),G9=Fr(Y9),q9=m({},Xc,{data:0}),ZL=Fr(q9),K9={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},X9={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Z9={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Q9(s){var l=this.nativeEvent;return l.getModifierState?l.getModifierState(s):(s=Z9[s])?!!l[s]:!1}function cE(){return Q9}var J9=m({},Im,{key:function(s){if(s.key){var l=K9[s.key]||s.key;if(l!=="Unidentified")return l}return s.type==="keypress"?(s=ay(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?X9[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:cE,charCode:function(s){return s.type==="keypress"?ay(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ay(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),e7=Fr(J9),t7=m({},cy,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),QL=Fr(t7),n7=m({},Im,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:cE}),i7=Fr(n7),r7=m({},Xc,{propertyName:0,elapsedTime:0,pseudoElement:0}),o7=Fr(r7),s7=m({},cy,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),a7=Fr(s7),l7=m({},Xc,{newState:0,oldState:0}),u7=Fr(l7),c7=[9,13,27,32],hE=fl&&"CompositionEvent"in window,Nm=null;fl&&"documentMode"in document&&(Nm=document.documentMode);var h7=fl&&"TextEvent"in window&&!Nm,JL=fl&&(!hE||Nm&&8<Nm&&11>=Nm),ek=" ",tk=!1;function nk(s,l){switch(s){case"keyup":return c7.indexOf(l.keyCode)!==-1;case"keydown":return l.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ik(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var Kd=!1;function d7(s,l){switch(s){case"compositionend":return ik(l);case"keypress":return l.which!==32?null:(tk=!0,ek);case"textInput":return s=l.data,s===ek&&tk?null:s;default:return null}}function f7(s,l){if(Kd)return s==="compositionend"||!hE&&nk(s,l)?(s=qL(),sy=sE=Tu=null,Kd=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(l.ctrlKey||l.altKey||l.metaKey)||l.ctrlKey&&l.altKey){if(l.char&&1<l.char.length)return l.char;if(l.which)return String.fromCharCode(l.which)}return null;case"compositionend":return JL&&l.locale!=="ko"?null:l.data;default:return null}}var g7={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function rk(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l==="input"?!!g7[s.type]:l==="textarea"}function ok(s,l,c,f){Gd?qd?qd.push(f):qd=[f]:Gd=f,l=Jy(l,"onChange"),0<l.length&&(c=new uy("onChange","change",null,c,f),s.push({event:c,listeners:l}))}var Dm=null,Lm=null;function m7(s){FV(s,0)}function hy(s){var l=nn(s);if(BL(l))return s}function sk(s,l){if(s==="change")return l}var ak=!1;if(fl){var dE;if(fl){var fE="oninput"in document;if(!fE){var lk=document.createElement("div");lk.setAttribute("oninput","return;"),fE=typeof lk.oninput=="function"}dE=fE}else dE=!1;ak=dE&&(!document.documentMode||9<document.documentMode)}function uk(){Dm&&(Dm.detachEvent("onpropertychange",ck),Lm=Dm=null)}function ck(s){if(s.propertyName==="value"&&hy(Lm)){var l=[];ok(l,Lm,s,iE(s)),GL(m7,l)}}function p7(s,l,c){s==="focusin"?(uk(),Dm=l,Lm=c,Dm.attachEvent("onpropertychange",ck)):s==="focusout"&&uk()}function v7(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return hy(Lm)}function w7(s,l){if(s==="click")return hy(l)}function y7(s,l){if(s==="input"||s==="change")return hy(l)}function S7(s,l){return s===l&&(s!==0||1/s===1/l)||s!==s&&l!==l}var fo=typeof Object.is=="function"?Object.is:S7;function km(s,l){if(fo(s,l))return!0;if(typeof s!="object"||s===null||typeof l!="object"||l===null)return!1;var c=Object.keys(s),f=Object.keys(l);if(c.length!==f.length)return!1;for(f=0;f<c.length;f++){var p=c[f];if(!ne.call(l,p)||!fo(s[p],l[p]))return!1}return!0}function hk(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function dk(s,l){var c=hk(s);s=0;for(var f;c;){if(c.nodeType===3){if(f=s+c.textContent.length,s<=l&&f>=l)return{node:c,offset:l-s};s=f}e:{for(;c;){if(c.nextSibling){c=c.nextSibling;break e}c=c.parentNode}c=void 0}c=hk(c)}}function fk(s,l){return s&&l?s===l?!0:s&&s.nodeType===3?!1:l&&l.nodeType===3?fk(s,l.parentNode):"contains"in s?s.contains(l):s.compareDocumentPosition?!!(s.compareDocumentPosition(l)&16):!1:!1}function gk(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var l=ry(s.document);l instanceof s.HTMLIFrameElement;){try{var c=typeof l.contentWindow.location.href=="string"}catch{c=!1}if(c)s=l.contentWindow;else break;l=ry(s.document)}return l}function gE(s){var l=s&&s.nodeName&&s.nodeName.toLowerCase();return l&&(l==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||l==="textarea"||s.contentEditable==="true")}var b7=fl&&"documentMode"in document&&11>=document.documentMode,Xd=null,mE=null,$m=null,pE=!1;function mk(s,l,c){var f=c.window===c?c.document:c.nodeType===9?c:c.ownerDocument;pE||Xd==null||Xd!==ry(f)||(f=Xd,"selectionStart"in f&&gE(f)?f={start:f.selectionStart,end:f.selectionEnd}:(f=(f.ownerDocument&&f.ownerDocument.defaultView||window).getSelection(),f={anchorNode:f.anchorNode,anchorOffset:f.anchorOffset,focusNode:f.focusNode,focusOffset:f.focusOffset}),$m&&km($m,f)||($m=f,f=Jy(mE,"onSelect"),0<f.length&&(l=new uy("onSelect","select",null,l,c),s.push({event:l,listeners:f}),l.target=Xd)))}function Zc(s,l){var c={};return c[s.toLowerCase()]=l.toLowerCase(),c["Webkit"+s]="webkit"+l,c["Moz"+s]="moz"+l,c}var Zd={animationend:Zc("Animation","AnimationEnd"),animationiteration:Zc("Animation","AnimationIteration"),animationstart:Zc("Animation","AnimationStart"),transitionrun:Zc("Transition","TransitionRun"),transitionstart:Zc("Transition","TransitionStart"),transitioncancel:Zc("Transition","TransitionCancel"),transitionend:Zc("Transition","TransitionEnd")},vE={},pk={};fl&&(pk=document.createElement("div").style,"AnimationEvent"in window||(delete Zd.animationend.animation,delete Zd.animationiteration.animation,delete Zd.animationstart.animation),"TransitionEvent"in window||delete Zd.transitionend.transition);function Qc(s){if(vE[s])return vE[s];if(!Zd[s])return s;var l=Zd[s],c;for(c in l)if(l.hasOwnProperty(c)&&c in pk)return vE[s]=l[c];return s}var vk=Qc("animationend"),wk=Qc("animationiteration"),yk=Qc("animationstart"),C7=Qc("transitionrun"),R7=Qc("transitionstart"),E7=Qc("transitioncancel"),Sk=Qc("transitionend"),bk=new Map,wE="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");wE.push("scrollEnd");function ks(s,l){bk.set(s,l),Br(l,[s])}var dy=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var l=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(l))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)},Zo=[],Qd=0,yE=0;function fy(){for(var s=Qd,l=yE=Qd=0;l<s;){var c=Zo[l];Zo[l++]=null;var f=Zo[l];Zo[l++]=null;var p=Zo[l];Zo[l++]=null;var w=Zo[l];if(Zo[l++]=null,f!==null&&p!==null){var R=f.pending;R===null?p.next=p:(p.next=R.next,R.next=p),f.pending=p}w!==0&&Ck(c,p,w)}}function gy(s,l,c,f){Zo[Qd++]=s,Zo[Qd++]=l,Zo[Qd++]=c,Zo[Qd++]=f,yE|=f,s.lanes|=f,s=s.alternate,s!==null&&(s.lanes|=f)}function SE(s,l,c,f){return gy(s,l,c,f),my(s)}function Jc(s,l){return gy(s,null,null,l),my(s)}function Ck(s,l,c){s.lanes|=c;var f=s.alternate;f!==null&&(f.lanes|=c);for(var p=!1,w=s.return;w!==null;)w.childLanes|=c,f=w.alternate,f!==null&&(f.childLanes|=c),w.tag===22&&(s=w.stateNode,s===null||s._visibility&1||(p=!0)),s=w,w=w.return;return s.tag===3?(w=s.stateNode,p&&l!==null&&(p=31-nt(c),s=w.hiddenUpdates,f=s[p],f===null?s[p]=[l]:f.push(l),l.lane=c|536870912),w):null}function my(s){if(50<sp)throw sp=0,OT=null,Error(i(185));for(var l=s.return;l!==null;)s=l,l=s.return;return s.tag===3?s.stateNode:null}var Jd={};function T7(s,l,c,f){this.tag=s,this.key=c,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=l,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=f,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function go(s,l,c,f){return new T7(s,l,c,f)}function bE(s){return s=s.prototype,!(!s||!s.isReactComponent)}function gl(s,l){var c=s.alternate;return c===null?(c=go(s.tag,l,s.key,s.mode),c.elementType=s.elementType,c.type=s.type,c.stateNode=s.stateNode,c.alternate=s,s.alternate=c):(c.pendingProps=l,c.type=s.type,c.flags=0,c.subtreeFlags=0,c.deletions=null),c.flags=s.flags&65011712,c.childLanes=s.childLanes,c.lanes=s.lanes,c.child=s.child,c.memoizedProps=s.memoizedProps,c.memoizedState=s.memoizedState,c.updateQueue=s.updateQueue,l=s.dependencies,c.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext},c.sibling=s.sibling,c.index=s.index,c.ref=s.ref,c.refCleanup=s.refCleanup,c}function Rk(s,l){s.flags&=65011714;var c=s.alternate;return c===null?(s.childLanes=0,s.lanes=l,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=c.childLanes,s.lanes=c.lanes,s.child=c.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=c.memoizedProps,s.memoizedState=c.memoizedState,s.updateQueue=c.updateQueue,s.type=c.type,l=c.dependencies,s.dependencies=l===null?null:{lanes:l.lanes,firstContext:l.firstContext}),s}function py(s,l,c,f,p,w){var R=0;if(f=s,typeof s=="function")bE(s)&&(R=1);else if(typeof s=="string")R=xX(s,c,S.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case ue:return s=go(31,c,l,p),s.elementType=ue,s.lanes=w,s;case C:return eh(c.children,p,w,l);case T:R=8,p|=24;break;case O:return s=go(12,c,l,p|2),s.elementType=O,s.lanes=w,s;case $:return s=go(13,c,l,p),s.elementType=$,s.lanes=w,s;case L:return s=go(19,c,l,p),s.elementType=L,s.lanes=w,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:R=10;break e;case A:R=9;break e;case x:R=11;break e;case P:R=14;break e;case Q:R=16,f=null;break e}R=29,c=Error(i(130,s===null?"null":typeof s,"")),f=null}return l=go(R,c,l,p),l.elementType=s,l.type=f,l.lanes=w,l}function eh(s,l,c,f){return s=go(7,s,f,l),s.lanes=c,s}function CE(s,l,c){return s=go(6,s,null,l),s.lanes=c,s}function Ek(s){var l=go(18,null,null,0);return l.stateNode=s,l}function RE(s,l,c){return l=go(4,s.children!==null?s.children:[],s.key,l),l.lanes=c,l.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},l}var Tk=new WeakMap;function Qo(s,l){if(typeof s=="object"&&s!==null){var c=Tk.get(s);return c!==void 0?c:(l={value:s,source:l,stack:K(l)},Tk.set(s,l),l)}return{value:s,source:l,stack:K(l)}}var ef=[],tf=0,vy=null,Vm=0,Jo=[],es=0,_u=null,wa=1,ya="";function ml(s,l){ef[tf++]=Vm,ef[tf++]=vy,vy=s,Vm=l}function _k(s,l,c){Jo[es++]=wa,Jo[es++]=ya,Jo[es++]=_u,_u=s;var f=wa;s=ya;var p=32-nt(f)-1;f&=~(1<<p),c+=1;var w=32-nt(l)+p;if(30<w){var R=p-p%5;w=(f&(1<<R)-1).toString(32),f>>=R,p-=R,wa=1<<32-nt(l)+p|c<<p|f,ya=w+s}else wa=1<<w|c<<p|f,ya=s}function EE(s){s.return!==null&&(ml(s,1),_k(s,1,0))}function TE(s){for(;s===vy;)vy=ef[--tf],ef[tf]=null,Vm=ef[--tf],ef[tf]=null;for(;s===_u;)_u=Jo[--es],Jo[es]=null,ya=Jo[--es],Jo[es]=null,wa=Jo[--es],Jo[es]=null}function Mk(s,l){Jo[es++]=wa,Jo[es++]=ya,Jo[es++]=_u,wa=l.id,ya=l.overflow,_u=s}var er=null,Mn=null,$t=!1,Mu=null,ts=!1,_E=Error(i(519));function Au(s){var l=Error(i(418,1<arguments.length&&arguments[1]!==void 0&&arguments[1]?"text":"HTML",""));throw Bm(Qo(l,s)),_E}function Ak(s){var l=s.stateNode,c=s.type,f=s.memoizedProps;switch(l[Kt]=s,l[kt]=f,c){case"dialog":Ot("cancel",l),Ot("close",l);break;case"iframe":case"object":case"embed":Ot("load",l);break;case"video":case"audio":for(c=0;c<lp.length;c++)Ot(lp[c],l);break;case"source":Ot("error",l);break;case"img":case"image":case"link":Ot("error",l),Ot("load",l);break;case"details":Ot("toggle",l);break;case"input":Ot("invalid",l),FL(l,f.value,f.defaultValue,f.checked,f.defaultChecked,f.type,f.name,!0);break;case"select":Ot("invalid",l);break;case"textarea":Ot("invalid",l),jL(l,f.value,f.defaultValue,f.children)}c=f.children,typeof c!="string"&&typeof c!="number"&&typeof c!="bigint"||l.textContent===""+c||f.suppressHydrationWarning===!0||UV(l.textContent,c)?(f.popover!=null&&(Ot("beforetoggle",l),Ot("toggle",l)),f.onScroll!=null&&Ot("scroll",l),f.onScrollEnd!=null&&Ot("scrollend",l),f.onClick!=null&&(l.onclick=dl),l=!0):l=!1,l||Au(s,!0)}function Ok(s){for(er=s.return;er;)switch(er.tag){case 5:case 31:case 13:ts=!1;return;case 27:case 3:ts=!0;return;default:er=er.return}}function nf(s){if(s!==er)return!1;if(!$t)return Ok(s),$t=!0,!1;var l=s.tag,c;if((c=l!==3&&l!==27)&&((c=l===5)&&(c=s.type,c=!(c!=="form"&&c!=="button")||zT(s.type,s.memoizedProps)),c=!c),c&&Mn&&Au(s),Ok(s),l===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Mn=eB(s)}else if(l===31){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(317));Mn=eB(s)}else l===27?(l=Mn,Wu(s.type)?(s=KT,KT=null,Mn=s):Mn=l):Mn=er?is(s.stateNode.nextSibling):null;return!0}function th(){Mn=er=null,$t=!1}function ME(){var s=Mu;return s!==null&&(Ur===null?Ur=s:Ur.push.apply(Ur,s),Mu=null),s}function Bm(s){Mu===null?Mu=[s]:Mu.push(s)}var AE=V(null),nh=null,pl=null;function Ou(s,l,c){ye(AE,l._currentValue),l._currentValue=c}function vl(s){s._currentValue=AE.current,le(AE)}function OE(s,l,c){for(;s!==null;){var f=s.alternate;if((s.childLanes&l)!==l?(s.childLanes|=l,f!==null&&(f.childLanes|=l)):f!==null&&(f.childLanes&l)!==l&&(f.childLanes|=l),s===c)break;s=s.return}}function xE(s,l,c,f){var p=s.child;for(p!==null&&(p.return=s);p!==null;){var w=p.dependencies;if(w!==null){var R=p.child;w=w.firstContext;e:for(;w!==null;){var H=w;w=p;for(var B=0;B<l.length;B++)if(H.context===l[B]){w.lanes|=c,H=w.alternate,H!==null&&(H.lanes|=c),OE(w.return,c,s),f||(R=null);break e}w=H.next}}else if(p.tag===18){if(R=p.return,R===null)throw Error(i(341));R.lanes|=c,w=R.alternate,w!==null&&(w.lanes|=c),OE(R,c,s),R=null}else R=p.child;if(R!==null)R.return=p;else for(R=p;R!==null;){if(R===s){R=null;break}if(p=R.sibling,p!==null){p.return=R.return,R=p;break}R=R.return}p=R}}function rf(s,l,c,f){s=null;for(var p=l,w=!1;p!==null;){if(!w){if((p.flags&524288)!==0)w=!0;else if((p.flags&262144)!==0)break}if(p.tag===10){var R=p.alternate;if(R===null)throw Error(i(387));if(R=R.memoizedProps,R!==null){var H=p.type;fo(p.pendingProps.value,R.value)||(s!==null?s.push(H):s=[H])}}else if(p===F.current){if(R=p.alternate,R===null)throw Error(i(387));R.memoizedState.memoizedState!==p.memoizedState.memoizedState&&(s!==null?s.push(fp):s=[fp])}p=p.return}s!==null&&xE(l,s,c,f),l.flags|=262144}function wy(s){for(s=s.firstContext;s!==null;){if(!fo(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function ih(s){nh=s,pl=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function tr(s){return xk(nh,s)}function yy(s,l){return nh===null&&ih(s),xk(s,l)}function xk(s,l){var c=l._currentValue;if(l={context:l,memoizedValue:c,next:null},pl===null){if(s===null)throw Error(i(308));pl=l,s.dependencies={lanes:0,firstContext:l},s.flags|=524288}else pl=pl.next=l;return c}var _7=typeof AbortController<"u"?AbortController:function(){var s=[],l=this.signal={aborted:!1,addEventListener:function(c,f){s.push(f)}};this.abort=function(){l.aborted=!0,s.forEach(function(c){return c()})}},M7=t.unstable_scheduleCallback,A7=t.unstable_NormalPriority,vi={$$typeof:N,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function HE(){return{controller:new _7,data:new Map,refCount:0}}function Fm(s){s.refCount--,s.refCount===0&&M7(A7,function(){s.controller.abort()})}var Wm=null,IE=0,of=0,sf=null;function O7(s,l){if(Wm===null){var c=Wm=[];IE=0,of=DT(),sf={status:"pending",value:void 0,then:function(f){c.push(f)}}}return IE++,l.then(Hk,Hk),l}function Hk(){if(--IE===0&&Wm!==null){sf!==null&&(sf.status="fulfilled");var s=Wm;Wm=null,of=0,sf=null;for(var l=0;l<s.length;l++)(0,s[l])()}}function x7(s,l){var c=[],f={status:"pending",value:null,reason:null,then:function(p){c.push(p)}};return s.then(function(){f.status="fulfilled",f.value=l;for(var p=0;p<c.length;p++)(0,c[p])(l)},function(p){for(f.status="rejected",f.reason=p,p=0;p<c.length;p++)(0,c[p])(void 0)}),f}var Ik=ie.S;ie.S=function(s,l){mV=Le(),typeof l=="object"&&l!==null&&typeof l.then=="function"&&O7(s,l),Ik!==null&&Ik(s,l)};var rh=V(null);function PE(){var s=rh.current;return s!==null?s:yn.pooledCache}function Sy(s,l){l===null?ye(rh,rh.current):ye(rh,l.pool)}function Pk(){var s=PE();return s===null?null:{parent:vi._currentValue,pool:s}}var af=Error(i(460)),NE=Error(i(474)),by=Error(i(542)),Cy={then:function(){}};function Nk(s){return s=s.status,s==="fulfilled"||s==="rejected"}function Dk(s,l,c){switch(c=s[c],c===void 0?s.push(l):c!==l&&(l.then(dl,dl),l=c),l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,kk(s),s;default:if(typeof l.status=="string")l.then(dl,dl);else{if(s=yn,s!==null&&100<s.shellSuspendCounter)throw Error(i(482));s=l,s.status="pending",s.then(function(f){if(l.status==="pending"){var p=l;p.status="fulfilled",p.value=f}},function(f){if(l.status==="pending"){var p=l;p.status="rejected",p.reason=f}})}switch(l.status){case"fulfilled":return l.value;case"rejected":throw s=l.reason,kk(s),s}throw sh=l,af}}function oh(s){try{var l=s._init;return l(s._payload)}catch(c){throw c!==null&&typeof c=="object"&&typeof c.then=="function"?(sh=c,af):c}}var sh=null;function Lk(){if(sh===null)throw Error(i(459));var s=sh;return sh=null,s}function kk(s){if(s===af||s===by)throw Error(i(483))}var lf=null,jm=0;function Ry(s){var l=jm;return jm+=1,lf===null&&(lf=[]),Dk(lf,s,l)}function zm(s,l){l=l.props.ref,s.ref=l!==void 0?l:null}function Ey(s,l){throw l.$$typeof===v?Error(i(525)):(s=Object.prototype.toString.call(l),Error(i(31,s==="[object Object]"?"object with keys {"+Object.keys(l).join(", ")+"}":s)))}function $k(s){function l(te,G){if(s){var oe=te.deletions;oe===null?(te.deletions=[G],te.flags|=16):oe.push(G)}}function c(te,G){if(!s)return null;for(;G!==null;)l(te,G),G=G.sibling;return null}function f(te){for(var G=new Map;te!==null;)te.key!==null?G.set(te.key,te):G.set(te.index,te),te=te.sibling;return G}function p(te,G){return te=gl(te,G),te.index=0,te.sibling=null,te}function w(te,G,oe){return te.index=oe,s?(oe=te.alternate,oe!==null?(oe=oe.index,oe<G?(te.flags|=67108866,G):oe):(te.flags|=67108866,G)):(te.flags|=1048576,G)}function R(te){return s&&te.alternate===null&&(te.flags|=67108866),te}function H(te,G,oe,pe){return G===null||G.tag!==6?(G=CE(oe,te.mode,pe),G.return=te,G):(G=p(G,oe),G.return=te,G)}function B(te,G,oe,pe){var qe=oe.type;return qe===C?ge(te,G,oe.props.children,pe,oe.key):G!==null&&(G.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===Q&&oh(qe)===G.type)?(G=p(G,oe.props),zm(G,oe),G.return=te,G):(G=py(oe.type,oe.key,oe.props,null,te.mode,pe),zm(G,oe),G.return=te,G)}function se(te,G,oe,pe){return G===null||G.tag!==4||G.stateNode.containerInfo!==oe.containerInfo||G.stateNode.implementation!==oe.implementation?(G=RE(oe,te.mode,pe),G.return=te,G):(G=p(G,oe.children||[]),G.return=te,G)}function ge(te,G,oe,pe,qe){return G===null||G.tag!==7?(G=eh(oe,te.mode,pe,qe),G.return=te,G):(G=p(G,oe),G.return=te,G)}function ve(te,G,oe){if(typeof G=="string"&&G!==""||typeof G=="number"||typeof G=="bigint")return G=CE(""+G,te.mode,oe),G.return=te,G;if(typeof G=="object"&&G!==null){switch(G.$$typeof){case y:return oe=py(G.type,G.key,G.props,null,te.mode,oe),zm(oe,G),oe.return=te,oe;case b:return G=RE(G,te.mode,oe),G.return=te,G;case Q:return G=oh(G),ve(te,G,oe)}if(_e(G)||re(G))return G=eh(G,te.mode,oe,null),G.return=te,G;if(typeof G.then=="function")return ve(te,Ry(G),oe);if(G.$$typeof===N)return ve(te,yy(te,G),oe);Ey(te,G)}return null}function ae(te,G,oe,pe){var qe=G!==null?G.key:null;if(typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint")return qe!==null?null:H(te,G,""+oe,pe);if(typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:return oe.key===qe?B(te,G,oe,pe):null;case b:return oe.key===qe?se(te,G,oe,pe):null;case Q:return oe=oh(oe),ae(te,G,oe,pe)}if(_e(oe)||re(oe))return qe!==null?null:ge(te,G,oe,pe,null);if(typeof oe.then=="function")return ae(te,G,Ry(oe),pe);if(oe.$$typeof===N)return ae(te,G,yy(te,oe),pe);Ey(te,oe)}return null}function he(te,G,oe,pe,qe){if(typeof pe=="string"&&pe!==""||typeof pe=="number"||typeof pe=="bigint")return te=te.get(oe)||null,H(G,te,""+pe,qe);if(typeof pe=="object"&&pe!==null){switch(pe.$$typeof){case y:return te=te.get(pe.key===null?oe:pe.key)||null,B(G,te,pe,qe);case b:return te=te.get(pe.key===null?oe:pe.key)||null,se(G,te,pe,qe);case Q:return pe=oh(pe),he(te,G,oe,pe,qe)}if(_e(pe)||re(pe))return te=te.get(oe)||null,ge(G,te,pe,qe,null);if(typeof pe.then=="function")return he(te,G,oe,Ry(pe),qe);if(pe.$$typeof===N)return he(te,G,oe,yy(G,pe),qe);Ey(G,pe)}return null}function Be(te,G,oe,pe){for(var qe=null,jt=null,Ue=G,ht=G=0,Pt=null;Ue!==null&&ht<oe.length;ht++){Ue.index>ht?(Pt=Ue,Ue=null):Pt=Ue.sibling;var zt=ae(te,Ue,oe[ht],pe);if(zt===null){Ue===null&&(Ue=Pt);break}s&&Ue&&zt.alternate===null&&l(te,Ue),G=w(zt,G,ht),jt===null?qe=zt:jt.sibling=zt,jt=zt,Ue=Pt}if(ht===oe.length)return c(te,Ue),$t&&ml(te,ht),qe;if(Ue===null){for(;ht<oe.length;ht++)Ue=ve(te,oe[ht],pe),Ue!==null&&(G=w(Ue,G,ht),jt===null?qe=Ue:jt.sibling=Ue,jt=Ue);return $t&&ml(te,ht),qe}for(Ue=f(Ue);ht<oe.length;ht++)Pt=he(Ue,te,ht,oe[ht],pe),Pt!==null&&(s&&Pt.alternate!==null&&Ue.delete(Pt.key===null?ht:Pt.key),G=w(Pt,G,ht),jt===null?qe=Pt:jt.sibling=Pt,jt=Pt);return s&&Ue.forEach(function(Gu){return l(te,Gu)}),$t&&ml(te,ht),qe}function et(te,G,oe,pe){if(oe==null)throw Error(i(151));for(var qe=null,jt=null,Ue=G,ht=G=0,Pt=null,zt=oe.next();Ue!==null&&!zt.done;ht++,zt=oe.next()){Ue.index>ht?(Pt=Ue,Ue=null):Pt=Ue.sibling;var Gu=ae(te,Ue,zt.value,pe);if(Gu===null){Ue===null&&(Ue=Pt);break}s&&Ue&&Gu.alternate===null&&l(te,Ue),G=w(Gu,G,ht),jt===null?qe=Gu:jt.sibling=Gu,jt=Gu,Ue=Pt}if(zt.done)return c(te,Ue),$t&&ml(te,ht),qe;if(Ue===null){for(;!zt.done;ht++,zt=oe.next())zt=ve(te,zt.value,pe),zt!==null&&(G=w(zt,G,ht),jt===null?qe=zt:jt.sibling=zt,jt=zt);return $t&&ml(te,ht),qe}for(Ue=f(Ue);!zt.done;ht++,zt=oe.next())zt=he(Ue,te,ht,zt.value,pe),zt!==null&&(s&&zt.alternate!==null&&Ue.delete(zt.key===null?ht:zt.key),G=w(zt,G,ht),jt===null?qe=zt:jt.sibling=zt,jt=zt);return s&&Ue.forEach(function(FX){return l(te,FX)}),$t&&ml(te,ht),qe}function vn(te,G,oe,pe){if(typeof oe=="object"&&oe!==null&&oe.type===C&&oe.key===null&&(oe=oe.props.children),typeof oe=="object"&&oe!==null){switch(oe.$$typeof){case y:e:{for(var qe=oe.key;G!==null;){if(G.key===qe){if(qe=oe.type,qe===C){if(G.tag===7){c(te,G.sibling),pe=p(G,oe.props.children),pe.return=te,te=pe;break e}}else if(G.elementType===qe||typeof qe=="object"&&qe!==null&&qe.$$typeof===Q&&oh(qe)===G.type){c(te,G.sibling),pe=p(G,oe.props),zm(pe,oe),pe.return=te,te=pe;break e}c(te,G);break}else l(te,G);G=G.sibling}oe.type===C?(pe=eh(oe.props.children,te.mode,pe,oe.key),pe.return=te,te=pe):(pe=py(oe.type,oe.key,oe.props,null,te.mode,pe),zm(pe,oe),pe.return=te,te=pe)}return R(te);case b:e:{for(qe=oe.key;G!==null;){if(G.key===qe)if(G.tag===4&&G.stateNode.containerInfo===oe.containerInfo&&G.stateNode.implementation===oe.implementation){c(te,G.sibling),pe=p(G,oe.children||[]),pe.return=te,te=pe;break e}else{c(te,G);break}else l(te,G);G=G.sibling}pe=RE(oe,te.mode,pe),pe.return=te,te=pe}return R(te);case Q:return oe=oh(oe),vn(te,G,oe,pe)}if(_e(oe))return Be(te,G,oe,pe);if(re(oe)){if(qe=re(oe),typeof qe!="function")throw Error(i(150));return oe=qe.call(oe),et(te,G,oe,pe)}if(typeof oe.then=="function")return vn(te,G,Ry(oe),pe);if(oe.$$typeof===N)return vn(te,G,yy(te,oe),pe);Ey(te,oe)}return typeof oe=="string"&&oe!==""||typeof oe=="number"||typeof oe=="bigint"?(oe=""+oe,G!==null&&G.tag===6?(c(te,G.sibling),pe=p(G,oe),pe.return=te,te=pe):(c(te,G),pe=CE(oe,te.mode,pe),pe.return=te,te=pe),R(te)):c(te,G)}return function(te,G,oe,pe){try{jm=0;var qe=vn(te,G,oe,pe);return lf=null,qe}catch(Ue){if(Ue===af||Ue===by)throw Ue;var jt=go(29,Ue,null,te.mode);return jt.lanes=pe,jt.return=te,jt}finally{}}}var ah=$k(!0),Vk=$k(!1),xu=!1;function DE(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function LE(s,l){s=s.updateQueue,l.updateQueue===s&&(l.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Hu(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Iu(s,l,c){var f=s.updateQueue;if(f===null)return null;if(f=f.shared,(Xt&2)!==0){var p=f.pending;return p===null?l.next=l:(l.next=p.next,p.next=l),f.pending=l,l=my(s),Ck(s,null,c),l}return gy(s,f,l,c),my(s)}function Um(s,l,c){if(l=l.updateQueue,l!==null&&(l=l.shared,(c&4194048)!==0)){var f=l.lanes;f&=s.pendingLanes,c|=f,l.lanes=c,Cu(s,c)}}function kE(s,l){var c=s.updateQueue,f=s.alternate;if(f!==null&&(f=f.updateQueue,c===f)){var p=null,w=null;if(c=c.firstBaseUpdate,c!==null){do{var R={lane:c.lane,tag:c.tag,payload:c.payload,callback:null,next:null};w===null?p=w=R:w=w.next=R,c=c.next}while(c!==null);w===null?p=w=l:w=w.next=l}else p=w=l;c={baseState:f.baseState,firstBaseUpdate:p,lastBaseUpdate:w,shared:f.shared,callbacks:f.callbacks},s.updateQueue=c;return}s=c.lastBaseUpdate,s===null?c.firstBaseUpdate=l:s.next=l,c.lastBaseUpdate=l}var $E=!1;function Ym(){if($E){var s=sf;if(s!==null)throw s}}function Gm(s,l,c,f){$E=!1;var p=s.updateQueue;xu=!1;var w=p.firstBaseUpdate,R=p.lastBaseUpdate,H=p.shared.pending;if(H!==null){p.shared.pending=null;var B=H,se=B.next;B.next=null,R===null?w=se:R.next=se,R=B;var ge=s.alternate;ge!==null&&(ge=ge.updateQueue,H=ge.lastBaseUpdate,H!==R&&(H===null?ge.firstBaseUpdate=se:H.next=se,ge.lastBaseUpdate=B))}if(w!==null){var ve=p.baseState;R=0,ge=se=B=null,H=w;do{var ae=H.lane&-536870913,he=ae!==H.lane;if(he?(It&ae)===ae:(f&ae)===ae){ae!==0&&ae===of&&($E=!0),ge!==null&&(ge=ge.next={lane:0,tag:H.tag,payload:H.payload,callback:null,next:null});e:{var Be=s,et=H;ae=l;var vn=c;switch(et.tag){case 1:if(Be=et.payload,typeof Be=="function"){ve=Be.call(vn,ve,ae);break e}ve=Be;break e;case 3:Be.flags=Be.flags&-65537|128;case 0:if(Be=et.payload,ae=typeof Be=="function"?Be.call(vn,ve,ae):Be,ae==null)break e;ve=m({},ve,ae);break e;case 2:xu=!0}}ae=H.callback,ae!==null&&(s.flags|=64,he&&(s.flags|=8192),he=p.callbacks,he===null?p.callbacks=[ae]:he.push(ae))}else he={lane:ae,tag:H.tag,payload:H.payload,callback:H.callback,next:null},ge===null?(se=ge=he,B=ve):ge=ge.next=he,R|=ae;if(H=H.next,H===null){if(H=p.shared.pending,H===null)break;he=H,H=he.next,he.next=null,p.lastBaseUpdate=he,p.shared.pending=null}}while(!0);ge===null&&(B=ve),p.baseState=B,p.firstBaseUpdate=se,p.lastBaseUpdate=ge,w===null&&(p.shared.lanes=0),ku|=R,s.lanes=R,s.memoizedState=ve}}function Bk(s,l){if(typeof s!="function")throw Error(i(191,s));s.call(l)}function Fk(s,l){var c=s.callbacks;if(c!==null)for(s.callbacks=null,s=0;s<c.length;s++)Bk(c[s],l)}var uf=V(null),Ty=V(0);function Wk(s,l){s=_l,ye(Ty,s),ye(uf,l),_l=s|l.baseLanes}function VE(){ye(Ty,_l),ye(uf,uf.current)}function BE(){_l=Ty.current,le(uf),le(Ty)}var mo=V(null),ns=null;function Pu(s){var l=s.alternate;ye(oi,oi.current&1),ye(mo,s),ns===null&&(l===null||uf.current!==null||l.memoizedState!==null)&&(ns=s)}function FE(s){ye(oi,oi.current),ye(mo,s),ns===null&&(ns=s)}function jk(s){s.tag===22?(ye(oi,oi.current),ye(mo,s),ns===null&&(ns=s)):Nu()}function Nu(){ye(oi,oi.current),ye(mo,mo.current)}function po(s){le(mo),ns===s&&(ns=null),le(oi)}var oi=V(0);function _y(s){for(var l=s;l!==null;){if(l.tag===13){var c=l.memoizedState;if(c!==null&&(c=c.dehydrated,c===null||GT(c)||qT(c)))return l}else if(l.tag===19&&(l.memoizedProps.revealOrder==="forwards"||l.memoizedProps.revealOrder==="backwards"||l.memoizedProps.revealOrder==="unstable_legacy-backwards"||l.memoizedProps.revealOrder==="together")){if((l.flags&128)!==0)return l}else if(l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return null;l=l.return}l.sibling.return=l.return,l=l.sibling}return null}var wl=0,ct=null,mn=null,wi=null,My=!1,cf=!1,lh=!1,Ay=0,qm=0,hf=null,H7=0;function Kn(){throw Error(i(321))}function WE(s,l){if(l===null)return!1;for(var c=0;c<l.length&&c<s.length;c++)if(!fo(s[c],l[c]))return!1;return!0}function jE(s,l,c,f,p,w){return wl=w,ct=l,l.memoizedState=null,l.updateQueue=null,l.lanes=0,ie.H=s===null||s.memoizedState===null?_$:rT,lh=!1,w=c(f,p),lh=!1,cf&&(w=Uk(l,c,f,p)),zk(s),w}function zk(s){ie.H=Zm;var l=mn!==null&&mn.next!==null;if(wl=0,wi=mn=ct=null,My=!1,qm=0,hf=null,l)throw Error(i(300));s===null||yi||(s=s.dependencies,s!==null&&wy(s)&&(yi=!0))}function Uk(s,l,c,f){ct=s;var p=0;do{if(cf&&(hf=null),qm=0,cf=!1,25<=p)throw Error(i(301));if(p+=1,wi=mn=null,s.updateQueue!=null){var w=s.updateQueue;w.lastEffect=null,w.events=null,w.stores=null,w.memoCache!=null&&(w.memoCache.index=0)}ie.H=M$,w=l(c,f)}while(cf);return w}function I7(){var s=ie.H,l=s.useState()[0];return l=typeof l.then=="function"?Km(l):l,s=s.useState()[0],(mn!==null?mn.memoizedState:null)!==s&&(ct.flags|=1024),l}function zE(){var s=Ay!==0;return Ay=0,s}function UE(s,l,c){l.updateQueue=s.updateQueue,l.flags&=-2053,s.lanes&=~c}function YE(s){if(My){for(s=s.memoizedState;s!==null;){var l=s.queue;l!==null&&(l.pending=null),s=s.next}My=!1}wl=0,wi=mn=ct=null,cf=!1,qm=Ay=0,hf=null}function yr(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return wi===null?ct.memoizedState=wi=s:wi=wi.next=s,wi}function si(){if(mn===null){var s=ct.alternate;s=s!==null?s.memoizedState:null}else s=mn.next;var l=wi===null?ct.memoizedState:wi.next;if(l!==null)wi=l,mn=s;else{if(s===null)throw ct.alternate===null?Error(i(467)):Error(i(310));mn=s,s={memoizedState:mn.memoizedState,baseState:mn.baseState,baseQueue:mn.baseQueue,queue:mn.queue,next:null},wi===null?ct.memoizedState=wi=s:wi=wi.next=s}return wi}function Oy(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Km(s){var l=qm;return qm+=1,hf===null&&(hf=[]),s=Dk(hf,s,l),l=ct,(wi===null?l.memoizedState:wi.next)===null&&(l=l.alternate,ie.H=l===null||l.memoizedState===null?_$:rT),s}function xy(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return Km(s);if(s.$$typeof===N)return tr(s)}throw Error(i(438,String(s)))}function GE(s){var l=null,c=ct.updateQueue;if(c!==null&&(l=c.memoCache),l==null){var f=ct.alternate;f!==null&&(f=f.updateQueue,f!==null&&(f=f.memoCache,f!=null&&(l={data:f.data.map(function(p){return p.slice()}),index:0})))}if(l==null&&(l={data:[],index:0}),c===null&&(c=Oy(),ct.updateQueue=c),c.memoCache=l,c=l.data[l.index],c===void 0)for(c=l.data[l.index]=Array(s),f=0;f<s;f++)c[f]=X;return l.index++,c}function yl(s,l){return typeof l=="function"?l(s):l}function Hy(s){var l=si();return qE(l,mn,s)}function qE(s,l,c){var f=s.queue;if(f===null)throw Error(i(311));f.lastRenderedReducer=c;var p=s.baseQueue,w=f.pending;if(w!==null){if(p!==null){var R=p.next;p.next=w.next,w.next=R}l.baseQueue=p=w,f.pending=null}if(w=s.baseState,p===null)s.memoizedState=w;else{l=p.next;var H=R=null,B=null,se=l,ge=!1;do{var ve=se.lane&-536870913;if(ve!==se.lane?(It&ve)===ve:(wl&ve)===ve){var ae=se.revertLane;if(ae===0)B!==null&&(B=B.next={lane:0,revertLane:0,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null}),ve===of&&(ge=!0);else if((wl&ae)===ae){se=se.next,ae===of&&(ge=!0);continue}else ve={lane:0,revertLane:se.revertLane,gesture:null,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},B===null?(H=B=ve,R=w):B=B.next=ve,ct.lanes|=ae,ku|=ae;ve=se.action,lh&&c(w,ve),w=se.hasEagerState?se.eagerState:c(w,ve)}else ae={lane:ve,revertLane:se.revertLane,gesture:se.gesture,action:se.action,hasEagerState:se.hasEagerState,eagerState:se.eagerState,next:null},B===null?(H=B=ae,R=w):B=B.next=ae,ct.lanes|=ve,ku|=ve;se=se.next}while(se!==null&&se!==l);if(B===null?R=w:B.next=H,!fo(w,s.memoizedState)&&(yi=!0,ge&&(c=sf,c!==null)))throw c;s.memoizedState=w,s.baseState=R,s.baseQueue=B,f.lastRenderedState=w}return p===null&&(f.lanes=0),[s.memoizedState,f.dispatch]}function KE(s){var l=si(),c=l.queue;if(c===null)throw Error(i(311));c.lastRenderedReducer=s;var f=c.dispatch,p=c.pending,w=l.memoizedState;if(p!==null){c.pending=null;var R=p=p.next;do w=s(w,R.action),R=R.next;while(R!==p);fo(w,l.memoizedState)||(yi=!0),l.memoizedState=w,l.baseQueue===null&&(l.baseState=w),c.lastRenderedState=w}return[w,f]}function Yk(s,l,c){var f=ct,p=si(),w=$t;if(w){if(c===void 0)throw Error(i(407));c=c()}else c=l();var R=!fo((mn||p).memoizedState,c);if(R&&(p.memoizedState=c,yi=!0),p=p.queue,QE(Kk.bind(null,f,p,s),[s]),p.getSnapshot!==l||R||wi!==null&&wi.memoizedState.tag&1){if(f.flags|=2048,df(9,{destroy:void 0},qk.bind(null,f,p,c,l),null),yn===null)throw Error(i(349));w||(wl&127)!==0||Gk(f,l,c)}return c}function Gk(s,l,c){s.flags|=16384,s={getSnapshot:l,value:c},l=ct.updateQueue,l===null?(l=Oy(),ct.updateQueue=l,l.stores=[s]):(c=l.stores,c===null?l.stores=[s]:c.push(s))}function qk(s,l,c,f){l.value=c,l.getSnapshot=f,Xk(l)&&Zk(s)}function Kk(s,l,c){return c(function(){Xk(l)&&Zk(s)})}function Xk(s){var l=s.getSnapshot;s=s.value;try{var c=l();return!fo(s,c)}catch{return!0}}function Zk(s){var l=Jc(s,2);l!==null&&Yr(l,s,2)}function XE(s){var l=yr();if(typeof s=="function"){var c=s;if(s=c(),lh){Mt(!0);try{c()}finally{Mt(!1)}}}return l.memoizedState=l.baseState=s,l.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:s},l}function Qk(s,l,c,f){return s.baseState=c,qE(s,mn,typeof f=="function"?f:yl)}function P7(s,l,c,f,p){if(Ny(s))throw Error(i(485));if(s=l.action,s!==null){var w={payload:p,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){w.listeners.push(R)}};ie.T!==null?c(!0):w.isTransition=!1,f(w),c=l.pending,c===null?(w.next=l.pending=w,Jk(l,w)):(w.next=c.next,l.pending=c.next=w)}}function Jk(s,l){var c=l.action,f=l.payload,p=s.state;if(l.isTransition){var w=ie.T,R={};ie.T=R;try{var H=c(p,f),B=ie.S;B!==null&&B(R,H),e$(s,l,H)}catch(se){ZE(s,l,se)}finally{w!==null&&R.types!==null&&(w.types=R.types),ie.T=w}}else try{w=c(p,f),e$(s,l,w)}catch(se){ZE(s,l,se)}}function e$(s,l,c){c!==null&&typeof c=="object"&&typeof c.then=="function"?c.then(function(f){t$(s,l,f)},function(f){return ZE(s,l,f)}):t$(s,l,c)}function t$(s,l,c){l.status="fulfilled",l.value=c,n$(l),s.state=c,l=s.pending,l!==null&&(c=l.next,c===l?s.pending=null:(c=c.next,l.next=c,Jk(s,c)))}function ZE(s,l,c){var f=s.pending;if(s.pending=null,f!==null){f=f.next;do l.status="rejected",l.reason=c,n$(l),l=l.next;while(l!==f)}s.action=null}function n$(s){s=s.listeners;for(var l=0;l<s.length;l++)(0,s[l])()}function i$(s,l){return l}function r$(s,l){if($t){var c=yn.formState;if(c!==null){e:{var f=ct;if($t){if(Mn){t:{for(var p=Mn,w=ts;p.nodeType!==8;){if(!w){p=null;break t}if(p=is(p.nextSibling),p===null){p=null;break t}}w=p.data,p=w==="F!"||w==="F"?p:null}if(p){Mn=is(p.nextSibling),f=p.data==="F!";break e}}Au(f)}f=!1}f&&(l=c[0])}}return c=yr(),c.memoizedState=c.baseState=l,f={pending:null,lanes:0,dispatch:null,lastRenderedReducer:i$,lastRenderedState:l},c.queue=f,c=R$.bind(null,ct,f),f.dispatch=c,f=XE(!1),w=iT.bind(null,ct,!1,f.queue),f=yr(),p={state:l,dispatch:null,action:s,pending:null},f.queue=p,c=P7.bind(null,ct,p,w,c),p.dispatch=c,f.memoizedState=s,[l,c,!1]}function o$(s){var l=si();return s$(l,mn,s)}function s$(s,l,c){if(l=qE(s,l,i$)[0],s=Hy(yl)[0],typeof l=="object"&&l!==null&&typeof l.then=="function")try{var f=Km(l)}catch(R){throw R===af?by:R}else f=l;l=si();var p=l.queue,w=p.dispatch;return c!==l.memoizedState&&(ct.flags|=2048,df(9,{destroy:void 0},N7.bind(null,p,c),null)),[f,w,s]}function N7(s,l){s.action=l}function a$(s){var l=si(),c=mn;if(c!==null)return s$(l,c,s);si(),l=l.memoizedState,c=si();var f=c.queue.dispatch;return c.memoizedState=s,[l,f,!1]}function df(s,l,c,f){return s={tag:s,create:c,deps:f,inst:l,next:null},l=ct.updateQueue,l===null&&(l=Oy(),ct.updateQueue=l),c=l.lastEffect,c===null?l.lastEffect=s.next=s:(f=c.next,c.next=s,s.next=f,l.lastEffect=s),s}function l$(){return si().memoizedState}function Iy(s,l,c,f){var p=yr();ct.flags|=s,p.memoizedState=df(1|l,{destroy:void 0},c,f===void 0?null:f)}function Py(s,l,c,f){var p=si();f=f===void 0?null:f;var w=p.memoizedState.inst;mn!==null&&f!==null&&WE(f,mn.memoizedState.deps)?p.memoizedState=df(l,w,c,f):(ct.flags|=s,p.memoizedState=df(1|l,w,c,f))}function u$(s,l){Iy(8390656,8,s,l)}function QE(s,l){Py(2048,8,s,l)}function D7(s){ct.flags|=4;var l=ct.updateQueue;if(l===null)l=Oy(),ct.updateQueue=l,l.events=[s];else{var c=l.events;c===null?l.events=[s]:c.push(s)}}function c$(s){var l=si().memoizedState;return D7({ref:l,nextImpl:s}),function(){if((Xt&2)!==0)throw Error(i(440));return l.impl.apply(void 0,arguments)}}function h$(s,l){return Py(4,2,s,l)}function d$(s,l){return Py(4,4,s,l)}function f$(s,l){if(typeof l=="function"){s=s();var c=l(s);return function(){typeof c=="function"?c():l(null)}}if(l!=null)return s=s(),l.current=s,function(){l.current=null}}function g$(s,l,c){c=c!=null?c.concat([s]):null,Py(4,4,f$.bind(null,l,s),c)}function JE(){}function m$(s,l){var c=si();l=l===void 0?null:l;var f=c.memoizedState;return l!==null&&WE(l,f[1])?f[0]:(c.memoizedState=[s,l],s)}function p$(s,l){var c=si();l=l===void 0?null:l;var f=c.memoizedState;if(l!==null&&WE(l,f[1]))return f[0];if(f=s(),lh){Mt(!0);try{s()}finally{Mt(!1)}}return c.memoizedState=[f,l],f}function eT(s,l,c){return c===void 0||(wl&1073741824)!==0&&(It&261930)===0?s.memoizedState=l:(s.memoizedState=c,s=vV(),ct.lanes|=s,ku|=s,c)}function v$(s,l,c,f){return fo(c,l)?c:uf.current!==null?(s=eT(s,c,f),fo(s,l)||(yi=!0),s):(wl&42)===0||(wl&1073741824)!==0&&(It&261930)===0?(yi=!0,s.memoizedState=c):(s=vV(),ct.lanes|=s,ku|=s,l)}function w$(s,l,c,f,p){var w=de.p;de.p=w!==0&&8>w?w:8;var R=ie.T,H={};ie.T=H,iT(s,!1,l,c);try{var B=p(),se=ie.S;if(se!==null&&se(H,B),B!==null&&typeof B=="object"&&typeof B.then=="function"){var ge=x7(B,f);Xm(s,l,ge,yo(s))}else Xm(s,l,f,yo(s))}catch(ve){Xm(s,l,{then:function(){},status:"rejected",reason:ve},yo())}finally{de.p=w,R!==null&&H.types!==null&&(R.types=H.types),ie.T=R}}function L7(){}function tT(s,l,c,f){if(s.tag!==5)throw Error(i(476));var p=y$(s).queue;w$(s,p,l,Te,c===null?L7:function(){return S$(s),c(f)})}function y$(s){var l=s.memoizedState;if(l!==null)return l;l={memoizedState:Te,baseState:Te,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:Te},next:null};var c={};return l.next={memoizedState:c,baseState:c,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:yl,lastRenderedState:c},next:null},s.memoizedState=l,s=s.alternate,s!==null&&(s.memoizedState=l),l}function S$(s){var l=y$(s);l.next===null&&(l=s.alternate.memoizedState),Xm(s,l.next.queue,{},yo())}function nT(){return tr(fp)}function b$(){return si().memoizedState}function C$(){return si().memoizedState}function k7(s){for(var l=s.return;l!==null;){switch(l.tag){case 24:case 3:var c=yo();s=Hu(c);var f=Iu(l,s,c);f!==null&&(Yr(f,l,c),Um(f,l,c)),l={cache:HE()},s.payload=l;return}l=l.return}}function $7(s,l,c){var f=yo();c={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null},Ny(s)?E$(l,c):(c=SE(s,l,c,f),c!==null&&(Yr(c,s,f),T$(c,l,f)))}function R$(s,l,c){var f=yo();Xm(s,l,c,f)}function Xm(s,l,c,f){var p={lane:f,revertLane:0,gesture:null,action:c,hasEagerState:!1,eagerState:null,next:null};if(Ny(s))E$(l,p);else{var w=s.alternate;if(s.lanes===0&&(w===null||w.lanes===0)&&(w=l.lastRenderedReducer,w!==null))try{var R=l.lastRenderedState,H=w(R,c);if(p.hasEagerState=!0,p.eagerState=H,fo(H,R))return gy(s,l,p,0),yn===null&&fy(),!1}catch{}finally{}if(c=SE(s,l,p,f),c!==null)return Yr(c,s,f),T$(c,l,f),!0}return!1}function iT(s,l,c,f){if(f={lane:2,revertLane:DT(),gesture:null,action:f,hasEagerState:!1,eagerState:null,next:null},Ny(s)){if(l)throw Error(i(479))}else l=SE(s,c,f,2),l!==null&&Yr(l,s,2)}function Ny(s){var l=s.alternate;return s===ct||l!==null&&l===ct}function E$(s,l){cf=My=!0;var c=s.pending;c===null?l.next=l:(l.next=c.next,c.next=l),s.pending=l}function T$(s,l,c){if((c&4194048)!==0){var f=l.lanes;f&=s.pendingLanes,c|=f,l.lanes=c,Cu(s,c)}}var Zm={readContext:tr,use:xy,useCallback:Kn,useContext:Kn,useEffect:Kn,useImperativeHandle:Kn,useLayoutEffect:Kn,useInsertionEffect:Kn,useMemo:Kn,useReducer:Kn,useRef:Kn,useState:Kn,useDebugValue:Kn,useDeferredValue:Kn,useTransition:Kn,useSyncExternalStore:Kn,useId:Kn,useHostTransitionStatus:Kn,useFormState:Kn,useActionState:Kn,useOptimistic:Kn,useMemoCache:Kn,useCacheRefresh:Kn};Zm.useEffectEvent=Kn;var _$={readContext:tr,use:xy,useCallback:function(s,l){return yr().memoizedState=[s,l===void 0?null:l],s},useContext:tr,useEffect:u$,useImperativeHandle:function(s,l,c){c=c!=null?c.concat([s]):null,Iy(4194308,4,f$.bind(null,l,s),c)},useLayoutEffect:function(s,l){return Iy(4194308,4,s,l)},useInsertionEffect:function(s,l){Iy(4,2,s,l)},useMemo:function(s,l){var c=yr();l=l===void 0?null:l;var f=s();if(lh){Mt(!0);try{s()}finally{Mt(!1)}}return c.memoizedState=[f,l],f},useReducer:function(s,l,c){var f=yr();if(c!==void 0){var p=c(l);if(lh){Mt(!0);try{c(l)}finally{Mt(!1)}}}else p=l;return f.memoizedState=f.baseState=p,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:p},f.queue=s,s=s.dispatch=$7.bind(null,ct,s),[f.memoizedState,s]},useRef:function(s){var l=yr();return s={current:s},l.memoizedState=s},useState:function(s){s=XE(s);var l=s.queue,c=R$.bind(null,ct,l);return l.dispatch=c,[s.memoizedState,c]},useDebugValue:JE,useDeferredValue:function(s,l){var c=yr();return eT(c,s,l)},useTransition:function(){var s=XE(!1);return s=w$.bind(null,ct,s.queue,!0,!1),yr().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,l,c){var f=ct,p=yr();if($t){if(c===void 0)throw Error(i(407));c=c()}else{if(c=l(),yn===null)throw Error(i(349));(It&127)!==0||Gk(f,l,c)}p.memoizedState=c;var w={value:c,getSnapshot:l};return p.queue=w,u$(Kk.bind(null,f,w,s),[s]),f.flags|=2048,df(9,{destroy:void 0},qk.bind(null,f,w,c,l),null),c},useId:function(){var s=yr(),l=yn.identifierPrefix;if($t){var c=ya,f=wa;c=(f&~(1<<32-nt(f)-1)).toString(32)+c,l="_"+l+"R_"+c,c=Ay++,0<c&&(l+="H"+c.toString(32)),l+="_"}else c=H7++,l="_"+l+"r_"+c.toString(32)+"_";return s.memoizedState=l},useHostTransitionStatus:nT,useFormState:r$,useActionState:r$,useOptimistic:function(s){var l=yr();l.memoizedState=l.baseState=s;var c={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return l.queue=c,l=iT.bind(null,ct,!0,c),c.dispatch=l,[s,l]},useMemoCache:GE,useCacheRefresh:function(){return yr().memoizedState=k7.bind(null,ct)},useEffectEvent:function(s){var l=yr(),c={impl:s};return l.memoizedState=c,function(){if((Xt&2)!==0)throw Error(i(440));return c.impl.apply(void 0,arguments)}}},rT={readContext:tr,use:xy,useCallback:m$,useContext:tr,useEffect:QE,useImperativeHandle:g$,useInsertionEffect:h$,useLayoutEffect:d$,useMemo:p$,useReducer:Hy,useRef:l$,useState:function(){return Hy(yl)},useDebugValue:JE,useDeferredValue:function(s,l){var c=si();return v$(c,mn.memoizedState,s,l)},useTransition:function(){var s=Hy(yl)[0],l=si().memoizedState;return[typeof s=="boolean"?s:Km(s),l]},useSyncExternalStore:Yk,useId:b$,useHostTransitionStatus:nT,useFormState:o$,useActionState:o$,useOptimistic:function(s,l){var c=si();return Qk(c,mn,s,l)},useMemoCache:GE,useCacheRefresh:C$};rT.useEffectEvent=c$;var M$={readContext:tr,use:xy,useCallback:m$,useContext:tr,useEffect:QE,useImperativeHandle:g$,useInsertionEffect:h$,useLayoutEffect:d$,useMemo:p$,useReducer:KE,useRef:l$,useState:function(){return KE(yl)},useDebugValue:JE,useDeferredValue:function(s,l){var c=si();return mn===null?eT(c,s,l):v$(c,mn.memoizedState,s,l)},useTransition:function(){var s=KE(yl)[0],l=si().memoizedState;return[typeof s=="boolean"?s:Km(s),l]},useSyncExternalStore:Yk,useId:b$,useHostTransitionStatus:nT,useFormState:a$,useActionState:a$,useOptimistic:function(s,l){var c=si();return mn!==null?Qk(c,mn,s,l):(c.baseState=s,[s,c.queue.dispatch])},useMemoCache:GE,useCacheRefresh:C$};M$.useEffectEvent=c$;function oT(s,l,c,f){l=s.memoizedState,c=c(f,l),c=c==null?l:m({},l,c),s.memoizedState=c,s.lanes===0&&(s.updateQueue.baseState=c)}var sT={enqueueSetState:function(s,l,c){s=s._reactInternals;var f=yo(),p=Hu(f);p.payload=l,c!=null&&(p.callback=c),l=Iu(s,p,f),l!==null&&(Yr(l,s,f),Um(l,s,f))},enqueueReplaceState:function(s,l,c){s=s._reactInternals;var f=yo(),p=Hu(f);p.tag=1,p.payload=l,c!=null&&(p.callback=c),l=Iu(s,p,f),l!==null&&(Yr(l,s,f),Um(l,s,f))},enqueueForceUpdate:function(s,l){s=s._reactInternals;var c=yo(),f=Hu(c);f.tag=2,l!=null&&(f.callback=l),l=Iu(s,f,c),l!==null&&(Yr(l,s,c),Um(l,s,c))}};function A$(s,l,c,f,p,w,R){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(f,w,R):l.prototype&&l.prototype.isPureReactComponent?!km(c,f)||!km(p,w):!0}function O$(s,l,c,f){s=l.state,typeof l.componentWillReceiveProps=="function"&&l.componentWillReceiveProps(c,f),typeof l.UNSAFE_componentWillReceiveProps=="function"&&l.UNSAFE_componentWillReceiveProps(c,f),l.state!==s&&sT.enqueueReplaceState(l,l.state,null)}function uh(s,l){var c=l;if("ref"in l){c={};for(var f in l)f!=="ref"&&(c[f]=l[f])}if(s=s.defaultProps){c===l&&(c=m({},c));for(var p in s)c[p]===void 0&&(c[p]=s[p])}return c}function x$(s){dy(s)}function H$(s){console.error(s)}function I$(s){dy(s)}function Dy(s,l){try{var c=s.onUncaughtError;c(l.value,{componentStack:l.stack})}catch(f){setTimeout(function(){throw f})}}function P$(s,l,c){try{var f=s.onCaughtError;f(c.value,{componentStack:c.stack,errorBoundary:l.tag===1?l.stateNode:null})}catch(p){setTimeout(function(){throw p})}}function aT(s,l,c){return c=Hu(c),c.tag=3,c.payload={element:null},c.callback=function(){Dy(s,l)},c}function N$(s){return s=Hu(s),s.tag=3,s}function D$(s,l,c,f){var p=c.type.getDerivedStateFromError;if(typeof p=="function"){var w=f.value;s.payload=function(){return p(w)},s.callback=function(){P$(l,c,f)}}var R=c.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(s.callback=function(){P$(l,c,f),typeof p!="function"&&($u===null?$u=new Set([this]):$u.add(this));var H=f.stack;this.componentDidCatch(f.value,{componentStack:H!==null?H:""})})}function V7(s,l,c,f,p){if(c.flags|=32768,f!==null&&typeof f=="object"&&typeof f.then=="function"){if(l=c.alternate,l!==null&&rf(l,c,p,!0),c=mo.current,c!==null){switch(c.tag){case 31:case 13:return ns===null?Gy():c.alternate===null&&Xn===0&&(Xn=3),c.flags&=-257,c.flags|=65536,c.lanes=p,f===Cy?c.flags|=16384:(l=c.updateQueue,l===null?c.updateQueue=new Set([f]):l.add(f),IT(s,f,p)),!1;case 22:return c.flags|=65536,f===Cy?c.flags|=16384:(l=c.updateQueue,l===null?(l={transitions:null,markerInstances:null,retryQueue:new Set([f])},c.updateQueue=l):(c=l.retryQueue,c===null?l.retryQueue=new Set([f]):c.add(f)),IT(s,f,p)),!1}throw Error(i(435,c.tag))}return IT(s,f,p),Gy(),!1}if($t)return l=mo.current,l!==null?((l.flags&65536)===0&&(l.flags|=256),l.flags|=65536,l.lanes=p,f!==_E&&(s=Error(i(422),{cause:f}),Bm(Qo(s,c)))):(f!==_E&&(l=Error(i(423),{cause:f}),Bm(Qo(l,c))),s=s.current.alternate,s.flags|=65536,p&=-p,s.lanes|=p,f=Qo(f,c),p=aT(s.stateNode,f,p),kE(s,p),Xn!==4&&(Xn=2)),!1;var w=Error(i(520),{cause:f});if(w=Qo(w,c),op===null?op=[w]:op.push(w),Xn!==4&&(Xn=2),l===null)return!0;f=Qo(f,c),c=l;do{switch(c.tag){case 3:return c.flags|=65536,s=p&-p,c.lanes|=s,s=aT(c.stateNode,f,s),kE(c,s),!1;case 1:if(l=c.type,w=c.stateNode,(c.flags&128)===0&&(typeof l.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&($u===null||!$u.has(w))))return c.flags|=65536,p&=-p,c.lanes|=p,p=N$(p),D$(p,s,c,f),kE(c,p),!1}c=c.return}while(c!==null);return!1}var lT=Error(i(461)),yi=!1;function nr(s,l,c,f){l.child=s===null?Vk(l,null,c,f):ah(l,s.child,c,f)}function L$(s,l,c,f,p){c=c.render;var w=l.ref;if("ref"in f){var R={};for(var H in f)H!=="ref"&&(R[H]=f[H])}else R=f;return ih(l),f=jE(s,l,c,R,w,p),H=zE(),s!==null&&!yi?(UE(s,l,p),Sl(s,l,p)):($t&&H&&EE(l),l.flags|=1,nr(s,l,f,p),l.child)}function k$(s,l,c,f,p){if(s===null){var w=c.type;return typeof w=="function"&&!bE(w)&&w.defaultProps===void 0&&c.compare===null?(l.tag=15,l.type=w,$$(s,l,w,f,p)):(s=py(c.type,null,f,l,l.mode,p),s.ref=l.ref,s.return=l,l.child=s)}if(w=s.child,!pT(s,p)){var R=w.memoizedProps;if(c=c.compare,c=c!==null?c:km,c(R,f)&&s.ref===l.ref)return Sl(s,l,p)}return l.flags|=1,s=gl(w,f),s.ref=l.ref,s.return=l,l.child=s}function $$(s,l,c,f,p){if(s!==null){var w=s.memoizedProps;if(km(w,f)&&s.ref===l.ref)if(yi=!1,l.pendingProps=f=w,pT(s,p))(s.flags&131072)!==0&&(yi=!0);else return l.lanes=s.lanes,Sl(s,l,p)}return uT(s,l,c,f,p)}function V$(s,l,c,f){var p=f.children,w=s!==null?s.memoizedState:null;if(s===null&&l.stateNode===null&&(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),f.mode==="hidden"){if((l.flags&128)!==0){if(w=w!==null?w.baseLanes|c:c,s!==null){for(f=l.child=s.child,p=0;f!==null;)p=p|f.lanes|f.childLanes,f=f.sibling;f=p&~w}else f=0,l.child=null;return B$(s,l,w,c,f)}if((c&536870912)!==0)l.memoizedState={baseLanes:0,cachePool:null},s!==null&&Sy(l,w!==null?w.cachePool:null),w!==null?Wk(l,w):VE(),jk(l);else return f=l.lanes=536870912,B$(s,l,w!==null?w.baseLanes|c:c,c,f)}else w!==null?(Sy(l,w.cachePool),Wk(l,w),Nu(),l.memoizedState=null):(s!==null&&Sy(l,null),VE(),Nu());return nr(s,l,p,c),l.child}function Qm(s,l){return s!==null&&s.tag===22||l.stateNode!==null||(l.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null}),l.sibling}function B$(s,l,c,f,p){var w=PE();return w=w===null?null:{parent:vi._currentValue,pool:w},l.memoizedState={baseLanes:c,cachePool:w},s!==null&&Sy(l,null),VE(),jk(l),s!==null&&rf(s,l,f,!0),l.childLanes=p,null}function Ly(s,l){return l=$y({mode:l.mode,children:l.children},s.mode),l.ref=s.ref,s.child=l,l.return=s,l}function F$(s,l,c){return ah(l,s.child,null,c),s=Ly(l,l.pendingProps),s.flags|=2,po(l),l.memoizedState=null,s}function B7(s,l,c){var f=l.pendingProps,p=(l.flags&128)!==0;if(l.flags&=-129,s===null){if($t){if(f.mode==="hidden")return s=Ly(l,f),l.lanes=536870912,Qm(null,s);if(FE(l),(s=Mn)?(s=JV(s,ts),s=s!==null&&s.data==="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:_u!==null?{id:wa,overflow:ya}:null,retryLane:536870912,hydrationErrors:null},c=Ek(s),c.return=l,l.child=c,er=l,Mn=null)):s=null,s===null)throw Au(l);return l.lanes=536870912,null}return Ly(l,f)}var w=s.memoizedState;if(w!==null){var R=w.dehydrated;if(FE(l),p)if(l.flags&256)l.flags&=-257,l=F$(s,l,c);else if(l.memoizedState!==null)l.child=s.child,l.flags|=128,l=null;else throw Error(i(558));else if(yi||rf(s,l,c,!1),p=(c&s.childLanes)!==0,yi||p){if(f=yn,f!==null&&(R=zd(f,c),R!==0&&R!==w.retryLane))throw w.retryLane=R,Jc(s,R),Yr(f,s,R),lT;Gy(),l=F$(s,l,c)}else s=w.treeContext,Mn=is(R.nextSibling),er=l,$t=!0,Mu=null,ts=!1,s!==null&&Mk(l,s),l=Ly(l,f),l.flags|=4096;return l}return s=gl(s.child,{mode:f.mode,children:f.children}),s.ref=l.ref,l.child=s,s.return=l,s}function ky(s,l){var c=l.ref;if(c===null)s!==null&&s.ref!==null&&(l.flags|=4194816);else{if(typeof c!="function"&&typeof c!="object")throw Error(i(284));(s===null||s.ref!==c)&&(l.flags|=4194816)}}function uT(s,l,c,f,p){return ih(l),c=jE(s,l,c,f,void 0,p),f=zE(),s!==null&&!yi?(UE(s,l,p),Sl(s,l,p)):($t&&f&&EE(l),l.flags|=1,nr(s,l,c,p),l.child)}function W$(s,l,c,f,p,w){return ih(l),l.updateQueue=null,c=Uk(l,f,c,p),zk(s),f=zE(),s!==null&&!yi?(UE(s,l,w),Sl(s,l,w)):($t&&f&&EE(l),l.flags|=1,nr(s,l,c,w),l.child)}function j$(s,l,c,f,p){if(ih(l),l.stateNode===null){var w=Jd,R=c.contextType;typeof R=="object"&&R!==null&&(w=tr(R)),w=new c(f,w),l.memoizedState=w.state!==null&&w.state!==void 0?w.state:null,w.updater=sT,l.stateNode=w,w._reactInternals=l,w=l.stateNode,w.props=f,w.state=l.memoizedState,w.refs={},DE(l),R=c.contextType,w.context=typeof R=="object"&&R!==null?tr(R):Jd,w.state=l.memoizedState,R=c.getDerivedStateFromProps,typeof R=="function"&&(oT(l,c,R,f),w.state=l.memoizedState),typeof c.getDerivedStateFromProps=="function"||typeof w.getSnapshotBeforeUpdate=="function"||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(R=w.state,typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount(),R!==w.state&&sT.enqueueReplaceState(w,w.state,null),Gm(l,f,w,p),Ym(),w.state=l.memoizedState),typeof w.componentDidMount=="function"&&(l.flags|=4194308),f=!0}else if(s===null){w=l.stateNode;var H=l.memoizedProps,B=uh(c,H);w.props=B;var se=w.context,ge=c.contextType;R=Jd,typeof ge=="object"&&ge!==null&&(R=tr(ge));var ve=c.getDerivedStateFromProps;ge=typeof ve=="function"||typeof w.getSnapshotBeforeUpdate=="function",H=l.pendingProps!==H,ge||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(H||se!==R)&&O$(l,w,f,R),xu=!1;var ae=l.memoizedState;w.state=ae,Gm(l,f,w,p),Ym(),se=l.memoizedState,H||ae!==se||xu?(typeof ve=="function"&&(oT(l,c,ve,f),se=l.memoizedState),(B=xu||A$(l,c,B,f,ae,se,R))?(ge||typeof w.UNSAFE_componentWillMount!="function"&&typeof w.componentWillMount!="function"||(typeof w.componentWillMount=="function"&&w.componentWillMount(),typeof w.UNSAFE_componentWillMount=="function"&&w.UNSAFE_componentWillMount()),typeof w.componentDidMount=="function"&&(l.flags|=4194308)):(typeof w.componentDidMount=="function"&&(l.flags|=4194308),l.memoizedProps=f,l.memoizedState=se),w.props=f,w.state=se,w.context=R,f=B):(typeof w.componentDidMount=="function"&&(l.flags|=4194308),f=!1)}else{w=l.stateNode,LE(s,l),R=l.memoizedProps,ge=uh(c,R),w.props=ge,ve=l.pendingProps,ae=w.context,se=c.contextType,B=Jd,typeof se=="object"&&se!==null&&(B=tr(se)),H=c.getDerivedStateFromProps,(se=typeof H=="function"||typeof w.getSnapshotBeforeUpdate=="function")||typeof w.UNSAFE_componentWillReceiveProps!="function"&&typeof w.componentWillReceiveProps!="function"||(R!==ve||ae!==B)&&O$(l,w,f,B),xu=!1,ae=l.memoizedState,w.state=ae,Gm(l,f,w,p),Ym();var he=l.memoizedState;R!==ve||ae!==he||xu||s!==null&&s.dependencies!==null&&wy(s.dependencies)?(typeof H=="function"&&(oT(l,c,H,f),he=l.memoizedState),(ge=xu||A$(l,c,ge,f,ae,he,B)||s!==null&&s.dependencies!==null&&wy(s.dependencies))?(se||typeof w.UNSAFE_componentWillUpdate!="function"&&typeof w.componentWillUpdate!="function"||(typeof w.componentWillUpdate=="function"&&w.componentWillUpdate(f,he,B),typeof w.UNSAFE_componentWillUpdate=="function"&&w.UNSAFE_componentWillUpdate(f,he,B)),typeof w.componentDidUpdate=="function"&&(l.flags|=4),typeof w.getSnapshotBeforeUpdate=="function"&&(l.flags|=1024)):(typeof w.componentDidUpdate!="function"||R===s.memoizedProps&&ae===s.memoizedState||(l.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&ae===s.memoizedState||(l.flags|=1024),l.memoizedProps=f,l.memoizedState=he),w.props=f,w.state=he,w.context=B,f=ge):(typeof w.componentDidUpdate!="function"||R===s.memoizedProps&&ae===s.memoizedState||(l.flags|=4),typeof w.getSnapshotBeforeUpdate!="function"||R===s.memoizedProps&&ae===s.memoizedState||(l.flags|=1024),f=!1)}return w=f,ky(s,l),f=(l.flags&128)!==0,w||f?(w=l.stateNode,c=f&&typeof c.getDerivedStateFromError!="function"?null:w.render(),l.flags|=1,s!==null&&f?(l.child=ah(l,s.child,null,p),l.child=ah(l,null,c,p)):nr(s,l,c,p),l.memoizedState=w.state,s=l.child):s=Sl(s,l,p),s}function z$(s,l,c,f){return th(),l.flags|=256,nr(s,l,c,f),l.child}var cT={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function hT(s){return{baseLanes:s,cachePool:Pk()}}function dT(s,l,c){return s=s!==null?s.childLanes&~c:0,l&&(s|=wo),s}function U$(s,l,c){var f=l.pendingProps,p=!1,w=(l.flags&128)!==0,R;if((R=w)||(R=s!==null&&s.memoizedState===null?!1:(oi.current&2)!==0),R&&(p=!0,l.flags&=-129),R=(l.flags&32)!==0,l.flags&=-33,s===null){if($t){if(p?Pu(l):Nu(),(s=Mn)?(s=JV(s,ts),s=s!==null&&s.data!=="&"?s:null,s!==null&&(l.memoizedState={dehydrated:s,treeContext:_u!==null?{id:wa,overflow:ya}:null,retryLane:536870912,hydrationErrors:null},c=Ek(s),c.return=l,l.child=c,er=l,Mn=null)):s=null,s===null)throw Au(l);return qT(s)?l.lanes=32:l.lanes=536870912,null}var H=f.children;return f=f.fallback,p?(Nu(),p=l.mode,H=$y({mode:"hidden",children:H},p),f=eh(f,p,c,null),H.return=l,f.return=l,H.sibling=f,l.child=H,f=l.child,f.memoizedState=hT(c),f.childLanes=dT(s,R,c),l.memoizedState=cT,Qm(null,f)):(Pu(l),fT(l,H))}var B=s.memoizedState;if(B!==null&&(H=B.dehydrated,H!==null)){if(w)l.flags&256?(Pu(l),l.flags&=-257,l=gT(s,l,c)):l.memoizedState!==null?(Nu(),l.child=s.child,l.flags|=128,l=null):(Nu(),H=f.fallback,p=l.mode,f=$y({mode:"visible",children:f.children},p),H=eh(H,p,c,null),H.flags|=2,f.return=l,H.return=l,f.sibling=H,l.child=f,ah(l,s.child,null,c),f=l.child,f.memoizedState=hT(c),f.childLanes=dT(s,R,c),l.memoizedState=cT,l=Qm(null,f));else if(Pu(l),qT(H)){if(R=H.nextSibling&&H.nextSibling.dataset,R)var se=R.dgst;R=se,f=Error(i(419)),f.stack="",f.digest=R,Bm({value:f,source:null,stack:null}),l=gT(s,l,c)}else if(yi||rf(s,l,c,!1),R=(c&s.childLanes)!==0,yi||R){if(R=yn,R!==null&&(f=zd(R,c),f!==0&&f!==B.retryLane))throw B.retryLane=f,Jc(s,f),Yr(R,s,f),lT;GT(H)||Gy(),l=gT(s,l,c)}else GT(H)?(l.flags|=192,l.child=s.child,l=null):(s=B.treeContext,Mn=is(H.nextSibling),er=l,$t=!0,Mu=null,ts=!1,s!==null&&Mk(l,s),l=fT(l,f.children),l.flags|=4096);return l}return p?(Nu(),H=f.fallback,p=l.mode,B=s.child,se=B.sibling,f=gl(B,{mode:"hidden",children:f.children}),f.subtreeFlags=B.subtreeFlags&65011712,se!==null?H=gl(se,H):(H=eh(H,p,c,null),H.flags|=2),H.return=l,f.return=l,f.sibling=H,l.child=f,Qm(null,f),f=l.child,H=s.child.memoizedState,H===null?H=hT(c):(p=H.cachePool,p!==null?(B=vi._currentValue,p=p.parent!==B?{parent:B,pool:B}:p):p=Pk(),H={baseLanes:H.baseLanes|c,cachePool:p}),f.memoizedState=H,f.childLanes=dT(s,R,c),l.memoizedState=cT,Qm(s.child,f)):(Pu(l),c=s.child,s=c.sibling,c=gl(c,{mode:"visible",children:f.children}),c.return=l,c.sibling=null,s!==null&&(R=l.deletions,R===null?(l.deletions=[s],l.flags|=16):R.push(s)),l.child=c,l.memoizedState=null,c)}function fT(s,l){return l=$y({mode:"visible",children:l},s.mode),l.return=s,s.child=l}function $y(s,l){return s=go(22,s,null,l),s.lanes=0,s}function gT(s,l,c){return ah(l,s.child,null,c),s=fT(l,l.pendingProps.children),s.flags|=2,l.memoizedState=null,s}function Y$(s,l,c){s.lanes|=l;var f=s.alternate;f!==null&&(f.lanes|=l),OE(s.return,l,c)}function mT(s,l,c,f,p,w){var R=s.memoizedState;R===null?s.memoizedState={isBackwards:l,rendering:null,renderingStartTime:0,last:f,tail:c,tailMode:p,treeForkCount:w}:(R.isBackwards=l,R.rendering=null,R.renderingStartTime=0,R.last=f,R.tail=c,R.tailMode=p,R.treeForkCount=w)}function G$(s,l,c){var f=l.pendingProps,p=f.revealOrder,w=f.tail;f=f.children;var R=oi.current,H=(R&2)!==0;if(H?(R=R&1|2,l.flags|=128):R&=1,ye(oi,R),nr(s,l,f,c),f=$t?Vm:0,!H&&s!==null&&(s.flags&128)!==0)e:for(s=l.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&Y$(s,c,l);else if(s.tag===19)Y$(s,c,l);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===l)break e;for(;s.sibling===null;){if(s.return===null||s.return===l)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}switch(p){case"forwards":for(c=l.child,p=null;c!==null;)s=c.alternate,s!==null&&_y(s)===null&&(p=c),c=c.sibling;c=p,c===null?(p=l.child,l.child=null):(p=c.sibling,c.sibling=null),mT(l,!1,p,c,w,f);break;case"backwards":case"unstable_legacy-backwards":for(c=null,p=l.child,l.child=null;p!==null;){if(s=p.alternate,s!==null&&_y(s)===null){l.child=p;break}s=p.sibling,p.sibling=c,c=p,p=s}mT(l,!0,c,null,w,f);break;case"together":mT(l,!1,null,null,void 0,f);break;default:l.memoizedState=null}return l.child}function Sl(s,l,c){if(s!==null&&(l.dependencies=s.dependencies),ku|=l.lanes,(c&l.childLanes)===0)if(s!==null){if(rf(s,l,c,!1),(c&l.childLanes)===0)return null}else return null;if(s!==null&&l.child!==s.child)throw Error(i(153));if(l.child!==null){for(s=l.child,c=gl(s,s.pendingProps),l.child=c,c.return=l;s.sibling!==null;)s=s.sibling,c=c.sibling=gl(s,s.pendingProps),c.return=l;c.sibling=null}return l.child}function pT(s,l){return(s.lanes&l)!==0?!0:(s=s.dependencies,!!(s!==null&&wy(s)))}function F7(s,l,c){switch(l.tag){case 3:q(l,l.stateNode.containerInfo),Ou(l,vi,s.memoizedState.cache),th();break;case 27:case 5:_(l);break;case 4:q(l,l.stateNode.containerInfo);break;case 10:Ou(l,l.type,l.memoizedProps.value);break;case 31:if(l.memoizedState!==null)return l.flags|=128,FE(l),null;break;case 13:var f=l.memoizedState;if(f!==null)return f.dehydrated!==null?(Pu(l),l.flags|=128,null):(c&l.child.childLanes)!==0?U$(s,l,c):(Pu(l),s=Sl(s,l,c),s!==null?s.sibling:null);Pu(l);break;case 19:var p=(s.flags&128)!==0;if(f=(c&l.childLanes)!==0,f||(rf(s,l,c,!1),f=(c&l.childLanes)!==0),p){if(f)return G$(s,l,c);l.flags|=128}if(p=l.memoizedState,p!==null&&(p.rendering=null,p.tail=null,p.lastEffect=null),ye(oi,oi.current),f)break;return null;case 22:return l.lanes=0,V$(s,l,c,l.pendingProps);case 24:Ou(l,vi,s.memoizedState.cache)}return Sl(s,l,c)}function q$(s,l,c){if(s!==null)if(s.memoizedProps!==l.pendingProps)yi=!0;else{if(!pT(s,c)&&(l.flags&128)===0)return yi=!1,F7(s,l,c);yi=(s.flags&131072)!==0}else yi=!1,$t&&(l.flags&1048576)!==0&&_k(l,Vm,l.index);switch(l.lanes=0,l.tag){case 16:e:{var f=l.pendingProps;if(s=oh(l.elementType),l.type=s,typeof s=="function")bE(s)?(f=uh(s,f),l.tag=1,l=j$(null,l,s,f,c)):(l.tag=0,l=uT(null,l,s,f,c));else{if(s!=null){var p=s.$$typeof;if(p===x){l.tag=11,l=L$(null,l,s,f,c);break e}else if(p===P){l.tag=14,l=k$(null,l,s,f,c);break e}}throw l=we(s)||s,Error(i(306,l,""))}}return l;case 0:return uT(s,l,l.type,l.pendingProps,c);case 1:return f=l.type,p=uh(f,l.pendingProps),j$(s,l,f,p,c);case 3:e:{if(q(l,l.stateNode.containerInfo),s===null)throw Error(i(387));f=l.pendingProps;var w=l.memoizedState;p=w.element,LE(s,l),Gm(l,f,null,c);var R=l.memoizedState;if(f=R.cache,Ou(l,vi,f),f!==w.cache&&xE(l,[vi],c,!0),Ym(),f=R.element,w.isDehydrated)if(w={element:f,isDehydrated:!1,cache:R.cache},l.updateQueue.baseState=w,l.memoizedState=w,l.flags&256){l=z$(s,l,f,c);break e}else if(f!==p){p=Qo(Error(i(424)),l),Bm(p),l=z$(s,l,f,c);break e}else{switch(s=l.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(Mn=is(s.firstChild),er=l,$t=!0,Mu=null,ts=!0,c=Vk(l,null,f,c),l.child=c;c;)c.flags=c.flags&-3|4096,c=c.sibling}else{if(th(),f===p){l=Sl(s,l,c);break e}nr(s,l,f,c)}l=l.child}return l;case 26:return ky(s,l),s===null?(c=oB(l.type,null,l.pendingProps,null))?l.memoizedState=c:$t||(c=l.type,s=l.pendingProps,f=eS(M.current).createElement(c),f[Kt]=l,f[kt]=s,ir(f,c,s),yt(f),l.stateNode=f):l.memoizedState=oB(l.type,s.memoizedProps,l.pendingProps,s.memoizedState),null;case 27:return _(l),s===null&&$t&&(f=l.stateNode=nB(l.type,l.pendingProps,M.current),er=l,ts=!0,p=Mn,Wu(l.type)?(KT=p,Mn=is(f.firstChild)):Mn=p),nr(s,l,l.pendingProps.children,c),ky(s,l),s===null&&(l.flags|=4194304),l.child;case 5:return s===null&&$t&&((p=f=Mn)&&(f=vX(f,l.type,l.pendingProps,ts),f!==null?(l.stateNode=f,er=l,Mn=is(f.firstChild),ts=!1,p=!0):p=!1),p||Au(l)),_(l),p=l.type,w=l.pendingProps,R=s!==null?s.memoizedProps:null,f=w.children,zT(p,w)?f=null:R!==null&&zT(p,R)&&(l.flags|=32),l.memoizedState!==null&&(p=jE(s,l,I7,null,null,c),fp._currentValue=p),ky(s,l),nr(s,l,f,c),l.child;case 6:return s===null&&$t&&((s=c=Mn)&&(c=wX(c,l.pendingProps,ts),c!==null?(l.stateNode=c,er=l,Mn=null,s=!0):s=!1),s||Au(l)),null;case 13:return U$(s,l,c);case 4:return q(l,l.stateNode.containerInfo),f=l.pendingProps,s===null?l.child=ah(l,null,f,c):nr(s,l,f,c),l.child;case 11:return L$(s,l,l.type,l.pendingProps,c);case 7:return nr(s,l,l.pendingProps,c),l.child;case 8:return nr(s,l,l.pendingProps.children,c),l.child;case 12:return nr(s,l,l.pendingProps.children,c),l.child;case 10:return f=l.pendingProps,Ou(l,l.type,f.value),nr(s,l,f.children,c),l.child;case 9:return p=l.type._context,f=l.pendingProps.children,ih(l),p=tr(p),f=f(p),l.flags|=1,nr(s,l,f,c),l.child;case 14:return k$(s,l,l.type,l.pendingProps,c);case 15:return $$(s,l,l.type,l.pendingProps,c);case 19:return G$(s,l,c);case 31:return B7(s,l,c);case 22:return V$(s,l,c,l.pendingProps);case 24:return ih(l),f=tr(vi),s===null?(p=PE(),p===null&&(p=yn,w=HE(),p.pooledCache=w,w.refCount++,w!==null&&(p.pooledCacheLanes|=c),p=w),l.memoizedState={parent:f,cache:p},DE(l),Ou(l,vi,p)):((s.lanes&c)!==0&&(LE(s,l),Gm(l,null,null,c),Ym()),p=s.memoizedState,w=l.memoizedState,p.parent!==f?(p={parent:f,cache:f},l.memoizedState=p,l.lanes===0&&(l.memoizedState=l.updateQueue.baseState=p),Ou(l,vi,f)):(f=w.cache,Ou(l,vi,f),f!==p.cache&&xE(l,[vi],c,!0))),nr(s,l,l.pendingProps.children,c),l.child;case 29:throw l.pendingProps}throw Error(i(156,l.tag))}function bl(s){s.flags|=4}function vT(s,l,c,f,p){if((l=(s.mode&32)!==0)&&(l=!1),l){if(s.flags|=16777216,(p&335544128)===p)if(s.stateNode.complete)s.flags|=8192;else if(bV())s.flags|=8192;else throw sh=Cy,NE}else s.flags&=-16777217}function K$(s,l){if(l.type!=="stylesheet"||(l.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!cB(l))if(bV())s.flags|=8192;else throw sh=Cy,NE}function Vy(s,l){l!==null&&(s.flags|=4),s.flags&16384&&(l=s.tag!==22?kr():536870912,s.lanes|=l,pf|=l)}function Jm(s,l){if(!$t)switch(s.tailMode){case"hidden":l=s.tail;for(var c=null;l!==null;)l.alternate!==null&&(c=l),l=l.sibling;c===null?s.tail=null:c.sibling=null;break;case"collapsed":c=s.tail;for(var f=null;c!==null;)c.alternate!==null&&(f=c),c=c.sibling;f===null?l||s.tail===null?s.tail=null:s.tail.sibling=null:f.sibling=null}}function An(s){var l=s.alternate!==null&&s.alternate.child===s.child,c=0,f=0;if(l)for(var p=s.child;p!==null;)c|=p.lanes|p.childLanes,f|=p.subtreeFlags&65011712,f|=p.flags&65011712,p.return=s,p=p.sibling;else for(p=s.child;p!==null;)c|=p.lanes|p.childLanes,f|=p.subtreeFlags,f|=p.flags,p.return=s,p=p.sibling;return s.subtreeFlags|=f,s.childLanes=c,l}function W7(s,l,c){var f=l.pendingProps;switch(TE(l),l.tag){case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return An(l),null;case 1:return An(l),null;case 3:return c=l.stateNode,f=null,s!==null&&(f=s.memoizedState.cache),l.memoizedState.cache!==f&&(l.flags|=2048),vl(vi),J(),c.pendingContext&&(c.context=c.pendingContext,c.pendingContext=null),(s===null||s.child===null)&&(nf(l)?bl(l):s===null||s.memoizedState.isDehydrated&&(l.flags&256)===0||(l.flags|=1024,ME())),An(l),null;case 26:var p=l.type,w=l.memoizedState;return s===null?(bl(l),w!==null?(An(l),K$(l,w)):(An(l),vT(l,p,null,f,c))):w?w!==s.memoizedState?(bl(l),An(l),K$(l,w)):(An(l),l.flags&=-16777217):(s=s.memoizedProps,s!==f&&bl(l),An(l),vT(l,p,s,f,c)),null;case 27:if(I(l),c=M.current,p=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==f&&bl(l);else{if(!f){if(l.stateNode===null)throw Error(i(166));return An(l),null}s=S.current,nf(l)?Ak(l):(s=nB(p,f,c),l.stateNode=s,bl(l))}return An(l),null;case 5:if(I(l),p=l.type,s!==null&&l.stateNode!=null)s.memoizedProps!==f&&bl(l);else{if(!f){if(l.stateNode===null)throw Error(i(166));return An(l),null}if(w=S.current,nf(l))Ak(l);else{var R=eS(M.current);switch(w){case 1:w=R.createElementNS("http://www.w3.org/2000/svg",p);break;case 2:w=R.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;default:switch(p){case"svg":w=R.createElementNS("http://www.w3.org/2000/svg",p);break;case"math":w=R.createElementNS("http://www.w3.org/1998/Math/MathML",p);break;case"script":w=R.createElement("div"),w.innerHTML="<script><\/script>",w=w.removeChild(w.firstChild);break;case"select":w=typeof f.is=="string"?R.createElement("select",{is:f.is}):R.createElement("select"),f.multiple?w.multiple=!0:f.size&&(w.size=f.size);break;default:w=typeof f.is=="string"?R.createElement(p,{is:f.is}):R.createElement(p)}}w[Kt]=l,w[kt]=f;e:for(R=l.child;R!==null;){if(R.tag===5||R.tag===6)w.appendChild(R.stateNode);else if(R.tag!==4&&R.tag!==27&&R.child!==null){R.child.return=R,R=R.child;continue}if(R===l)break e;for(;R.sibling===null;){if(R.return===null||R.return===l)break e;R=R.return}R.sibling.return=R.return,R=R.sibling}l.stateNode=w;e:switch(ir(w,p,f),p){case"button":case"input":case"select":case"textarea":f=!!f.autoFocus;break e;case"img":f=!0;break e;default:f=!1}f&&bl(l)}}return An(l),vT(l,l.type,s===null?null:s.memoizedProps,l.pendingProps,c),null;case 6:if(s&&l.stateNode!=null)s.memoizedProps!==f&&bl(l);else{if(typeof f!="string"&&l.stateNode===null)throw Error(i(166));if(s=M.current,nf(l)){if(s=l.stateNode,c=l.memoizedProps,f=null,p=er,p!==null)switch(p.tag){case 27:case 5:f=p.memoizedProps}s[Kt]=l,s=!!(s.nodeValue===c||f!==null&&f.suppressHydrationWarning===!0||UV(s.nodeValue,c)),s||Au(l,!0)}else s=eS(s).createTextNode(f),s[Kt]=l,l.stateNode=s}return An(l),null;case 31:if(c=l.memoizedState,s===null||s.memoizedState!==null){if(f=nf(l),c!==null){if(s===null){if(!f)throw Error(i(318));if(s=l.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(i(557));s[Kt]=l}else th(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;An(l),s=!1}else c=ME(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=c),s=!0;if(!s)return l.flags&256?(po(l),l):(po(l),null);if((l.flags&128)!==0)throw Error(i(558))}return An(l),null;case 13:if(f=l.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(p=nf(l),f!==null&&f.dehydrated!==null){if(s===null){if(!p)throw Error(i(318));if(p=l.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(i(317));p[Kt]=l}else th(),(l.flags&128)===0&&(l.memoizedState=null),l.flags|=4;An(l),p=!1}else p=ME(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=p),p=!0;if(!p)return l.flags&256?(po(l),l):(po(l),null)}return po(l),(l.flags&128)!==0?(l.lanes=c,l):(c=f!==null,s=s!==null&&s.memoizedState!==null,c&&(f=l.child,p=null,f.alternate!==null&&f.alternate.memoizedState!==null&&f.alternate.memoizedState.cachePool!==null&&(p=f.alternate.memoizedState.cachePool.pool),w=null,f.memoizedState!==null&&f.memoizedState.cachePool!==null&&(w=f.memoizedState.cachePool.pool),w!==p&&(f.flags|=2048)),c!==s&&c&&(l.child.flags|=8192),Vy(l,l.updateQueue),An(l),null);case 4:return J(),s===null&&VT(l.stateNode.containerInfo),An(l),null;case 10:return vl(l.type),An(l),null;case 19:if(le(oi),f=l.memoizedState,f===null)return An(l),null;if(p=(l.flags&128)!==0,w=f.rendering,w===null)if(p)Jm(f,!1);else{if(Xn!==0||s!==null&&(s.flags&128)!==0)for(s=l.child;s!==null;){if(w=_y(s),w!==null){for(l.flags|=128,Jm(f,!1),s=w.updateQueue,l.updateQueue=s,Vy(l,s),l.subtreeFlags=0,s=c,c=l.child;c!==null;)Rk(c,s),c=c.sibling;return ye(oi,oi.current&1|2),$t&&ml(l,f.treeForkCount),l.child}s=s.sibling}f.tail!==null&&Le()>zy&&(l.flags|=128,p=!0,Jm(f,!1),l.lanes=4194304)}else{if(!p)if(s=_y(w),s!==null){if(l.flags|=128,p=!0,s=s.updateQueue,l.updateQueue=s,Vy(l,s),Jm(f,!0),f.tail===null&&f.tailMode==="hidden"&&!w.alternate&&!$t)return An(l),null}else 2*Le()-f.renderingStartTime>zy&&c!==536870912&&(l.flags|=128,p=!0,Jm(f,!1),l.lanes=4194304);f.isBackwards?(w.sibling=l.child,l.child=w):(s=f.last,s!==null?s.sibling=w:l.child=w,f.last=w)}return f.tail!==null?(s=f.tail,f.rendering=s,f.tail=s.sibling,f.renderingStartTime=Le(),s.sibling=null,c=oi.current,ye(oi,p?c&1|2:c&1),$t&&ml(l,f.treeForkCount),s):(An(l),null);case 22:case 23:return po(l),BE(),f=l.memoizedState!==null,s!==null?s.memoizedState!==null!==f&&(l.flags|=8192):f&&(l.flags|=8192),f?(c&536870912)!==0&&(l.flags&128)===0&&(An(l),l.subtreeFlags&6&&(l.flags|=8192)):An(l),c=l.updateQueue,c!==null&&Vy(l,c.retryQueue),c=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),f=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(f=l.memoizedState.cachePool.pool),f!==c&&(l.flags|=2048),s!==null&&le(rh),null;case 24:return c=null,s!==null&&(c=s.memoizedState.cache),l.memoizedState.cache!==c&&(l.flags|=2048),vl(vi),An(l),null;case 25:return null;case 30:return null}throw Error(i(156,l.tag))}function j7(s,l){switch(TE(l),l.tag){case 1:return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 3:return vl(vi),J(),s=l.flags,(s&65536)!==0&&(s&128)===0?(l.flags=s&-65537|128,l):null;case 26:case 27:case 5:return I(l),null;case 31:if(l.memoizedState!==null){if(po(l),l.alternate===null)throw Error(i(340));th()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 13:if(po(l),s=l.memoizedState,s!==null&&s.dehydrated!==null){if(l.alternate===null)throw Error(i(340));th()}return s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 19:return le(oi),null;case 4:return J(),null;case 10:return vl(l.type),null;case 22:case 23:return po(l),BE(),s!==null&&le(rh),s=l.flags,s&65536?(l.flags=s&-65537|128,l):null;case 24:return vl(vi),null;case 25:return null;default:return null}}function X$(s,l){switch(TE(l),l.tag){case 3:vl(vi),J();break;case 26:case 27:case 5:I(l);break;case 4:J();break;case 31:l.memoizedState!==null&&po(l);break;case 13:po(l);break;case 19:le(oi);break;case 10:vl(l.type);break;case 22:case 23:po(l),BE(),s!==null&&le(rh);break;case 24:vl(vi)}}function ep(s,l){try{var c=l.updateQueue,f=c!==null?c.lastEffect:null;if(f!==null){var p=f.next;c=p;do{if((c.tag&s)===s){f=void 0;var w=c.create,R=c.inst;f=w(),R.destroy=f}c=c.next}while(c!==p)}}catch(H){hn(l,l.return,H)}}function Du(s,l,c){try{var f=l.updateQueue,p=f!==null?f.lastEffect:null;if(p!==null){var w=p.next;f=w;do{if((f.tag&s)===s){var R=f.inst,H=R.destroy;if(H!==void 0){R.destroy=void 0,p=l;var B=c,se=H;try{se()}catch(ge){hn(p,B,ge)}}}f=f.next}while(f!==w)}}catch(ge){hn(l,l.return,ge)}}function Z$(s){var l=s.updateQueue;if(l!==null){var c=s.stateNode;try{Fk(l,c)}catch(f){hn(s,s.return,f)}}}function Q$(s,l,c){c.props=uh(s.type,s.memoizedProps),c.state=s.memoizedState;try{c.componentWillUnmount()}catch(f){hn(s,l,f)}}function tp(s,l){try{var c=s.ref;if(c!==null){switch(s.tag){case 26:case 27:case 5:var f=s.stateNode;break;case 30:f=s.stateNode;break;default:f=s.stateNode}typeof c=="function"?s.refCleanup=c(f):c.current=f}}catch(p){hn(s,l,p)}}function Sa(s,l){var c=s.ref,f=s.refCleanup;if(c!==null)if(typeof f=="function")try{f()}catch(p){hn(s,l,p)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof c=="function")try{c(null)}catch(p){hn(s,l,p)}else c.current=null}function J$(s){var l=s.type,c=s.memoizedProps,f=s.stateNode;try{e:switch(l){case"button":case"input":case"select":case"textarea":c.autoFocus&&f.focus();break e;case"img":c.src?f.src=c.src:c.srcSet&&(f.srcset=c.srcSet)}}catch(p){hn(s,s.return,p)}}function wT(s,l,c){try{var f=s.stateNode;hX(f,s.type,c,l),f[kt]=l}catch(p){hn(s,s.return,p)}}function eV(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Wu(s.type)||s.tag===4}function yT(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||eV(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Wu(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function ST(s,l,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?(c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c).insertBefore(s,l):(l=c.nodeType===9?c.body:c.nodeName==="HTML"?c.ownerDocument.body:c,l.appendChild(s),c=c._reactRootContainer,c!=null||l.onclick!==null||(l.onclick=dl));else if(f!==4&&(f===27&&Wu(s.type)&&(c=s.stateNode,l=null),s=s.child,s!==null))for(ST(s,l,c),s=s.sibling;s!==null;)ST(s,l,c),s=s.sibling}function By(s,l,c){var f=s.tag;if(f===5||f===6)s=s.stateNode,l?c.insertBefore(s,l):c.appendChild(s);else if(f!==4&&(f===27&&Wu(s.type)&&(c=s.stateNode),s=s.child,s!==null))for(By(s,l,c),s=s.sibling;s!==null;)By(s,l,c),s=s.sibling}function tV(s){var l=s.stateNode,c=s.memoizedProps;try{for(var f=s.type,p=l.attributes;p.length;)l.removeAttributeNode(p[0]);ir(l,f,c),l[Kt]=s,l[kt]=c}catch(w){hn(s,s.return,w)}}var Cl=!1,Si=!1,bT=!1,nV=typeof WeakSet=="function"?WeakSet:Set,ji=null;function z7(s,l){if(s=s.containerInfo,WT=aS,s=gk(s),gE(s)){if("selectionStart"in s)var c={start:s.selectionStart,end:s.selectionEnd};else e:{c=(c=s.ownerDocument)&&c.defaultView||window;var f=c.getSelection&&c.getSelection();if(f&&f.rangeCount!==0){c=f.anchorNode;var p=f.anchorOffset,w=f.focusNode;f=f.focusOffset;try{c.nodeType,w.nodeType}catch{c=null;break e}var R=0,H=-1,B=-1,se=0,ge=0,ve=s,ae=null;t:for(;;){for(var he;ve!==c||p!==0&&ve.nodeType!==3||(H=R+p),ve!==w||f!==0&&ve.nodeType!==3||(B=R+f),ve.nodeType===3&&(R+=ve.nodeValue.length),(he=ve.firstChild)!==null;)ae=ve,ve=he;for(;;){if(ve===s)break t;if(ae===c&&++se===p&&(H=R),ae===w&&++ge===f&&(B=R),(he=ve.nextSibling)!==null)break;ve=ae,ae=ve.parentNode}ve=he}c=H===-1||B===-1?null:{start:H,end:B}}else c=null}c=c||{start:0,end:0}}else c=null;for(jT={focusedElem:s,selectionRange:c},aS=!1,ji=l;ji!==null;)if(l=ji,s=l.child,(l.subtreeFlags&1028)!==0&&s!==null)s.return=l,ji=s;else for(;ji!==null;){switch(l=ji,w=l.alternate,s=l.flags,l.tag){case 0:if((s&4)!==0&&(s=l.updateQueue,s=s!==null?s.events:null,s!==null))for(c=0;c<s.length;c++)p=s[c],p.ref.impl=p.nextImpl;break;case 11:case 15:break;case 1:if((s&1024)!==0&&w!==null){s=void 0,c=l,p=w.memoizedProps,w=w.memoizedState,f=c.stateNode;try{var Be=uh(c.type,p);s=f.getSnapshotBeforeUpdate(Be,w),f.__reactInternalSnapshotBeforeUpdate=s}catch(et){hn(c,c.return,et)}}break;case 3:if((s&1024)!==0){if(s=l.stateNode.containerInfo,c=s.nodeType,c===9)YT(s);else if(c===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":YT(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(i(163))}if(s=l.sibling,s!==null){s.return=l.return,ji=s;break}ji=l.return}}function iV(s,l,c){var f=c.flags;switch(c.tag){case 0:case 11:case 15:El(s,c),f&4&&ep(5,c);break;case 1:if(El(s,c),f&4)if(s=c.stateNode,l===null)try{s.componentDidMount()}catch(R){hn(c,c.return,R)}else{var p=uh(c.type,l.memoizedProps);l=l.memoizedState;try{s.componentDidUpdate(p,l,s.__reactInternalSnapshotBeforeUpdate)}catch(R){hn(c,c.return,R)}}f&64&&Z$(c),f&512&&tp(c,c.return);break;case 3:if(El(s,c),f&64&&(s=c.updateQueue,s!==null)){if(l=null,c.child!==null)switch(c.child.tag){case 27:case 5:l=c.child.stateNode;break;case 1:l=c.child.stateNode}try{Fk(s,l)}catch(R){hn(c,c.return,R)}}break;case 27:l===null&&f&4&&tV(c);case 26:case 5:El(s,c),l===null&&f&4&&J$(c),f&512&&tp(c,c.return);break;case 12:El(s,c);break;case 31:El(s,c),f&4&&sV(s,c);break;case 13:El(s,c),f&4&&aV(s,c),f&64&&(s=c.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(c=J7.bind(null,c),yX(s,c))));break;case 22:if(f=c.memoizedState!==null||Cl,!f){l=l!==null&&l.memoizedState!==null||Si,p=Cl;var w=Si;Cl=f,(Si=l)&&!w?Tl(s,c,(c.subtreeFlags&8772)!==0):El(s,c),Cl=p,Si=w}break;case 30:break;default:El(s,c)}}function rV(s){var l=s.alternate;l!==null&&(s.alternate=null,rV(l)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(l=s.stateNode,l!==null&&Y(l)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var Pn=null,Wr=!1;function Rl(s,l,c){for(c=c.child;c!==null;)oV(s,l,c),c=c.sibling}function oV(s,l,c){if(un&&typeof un.onCommitFiberUnmount=="function")try{un.onCommitFiberUnmount(Rn,c)}catch{}switch(c.tag){case 26:Si||Sa(c,l),Rl(s,l,c),c.memoizedState?c.memoizedState.count--:c.stateNode&&(c=c.stateNode,c.parentNode.removeChild(c));break;case 27:Si||Sa(c,l);var f=Pn,p=Wr;Wu(c.type)&&(Pn=c.stateNode,Wr=!1),Rl(s,l,c),cp(c.stateNode),Pn=f,Wr=p;break;case 5:Si||Sa(c,l);case 6:if(f=Pn,p=Wr,Pn=null,Rl(s,l,c),Pn=f,Wr=p,Pn!==null)if(Wr)try{(Pn.nodeType===9?Pn.body:Pn.nodeName==="HTML"?Pn.ownerDocument.body:Pn).removeChild(c.stateNode)}catch(w){hn(c,l,w)}else try{Pn.removeChild(c.stateNode)}catch(w){hn(c,l,w)}break;case 18:Pn!==null&&(Wr?(s=Pn,ZV(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,c.stateNode),Ef(s)):ZV(Pn,c.stateNode));break;case 4:f=Pn,p=Wr,Pn=c.stateNode.containerInfo,Wr=!0,Rl(s,l,c),Pn=f,Wr=p;break;case 0:case 11:case 14:case 15:Du(2,c,l),Si||Du(4,c,l),Rl(s,l,c);break;case 1:Si||(Sa(c,l),f=c.stateNode,typeof f.componentWillUnmount=="function"&&Q$(c,l,f)),Rl(s,l,c);break;case 21:Rl(s,l,c);break;case 22:Si=(f=Si)||c.memoizedState!==null,Rl(s,l,c),Si=f;break;default:Rl(s,l,c)}}function sV(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null))){s=s.dehydrated;try{Ef(s)}catch(c){hn(l,l.return,c)}}}function aV(s,l){if(l.memoizedState===null&&(s=l.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Ef(s)}catch(c){hn(l,l.return,c)}}function U7(s){switch(s.tag){case 31:case 13:case 19:var l=s.stateNode;return l===null&&(l=s.stateNode=new nV),l;case 22:return s=s.stateNode,l=s._retryCache,l===null&&(l=s._retryCache=new nV),l;default:throw Error(i(435,s.tag))}}function Fy(s,l){var c=U7(s);l.forEach(function(f){if(!c.has(f)){c.add(f);var p=eX.bind(null,s,f);f.then(p,p)}})}function jr(s,l){var c=l.deletions;if(c!==null)for(var f=0;f<c.length;f++){var p=c[f],w=s,R=l,H=R;e:for(;H!==null;){switch(H.tag){case 27:if(Wu(H.type)){Pn=H.stateNode,Wr=!1;break e}break;case 5:Pn=H.stateNode,Wr=!1;break e;case 3:case 4:Pn=H.stateNode.containerInfo,Wr=!0;break e}H=H.return}if(Pn===null)throw Error(i(160));oV(w,R,p),Pn=null,Wr=!1,w=p.alternate,w!==null&&(w.return=null),p.return=null}if(l.subtreeFlags&13886)for(l=l.child;l!==null;)lV(l,s),l=l.sibling}var $s=null;function lV(s,l){var c=s.alternate,f=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:jr(l,s),zr(s),f&4&&(Du(3,s,s.return),ep(3,s),Du(5,s,s.return));break;case 1:jr(l,s),zr(s),f&512&&(Si||c===null||Sa(c,c.return)),f&64&&Cl&&(s=s.updateQueue,s!==null&&(f=s.callbacks,f!==null&&(c=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=c===null?f:c.concat(f))));break;case 26:var p=$s;if(jr(l,s),zr(s),f&512&&(Si||c===null||Sa(c,c.return)),f&4){var w=c!==null?c.memoizedState:null;if(f=s.memoizedState,c===null)if(f===null)if(s.stateNode===null){e:{f=s.type,c=s.memoizedProps,p=p.ownerDocument||p;t:switch(f){case"title":w=p.getElementsByTagName("title")[0],(!w||w[je]||w[Kt]||w.namespaceURI==="http://www.w3.org/2000/svg"||w.hasAttribute("itemprop"))&&(w=p.createElement(f),p.head.insertBefore(w,p.querySelector("head > title"))),ir(w,f,c),w[Kt]=s,yt(w),f=w;break e;case"link":var R=lB("link","href",p).get(f+(c.href||""));if(R){for(var H=0;H<R.length;H++)if(w=R[H],w.getAttribute("href")===(c.href==null||c.href===""?null:c.href)&&w.getAttribute("rel")===(c.rel==null?null:c.rel)&&w.getAttribute("title")===(c.title==null?null:c.title)&&w.getAttribute("crossorigin")===(c.crossOrigin==null?null:c.crossOrigin)){R.splice(H,1);break t}}w=p.createElement(f),ir(w,f,c),p.head.appendChild(w);break;case"meta":if(R=lB("meta","content",p).get(f+(c.content||""))){for(H=0;H<R.length;H++)if(w=R[H],w.getAttribute("content")===(c.content==null?null:""+c.content)&&w.getAttribute("name")===(c.name==null?null:c.name)&&w.getAttribute("property")===(c.property==null?null:c.property)&&w.getAttribute("http-equiv")===(c.httpEquiv==null?null:c.httpEquiv)&&w.getAttribute("charset")===(c.charSet==null?null:c.charSet)){R.splice(H,1);break t}}w=p.createElement(f),ir(w,f,c),p.head.appendChild(w);break;default:throw Error(i(468,f))}w[Kt]=s,yt(w),f=w}s.stateNode=f}else uB(p,s.type,s.stateNode);else s.stateNode=aB(p,f,s.memoizedProps);else w!==f?(w===null?c.stateNode!==null&&(c=c.stateNode,c.parentNode.removeChild(c)):w.count--,f===null?uB(p,s.type,s.stateNode):aB(p,f,s.memoizedProps)):f===null&&s.stateNode!==null&&wT(s,s.memoizedProps,c.memoizedProps)}break;case 27:jr(l,s),zr(s),f&512&&(Si||c===null||Sa(c,c.return)),c!==null&&f&4&&wT(s,s.memoizedProps,c.memoizedProps);break;case 5:if(jr(l,s),zr(s),f&512&&(Si||c===null||Sa(c,c.return)),s.flags&32){p=s.stateNode;try{Yd(p,"")}catch(Be){hn(s,s.return,Be)}}f&4&&s.stateNode!=null&&(p=s.memoizedProps,wT(s,p,c!==null?c.memoizedProps:p)),f&1024&&(bT=!0);break;case 6:if(jr(l,s),zr(s),f&4){if(s.stateNode===null)throw Error(i(162));f=s.memoizedProps,c=s.stateNode;try{c.nodeValue=f}catch(Be){hn(s,s.return,Be)}}break;case 3:if(iS=null,p=$s,$s=tS(l.containerInfo),jr(l,s),$s=p,zr(s),f&4&&c!==null&&c.memoizedState.isDehydrated)try{Ef(l.containerInfo)}catch(Be){hn(s,s.return,Be)}bT&&(bT=!1,uV(s));break;case 4:f=$s,$s=tS(s.stateNode.containerInfo),jr(l,s),zr(s),$s=f;break;case 12:jr(l,s),zr(s);break;case 31:jr(l,s),zr(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Fy(s,f)));break;case 13:jr(l,s),zr(s),s.child.flags&8192&&s.memoizedState!==null!=(c!==null&&c.memoizedState!==null)&&(jy=Le()),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Fy(s,f)));break;case 22:p=s.memoizedState!==null;var B=c!==null&&c.memoizedState!==null,se=Cl,ge=Si;if(Cl=se||p,Si=ge||B,jr(l,s),Si=ge,Cl=se,zr(s),f&8192)e:for(l=s.stateNode,l._visibility=p?l._visibility&-2:l._visibility|1,p&&(c===null||B||Cl||Si||ch(s)),c=null,l=s;;){if(l.tag===5||l.tag===26){if(c===null){B=c=l;try{if(w=B.stateNode,p)R=w.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{H=B.stateNode;var ve=B.memoizedProps.style,ae=ve!=null&&ve.hasOwnProperty("display")?ve.display:null;H.style.display=ae==null||typeof ae=="boolean"?"":(""+ae).trim()}}catch(Be){hn(B,B.return,Be)}}}else if(l.tag===6){if(c===null){B=l;try{B.stateNode.nodeValue=p?"":B.memoizedProps}catch(Be){hn(B,B.return,Be)}}}else if(l.tag===18){if(c===null){B=l;try{var he=B.stateNode;p?QV(he,!0):QV(B.stateNode,!1)}catch(Be){hn(B,B.return,Be)}}}else if((l.tag!==22&&l.tag!==23||l.memoizedState===null||l===s)&&l.child!==null){l.child.return=l,l=l.child;continue}if(l===s)break e;for(;l.sibling===null;){if(l.return===null||l.return===s)break e;c===l&&(c=null),l=l.return}c===l&&(c=null),l.sibling.return=l.return,l=l.sibling}f&4&&(f=s.updateQueue,f!==null&&(c=f.retryQueue,c!==null&&(f.retryQueue=null,Fy(s,c))));break;case 19:jr(l,s),zr(s),f&4&&(f=s.updateQueue,f!==null&&(s.updateQueue=null,Fy(s,f)));break;case 30:break;case 21:break;default:jr(l,s),zr(s)}}function zr(s){var l=s.flags;if(l&2){try{for(var c,f=s.return;f!==null;){if(eV(f)){c=f;break}f=f.return}if(c==null)throw Error(i(160));switch(c.tag){case 27:var p=c.stateNode,w=yT(s);By(s,w,p);break;case 5:var R=c.stateNode;c.flags&32&&(Yd(R,""),c.flags&=-33);var H=yT(s);By(s,H,R);break;case 3:case 4:var B=c.stateNode.containerInfo,se=yT(s);ST(s,se,B);break;default:throw Error(i(161))}}catch(ge){hn(s,s.return,ge)}s.flags&=-3}l&4096&&(s.flags&=-4097)}function uV(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var l=s;uV(l),l.tag===5&&l.flags&1024&&l.stateNode.reset(),s=s.sibling}}function El(s,l){if(l.subtreeFlags&8772)for(l=l.child;l!==null;)iV(s,l.alternate,l),l=l.sibling}function ch(s){for(s=s.child;s!==null;){var l=s;switch(l.tag){case 0:case 11:case 14:case 15:Du(4,l,l.return),ch(l);break;case 1:Sa(l,l.return);var c=l.stateNode;typeof c.componentWillUnmount=="function"&&Q$(l,l.return,c),ch(l);break;case 27:cp(l.stateNode);case 26:case 5:Sa(l,l.return),ch(l);break;case 22:l.memoizedState===null&&ch(l);break;case 30:ch(l);break;default:ch(l)}s=s.sibling}}function Tl(s,l,c){for(c=c&&(l.subtreeFlags&8772)!==0,l=l.child;l!==null;){var f=l.alternate,p=s,w=l,R=w.flags;switch(w.tag){case 0:case 11:case 15:Tl(p,w,c),ep(4,w);break;case 1:if(Tl(p,w,c),f=w,p=f.stateNode,typeof p.componentDidMount=="function")try{p.componentDidMount()}catch(se){hn(f,f.return,se)}if(f=w,p=f.updateQueue,p!==null){var H=f.stateNode;try{var B=p.shared.hiddenCallbacks;if(B!==null)for(p.shared.hiddenCallbacks=null,p=0;p<B.length;p++)Bk(B[p],H)}catch(se){hn(f,f.return,se)}}c&&R&64&&Z$(w),tp(w,w.return);break;case 27:tV(w);case 26:case 5:Tl(p,w,c),c&&f===null&&R&4&&J$(w),tp(w,w.return);break;case 12:Tl(p,w,c);break;case 31:Tl(p,w,c),c&&R&4&&sV(p,w);break;case 13:Tl(p,w,c),c&&R&4&&aV(p,w);break;case 22:w.memoizedState===null&&Tl(p,w,c),tp(w,w.return);break;case 30:break;default:Tl(p,w,c)}l=l.sibling}}function CT(s,l){var c=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(c=s.memoizedState.cachePool.pool),s=null,l.memoizedState!==null&&l.memoizedState.cachePool!==null&&(s=l.memoizedState.cachePool.pool),s!==c&&(s!=null&&s.refCount++,c!=null&&Fm(c))}function RT(s,l){s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Fm(s))}function Vs(s,l,c,f){if(l.subtreeFlags&10256)for(l=l.child;l!==null;)cV(s,l,c,f),l=l.sibling}function cV(s,l,c,f){var p=l.flags;switch(l.tag){case 0:case 11:case 15:Vs(s,l,c,f),p&2048&&ep(9,l);break;case 1:Vs(s,l,c,f);break;case 3:Vs(s,l,c,f),p&2048&&(s=null,l.alternate!==null&&(s=l.alternate.memoizedState.cache),l=l.memoizedState.cache,l!==s&&(l.refCount++,s!=null&&Fm(s)));break;case 12:if(p&2048){Vs(s,l,c,f),s=l.stateNode;try{var w=l.memoizedProps,R=w.id,H=w.onPostCommit;typeof H=="function"&&H(R,l.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(B){hn(l,l.return,B)}}else Vs(s,l,c,f);break;case 31:Vs(s,l,c,f);break;case 13:Vs(s,l,c,f);break;case 23:break;case 22:w=l.stateNode,R=l.alternate,l.memoizedState!==null?w._visibility&2?Vs(s,l,c,f):np(s,l):w._visibility&2?Vs(s,l,c,f):(w._visibility|=2,ff(s,l,c,f,(l.subtreeFlags&10256)!==0||!1)),p&2048&&CT(R,l);break;case 24:Vs(s,l,c,f),p&2048&&RT(l.alternate,l);break;default:Vs(s,l,c,f)}}function ff(s,l,c,f,p){for(p=p&&((l.subtreeFlags&10256)!==0||!1),l=l.child;l!==null;){var w=s,R=l,H=c,B=f,se=R.flags;switch(R.tag){case 0:case 11:case 15:ff(w,R,H,B,p),ep(8,R);break;case 23:break;case 22:var ge=R.stateNode;R.memoizedState!==null?ge._visibility&2?ff(w,R,H,B,p):np(w,R):(ge._visibility|=2,ff(w,R,H,B,p)),p&&se&2048&&CT(R.alternate,R);break;case 24:ff(w,R,H,B,p),p&&se&2048&&RT(R.alternate,R);break;default:ff(w,R,H,B,p)}l=l.sibling}}function np(s,l){if(l.subtreeFlags&10256)for(l=l.child;l!==null;){var c=s,f=l,p=f.flags;switch(f.tag){case 22:np(c,f),p&2048&&CT(f.alternate,f);break;case 24:np(c,f),p&2048&&RT(f.alternate,f);break;default:np(c,f)}l=l.sibling}}var ip=8192;function gf(s,l,c){if(s.subtreeFlags&ip)for(s=s.child;s!==null;)hV(s,l,c),s=s.sibling}function hV(s,l,c){switch(s.tag){case 26:gf(s,l,c),s.flags&ip&&s.memoizedState!==null&&HX(c,$s,s.memoizedState,s.memoizedProps);break;case 5:gf(s,l,c);break;case 3:case 4:var f=$s;$s=tS(s.stateNode.containerInfo),gf(s,l,c),$s=f;break;case 22:s.memoizedState===null&&(f=s.alternate,f!==null&&f.memoizedState!==null?(f=ip,ip=16777216,gf(s,l,c),ip=f):gf(s,l,c));break;default:gf(s,l,c)}}function dV(s){var l=s.alternate;if(l!==null&&(s=l.child,s!==null)){l.child=null;do l=s.sibling,s.sibling=null,s=l;while(s!==null)}}function rp(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];ji=f,gV(f,s)}dV(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)fV(s),s=s.sibling}function fV(s){switch(s.tag){case 0:case 11:case 15:rp(s),s.flags&2048&&Du(9,s,s.return);break;case 3:rp(s);break;case 12:rp(s);break;case 22:var l=s.stateNode;s.memoizedState!==null&&l._visibility&2&&(s.return===null||s.return.tag!==13)?(l._visibility&=-3,Wy(s)):rp(s);break;default:rp(s)}}function Wy(s){var l=s.deletions;if((s.flags&16)!==0){if(l!==null)for(var c=0;c<l.length;c++){var f=l[c];ji=f,gV(f,s)}dV(s)}for(s=s.child;s!==null;){switch(l=s,l.tag){case 0:case 11:case 15:Du(8,l,l.return),Wy(l);break;case 22:c=l.stateNode,c._visibility&2&&(c._visibility&=-3,Wy(l));break;default:Wy(l)}s=s.sibling}}function gV(s,l){for(;ji!==null;){var c=ji;switch(c.tag){case 0:case 11:case 15:Du(8,c,l);break;case 23:case 22:if(c.memoizedState!==null&&c.memoizedState.cachePool!==null){var f=c.memoizedState.cachePool.pool;f!=null&&f.refCount++}break;case 24:Fm(c.memoizedState.cache)}if(f=c.child,f!==null)f.return=c,ji=f;else e:for(c=s;ji!==null;){f=ji;var p=f.sibling,w=f.return;if(rV(f),f===c){ji=null;break e}if(p!==null){p.return=w,ji=p;break e}ji=w}}}var Y7={getCacheForType:function(s){var l=tr(vi),c=l.data.get(s);return c===void 0&&(c=s(),l.data.set(s,c)),c},cacheSignal:function(){return tr(vi).controller.signal}},G7=typeof WeakMap=="function"?WeakMap:Map,Xt=0,yn=null,At=null,It=0,cn=0,vo=null,Lu=!1,mf=!1,ET=!1,_l=0,Xn=0,ku=0,hh=0,TT=0,wo=0,pf=0,op=null,Ur=null,_T=!1,jy=0,mV=0,zy=1/0,Uy=null,$u=null,Pi=0,Vu=null,vf=null,Ml=0,MT=0,AT=null,pV=null,sp=0,OT=null;function yo(){return(Xt&2)!==0&&It!==0?It&-It:ie.T!==null?DT():Gc()}function vV(){if(wo===0)if((It&536870912)===0||$t){var s=qn;qn<<=1,(qn&3932160)===0&&(qn=262144),wo=s}else wo=536870912;return s=mo.current,s!==null&&(s.flags|=32),wo}function Yr(s,l,c){(s===yn&&(cn===2||cn===9)||s.cancelPendingCommit!==null)&&(wf(s,0),Bu(s,It,wo,!1)),Uo(s,c),((Xt&2)===0||s!==yn)&&(s===yn&&((Xt&2)===0&&(hh|=c),Xn===4&&Bu(s,It,wo,!1)),ba(s))}function wV(s,l,c){if((Xt&6)!==0)throw Error(i(327));var f=!c&&(l&127)===0&&(l&s.expiredLanes)===0||pa(s,l),p=f?X7(s,l):HT(s,l,!0),w=f;do{if(p===0){mf&&!f&&Bu(s,l,0,!1);break}else{if(c=s.current.alternate,w&&!q7(c)){p=HT(s,l,!1),w=!1;continue}if(p===2){if(w=l,s.errorRecoveryDisabledLanes&w)var R=0;else R=s.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){l=R;e:{var H=s;p=op;var B=H.current.memoizedState.isDehydrated;if(B&&(wf(H,R).flags|=256),R=HT(H,R,!1),R!==2){if(ET&&!B){H.errorRecoveryDisabledLanes|=w,hh|=w,p=4;break e}w=Ur,Ur=p,w!==null&&(Ur===null?Ur=w:Ur.push.apply(Ur,w))}p=R}if(w=!1,p!==2)continue}}if(p===1){wf(s,0),Bu(s,l,0,!0);break}e:{switch(f=s,w=p,w){case 0:case 1:throw Error(i(345));case 4:if((l&4194048)!==l)break;case 6:Bu(f,l,wo,!Lu);break e;case 2:Ur=null;break;case 3:case 5:break;default:throw Error(i(329))}if((l&62914560)===l&&(p=jy+300-Le(),10<p)){if(Bu(f,l,wo,!Lu),Ls(f,0,!0)!==0)break e;Ml=l,f.timeoutHandle=KV(yV.bind(null,f,c,Ur,Uy,_T,l,wo,hh,pf,Lu,w,"Throttled",-0,0),p);break e}yV(f,c,Ur,Uy,_T,l,wo,hh,pf,Lu,w,null,-0,0)}}break}while(!0);ba(s)}function yV(s,l,c,f,p,w,R,H,B,se,ge,ve,ae,he){if(s.timeoutHandle=-1,ve=l.subtreeFlags,ve&8192||(ve&16785408)===16785408){ve={stylesheets:null,count:0,imgCount:0,imgBytes:0,suspenseyImages:[],waitingForImages:!0,waitingForViewTransition:!1,unsuspend:dl},hV(l,w,ve);var Be=(w&62914560)===w?jy-Le():(w&4194048)===w?mV-Le():0;if(Be=IX(ve,Be),Be!==null){Ml=w,s.cancelPendingCommit=Be(MV.bind(null,s,l,w,c,f,p,R,H,B,ge,ve,null,ae,he)),Bu(s,w,R,!se);return}}MV(s,l,w,c,f,p,R,H,B)}function q7(s){for(var l=s;;){var c=l.tag;if((c===0||c===11||c===15)&&l.flags&16384&&(c=l.updateQueue,c!==null&&(c=c.stores,c!==null)))for(var f=0;f<c.length;f++){var p=c[f],w=p.getSnapshot;p=p.value;try{if(!fo(w(),p))return!1}catch{return!1}}if(c=l.child,l.subtreeFlags&16384&&c!==null)c.return=l,l=c;else{if(l===s)break;for(;l.sibling===null;){if(l.return===null||l.return===s)return!0;l=l.return}l.sibling.return=l.return,l=l.sibling}}return!0}function Bu(s,l,c,f){l&=~TT,l&=~hh,s.suspendedLanes|=l,s.pingedLanes&=~l,f&&(s.warmLanes|=l),f=s.expirationTimes;for(var p=l;0<p;){var w=31-nt(p),R=1<<w;f[w]=-1,p&=~R}c!==0&&Go(s,c,l)}function Yy(){return(Xt&6)===0?(ap(0),!1):!0}function xT(){if(At!==null){if(cn===0)var s=At.return;else s=At,pl=nh=null,YE(s),lf=null,jm=0,s=At;for(;s!==null;)X$(s.alternate,s),s=s.return;At=null}}function wf(s,l){var c=s.timeoutHandle;c!==-1&&(s.timeoutHandle=-1,gX(c)),c=s.cancelPendingCommit,c!==null&&(s.cancelPendingCommit=null,c()),Ml=0,xT(),yn=s,At=c=gl(s.current,null),It=l,cn=0,vo=null,Lu=!1,mf=pa(s,l),ET=!1,pf=wo=TT=hh=ku=Xn=0,Ur=op=null,_T=!1,(l&8)!==0&&(l|=l&32);var f=s.entangledLanes;if(f!==0)for(s=s.entanglements,f&=l;0<f;){var p=31-nt(f),w=1<<p;l|=s[p],f&=~w}return _l=l,fy(),c}function SV(s,l){ct=null,ie.H=Zm,l===af||l===by?(l=Lk(),cn=3):l===NE?(l=Lk(),cn=4):cn=l===lT?8:l!==null&&typeof l=="object"&&typeof l.then=="function"?6:1,vo=l,At===null&&(Xn=1,Dy(s,Qo(l,s.current)))}function bV(){var s=mo.current;return s===null?!0:(It&4194048)===It?ns===null:(It&62914560)===It||(It&536870912)!==0?s===ns:!1}function CV(){var s=ie.H;return ie.H=Zm,s===null?Zm:s}function RV(){var s=ie.A;return ie.A=Y7,s}function Gy(){Xn=4,Lu||(It&4194048)!==It&&mo.current!==null||(mf=!0),(ku&134217727)===0&&(hh&134217727)===0||yn===null||Bu(yn,It,wo,!1)}function HT(s,l,c){var f=Xt;Xt|=2;var p=CV(),w=RV();(yn!==s||It!==l)&&(Uy=null,wf(s,l)),l=!1;var R=Xn;e:do try{if(cn!==0&&At!==null){var H=At,B=vo;switch(cn){case 8:xT(),R=6;break e;case 3:case 2:case 9:case 6:mo.current===null&&(l=!0);var se=cn;if(cn=0,vo=null,yf(s,H,B,se),c&&mf){R=0;break e}break;default:se=cn,cn=0,vo=null,yf(s,H,B,se)}}K7(),R=Xn;break}catch(ge){SV(s,ge)}while(!0);return l&&s.shellSuspendCounter++,pl=nh=null,Xt=f,ie.H=p,ie.A=w,At===null&&(yn=null,It=0,fy()),R}function K7(){for(;At!==null;)EV(At)}function X7(s,l){var c=Xt;Xt|=2;var f=CV(),p=RV();yn!==s||It!==l?(Uy=null,zy=Le()+500,wf(s,l)):mf=pa(s,l);e:do try{if(cn!==0&&At!==null){l=At;var w=vo;t:switch(cn){case 1:cn=0,vo=null,yf(s,l,w,1);break;case 2:case 9:if(Nk(w)){cn=0,vo=null,TV(l);break}l=function(){cn!==2&&cn!==9||yn!==s||(cn=7),ba(s)},w.then(l,l);break e;case 3:cn=7;break e;case 4:cn=5;break e;case 7:Nk(w)?(cn=0,vo=null,TV(l)):(cn=0,vo=null,yf(s,l,w,7));break;case 5:var R=null;switch(At.tag){case 26:R=At.memoizedState;case 5:case 27:var H=At;if(R?cB(R):H.stateNode.complete){cn=0,vo=null;var B=H.sibling;if(B!==null)At=B;else{var se=H.return;se!==null?(At=se,qy(se)):At=null}break t}}cn=0,vo=null,yf(s,l,w,5);break;case 6:cn=0,vo=null,yf(s,l,w,6);break;case 8:xT(),Xn=6;break e;default:throw Error(i(462))}}Z7();break}catch(ge){SV(s,ge)}while(!0);return pl=nh=null,ie.H=f,ie.A=p,Xt=c,At!==null?0:(yn=null,It=0,fy(),Xn)}function Z7(){for(;At!==null&&!Re();)EV(At)}function EV(s){var l=q$(s.alternate,s,_l);s.memoizedProps=s.pendingProps,l===null?qy(s):At=l}function TV(s){var l=s,c=l.alternate;switch(l.tag){case 15:case 0:l=W$(c,l,l.pendingProps,l.type,void 0,It);break;case 11:l=W$(c,l,l.pendingProps,l.type.render,l.ref,It);break;case 5:YE(l);default:X$(c,l),l=At=Rk(l,_l),l=q$(c,l,_l)}s.memoizedProps=s.pendingProps,l===null?qy(s):At=l}function yf(s,l,c,f){pl=nh=null,YE(l),lf=null,jm=0;var p=l.return;try{if(V7(s,p,l,c,It)){Xn=1,Dy(s,Qo(c,s.current)),At=null;return}}catch(w){if(p!==null)throw At=p,w;Xn=1,Dy(s,Qo(c,s.current)),At=null;return}l.flags&32768?($t||f===1?s=!0:mf||(It&536870912)!==0?s=!1:(Lu=s=!0,(f===2||f===9||f===3||f===6)&&(f=mo.current,f!==null&&f.tag===13&&(f.flags|=16384))),_V(l,s)):qy(l)}function qy(s){var l=s;do{if((l.flags&32768)!==0){_V(l,Lu);return}s=l.return;var c=W7(l.alternate,l,_l);if(c!==null){At=c;return}if(l=l.sibling,l!==null){At=l;return}At=l=s}while(l!==null);Xn===0&&(Xn=5)}function _V(s,l){do{var c=j7(s.alternate,s);if(c!==null){c.flags&=32767,At=c;return}if(c=s.return,c!==null&&(c.flags|=32768,c.subtreeFlags=0,c.deletions=null),!l&&(s=s.sibling,s!==null)){At=s;return}At=s=c}while(s!==null);Xn=6,At=null}function MV(s,l,c,f,p,w,R,H,B){s.cancelPendingCommit=null;do Ky();while(Pi!==0);if((Xt&6)!==0)throw Error(i(327));if(l!==null){if(l===s.current)throw Error(i(177));if(w=l.lanes|l.childLanes,w|=yE,Yo(s,c,w,R,H,B),s===yn&&(At=yn=null,It=0),vf=l,Vu=s,Ml=c,MT=w,AT=p,pV=f,(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,tX(Je,function(){return IV(),null})):(s.callbackNode=null,s.callbackPriority=0),f=(l.flags&13878)!==0,(l.subtreeFlags&13878)!==0||f){f=ie.T,ie.T=null,p=de.p,de.p=2,R=Xt,Xt|=4;try{z7(s,l,c)}finally{Xt=R,de.p=p,ie.T=f}}Pi=1,AV(),OV(),xV()}}function AV(){if(Pi===1){Pi=0;var s=Vu,l=vf,c=(l.flags&13878)!==0;if((l.subtreeFlags&13878)!==0||c){c=ie.T,ie.T=null;var f=de.p;de.p=2;var p=Xt;Xt|=4;try{lV(l,s);var w=jT,R=gk(s.containerInfo),H=w.focusedElem,B=w.selectionRange;if(R!==H&&H&&H.ownerDocument&&fk(H.ownerDocument.documentElement,H)){if(B!==null&&gE(H)){var se=B.start,ge=B.end;if(ge===void 0&&(ge=se),"selectionStart"in H)H.selectionStart=se,H.selectionEnd=Math.min(ge,H.value.length);else{var ve=H.ownerDocument||document,ae=ve&&ve.defaultView||window;if(ae.getSelection){var he=ae.getSelection(),Be=H.textContent.length,et=Math.min(B.start,Be),vn=B.end===void 0?et:Math.min(B.end,Be);!he.extend&&et>vn&&(R=vn,vn=et,et=R);var te=dk(H,et),G=dk(H,vn);if(te&&G&&(he.rangeCount!==1||he.anchorNode!==te.node||he.anchorOffset!==te.offset||he.focusNode!==G.node||he.focusOffset!==G.offset)){var oe=ve.createRange();oe.setStart(te.node,te.offset),he.removeAllRanges(),et>vn?(he.addRange(oe),he.extend(G.node,G.offset)):(oe.setEnd(G.node,G.offset),he.addRange(oe))}}}}for(ve=[],he=H;he=he.parentNode;)he.nodeType===1&&ve.push({element:he,left:he.scrollLeft,top:he.scrollTop});for(typeof H.focus=="function"&&H.focus(),H=0;H<ve.length;H++){var pe=ve[H];pe.element.scrollLeft=pe.left,pe.element.scrollTop=pe.top}}aS=!!WT,jT=WT=null}finally{Xt=p,de.p=f,ie.T=c}}s.current=l,Pi=2}}function OV(){if(Pi===2){Pi=0;var s=Vu,l=vf,c=(l.flags&8772)!==0;if((l.subtreeFlags&8772)!==0||c){c=ie.T,ie.T=null;var f=de.p;de.p=2;var p=Xt;Xt|=4;try{iV(s,l.alternate,l)}finally{Xt=p,de.p=f,ie.T=c}}Pi=3}}function xV(){if(Pi===4||Pi===3){Pi=0,Ae();var s=Vu,l=vf,c=Ml,f=pV;(l.subtreeFlags&10256)!==0||(l.flags&10256)!==0?Pi=5:(Pi=0,vf=Vu=null,HV(s,s.pendingLanes));var p=s.pendingLanes;if(p===0&&($u=null),$r(c),l=l.stateNode,un&&typeof un.onCommitFiberRoot=="function")try{un.onCommitFiberRoot(Rn,l,void 0,(l.current.flags&128)===128)}catch{}if(f!==null){l=ie.T,p=de.p,de.p=2,ie.T=null;try{for(var w=s.onRecoverableError,R=0;R<f.length;R++){var H=f[R];w(H.value,{componentStack:H.stack})}}finally{ie.T=l,de.p=p}}(Ml&3)!==0&&Ky(),ba(s),p=s.pendingLanes,(c&261930)!==0&&(p&42)!==0?s===OT?sp++:(sp=0,OT=s):sp=0,ap(0)}}function HV(s,l){(s.pooledCacheLanes&=l)===0&&(l=s.pooledCache,l!=null&&(s.pooledCache=null,Fm(l)))}function Ky(){return AV(),OV(),xV(),IV()}function IV(){if(Pi!==5)return!1;var s=Vu,l=MT;MT=0;var c=$r(Ml),f=ie.T,p=de.p;try{de.p=32>c?32:c,ie.T=null,c=AT,AT=null;var w=Vu,R=Ml;if(Pi=0,vf=Vu=null,Ml=0,(Xt&6)!==0)throw Error(i(331));var H=Xt;if(Xt|=4,fV(w.current),cV(w,w.current,R,c),Xt=H,ap(0,!1),un&&typeof un.onPostCommitFiberRoot=="function")try{un.onPostCommitFiberRoot(Rn,w)}catch{}return!0}finally{de.p=p,ie.T=f,HV(s,l)}}function PV(s,l,c){l=Qo(c,l),l=aT(s.stateNode,l,2),s=Iu(s,l,2),s!==null&&(Uo(s,2),ba(s))}function hn(s,l,c){if(s.tag===3)PV(s,s,c);else for(;l!==null;){if(l.tag===3){PV(l,s,c);break}else if(l.tag===1){var f=l.stateNode;if(typeof l.type.getDerivedStateFromError=="function"||typeof f.componentDidCatch=="function"&&($u===null||!$u.has(f))){s=Qo(c,s),c=N$(2),f=Iu(l,c,2),f!==null&&(D$(c,f,l,s),Uo(f,2),ba(f));break}}l=l.return}}function IT(s,l,c){var f=s.pingCache;if(f===null){f=s.pingCache=new G7;var p=new Set;f.set(l,p)}else p=f.get(l),p===void 0&&(p=new Set,f.set(l,p));p.has(c)||(ET=!0,p.add(c),s=Q7.bind(null,s,l,c),l.then(s,s))}function Q7(s,l,c){var f=s.pingCache;f!==null&&f.delete(l),s.pingedLanes|=s.suspendedLanes&c,s.warmLanes&=~c,yn===s&&(It&c)===c&&(Xn===4||Xn===3&&(It&62914560)===It&&300>Le()-jy?(Xt&2)===0&&wf(s,0):TT|=c,pf===It&&(pf=0)),ba(s)}function NV(s,l){l===0&&(l=kr()),s=Jc(s,l),s!==null&&(Uo(s,l),ba(s))}function J7(s){var l=s.memoizedState,c=0;l!==null&&(c=l.retryLane),NV(s,c)}function eX(s,l){var c=0;switch(s.tag){case 31:case 13:var f=s.stateNode,p=s.memoizedState;p!==null&&(c=p.retryLane);break;case 19:f=s.stateNode;break;case 22:f=s.stateNode._retryCache;break;default:throw Error(i(314))}f!==null&&f.delete(l),NV(s,c)}function tX(s,l){return ee(s,l)}var Xy=null,Sf=null,PT=!1,Zy=!1,NT=!1,Fu=0;function ba(s){s!==Sf&&s.next===null&&(Sf===null?Xy=Sf=s:Sf=Sf.next=s),Zy=!0,PT||(PT=!0,iX())}function ap(s,l){if(!NT&&Zy){NT=!0;do for(var c=!1,f=Xy;f!==null;){if(s!==0){var p=f.pendingLanes;if(p===0)var w=0;else{var R=f.suspendedLanes,H=f.pingedLanes;w=(1<<31-nt(42|s)+1)-1,w&=p&~(R&~H),w=w&201326741?w&201326741|1:w?w|2:0}w!==0&&(c=!0,$V(f,w))}else w=It,w=Ls(f,f===yn?w:0,f.cancelPendingCommit!==null||f.timeoutHandle!==-1),(w&3)===0||pa(f,w)||(c=!0,$V(f,w));f=f.next}while(c);NT=!1}}function nX(){DV()}function DV(){Zy=PT=!1;var s=0;Fu!==0&&fX()&&(s=Fu);for(var l=Le(),c=null,f=Xy;f!==null;){var p=f.next,w=LV(f,l);w===0?(f.next=null,c===null?Xy=p:c.next=p,p===null&&(Sf=c)):(c=f,(s!==0||(w&3)!==0)&&(Zy=!0)),f=p}Pi!==0&&Pi!==5||ap(s),Fu!==0&&(Fu=0)}function LV(s,l){for(var c=s.suspendedLanes,f=s.pingedLanes,p=s.expirationTimes,w=s.pendingLanes&-62914561;0<w;){var R=31-nt(w),H=1<<R,B=p[R];B===-1?((H&c)===0||(H&f)!==0)&&(p[R]=Tn(H,l)):B<=l&&(s.expiredLanes|=H),w&=~H}if(l=yn,c=It,c=Ls(s,s===l?c:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f=s.callbackNode,c===0||s===l&&(cn===2||cn===9)||s.cancelPendingCommit!==null)return f!==null&&f!==null&&ce(f),s.callbackNode=null,s.callbackPriority=0;if((c&3)===0||pa(s,c)){if(l=c&-c,l===s.callbackPriority)return l;switch(f!==null&&ce(f),$r(c)){case 2:case 8:c=Ze;break;case 32:c=Je;break;case 268435456:c=Gn;break;default:c=Je}return f=kV.bind(null,s),c=ee(c,f),s.callbackPriority=l,s.callbackNode=c,l}return f!==null&&f!==null&&ce(f),s.callbackPriority=2,s.callbackNode=null,2}function kV(s,l){if(Pi!==0&&Pi!==5)return s.callbackNode=null,s.callbackPriority=0,null;var c=s.callbackNode;if(Ky()&&s.callbackNode!==c)return null;var f=It;return f=Ls(s,s===yn?f:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),f===0?null:(wV(s,f,l),LV(s,Le()),s.callbackNode!=null&&s.callbackNode===c?kV.bind(null,s):null)}function $V(s,l){if(Ky())return null;wV(s,l,!0)}function iX(){mX(function(){(Xt&6)!==0?ee(bt,nX):DV()})}function DT(){if(Fu===0){var s=of;s===0&&(s=wr,wr<<=1,(wr&261888)===0&&(wr=256)),Fu=s}return Fu}function VV(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:oy(""+s)}function BV(s,l){var c=l.ownerDocument.createElement("input");return c.name=l.name,c.value=l.value,s.id&&c.setAttribute("form",s.id),l.parentNode.insertBefore(c,l),s=new FormData(s),c.parentNode.removeChild(c),s}function rX(s,l,c,f,p){if(l==="submit"&&c&&c.stateNode===p){var w=VV((p[kt]||null).action),R=f.submitter;R&&(l=(l=R[kt]||null)?VV(l.formAction):R.getAttribute("formAction"),l!==null&&(w=l,R=null));var H=new uy("action","action",null,f,p);s.push({event:H,listeners:[{instance:null,listener:function(){if(f.defaultPrevented){if(Fu!==0){var B=R?BV(p,R):new FormData(p);tT(c,{pending:!0,data:B,method:p.method,action:w},null,B)}}else typeof w=="function"&&(H.preventDefault(),B=R?BV(p,R):new FormData(p),tT(c,{pending:!0,data:B,method:p.method,action:w},w,B))},currentTarget:p}]})}}for(var LT=0;LT<wE.length;LT++){var kT=wE[LT],oX=kT.toLowerCase(),sX=kT[0].toUpperCase()+kT.slice(1);ks(oX,"on"+sX)}ks(vk,"onAnimationEnd"),ks(wk,"onAnimationIteration"),ks(yk,"onAnimationStart"),ks("dblclick","onDoubleClick"),ks("focusin","onFocus"),ks("focusout","onBlur"),ks(C7,"onTransitionRun"),ks(R7,"onTransitionStart"),ks(E7,"onTransitionCancel"),ks(Sk,"onTransitionEnd"),va("onMouseEnter",["mouseout","mouseover"]),va("onMouseLeave",["mouseout","mouseover"]),va("onPointerEnter",["pointerout","pointerover"]),va("onPointerLeave",["pointerout","pointerover"]),Br("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Br("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Br("onBeforeInput",["compositionend","keypress","textInput","paste"]),Br("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Br("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Br("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var lp="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),aX=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(lp));function FV(s,l){l=(l&4)!==0;for(var c=0;c<s.length;c++){var f=s[c],p=f.event;f=f.listeners;e:{var w=void 0;if(l)for(var R=f.length-1;0<=R;R--){var H=f[R],B=H.instance,se=H.currentTarget;if(H=H.listener,B!==w&&p.isPropagationStopped())break e;w=H,p.currentTarget=se;try{w(p)}catch(ge){dy(ge)}p.currentTarget=null,w=B}else for(R=0;R<f.length;R++){if(H=f[R],B=H.instance,se=H.currentTarget,H=H.listener,B!==w&&p.isPropagationStopped())break e;w=H,p.currentTarget=se;try{w(p)}catch(ge){dy(ge)}p.currentTarget=null,w=B}}}}function Ot(s,l){var c=l[Ru];c===void 0&&(c=l[Ru]=new Set);var f=s+"__bubble";c.has(f)||(WV(l,s,2,!1),c.add(f))}function $T(s,l,c){var f=0;l&&(f|=4),WV(c,s,f,l)}var Qy="_reactListening"+Math.random().toString(36).slice(2);function VT(s){if(!s[Qy]){s[Qy]=!0,Ji.forEach(function(c){c!=="selectionchange"&&(aX.has(c)||$T(c,!1,s),$T(c,!0,s))});var l=s.nodeType===9?s:s.ownerDocument;l===null||l[Qy]||(l[Qy]=!0,$T("selectionchange",!1,l))}}function WV(s,l,c,f){switch(vB(l)){case 2:var p=DX;break;case 8:p=LX;break;default:p=e_}c=p.bind(null,l,c,s),p=void 0,!oE||l!=="touchstart"&&l!=="touchmove"&&l!=="wheel"||(p=!0),f?p!==void 0?s.addEventListener(l,c,{capture:!0,passive:p}):s.addEventListener(l,c,!0):p!==void 0?s.addEventListener(l,c,{passive:p}):s.addEventListener(l,c,!1)}function BT(s,l,c,f,p){var w=f;if((l&1)===0&&(l&2)===0&&f!==null)e:for(;;){if(f===null)return;var R=f.tag;if(R===3||R===4){var H=f.stateNode.containerInfo;if(H===p)break;if(R===4)for(R=f.return;R!==null;){var B=R.tag;if((B===3||B===4)&&R.stateNode.containerInfo===p)return;R=R.return}for(;H!==null;){if(R=be(H),R===null)return;if(B=R.tag,B===5||B===6||B===26||B===27){f=w=R;continue e}H=H.parentNode}}f=f.return}GL(function(){var se=w,ge=iE(c),ve=[];e:{var ae=bk.get(s);if(ae!==void 0){var he=uy,Be=s;switch(s){case"keypress":if(ay(c)===0)break e;case"keydown":case"keyup":he=e7;break;case"focusin":Be="focus",he=uE;break;case"focusout":Be="blur",he=uE;break;case"beforeblur":case"afterblur":he=uE;break;case"click":if(c.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":he=XL;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":he=W9;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":he=i7;break;case vk:case wk:case yk:he=U9;break;case Sk:he=o7;break;case"scroll":case"scrollend":he=B9;break;case"wheel":he=a7;break;case"copy":case"cut":case"paste":he=G9;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":he=QL;break;case"toggle":case"beforetoggle":he=u7}var et=(l&4)!==0,vn=!et&&(s==="scroll"||s==="scrollend"),te=et?ae!==null?ae+"Capture":null:ae;et=[];for(var G=se,oe;G!==null;){var pe=G;if(oe=pe.stateNode,pe=pe.tag,pe!==5&&pe!==26&&pe!==27||oe===null||te===null||(pe=xm(G,te),pe!=null&&et.push(up(G,pe,oe))),vn)break;G=G.return}0<et.length&&(ae=new he(ae,Be,null,c,ge),ve.push({event:ae,listeners:et}))}}if((l&7)===0){e:{if(ae=s==="mouseover"||s==="pointerover",he=s==="mouseout"||s==="pointerout",ae&&c!==nE&&(Be=c.relatedTarget||c.fromElement)&&(be(Be)||Be[Vr]))break e;if((he||ae)&&(ae=ge.window===ge?ge:(ae=ge.ownerDocument)?ae.defaultView||ae.parentWindow:window,he?(Be=c.relatedTarget||c.toElement,he=se,Be=Be?be(Be):null,Be!==null&&(vn=o(Be),et=Be.tag,Be!==vn||et!==5&&et!==27&&et!==6)&&(Be=null)):(he=null,Be=se),he!==Be)){if(et=XL,pe="onMouseLeave",te="onMouseEnter",G="mouse",(s==="pointerout"||s==="pointerover")&&(et=QL,pe="onPointerLeave",te="onPointerEnter",G="pointer"),vn=he==null?ae:nn(he),oe=Be==null?ae:nn(Be),ae=new et(pe,G+"leave",he,c,ge),ae.target=vn,ae.relatedTarget=oe,pe=null,be(ge)===se&&(et=new et(te,G+"enter",Be,c,ge),et.target=oe,et.relatedTarget=vn,pe=et),vn=pe,he&&Be)t:{for(et=lX,te=he,G=Be,oe=0,pe=te;pe;pe=et(pe))oe++;pe=0;for(var qe=G;qe;qe=et(qe))pe++;for(;0<oe-pe;)te=et(te),oe--;for(;0<pe-oe;)G=et(G),pe--;for(;oe--;){if(te===G||G!==null&&te===G.alternate){et=te;break t}te=et(te),G=et(G)}et=null}else et=null;he!==null&&jV(ve,ae,he,et,!1),Be!==null&&vn!==null&&jV(ve,vn,Be,et,!0)}}e:{if(ae=se?nn(se):window,he=ae.nodeName&&ae.nodeName.toLowerCase(),he==="select"||he==="input"&&ae.type==="file")var jt=sk;else if(rk(ae))if(ak)jt=y7;else{jt=v7;var Ue=p7}else he=ae.nodeName,!he||he.toLowerCase()!=="input"||ae.type!=="checkbox"&&ae.type!=="radio"?se&&tE(se.elementType)&&(jt=sk):jt=w7;if(jt&&(jt=jt(s,se))){ok(ve,jt,c,ge);break e}Ue&&Ue(s,ae,se),s==="focusout"&&se&&ae.type==="number"&&se.memoizedProps.value!=null&&eE(ae,"number",ae.value)}switch(Ue=se?nn(se):window,s){case"focusin":(rk(Ue)||Ue.contentEditable==="true")&&(Xd=Ue,mE=se,$m=null);break;case"focusout":$m=mE=Xd=null;break;case"mousedown":pE=!0;break;case"contextmenu":case"mouseup":case"dragend":pE=!1,mk(ve,c,ge);break;case"selectionchange":if(b7)break;case"keydown":case"keyup":mk(ve,c,ge)}var ht;if(hE)e:{switch(s){case"compositionstart":var Pt="onCompositionStart";break e;case"compositionend":Pt="onCompositionEnd";break e;case"compositionupdate":Pt="onCompositionUpdate";break e}Pt=void 0}else Kd?nk(s,c)&&(Pt="onCompositionEnd"):s==="keydown"&&c.keyCode===229&&(Pt="onCompositionStart");Pt&&(JL&&c.locale!=="ko"&&(Kd||Pt!=="onCompositionStart"?Pt==="onCompositionEnd"&&Kd&&(ht=qL()):(Tu=ge,sE="value"in Tu?Tu.value:Tu.textContent,Kd=!0)),Ue=Jy(se,Pt),0<Ue.length&&(Pt=new ZL(Pt,s,null,c,ge),ve.push({event:Pt,listeners:Ue}),ht?Pt.data=ht:(ht=ik(c),ht!==null&&(Pt.data=ht)))),(ht=h7?d7(s,c):f7(s,c))&&(Pt=Jy(se,"onBeforeInput"),0<Pt.length&&(Ue=new ZL("onBeforeInput","beforeinput",null,c,ge),ve.push({event:Ue,listeners:Pt}),Ue.data=ht)),rX(ve,s,se,c,ge)}FV(ve,l)})}function up(s,l,c){return{instance:s,listener:l,currentTarget:c}}function Jy(s,l){for(var c=l+"Capture",f=[];s!==null;){var p=s,w=p.stateNode;if(p=p.tag,p!==5&&p!==26&&p!==27||w===null||(p=xm(s,c),p!=null&&f.unshift(up(s,p,w)),p=xm(s,l),p!=null&&f.push(up(s,p,w))),s.tag===3)return f;s=s.return}return[]}function lX(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function jV(s,l,c,f,p){for(var w=l._reactName,R=[];c!==null&&c!==f;){var H=c,B=H.alternate,se=H.stateNode;if(H=H.tag,B!==null&&B===f)break;H!==5&&H!==26&&H!==27||se===null||(B=se,p?(se=xm(c,w),se!=null&&R.unshift(up(c,se,B))):p||(se=xm(c,w),se!=null&&R.push(up(c,se,B)))),c=c.return}R.length!==0&&s.push({event:l,listeners:R})}var uX=/\r\n?/g,cX=/\u0000|\uFFFD/g;function zV(s){return(typeof s=="string"?s:""+s).replace(uX,`
`).replace(cX,"")}function UV(s,l){return l=zV(l),zV(s)===l}function pn(s,l,c,f,p,w){switch(c){case"children":typeof f=="string"?l==="body"||l==="textarea"&&f===""||Yd(s,f):(typeof f=="number"||typeof f=="bigint")&&l!=="body"&&Yd(s,""+f);break;case"className":iy(s,"class",f);break;case"tabIndex":iy(s,"tabindex",f);break;case"dir":case"role":case"viewBox":case"width":case"height":iy(s,c,f);break;case"style":UL(s,f,w);break;case"data":if(l!=="object"){iy(s,"data",f);break}case"src":case"href":if(f===""&&(l!=="a"||c!=="href")){s.removeAttribute(c);break}if(f==null||typeof f=="function"||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=oy(""+f),s.setAttribute(c,f);break;case"action":case"formAction":if(typeof f=="function"){s.setAttribute(c,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof w=="function"&&(c==="formAction"?(l!=="input"&&pn(s,l,"name",p.name,p,null),pn(s,l,"formEncType",p.formEncType,p,null),pn(s,l,"formMethod",p.formMethod,p,null),pn(s,l,"formTarget",p.formTarget,p,null)):(pn(s,l,"encType",p.encType,p,null),pn(s,l,"method",p.method,p,null),pn(s,l,"target",p.target,p,null)));if(f==null||typeof f=="symbol"||typeof f=="boolean"){s.removeAttribute(c);break}f=oy(""+f),s.setAttribute(c,f);break;case"onClick":f!=null&&(s.onclick=dl);break;case"onScroll":f!=null&&Ot("scroll",s);break;case"onScrollEnd":f!=null&&Ot("scrollend",s);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(p.children!=null)throw Error(i(60));s.innerHTML=c}}break;case"multiple":s.multiple=f&&typeof f!="function"&&typeof f!="symbol";break;case"muted":s.muted=f&&typeof f!="function"&&typeof f!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(f==null||typeof f=="function"||typeof f=="boolean"||typeof f=="symbol"){s.removeAttribute("xlink:href");break}c=oy(""+f),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",c);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""+f):s.removeAttribute(c);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":f&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,""):s.removeAttribute(c);break;case"capture":case"download":f===!0?s.setAttribute(c,""):f!==!1&&f!=null&&typeof f!="function"&&typeof f!="symbol"?s.setAttribute(c,f):s.removeAttribute(c);break;case"cols":case"rows":case"size":case"span":f!=null&&typeof f!="function"&&typeof f!="symbol"&&!isNaN(f)&&1<=f?s.setAttribute(c,f):s.removeAttribute(c);break;case"rowSpan":case"start":f==null||typeof f=="function"||typeof f=="symbol"||isNaN(f)?s.removeAttribute(c):s.setAttribute(c,f);break;case"popover":Ot("beforetoggle",s),Ot("toggle",s),ny(s,"popover",f);break;case"xlinkActuate":hl(s,"http://www.w3.org/1999/xlink","xlink:actuate",f);break;case"xlinkArcrole":hl(s,"http://www.w3.org/1999/xlink","xlink:arcrole",f);break;case"xlinkRole":hl(s,"http://www.w3.org/1999/xlink","xlink:role",f);break;case"xlinkShow":hl(s,"http://www.w3.org/1999/xlink","xlink:show",f);break;case"xlinkTitle":hl(s,"http://www.w3.org/1999/xlink","xlink:title",f);break;case"xlinkType":hl(s,"http://www.w3.org/1999/xlink","xlink:type",f);break;case"xmlBase":hl(s,"http://www.w3.org/XML/1998/namespace","xml:base",f);break;case"xmlLang":hl(s,"http://www.w3.org/XML/1998/namespace","xml:lang",f);break;case"xmlSpace":hl(s,"http://www.w3.org/XML/1998/namespace","xml:space",f);break;case"is":ny(s,"is",f);break;case"innerText":case"textContent":break;default:(!(2<c.length)||c[0]!=="o"&&c[0]!=="O"||c[1]!=="n"&&c[1]!=="N")&&(c=$9.get(c)||c,ny(s,c,f))}}function FT(s,l,c,f,p,w){switch(c){case"style":UL(s,f,w);break;case"dangerouslySetInnerHTML":if(f!=null){if(typeof f!="object"||!("__html"in f))throw Error(i(61));if(c=f.__html,c!=null){if(p.children!=null)throw Error(i(60));s.innerHTML=c}}break;case"children":typeof f=="string"?Yd(s,f):(typeof f=="number"||typeof f=="bigint")&&Yd(s,""+f);break;case"onScroll":f!=null&&Ot("scroll",s);break;case"onScrollEnd":f!=null&&Ot("scrollend",s);break;case"onClick":f!=null&&(s.onclick=dl);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!qo.hasOwnProperty(c))e:{if(c[0]==="o"&&c[1]==="n"&&(p=c.endsWith("Capture"),l=c.slice(2,p?c.length-7:void 0),w=s[kt]||null,w=w!=null?w[c]:null,typeof w=="function"&&s.removeEventListener(l,w,p),typeof f=="function")){typeof w!="function"&&w!==null&&(c in s?s[c]=null:s.hasAttribute(c)&&s.removeAttribute(c)),s.addEventListener(l,f,p);break e}c in s?s[c]=f:f===!0?s.setAttribute(c,""):ny(s,c,f)}}}function ir(s,l,c){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Ot("error",s),Ot("load",s);var f=!1,p=!1,w;for(w in c)if(c.hasOwnProperty(w)){var R=c[w];if(R!=null)switch(w){case"src":f=!0;break;case"srcSet":p=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:pn(s,l,w,R,c,null)}}p&&pn(s,l,"srcSet",c.srcSet,c,null),f&&pn(s,l,"src",c.src,c,null);return;case"input":Ot("invalid",s);var H=w=R=p=null,B=null,se=null;for(f in c)if(c.hasOwnProperty(f)){var ge=c[f];if(ge!=null)switch(f){case"name":p=ge;break;case"type":R=ge;break;case"checked":B=ge;break;case"defaultChecked":se=ge;break;case"value":w=ge;break;case"defaultValue":H=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(i(137,l));break;default:pn(s,l,f,ge,c,null)}}FL(s,w,H,B,se,R,p,!1);return;case"select":Ot("invalid",s),f=R=w=null;for(p in c)if(c.hasOwnProperty(p)&&(H=c[p],H!=null))switch(p){case"value":w=H;break;case"defaultValue":R=H;break;case"multiple":f=H;default:pn(s,l,p,H,c,null)}l=w,c=R,s.multiple=!!f,l!=null?Ud(s,!!f,l,!1):c!=null&&Ud(s,!!f,c,!0);return;case"textarea":Ot("invalid",s),w=p=f=null;for(R in c)if(c.hasOwnProperty(R)&&(H=c[R],H!=null))switch(R){case"value":f=H;break;case"defaultValue":p=H;break;case"children":w=H;break;case"dangerouslySetInnerHTML":if(H!=null)throw Error(i(91));break;default:pn(s,l,R,H,c,null)}jL(s,f,p,w);return;case"option":for(B in c)if(c.hasOwnProperty(B)&&(f=c[B],f!=null))switch(B){case"selected":s.selected=f&&typeof f!="function"&&typeof f!="symbol";break;default:pn(s,l,B,f,c,null)}return;case"dialog":Ot("beforetoggle",s),Ot("toggle",s),Ot("cancel",s),Ot("close",s);break;case"iframe":case"object":Ot("load",s);break;case"video":case"audio":for(f=0;f<lp.length;f++)Ot(lp[f],s);break;case"image":Ot("error",s),Ot("load",s);break;case"details":Ot("toggle",s);break;case"embed":case"source":case"link":Ot("error",s),Ot("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(se in c)if(c.hasOwnProperty(se)&&(f=c[se],f!=null))switch(se){case"children":case"dangerouslySetInnerHTML":throw Error(i(137,l));default:pn(s,l,se,f,c,null)}return;default:if(tE(l)){for(ge in c)c.hasOwnProperty(ge)&&(f=c[ge],f!==void 0&&FT(s,l,ge,f,c,void 0));return}}for(H in c)c.hasOwnProperty(H)&&(f=c[H],f!=null&&pn(s,l,H,f,c,null))}function hX(s,l,c,f){switch(l){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var p=null,w=null,R=null,H=null,B=null,se=null,ge=null;for(he in c){var ve=c[he];if(c.hasOwnProperty(he)&&ve!=null)switch(he){case"checked":break;case"value":break;case"defaultValue":B=ve;default:f.hasOwnProperty(he)||pn(s,l,he,null,f,ve)}}for(var ae in f){var he=f[ae];if(ve=c[ae],f.hasOwnProperty(ae)&&(he!=null||ve!=null))switch(ae){case"type":w=he;break;case"name":p=he;break;case"checked":se=he;break;case"defaultChecked":ge=he;break;case"value":R=he;break;case"defaultValue":H=he;break;case"children":case"dangerouslySetInnerHTML":if(he!=null)throw Error(i(137,l));break;default:he!==ve&&pn(s,l,ae,he,f,ve)}}JR(s,R,H,B,se,ge,w,p);return;case"select":he=R=H=ae=null;for(w in c)if(B=c[w],c.hasOwnProperty(w)&&B!=null)switch(w){case"value":break;case"multiple":he=B;default:f.hasOwnProperty(w)||pn(s,l,w,null,f,B)}for(p in f)if(w=f[p],B=c[p],f.hasOwnProperty(p)&&(w!=null||B!=null))switch(p){case"value":ae=w;break;case"defaultValue":H=w;break;case"multiple":R=w;default:w!==B&&pn(s,l,p,w,f,B)}l=H,c=R,f=he,ae!=null?Ud(s,!!c,ae,!1):!!f!=!!c&&(l!=null?Ud(s,!!c,l,!0):Ud(s,!!c,c?[]:"",!1));return;case"textarea":he=ae=null;for(H in c)if(p=c[H],c.hasOwnProperty(H)&&p!=null&&!f.hasOwnProperty(H))switch(H){case"value":break;case"children":break;default:pn(s,l,H,null,f,p)}for(R in f)if(p=f[R],w=c[R],f.hasOwnProperty(R)&&(p!=null||w!=null))switch(R){case"value":ae=p;break;case"defaultValue":he=p;break;case"children":break;case"dangerouslySetInnerHTML":if(p!=null)throw Error(i(91));break;default:p!==w&&pn(s,l,R,p,f,w)}WL(s,ae,he);return;case"option":for(var Be in c)if(ae=c[Be],c.hasOwnProperty(Be)&&ae!=null&&!f.hasOwnProperty(Be))switch(Be){case"selected":s.selected=!1;break;default:pn(s,l,Be,null,f,ae)}for(B in f)if(ae=f[B],he=c[B],f.hasOwnProperty(B)&&ae!==he&&(ae!=null||he!=null))switch(B){case"selected":s.selected=ae&&typeof ae!="function"&&typeof ae!="symbol";break;default:pn(s,l,B,ae,f,he)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var et in c)ae=c[et],c.hasOwnProperty(et)&&ae!=null&&!f.hasOwnProperty(et)&&pn(s,l,et,null,f,ae);for(se in f)if(ae=f[se],he=c[se],f.hasOwnProperty(se)&&ae!==he&&(ae!=null||he!=null))switch(se){case"children":case"dangerouslySetInnerHTML":if(ae!=null)throw Error(i(137,l));break;default:pn(s,l,se,ae,f,he)}return;default:if(tE(l)){for(var vn in c)ae=c[vn],c.hasOwnProperty(vn)&&ae!==void 0&&!f.hasOwnProperty(vn)&&FT(s,l,vn,void 0,f,ae);for(ge in f)ae=f[ge],he=c[ge],!f.hasOwnProperty(ge)||ae===he||ae===void 0&&he===void 0||FT(s,l,ge,ae,f,he);return}}for(var te in c)ae=c[te],c.hasOwnProperty(te)&&ae!=null&&!f.hasOwnProperty(te)&&pn(s,l,te,null,f,ae);for(ve in f)ae=f[ve],he=c[ve],!f.hasOwnProperty(ve)||ae===he||ae==null&&he==null||pn(s,l,ve,ae,f,he)}function YV(s){switch(s){case"css":case"script":case"font":case"img":case"image":case"input":case"link":return!0;default:return!1}}function dX(){if(typeof performance.getEntriesByType=="function"){for(var s=0,l=0,c=performance.getEntriesByType("resource"),f=0;f<c.length;f++){var p=c[f],w=p.transferSize,R=p.initiatorType,H=p.duration;if(w&&H&&YV(R)){for(R=0,H=p.responseEnd,f+=1;f<c.length;f++){var B=c[f],se=B.startTime;if(se>H)break;var ge=B.transferSize,ve=B.initiatorType;ge&&YV(ve)&&(B=B.responseEnd,R+=ge*(B<H?1:(H-se)/(B-se)))}if(--f,l+=8*(w+R)/(p.duration/1e3),s++,10<s)break}}if(0<s)return l/s/1e6}return navigator.connection&&(s=navigator.connection.downlink,typeof s=="number")?s:5}var WT=null,jT=null;function eS(s){return s.nodeType===9?s:s.ownerDocument}function GV(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function qV(s,l){if(s===0)switch(l){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&l==="foreignObject"?0:s}function zT(s,l){return s==="textarea"||s==="noscript"||typeof l.children=="string"||typeof l.children=="number"||typeof l.children=="bigint"||typeof l.dangerouslySetInnerHTML=="object"&&l.dangerouslySetInnerHTML!==null&&l.dangerouslySetInnerHTML.__html!=null}var UT=null;function fX(){var s=window.event;return s&&s.type==="popstate"?s===UT?!1:(UT=s,!0):(UT=null,!1)}var KV=typeof setTimeout=="function"?setTimeout:void 0,gX=typeof clearTimeout=="function"?clearTimeout:void 0,XV=typeof Promise=="function"?Promise:void 0,mX=typeof queueMicrotask=="function"?queueMicrotask:typeof XV<"u"?function(s){return XV.resolve(null).then(s).catch(pX)}:KV;function pX(s){setTimeout(function(){throw s})}function Wu(s){return s==="head"}function ZV(s,l){var c=l,f=0;do{var p=c.nextSibling;if(s.removeChild(c),p&&p.nodeType===8)if(c=p.data,c==="/$"||c==="/&"){if(f===0){s.removeChild(p),Ef(l);return}f--}else if(c==="$"||c==="$?"||c==="$~"||c==="$!"||c==="&")f++;else if(c==="html")cp(s.ownerDocument.documentElement);else if(c==="head"){c=s.ownerDocument.head,cp(c);for(var w=c.firstChild;w;){var R=w.nextSibling,H=w.nodeName;w[je]||H==="SCRIPT"||H==="STYLE"||H==="LINK"&&w.rel.toLowerCase()==="stylesheet"||c.removeChild(w),w=R}}else c==="body"&&cp(s.ownerDocument.body);c=p}while(c);Ef(l)}function QV(s,l){var c=s;s=0;do{var f=c.nextSibling;if(c.nodeType===1?l?(c._stashedDisplay=c.style.display,c.style.display="none"):(c.style.display=c._stashedDisplay||"",c.getAttribute("style")===""&&c.removeAttribute("style")):c.nodeType===3&&(l?(c._stashedText=c.nodeValue,c.nodeValue=""):c.nodeValue=c._stashedText||""),f&&f.nodeType===8)if(c=f.data,c==="/$"){if(s===0)break;s--}else c!=="$"&&c!=="$?"&&c!=="$~"&&c!=="$!"||s++;c=f}while(c)}function YT(s){var l=s.firstChild;for(l&&l.nodeType===10&&(l=l.nextSibling);l;){var c=l;switch(l=l.nextSibling,c.nodeName){case"HTML":case"HEAD":case"BODY":YT(c),Y(c);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(c.rel.toLowerCase()==="stylesheet")continue}s.removeChild(c)}}function vX(s,l,c,f){for(;s.nodeType===1;){var p=c;if(s.nodeName.toLowerCase()!==l.toLowerCase()){if(!f&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(f){if(!s[je])switch(l){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(w=s.getAttribute("rel"),w==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(w!==p.rel||s.getAttribute("href")!==(p.href==null||p.href===""?null:p.href)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin)||s.getAttribute("title")!==(p.title==null?null:p.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(w=s.getAttribute("src"),(w!==(p.src==null?null:p.src)||s.getAttribute("type")!==(p.type==null?null:p.type)||s.getAttribute("crossorigin")!==(p.crossOrigin==null?null:p.crossOrigin))&&w&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(l==="input"&&s.type==="hidden"){var w=p.name==null?null:""+p.name;if(p.type==="hidden"&&s.getAttribute("name")===w)return s}else return s;if(s=is(s.nextSibling),s===null)break}return null}function wX(s,l,c){if(l==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!c||(s=is(s.nextSibling),s===null))return null;return s}function JV(s,l){for(;s.nodeType!==8;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!l||(s=is(s.nextSibling),s===null))return null;return s}function GT(s){return s.data==="$?"||s.data==="$~"}function qT(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState!=="loading"}function yX(s,l){var c=s.ownerDocument;if(s.data==="$~")s._reactRetry=l;else if(s.data!=="$?"||c.readyState!=="loading")l();else{var f=function(){l(),c.removeEventListener("DOMContentLoaded",f)};c.addEventListener("DOMContentLoaded",f),s._reactRetry=f}}function is(s){for(;s!=null;s=s.nextSibling){var l=s.nodeType;if(l===1||l===3)break;if(l===8){if(l=s.data,l==="$"||l==="$!"||l==="$?"||l==="$~"||l==="&"||l==="F!"||l==="F")break;if(l==="/$"||l==="/&")return null}}return s}var KT=null;function eB(s){s=s.nextSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="/$"||c==="/&"){if(l===0)return is(s.nextSibling);l--}else c!=="$"&&c!=="$!"&&c!=="$?"&&c!=="$~"&&c!=="&"||l++}s=s.nextSibling}return null}function tB(s){s=s.previousSibling;for(var l=0;s;){if(s.nodeType===8){var c=s.data;if(c==="$"||c==="$!"||c==="$?"||c==="$~"||c==="&"){if(l===0)return s;l--}else c!=="/$"&&c!=="/&"||l++}s=s.previousSibling}return null}function nB(s,l,c){switch(l=eS(c),s){case"html":if(s=l.documentElement,!s)throw Error(i(452));return s;case"head":if(s=l.head,!s)throw Error(i(453));return s;case"body":if(s=l.body,!s)throw Error(i(454));return s;default:throw Error(i(451))}}function cp(s){for(var l=s.attributes;l.length;)s.removeAttributeNode(l[0]);Y(s)}var rs=new Map,iB=new Set;function tS(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var Al=de.d;de.d={f:SX,r:bX,D:CX,C:RX,L:EX,m:TX,X:MX,S:_X,M:AX};function SX(){var s=Al.f(),l=Yy();return s||l}function bX(s){var l=ke(s);l!==null&&l.tag===5&&l.type==="form"?S$(l):Al.r(s)}var bf=typeof document>"u"?null:document;function rB(s,l,c){var f=bf;if(f&&typeof l=="string"&&l){var p=Xo(l);p='link[rel="'+s+'"][href="'+p+'"]',typeof c=="string"&&(p+='[crossorigin="'+c+'"]'),iB.has(p)||(iB.add(p),s={rel:s,crossOrigin:c,href:l},f.querySelector(p)===null&&(l=f.createElement("link"),ir(l,"link",s),yt(l),f.head.appendChild(l)))}}function CX(s){Al.D(s),rB("dns-prefetch",s,null)}function RX(s,l){Al.C(s,l),rB("preconnect",s,l)}function EX(s,l,c){Al.L(s,l,c);var f=bf;if(f&&s&&l){var p='link[rel="preload"][as="'+Xo(l)+'"]';l==="image"&&c&&c.imageSrcSet?(p+='[imagesrcset="'+Xo(c.imageSrcSet)+'"]',typeof c.imageSizes=="string"&&(p+='[imagesizes="'+Xo(c.imageSizes)+'"]')):p+='[href="'+Xo(s)+'"]';var w=p;switch(l){case"style":w=Cf(s);break;case"script":w=Rf(s)}rs.has(w)||(s=m({rel:"preload",href:l==="image"&&c&&c.imageSrcSet?void 0:s,as:l},c),rs.set(w,s),f.querySelector(p)!==null||l==="style"&&f.querySelector(hp(w))||l==="script"&&f.querySelector(dp(w))||(l=f.createElement("link"),ir(l,"link",s),yt(l),f.head.appendChild(l)))}}function TX(s,l){Al.m(s,l);var c=bf;if(c&&s){var f=l&&typeof l.as=="string"?l.as:"script",p='link[rel="modulepreload"][as="'+Xo(f)+'"][href="'+Xo(s)+'"]',w=p;switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":w=Rf(s)}if(!rs.has(w)&&(s=m({rel:"modulepreload",href:s},l),rs.set(w,s),c.querySelector(p)===null)){switch(f){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(c.querySelector(dp(w)))return}f=c.createElement("link"),ir(f,"link",s),yt(f),c.head.appendChild(f)}}}function _X(s,l,c){Al.S(s,l,c);var f=bf;if(f&&s){var p=Vn(f).hoistableStyles,w=Cf(s);l=l||"default";var R=p.get(w);if(!R){var H={loading:0,preload:null};if(R=f.querySelector(hp(w)))H.loading=5;else{s=m({rel:"stylesheet",href:s,"data-precedence":l},c),(c=rs.get(w))&&XT(s,c);var B=R=f.createElement("link");yt(B),ir(B,"link",s),B._p=new Promise(function(se,ge){B.onload=se,B.onerror=ge}),B.addEventListener("load",function(){H.loading|=1}),B.addEventListener("error",function(){H.loading|=2}),H.loading|=4,nS(R,l,f)}R={type:"stylesheet",instance:R,count:1,state:H},p.set(w,R)}}}function MX(s,l){Al.X(s,l);var c=bf;if(c&&s){var f=Vn(c).hoistableScripts,p=Rf(s),w=f.get(p);w||(w=c.querySelector(dp(p)),w||(s=m({src:s,async:!0},l),(l=rs.get(p))&&ZT(s,l),w=c.createElement("script"),yt(w),ir(w,"link",s),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(p,w))}}function AX(s,l){Al.M(s,l);var c=bf;if(c&&s){var f=Vn(c).hoistableScripts,p=Rf(s),w=f.get(p);w||(w=c.querySelector(dp(p)),w||(s=m({src:s,async:!0,type:"module"},l),(l=rs.get(p))&&ZT(s,l),w=c.createElement("script"),yt(w),ir(w,"link",s),c.head.appendChild(w)),w={type:"script",instance:w,count:1,state:null},f.set(p,w))}}function oB(s,l,c,f){var p=(p=M.current)?tS(p):null;if(!p)throw Error(i(446));switch(s){case"meta":case"title":return null;case"style":return typeof c.precedence=="string"&&typeof c.href=="string"?(l=Cf(c.href),c=Vn(p).hoistableStyles,f=c.get(l),f||(f={type:"style",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};case"link":if(c.rel==="stylesheet"&&typeof c.href=="string"&&typeof c.precedence=="string"){s=Cf(c.href);var w=Vn(p).hoistableStyles,R=w.get(s);if(R||(p=p.ownerDocument||p,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},w.set(s,R),(w=p.querySelector(hp(s)))&&!w._p&&(R.instance=w,R.state.loading=5),rs.has(s)||(c={rel:"preload",as:"style",href:c.href,crossOrigin:c.crossOrigin,integrity:c.integrity,media:c.media,hrefLang:c.hrefLang,referrerPolicy:c.referrerPolicy},rs.set(s,c),w||OX(p,s,c,R.state))),l&&f===null)throw Error(i(528,""));return R}if(l&&f!==null)throw Error(i(529,""));return null;case"script":return l=c.async,c=c.src,typeof c=="string"&&l&&typeof l!="function"&&typeof l!="symbol"?(l=Rf(c),c=Vn(p).hoistableScripts,f=c.get(l),f||(f={type:"script",instance:null,count:0,state:null},c.set(l,f)),f):{type:"void",instance:null,count:0,state:null};default:throw Error(i(444,s))}}function Cf(s){return'href="'+Xo(s)+'"'}function hp(s){return'link[rel="stylesheet"]['+s+"]"}function sB(s){return m({},s,{"data-precedence":s.precedence,precedence:null})}function OX(s,l,c,f){s.querySelector('link[rel="preload"][as="style"]['+l+"]")?f.loading=1:(l=s.createElement("link"),f.preload=l,l.addEventListener("load",function(){return f.loading|=1}),l.addEventListener("error",function(){return f.loading|=2}),ir(l,"link",c),yt(l),s.head.appendChild(l))}function Rf(s){return'[src="'+Xo(s)+'"]'}function dp(s){return"script[async]"+s}function aB(s,l,c){if(l.count++,l.instance===null)switch(l.type){case"style":var f=s.querySelector('style[data-href~="'+Xo(c.href)+'"]');if(f)return l.instance=f,yt(f),f;var p=m({},c,{"data-href":c.href,"data-precedence":c.precedence,href:null,precedence:null});return f=(s.ownerDocument||s).createElement("style"),yt(f),ir(f,"style",p),nS(f,c.precedence,s),l.instance=f;case"stylesheet":p=Cf(c.href);var w=s.querySelector(hp(p));if(w)return l.state.loading|=4,l.instance=w,yt(w),w;f=sB(c),(p=rs.get(p))&&XT(f,p),w=(s.ownerDocument||s).createElement("link"),yt(w);var R=w;return R._p=new Promise(function(H,B){R.onload=H,R.onerror=B}),ir(w,"link",f),l.state.loading|=4,nS(w,c.precedence,s),l.instance=w;case"script":return w=Rf(c.src),(p=s.querySelector(dp(w)))?(l.instance=p,yt(p),p):(f=c,(p=rs.get(w))&&(f=m({},c),ZT(f,p)),s=s.ownerDocument||s,p=s.createElement("script"),yt(p),ir(p,"link",f),s.head.appendChild(p),l.instance=p);case"void":return null;default:throw Error(i(443,l.type))}else l.type==="stylesheet"&&(l.state.loading&4)===0&&(f=l.instance,l.state.loading|=4,nS(f,c.precedence,s));return l.instance}function nS(s,l,c){for(var f=c.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),p=f.length?f[f.length-1]:null,w=p,R=0;R<f.length;R++){var H=f[R];if(H.dataset.precedence===l)w=H;else if(w!==p)break}w?w.parentNode.insertBefore(s,w.nextSibling):(l=c.nodeType===9?c.head:c,l.insertBefore(s,l.firstChild))}function XT(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.title==null&&(s.title=l.title)}function ZT(s,l){s.crossOrigin==null&&(s.crossOrigin=l.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=l.referrerPolicy),s.integrity==null&&(s.integrity=l.integrity)}var iS=null;function lB(s,l,c){if(iS===null){var f=new Map,p=iS=new Map;p.set(c,f)}else p=iS,f=p.get(c),f||(f=new Map,p.set(c,f));if(f.has(s))return f;for(f.set(s,null),c=c.getElementsByTagName(s),p=0;p<c.length;p++){var w=c[p];if(!(w[je]||w[Kt]||s==="link"&&w.getAttribute("rel")==="stylesheet")&&w.namespaceURI!=="http://www.w3.org/2000/svg"){var R=w.getAttribute(l)||"";R=s+R;var H=f.get(R);H?H.push(w):f.set(R,[w])}}return f}function uB(s,l,c){s=s.ownerDocument||s,s.head.insertBefore(c,l==="title"?s.querySelector("head > title"):null)}function xX(s,l,c){if(c===1||l.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof l.precedence!="string"||typeof l.href!="string"||l.href==="")break;return!0;case"link":if(typeof l.rel!="string"||typeof l.href!="string"||l.href===""||l.onLoad||l.onError)break;switch(l.rel){case"stylesheet":return s=l.disabled,typeof l.precedence=="string"&&s==null;default:return!0}case"script":if(l.async&&typeof l.async!="function"&&typeof l.async!="symbol"&&!l.onLoad&&!l.onError&&l.src&&typeof l.src=="string")return!0}return!1}function cB(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}function HX(s,l,c,f){if(c.type==="stylesheet"&&(typeof f.media!="string"||matchMedia(f.media).matches!==!1)&&(c.state.loading&4)===0){if(c.instance===null){var p=Cf(f.href),w=l.querySelector(hp(p));if(w){l=w._p,l!==null&&typeof l=="object"&&typeof l.then=="function"&&(s.count++,s=rS.bind(s),l.then(s,s)),c.state.loading|=4,c.instance=w,yt(w);return}w=l.ownerDocument||l,f=sB(f),(p=rs.get(p))&&XT(f,p),w=w.createElement("link"),yt(w);var R=w;R._p=new Promise(function(H,B){R.onload=H,R.onerror=B}),ir(w,"link",f),c.instance=w}s.stylesheets===null&&(s.stylesheets=new Map),s.stylesheets.set(c,l),(l=c.state.preload)&&(c.state.loading&3)===0&&(s.count++,c=rS.bind(s),l.addEventListener("load",c),l.addEventListener("error",c))}}var QT=0;function IX(s,l){return s.stylesheets&&s.count===0&&sS(s,s.stylesheets),0<s.count||0<s.imgCount?function(c){var f=setTimeout(function(){if(s.stylesheets&&sS(s,s.stylesheets),s.unsuspend){var w=s.unsuspend;s.unsuspend=null,w()}},6e4+l);0<s.imgBytes&&QT===0&&(QT=62500*dX());var p=setTimeout(function(){if(s.waitingForImages=!1,s.count===0&&(s.stylesheets&&sS(s,s.stylesheets),s.unsuspend)){var w=s.unsuspend;s.unsuspend=null,w()}},(s.imgBytes>QT?50:800)+l);return s.unsuspend=c,function(){s.unsuspend=null,clearTimeout(f),clearTimeout(p)}}:null}function rS(){if(this.count--,this.count===0&&(this.imgCount===0||!this.waitingForImages)){if(this.stylesheets)sS(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var oS=null;function sS(s,l){s.stylesheets=null,s.unsuspend!==null&&(s.count++,oS=new Map,l.forEach(PX,s),oS=null,rS.call(s))}function PX(s,l){if(!(l.state.loading&4)){var c=oS.get(s);if(c)var f=c.get(null);else{c=new Map,oS.set(s,c);for(var p=s.querySelectorAll("link[data-precedence],style[data-precedence]"),w=0;w<p.length;w++){var R=p[w];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(c.set(R.dataset.precedence,R),f=R)}f&&c.set(null,f)}p=l.instance,R=p.getAttribute("data-precedence"),w=c.get(R)||f,w===f&&c.set(null,p),c.set(R,p),this.count++,f=rS.bind(this),p.addEventListener("load",f),p.addEventListener("error",f),w?w.parentNode.insertBefore(p,w.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(p,s.firstChild)),l.state.loading|=4}}var fp={$$typeof:N,Provider:null,Consumer:null,_currentValue:Te,_currentValue2:Te,_threadCount:0};function NX(s,l,c,f,p,w,R,H,B){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=cl(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=cl(0),this.hiddenUpdates=cl(null),this.identifierPrefix=f,this.onUncaughtError=p,this.onCaughtError=w,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=B,this.incompleteTransitions=new Map}function hB(s,l,c,f,p,w,R,H,B,se,ge,ve){return s=new NX(s,l,c,R,B,se,ge,ve,H),l=1,w===!0&&(l|=24),w=go(3,null,null,l),s.current=w,w.stateNode=s,l=HE(),l.refCount++,s.pooledCache=l,l.refCount++,w.memoizedState={element:f,isDehydrated:c,cache:l},DE(w),s}function dB(s){return s?(s=Jd,s):Jd}function fB(s,l,c,f,p,w){p=dB(p),f.context===null?f.context=p:f.pendingContext=p,f=Hu(l),f.payload={element:c},w=w===void 0?null:w,w!==null&&(f.callback=w),c=Iu(s,f,l),c!==null&&(Yr(c,s,l),Um(c,s,l))}function gB(s,l){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var c=s.retryLane;s.retryLane=c!==0&&c<l?c:l}}function JT(s,l){gB(s,l),(s=s.alternate)&&gB(s,l)}function mB(s){if(s.tag===13||s.tag===31){var l=Jc(s,67108864);l!==null&&Yr(l,s,67108864),JT(s,67108864)}}function pB(s){if(s.tag===13||s.tag===31){var l=yo();l=Wt(l);var c=Jc(s,l);c!==null&&Yr(c,s,l),JT(s,l)}}var aS=!0;function DX(s,l,c,f){var p=ie.T;ie.T=null;var w=de.p;try{de.p=2,e_(s,l,c,f)}finally{de.p=w,ie.T=p}}function LX(s,l,c,f){var p=ie.T;ie.T=null;var w=de.p;try{de.p=8,e_(s,l,c,f)}finally{de.p=w,ie.T=p}}function e_(s,l,c,f){if(aS){var p=t_(f);if(p===null)BT(s,l,f,lS,c),wB(s,f);else if($X(p,s,l,c,f))f.stopPropagation();else if(wB(s,f),l&4&&-1<kX.indexOf(s)){for(;p!==null;){var w=ke(p);if(w!==null)switch(w.tag){case 3:if(w=w.stateNode,w.current.memoizedState.isDehydrated){var R=Wi(w.pendingLanes);if(R!==0){var H=w;for(H.pendingLanes|=2,H.entangledLanes|=2;R;){var B=1<<31-nt(R);H.entanglements[1]|=B,R&=~B}ba(w),(Xt&6)===0&&(zy=Le()+500,ap(0))}}break;case 31:case 13:H=Jc(w,2),H!==null&&Yr(H,w,2),Yy(),JT(w,2)}if(w=t_(f),w===null&&BT(s,l,f,lS,c),w===p)break;p=w}p!==null&&f.stopPropagation()}else BT(s,l,f,null,c)}}function t_(s){return s=iE(s),n_(s)}var lS=null;function n_(s){if(lS=null,s=be(s),s!==null){var l=o(s);if(l===null)s=null;else{var c=l.tag;if(c===13){if(s=a(l),s!==null)return s;s=null}else if(c===31){if(s=u(l),s!==null)return s;s=null}else if(c===3){if(l.stateNode.current.memoizedState.isDehydrated)return l.tag===3?l.stateNode.containerInfo:null;s=null}else l!==s&&(s=null)}}return lS=s,null}function vB(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(it()){case bt:return 2;case Ze:return 8;case Je:case Ct:return 32;case Gn:return 268435456;default:return 32}default:return 32}}var i_=!1,ju=null,zu=null,Uu=null,gp=new Map,mp=new Map,Yu=[],kX="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wB(s,l){switch(s){case"focusin":case"focusout":ju=null;break;case"dragenter":case"dragleave":zu=null;break;case"mouseover":case"mouseout":Uu=null;break;case"pointerover":case"pointerout":gp.delete(l.pointerId);break;case"gotpointercapture":case"lostpointercapture":mp.delete(l.pointerId)}}function pp(s,l,c,f,p,w){return s===null||s.nativeEvent!==w?(s={blockedOn:l,domEventName:c,eventSystemFlags:f,nativeEvent:w,targetContainers:[p]},l!==null&&(l=ke(l),l!==null&&mB(l)),s):(s.eventSystemFlags|=f,l=s.targetContainers,p!==null&&l.indexOf(p)===-1&&l.push(p),s)}function $X(s,l,c,f,p){switch(l){case"focusin":return ju=pp(ju,s,l,c,f,p),!0;case"dragenter":return zu=pp(zu,s,l,c,f,p),!0;case"mouseover":return Uu=pp(Uu,s,l,c,f,p),!0;case"pointerover":var w=p.pointerId;return gp.set(w,pp(gp.get(w)||null,s,l,c,f,p)),!0;case"gotpointercapture":return w=p.pointerId,mp.set(w,pp(mp.get(w)||null,s,l,c,f,p)),!0}return!1}function yB(s){var l=be(s.target);if(l!==null){var c=o(l);if(c!==null){if(l=c.tag,l===13){if(l=a(c),l!==null){s.blockedOn=l,_n(s.priority,function(){pB(c)});return}}else if(l===31){if(l=u(c),l!==null){s.blockedOn=l,_n(s.priority,function(){pB(c)});return}}else if(l===3&&c.stateNode.current.memoizedState.isDehydrated){s.blockedOn=c.tag===3?c.stateNode.containerInfo:null;return}}}s.blockedOn=null}function uS(s){if(s.blockedOn!==null)return!1;for(var l=s.targetContainers;0<l.length;){var c=t_(s.nativeEvent);if(c===null){c=s.nativeEvent;var f=new c.constructor(c.type,c);nE=f,c.target.dispatchEvent(f),nE=null}else return l=ke(c),l!==null&&mB(l),s.blockedOn=c,!1;l.shift()}return!0}function SB(s,l,c){uS(s)&&c.delete(l)}function VX(){i_=!1,ju!==null&&uS(ju)&&(ju=null),zu!==null&&uS(zu)&&(zu=null),Uu!==null&&uS(Uu)&&(Uu=null),gp.forEach(SB),mp.forEach(SB)}function cS(s,l){s.blockedOn===l&&(s.blockedOn=null,i_||(i_=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,VX)))}var hS=null;function bB(s){hS!==s&&(hS=s,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){hS===s&&(hS=null);for(var l=0;l<s.length;l+=3){var c=s[l],f=s[l+1],p=s[l+2];if(typeof f!="function"){if(n_(f||c)===null)continue;break}var w=ke(c);w!==null&&(s.splice(l,3),l-=3,tT(w,{pending:!0,data:p,method:c.method,action:f},f,p))}}))}function Ef(s){function l(B){return cS(B,s)}ju!==null&&cS(ju,s),zu!==null&&cS(zu,s),Uu!==null&&cS(Uu,s),gp.forEach(l),mp.forEach(l);for(var c=0;c<Yu.length;c++){var f=Yu[c];f.blockedOn===s&&(f.blockedOn=null)}for(;0<Yu.length&&(c=Yu[0],c.blockedOn===null);)yB(c),c.blockedOn===null&&Yu.shift();if(c=(s.ownerDocument||s).$$reactFormReplay,c!=null)for(f=0;f<c.length;f+=3){var p=c[f],w=c[f+1],R=p[kt]||null;if(typeof w=="function")R||bB(c);else if(R){var H=null;if(w&&w.hasAttribute("formAction")){if(p=w,R=w[kt]||null)H=R.formAction;else if(n_(p)!==null)continue}else H=R.action;typeof H=="function"?c[f+1]=H:(c.splice(f,3),f-=3),bB(c)}}}function CB(){function s(w){w.canIntercept&&w.info==="react-transition"&&w.intercept({handler:function(){return new Promise(function(R){return p=R})},focusReset:"manual",scroll:"manual"})}function l(){p!==null&&(p(),p=null),f||setTimeout(c,20)}function c(){if(!f&&!navigation.transition){var w=navigation.currentEntry;w&&w.url!=null&&navigation.navigate(w.url,{state:w.getState(),info:"react-transition",history:"replace"})}}if(typeof navigation=="object"){var f=!1,p=null;return navigation.addEventListener("navigate",s),navigation.addEventListener("navigatesuccess",l),navigation.addEventListener("navigateerror",l),setTimeout(c,100),function(){f=!0,navigation.removeEventListener("navigate",s),navigation.removeEventListener("navigatesuccess",l),navigation.removeEventListener("navigateerror",l),p!==null&&(p(),p=null)}}}function r_(s){this._internalRoot=s}dS.prototype.render=r_.prototype.render=function(s){var l=this._internalRoot;if(l===null)throw Error(i(409));var c=l.current,f=yo();fB(c,f,s,l,null,null)},dS.prototype.unmount=r_.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var l=s.containerInfo;fB(s.current,2,null,s,null,null),Yy(),l[Vr]=null}};function dS(s){this._internalRoot=s}dS.prototype.unstable_scheduleHydration=function(s){if(s){var l=Gc();s={blockedOn:null,target:s,priority:l};for(var c=0;c<Yu.length&&l!==0&&l<Yu[c].priority;c++);Yu.splice(c,0,s),c===0&&yB(s)}};var RB=e.version;if(RB!=="19.2.0")throw Error(i(527,RB,"19.2.0"));de.findDOMNode=function(s){var l=s._reactInternals;if(l===void 0)throw typeof s.render=="function"?Error(i(188)):(s=Object.keys(s).join(","),Error(i(268,s)));return s=d(l),s=s!==null?g(s):null,s=s===null?null:s.stateNode,s};var BX={bundleType:0,version:"19.2.0",rendererPackageName:"react-dom",currentDispatcherRef:ie,reconcilerVersion:"19.2.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var fS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!fS.isDisabled&&fS.supportsFiber)try{Rn=fS.inject(BX),un=fS}catch{}}return wp.createRoot=function(s,l){if(!r(s))throw Error(i(299));var c=!1,f="",p=x$,w=H$,R=I$;return l!=null&&(l.unstable_strictMode===!0&&(c=!0),l.identifierPrefix!==void 0&&(f=l.identifierPrefix),l.onUncaughtError!==void 0&&(p=l.onUncaughtError),l.onCaughtError!==void 0&&(w=l.onCaughtError),l.onRecoverableError!==void 0&&(R=l.onRecoverableError)),l=hB(s,1,!1,null,null,c,f,null,p,w,R,CB),s[Vr]=l.current,VT(s),new r_(l)},wp.hydrateRoot=function(s,l,c){if(!r(s))throw Error(i(299));var f=!1,p="",w=x$,R=H$,H=I$,B=null;return c!=null&&(c.unstable_strictMode===!0&&(f=!0),c.identifierPrefix!==void 0&&(p=c.identifierPrefix),c.onUncaughtError!==void 0&&(w=c.onUncaughtError),c.onCaughtError!==void 0&&(R=c.onCaughtError),c.onRecoverableError!==void 0&&(H=c.onRecoverableError),c.formState!==void 0&&(B=c.formState)),l=hB(s,1,!0,l,c??null,f,p,B,w,R,H,CB),l.context=dB(null),c=l.current,f=yo(),f=Wt(f),p=Hu(f),p.callback=null,Iu(c,p,f),c=f,l.current.lanes=c,Uo(l,c),ba(l),s[Vr]=l.current,VT(s),new dS(l)},wp.version="19.2.0",wp}var NB;function ZX(){if(NB)return a_.exports;NB=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(e){console.error(e)}}return t(),a_.exports=XX(),a_.exports}var QX=ZX(),h_={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/var DB;function JX(){return DB||(DB=1,(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var o="",a=0;a<arguments.length;a++){var u=arguments[a];u&&(o=r(o,i(u)))}return o}function i(o){if(typeof o=="string"||typeof o=="number")return o;if(typeof o!="object")return"";if(Array.isArray(o))return n.apply(null,o);if(o.toString!==Object.prototype.toString&&!o.toString.toString().includes("[native code]"))return o.toString();var a="";for(var u in o)e.call(o,u)&&o[u]&&(a=r(a,u));return a}function r(o,a){return a?o?o+" "+a:o+a:o}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(h_)),h_.exports}var eZ=JX();const tZ=_I(eZ);function LC(){return LC=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},LC.apply(null,arguments)}function ii(t){"@babel/helpers - typeof";return ii=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},ii(t)}var nZ=Symbol.for("react.element"),iZ=Symbol.for("react.transitional.element"),rZ=Symbol.for("react.fragment");function oZ(t){return t&&ii(t)==="object"&&(t.$$typeof===nZ||t.$$typeof===iZ)&&t.type===rZ}var Bx={},sZ=function(e){};function aZ(t,e){}function lZ(t,e){}function uZ(){Bx={}}function B3(t,e,n){!e&&!Bx[n]&&(t(!1,n),Bx[n]=!0)}function U0(t,e){B3(aZ,t,e)}function cZ(t,e){B3(lZ,t,e)}U0.preMessage=sZ;U0.resetWarned=uZ;U0.noteOnce=cZ;function hZ(t,e){if(ii(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(ii(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function F3(t){var e=hZ(t,"string");return ii(e)=="symbol"?e:e+""}function tt(t,e,n){return(e=F3(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function LB(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Tt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?LB(Object(n),!0).forEach(function(i){tt(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):LB(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}var dZ=V3();const kC=_I(dZ);function kB(t){return t instanceof HTMLElement||t instanceof SVGElement}function fZ(t){return t&&ii(t)==="object"&&kB(t.nativeElement)?t.nativeElement:kB(t)?t:null}function gZ(t){var e=fZ(t);if(e)return e;if(t instanceof bn.Component){var n;return(n=kC.findDOMNode)===null||n===void 0?void 0:n.call(kC,t)}return null}var d_={exports:{}},rn={};/**
 * @license React
 * react-is.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $B;function mZ(){if($B)return rn;$B=1;var t=Symbol.for("react.element"),e=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),i=Symbol.for("react.strict_mode"),r=Symbol.for("react.profiler"),o=Symbol.for("react.provider"),a=Symbol.for("react.context"),u=Symbol.for("react.server_context"),h=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),g=Symbol.for("react.suspense_list"),m=Symbol.for("react.memo"),v=Symbol.for("react.lazy"),y=Symbol.for("react.offscreen"),b;b=Symbol.for("react.module.reference");function C(T){if(typeof T=="object"&&T!==null){var O=T.$$typeof;switch(O){case t:switch(T=T.type,T){case n:case r:case i:case d:case g:return T;default:switch(T=T&&T.$$typeof,T){case u:case a:case h:case v:case m:case o:return T;default:return O}}case e:return O}}}return rn.ContextConsumer=a,rn.ContextProvider=o,rn.Element=t,rn.ForwardRef=h,rn.Fragment=n,rn.Lazy=v,rn.Memo=m,rn.Portal=e,rn.Profiler=r,rn.StrictMode=i,rn.Suspense=d,rn.SuspenseList=g,rn.isAsyncMode=function(){return!1},rn.isConcurrentMode=function(){return!1},rn.isContextConsumer=function(T){return C(T)===a},rn.isContextProvider=function(T){return C(T)===o},rn.isElement=function(T){return typeof T=="object"&&T!==null&&T.$$typeof===t},rn.isForwardRef=function(T){return C(T)===h},rn.isFragment=function(T){return C(T)===n},rn.isLazy=function(T){return C(T)===v},rn.isMemo=function(T){return C(T)===m},rn.isPortal=function(T){return C(T)===e},rn.isProfiler=function(T){return C(T)===r},rn.isStrictMode=function(T){return C(T)===i},rn.isSuspense=function(T){return C(T)===d},rn.isSuspenseList=function(T){return C(T)===g},rn.isValidElementType=function(T){return typeof T=="string"||typeof T=="function"||T===n||T===r||T===i||T===d||T===g||T===y||typeof T=="object"&&T!==null&&(T.$$typeof===v||T.$$typeof===m||T.$$typeof===o||T.$$typeof===a||T.$$typeof===h||T.$$typeof===b||T.getModuleId!==void 0)},rn.typeOf=C,rn}var VB;function pZ(){return VB||(VB=1,d_.exports=mZ()),d_.exports}var f_=pZ();function W3(t,e,n){var i=Ee.useRef({});return(!("value"in i.current)||n(i.current.condition,e))&&(i.current.value=t(),i.current.condition=e),i.current.value}var vZ=Number(Ee.version.split(".")[0]),wZ=function(e,n){typeof e=="function"?e(n):ii(e)==="object"&&e&&"current"in e&&(e.current=n)},yZ=function(e){var n,i;if(!e)return!1;if(j3(e)&&vZ>=19)return!0;var r=f_.isMemo(e)?e.type.type:e.type;return!(typeof r=="function"&&!((n=r.prototype)!==null&&n!==void 0&&n.render)&&r.$$typeof!==f_.ForwardRef||typeof e=="function"&&!((i=e.prototype)!==null&&i!==void 0&&i.render)&&e.$$typeof!==f_.ForwardRef)};function j3(t){return Ee.isValidElement(t)&&!oZ(t)}var SZ=function(e){if(e&&j3(e)){var n=e;return n.props.propertyIsEnumerable("ref")?n.props.ref:n.ref}return null};function um(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function BB(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,F3(i.key),i)}}function cm(t,e,n){return e&&BB(t.prototype,e),n&&BB(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function Fx(t,e){return Fx=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},Fx(t,e)}function z3(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Fx(t,e)}function $C(t){return $C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},$C(t)}function U3(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(U3=function(){return!!t})()}function Wx(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function bZ(t,e){if(e&&(ii(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Wx(t)}function Y3(t){var e=U3();return function(){var n,i=$C(t);if(e){var r=$C(this).constructor;n=Reflect.construct(i,arguments,r)}else n=i.apply(this,arguments);return bZ(this,n)}}function jx(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function CZ(t){if(Array.isArray(t))return jx(t)}function G3(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function OI(t,e){if(t){if(typeof t=="string")return jx(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?jx(t,e):void 0}}function RZ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Pd(t){return CZ(t)||G3(t)||OI(t)||RZ()}var q3=function(e){return+setTimeout(e,16)},K3=function(e){return clearTimeout(e)};typeof window<"u"&&"requestAnimationFrame"in window&&(q3=function(e){return window.requestAnimationFrame(e)},K3=function(e){return window.cancelAnimationFrame(e)});var FB=0,xI=new Map;function X3(t){xI.delete(t)}var zx=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;FB+=1;var i=FB;function r(o){if(o===0)X3(i),e();else{var a=q3(function(){r(o-1)});xI.set(i,a)}}return r(n),i};zx.cancel=function(t){var e=xI.get(t);return X3(t),K3(e)};function Z3(t){if(Array.isArray(t))return t}function EZ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,o,a,u=[],h=!0,d=!1;try{if(o=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;h=!1}else for(;!(h=(i=o.call(n)).done)&&(u.push(i.value),u.length!==e);h=!0);}catch(g){d=!0,r=g}finally{try{if(!h&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(d)throw r}}return u}}function Q3(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ln(t,e){return Z3(t)||EZ(t,e)||OI(t,e)||Q3()}function nw(t){for(var e=0,n,i=0,r=t.length;r>=4;++i,r-=4)n=t.charCodeAt(i)&255|(t.charCodeAt(++i)&255)<<8|(t.charCodeAt(++i)&255)<<16|(t.charCodeAt(++i)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(r){case 3:e^=(t.charCodeAt(i+2)&255)<<16;case 2:e^=(t.charCodeAt(i+1)&255)<<8;case 1:e^=t.charCodeAt(i)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}function pu(){return!!(typeof window<"u"&&window.document&&window.document.createElement)}function TZ(t,e){if(!t)return!1;if(t.contains)return t.contains(e);for(var n=e;n;){if(n===t)return!0;n=n.parentNode}return!1}var WB="data-rc-order",jB="data-rc-priority",_Z="rc-util-key",Ux=new Map;function J3(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=t.mark;return e?e.startsWith("data-")?e:"data-".concat(e):_Z}function Y0(t){if(t.attachTo)return t.attachTo;var e=document.querySelector("head");return e||document.body}function MZ(t){return t==="queue"?"prependQueue":t?"prepend":"append"}function HI(t){return Array.from((Ux.get(t)||t).children).filter(function(e){return e.tagName==="STYLE"})}function eq(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!pu())return null;var n=e.csp,i=e.prepend,r=e.priority,o=r===void 0?0:r,a=MZ(i),u=a==="prependQueue",h=document.createElement("style");h.setAttribute(WB,a),u&&o&&h.setAttribute(jB,"".concat(o)),n!=null&&n.nonce&&(h.nonce=n?.nonce),h.innerHTML=t;var d=Y0(e),g=d.firstChild;if(i){if(u){var m=(e.styles||HI(d)).filter(function(v){if(!["prepend","prependQueue"].includes(v.getAttribute(WB)))return!1;var y=Number(v.getAttribute(jB)||0);return o>=y});if(m.length)return d.insertBefore(h,m[m.length-1].nextSibling),h}d.insertBefore(h,g)}else d.appendChild(h);return h}function tq(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=Y0(e);return(e.styles||HI(n)).find(function(i){return i.getAttribute(J3(e))===t})}function AZ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=tq(t,e);if(n){var i=Y0(e);i.removeChild(n)}}function OZ(t,e){var n=Ux.get(t);if(!n||!TZ(document,n)){var i=eq("",e),r=i.parentNode;Ux.set(t,r),t.removeChild(i)}}function Iv(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=Y0(n),r=HI(i),o=Tt(Tt({},n),{},{styles:r});OZ(i,o);var a=tq(e,o);if(a){var u,h;if((u=o.csp)!==null&&u!==void 0&&u.nonce&&a.nonce!==((h=o.csp)===null||h===void 0?void 0:h.nonce)){var d;a.nonce=(d=o.csp)===null||d===void 0?void 0:d.nonce}return a.innerHTML!==t&&(a.innerHTML=t),a}var g=eq(t,o);return g.setAttribute(J3(o),e),g}function xZ(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function Yx(t,e){if(t==null)return{};var n,i,r=xZ(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function HZ(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=new Set;function r(o,a){var u=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,h=i.has(o);if(U0(!h,"Warning: There may be circular references"),h)return!1;if(o===a)return!0;if(n&&u>1)return!1;i.add(o);var d=u+1;if(Array.isArray(o)){if(!Array.isArray(a)||o.length!==a.length)return!1;for(var g=0;g<o.length;g++)if(!r(o[g],a[g],d))return!1;return!0}if(o&&a&&ii(o)==="object"&&ii(a)==="object"){var m=Object.keys(o);return m.length!==Object.keys(a).length?!1:m.every(function(v){return r(o[v],a[v],d)})}return!1}return r(t,e)}var IZ="%";function Gx(t){return t.join(IZ)}var PZ=(function(){function t(e){um(this,t),tt(this,"instanceId",void 0),tt(this,"cache",new Map),tt(this,"extracted",new Set),this.instanceId=e}return cm(t,[{key:"get",value:function(n){return this.opGet(Gx(n))}},{key:"opGet",value:function(n){return this.cache.get(n)||null}},{key:"update",value:function(n,i){return this.opUpdate(Gx(n),i)}},{key:"opUpdate",value:function(n,i){var r=this.cache.get(n),o=i(r);o===null?this.cache.delete(n):this.cache.set(n,o)}}]),t})(),iw="data-token-hash",su="data-css-hash",ud="__cssinjs_instance__";function NZ(){var t=Math.random().toString(12).slice(2);if(typeof document<"u"&&document.head&&document.body){var e=document.body.querySelectorAll("style[".concat(su,"]"))||[],n=document.head.firstChild;Array.from(e).forEach(function(r){r[ud]=r[ud]||t,r[ud]===t&&document.head.insertBefore(r,n)});var i={};Array.from(document.querySelectorAll("style[".concat(su,"]"))).forEach(function(r){var o=r.getAttribute(su);if(i[o]){if(r[ud]===t){var a;(a=r.parentNode)===null||a===void 0||a.removeChild(r)}}else i[o]=!0})}return new PZ(t)}var G0=Ee.createContext({hashPriority:"low",cache:NZ(),defaultCache:!0});function DZ(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(t[n]!==e[n])return!1;return!0}var II=(function(){function t(){um(this,t),tt(this,"cache",void 0),tt(this,"keys",void 0),tt(this,"cacheCallTimes",void 0),this.cache=new Map,this.keys=[],this.cacheCallTimes=0}return cm(t,[{key:"size",value:function(){return this.keys.length}},{key:"internalGet",value:function(n){var i,r,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,a={map:this.cache};return n.forEach(function(u){if(!a)a=void 0;else{var h;a=(h=a)===null||h===void 0||(h=h.map)===null||h===void 0?void 0:h.get(u)}}),(i=a)!==null&&i!==void 0&&i.value&&o&&(a.value[1]=this.cacheCallTimes++),(r=a)===null||r===void 0?void 0:r.value}},{key:"get",value:function(n){var i;return(i=this.internalGet(n,!0))===null||i===void 0?void 0:i[0]}},{key:"has",value:function(n){return!!this.internalGet(n)}},{key:"set",value:function(n,i){var r=this;if(!this.has(n)){if(this.size()+1>t.MAX_CACHE_SIZE+t.MAX_CACHE_OFFSET){var o=this.keys.reduce(function(d,g){var m=ln(d,2),v=m[1];return r.internalGet(g)[1]<v?[g,r.internalGet(g)[1]]:d},[this.keys[0],this.cacheCallTimes]),a=ln(o,1),u=a[0];this.delete(u)}this.keys.push(n)}var h=this.cache;n.forEach(function(d,g){if(g===n.length-1)h.set(d,{value:[i,r.cacheCallTimes++]});else{var m=h.get(d);m?m.map||(m.map=new Map):h.set(d,{map:new Map}),h=h.get(d).map}})}},{key:"deleteByPath",value:function(n,i){var r=n.get(i[0]);if(i.length===1){var o;return r.map?n.set(i[0],{map:r.map}):n.delete(i[0]),(o=r.value)===null||o===void 0?void 0:o[0]}var a=this.deleteByPath(r.map,i.slice(1));return(!r.map||r.map.size===0)&&!r.value&&n.delete(i[0]),a}},{key:"delete",value:function(n){if(this.has(n))return this.keys=this.keys.filter(function(i){return!DZ(i,n)}),this.deleteByPath(this.cache,n)}}]),t})();tt(II,"MAX_CACHE_SIZE",20);tt(II,"MAX_CACHE_OFFSET",5);var zB=0,nq=(function(){function t(e){um(this,t),tt(this,"derivatives",void 0),tt(this,"id",void 0),this.derivatives=Array.isArray(e)?e:[e],this.id=zB,e.length===0&&(e.length>0,void 0),zB+=1}return cm(t,[{key:"getDerivativeToken",value:function(n){return this.derivatives.reduce(function(i,r){return r(n,i)},void 0)}}]),t})(),g_=new II;function qx(t){var e=Array.isArray(t)?t:[t];return g_.has(e)||g_.set(e,new nq(e)),g_.get(e)}var LZ=new WeakMap,m_={};function kZ(t,e){for(var n=LZ,i=0;i<e.length;i+=1){var r=e[i];n.has(r)||n.set(r,new WeakMap),n=n.get(r)}return n.has(m_)||n.set(m_,t()),n.get(m_)}var UB=new WeakMap;function Pv(t){var e=UB.get(t)||"";return e||(Object.keys(t).forEach(function(n){var i=t[n];e+=n,i instanceof nq?e+=i.id:i&&ii(i)==="object"?e+=Pv(i):e+=i}),e=nw(e),UB.set(t,e)),e}function YB(t,e){return nw("".concat(e,"_").concat(Pv(t)))}var GB=pu();function VC(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:{},r=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!1;if(r)return t;var o=Tt(Tt({},i),{},tt(tt({},iw,e),su,n)),a=Object.keys(o).map(function(u){var h=o[u];return h?"".concat(u,'="').concat(h,'"'):null}).filter(function(u){return u}).join(" ");return"<style ".concat(a,">").concat(t,"</style>")}var $Z=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"";return"--".concat(n?"".concat(n,"-"):"").concat(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").replace(/([A-Z]+)([A-Z][a-z0-9]+)/g,"$1-$2").replace(/([a-z])([A-Z0-9])/g,"$1-$2").toLowerCase()},VZ=function(e,n,i){return Object.keys(e).length?".".concat(n).concat(i!=null&&i.scope?".".concat(i.scope):"","{").concat(Object.entries(e).map(function(r){var o=ln(r,2),a=o[0],u=o[1];return"".concat(a,":").concat(u,";")}).join(""),"}"):""},BZ=function(e,n,i){var r={},o={};return Object.entries(e).forEach(function(a){var u,h,d=ln(a,2),g=d[0],m=d[1];if(i!=null&&(u=i.preserve)!==null&&u!==void 0&&u[g])o[g]=m;else if((typeof m=="string"||typeof m=="number")&&!(i!=null&&(h=i.ignore)!==null&&h!==void 0&&h[g])){var v,y=$Z(g,i?.prefix);r[y]=typeof m=="number"&&!(i!=null&&(v=i.unitless)!==null&&v!==void 0&&v[g])?"".concat(m,"px"):String(m),o[g]="var(".concat(y,")")}}),[o,VZ(r,n,{scope:i?.scope})]},qB=pu()?Ee.useLayoutEffect:Ee.useEffect,FZ=function(e,n){var i=Ee.useRef(!0);qB(function(){return e(i.current)},n),qB(function(){return i.current=!1,function(){i.current=!0}},[])},WZ=Tt({},AI),KB=WZ.useInsertionEffect,jZ=function(e,n,i){Ee.useMemo(e,i),FZ(function(){return n(!0)},i)},zZ=KB?function(t,e,n){return KB(function(){return t(),e()},n)}:jZ,UZ=Tt({},AI),YZ=UZ.useInsertionEffect,GZ=function(e){var n=[],i=!1;function r(o){i||n.push(o)}return Ee.useEffect(function(){return i=!1,function(){i=!0,n.length&&n.forEach(function(o){return o()})}},e),r},qZ=function(){return function(e){e()}},KZ=typeof YZ<"u"?GZ:qZ;function iq(t,e,n,i,r){var o=Ee.useContext(G0),a=o.cache,u=[t].concat(Pd(e)),h=Gx(u),d=KZ([h]),g=function(b){a.opUpdate(h,function(C){var T=C||[void 0,void 0],O=ln(T,2),A=O[0],N=A===void 0?0:A,x=O[1],$=x,L=$||n(),P=[N,L];return b?b(P):P})};Ee.useMemo(function(){g()},[h]);var m=a.opGet(h),v=m[1];return zZ(function(){r?.(v)},function(y){return g(function(b){var C=ln(b,2),T=C[0],O=C[1];return y&&T===0&&r?.(v),[T+1,O]}),function(){a.opUpdate(h,function(b){var C=b||[],T=ln(C,2),O=T[0],A=O===void 0?0:O,N=T[1],x=A-1;return x===0?(d(function(){(y||!a.opGet(h))&&i?.(N,!1)}),null):[A-1,N]})}},[h]),v}var XZ={},ZZ="css",id=new Map;function QZ(t){id.set(t,(id.get(t)||0)+1)}function JZ(t,e){if(typeof document<"u"){var n=document.querySelectorAll("style[".concat(iw,'="').concat(t,'"]'));n.forEach(function(i){if(i[ud]===e){var r;(r=i.parentNode)===null||r===void 0||r.removeChild(i)}})}}var eQ=0;function tQ(t,e){id.set(t,(id.get(t)||0)-1);var n=new Set;id.forEach(function(i,r){i<=0&&n.add(r)}),id.size-n.size>eQ&&n.forEach(function(i){JZ(i,e),id.delete(i)})}var nQ=function(e,n,i,r){var o=i.getDerivativeToken(e),a=Tt(Tt({},o),n);return r&&(a=r(a)),a},rq="token";function iQ(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},i=Ee.useContext(G0),r=i.cache.instanceId,o=i.container,a=n.salt,u=a===void 0?"":a,h=n.override,d=h===void 0?XZ:h,g=n.formatToken,m=n.getComputedToken,v=n.cssVar,y=kZ(function(){return Object.assign.apply(Object,[{}].concat(Pd(e)))},e),b=Pv(y),C=Pv(d),T=v?Pv(v):"",O=iq(rq,[u,t.id,b,C,T],function(){var A,N=m?m(y,d,t):nQ(y,d,t,g),x=Tt({},N),$="";if(v){var L=BZ(N,v.key,{prefix:v.prefix,ignore:v.ignore,unitless:v.unitless,preserve:v.preserve}),P=ln(L,2);N=P[0],$=P[1]}var Q=YB(N,u);N._tokenKey=Q,x._tokenKey=YB(x,u);var ue=(A=v?.key)!==null&&A!==void 0?A:Q;N._themeKey=ue,QZ(ue);var X="".concat(ZZ,"-").concat(nw(Q));return N._hashId=X,[N,X,x,$,v?.key||""]},function(A){tQ(A[0]._themeKey,r)},function(A){var N=ln(A,4),x=N[0],$=N[3];if(v&&$){var L=Iv($,nw("css-variables-".concat(x._themeKey)),{mark:su,prepend:"queue",attachTo:o,priority:-999});L[ud]=r,L.setAttribute(iw,x._themeKey)}});return O}var rQ=function(e,n,i){var r=ln(e,5),o=r[2],a=r[3],u=r[4],h=i||{},d=h.plain;if(!a)return null;var g=o._tokenKey,m=-999,v={"data-rc-order":"prependQueue","data-rc-priority":"".concat(m)},y=VC(a,u,g,v,d);return[m,g,y]},oQ={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},oq="comm",sq="rule",aq="decl",sQ="@import",aQ="@namespace",lQ="@keyframes",uQ="@layer",lq=Math.abs,PI=String.fromCharCode;function uq(t){return t.trim()}function rC(t,e,n){return t.replace(e,n)}function cQ(t,e,n){return t.indexOf(e,n)}function $g(t,e){return t.charCodeAt(e)|0}function Kg(t,e,n){return t.slice(e,n)}function Ga(t){return t.length}function hQ(t){return t.length}function gS(t,e){return e.push(t),t}var q0=1,Xg=1,cq=0,_s=0,Ei=0,hm="";function NI(t,e,n,i,r,o,a,u){return{value:t,root:e,parent:n,type:i,props:r,children:o,line:q0,column:Xg,length:a,return:"",siblings:u}}function dQ(){return Ei}function fQ(){return Ei=_s>0?$g(hm,--_s):0,Xg--,Ei===10&&(Xg=1,q0--),Ei}function aa(){return Ei=_s<cq?$g(hm,_s++):0,Xg++,Ei===10&&(Xg=1,q0++),Ei}function Ac(){return $g(hm,_s)}function oC(){return _s}function K0(t,e){return Kg(hm,t,e)}function rw(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function gQ(t){return q0=Xg=1,cq=Ga(hm=t),_s=0,[]}function mQ(t){return hm="",t}function p_(t){return uq(K0(_s-1,Kx(t===91?t+2:t===40?t+1:t)))}function pQ(t){for(;(Ei=Ac())&&Ei<33;)aa();return rw(t)>2||rw(Ei)>3?"":" "}function vQ(t,e){for(;--e&&aa()&&!(Ei<48||Ei>102||Ei>57&&Ei<65||Ei>70&&Ei<97););return K0(t,oC()+(e<6&&Ac()==32&&aa()==32))}function Kx(t){for(;aa();)switch(Ei){case t:return _s;case 34:case 39:t!==34&&t!==39&&Kx(Ei);break;case 40:t===41&&Kx(t);break;case 92:aa();break}return _s}function wQ(t,e){for(;aa()&&t+Ei!==57;)if(t+Ei===84&&Ac()===47)break;return"/*"+K0(e,_s-1)+"*"+PI(t===47?t:aa())}function yQ(t){for(;!rw(Ac());)aa();return K0(t,_s)}function SQ(t){return mQ(sC("",null,null,null,[""],t=gQ(t),0,[0],t))}function sC(t,e,n,i,r,o,a,u,h){for(var d=0,g=0,m=a,v=0,y=0,b=0,C=1,T=1,O=1,A=0,N="",x=r,$=o,L=i,P=N;T;)switch(b=A,A=aa()){case 40:if(b!=108&&$g(P,m-1)==58){cQ(P+=rC(p_(A),"&","&\f"),"&\f",lq(d?u[d-1]:0))!=-1&&(O=-1);break}case 34:case 39:case 91:P+=p_(A);break;case 9:case 10:case 13:case 32:P+=pQ(b);break;case 92:P+=vQ(oC()-1,7);continue;case 47:switch(Ac()){case 42:case 47:gS(bQ(wQ(aa(),oC()),e,n,h),h),(rw(b||1)==5||rw(Ac()||1)==5)&&Ga(P)&&Kg(P,-1,void 0)!==" "&&(P+=" ");break;default:P+="/"}break;case 123*C:u[d++]=Ga(P)*O;case 125*C:case 59:case 0:switch(A){case 0:case 125:T=0;case 59+g:O==-1&&(P=rC(P,/\f/g,"")),y>0&&(Ga(P)-m||C===0&&b===47)&&gS(y>32?ZB(P+";",i,n,m-1,h):ZB(rC(P," ","")+";",i,n,m-2,h),h);break;case 59:P+=";";default:if(gS(L=XB(P,e,n,d,g,r,u,N,x=[],$=[],m,o),o),A===123)if(g===0)sC(P,e,L,L,x,o,m,u,$);else{switch(v){case 99:if($g(P,3)===110)break;case 108:if($g(P,2)===97)break;default:g=0;case 100:case 109:case 115:}g?sC(t,L,L,i&&gS(XB(t,L,L,0,0,r,u,N,r,x=[],m,$),$),r,$,m,u,i?x:$):sC(P,L,L,L,[""],$,0,u,$)}}d=g=y=0,C=O=1,N=P="",m=a;break;case 58:m=1+Ga(P),y=b;default:if(C<1){if(A==123)--C;else if(A==125&&C++==0&&fQ()==125)continue}switch(P+=PI(A),A*C){case 38:O=g>0?1:(P+="\f",-1);break;case 44:u[d++]=(Ga(P)-1)*O,O=1;break;case 64:Ac()===45&&(P+=p_(aa())),v=Ac(),g=m=Ga(N=P+=yQ(oC())),A++;break;case 45:b===45&&Ga(P)==2&&(C=0)}}return o}function XB(t,e,n,i,r,o,a,u,h,d,g,m){for(var v=r-1,y=r===0?o:[""],b=hQ(y),C=0,T=0,O=0;C<i;++C)for(var A=0,N=Kg(t,v+1,v=lq(T=a[C])),x=t;A<b;++A)(x=uq(T>0?y[A]+" "+N:rC(N,/&\f/g,y[A])))&&(h[O++]=x);return NI(t,e,n,r===0?sq:u,h,d,g,m)}function bQ(t,e,n,i){return NI(t,e,n,oq,PI(dQ()),Kg(t,2,-2),0,i)}function ZB(t,e,n,i,r){return NI(t,e,n,aq,Kg(t,0,i),Kg(t,i+1,-1),i,r)}function Xx(t,e){for(var n="",i=0;i<t.length;i++)n+=e(t[i],i,t,e)||"";return n}function CQ(t,e,n,i){switch(t.type){case uQ:if(t.children.length)break;case sQ:case aQ:case aq:return t.return=t.return||t.value;case oq:return"";case lQ:return t.return=t.value+"{"+Xx(t.children,i)+"}";case sq:if(!Ga(t.value=t.props.join(",")))return""}return Ga(n=Xx(t.children,i))?t.return=t.value+"{"+n+"}":""}var QB="data-ant-cssinjs-cache-path",hq="_FILE_STYLE__",yd,dq=!0;function RQ(){if(!yd&&(yd={},pu())){var t=document.createElement("div");t.className=QB,t.style.position="fixed",t.style.visibility="hidden",t.style.top="-9999px",document.body.appendChild(t);var e=getComputedStyle(t).content||"";e=e.replace(/^"/,"").replace(/"$/,""),e.split(";").forEach(function(r){var o=r.split(":"),a=ln(o,2),u=a[0],h=a[1];yd[u]=h});var n=document.querySelector("style[".concat(QB,"]"));if(n){var i;dq=!1,(i=n.parentNode)===null||i===void 0||i.removeChild(n)}document.body.removeChild(t)}}function EQ(t){return RQ(),!!yd[t]}function TQ(t){var e=yd[t],n=null;if(e&&pu())if(dq)n=hq;else{var i=document.querySelector("style[".concat(su,'="').concat(yd[t],'"]'));i?n=i.innerHTML:delete yd[t]}return[n,e]}var _Q="_skip_check_",fq="_multi_value_";function aC(t){var e=Xx(SQ(t),CQ);return e.replace(/\{%%%\:[^;];}/g,";")}function MQ(t){return ii(t)==="object"&&t&&(_Q in t||fq in t)}function JB(t,e,n){if(!e)return t;var i=".".concat(e),r=n==="low"?":where(".concat(i,")"):i,o=t.split(",").map(function(a){var u,h=a.trim().split(/\s+/),d=h[0]||"",g=((u=d.match(/^\w+/))===null||u===void 0?void 0:u[0])||"";return d="".concat(g).concat(r).concat(d.slice(g.length)),[d].concat(Pd(h.slice(1))).join(" ")});return o.join(",")}var AQ=function t(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{root:!0,parentSelectors:[]},r=i.root,o=i.injectHash,a=i.parentSelectors,u=n.hashId,h=n.layer;n.path;var d=n.hashPriority,g=n.transformers,m=g===void 0?[]:g;n.linters;var v="",y={};function b(O){var A=O.getName(u);if(!y[A]){var N=t(O.style,n,{root:!1,parentSelectors:a}),x=ln(N,1),$=x[0];y[A]="@keyframes ".concat(O.getName(u)).concat($)}}function C(O){var A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return O.forEach(function(N){Array.isArray(N)?C(N,A):N&&A.push(N)}),A}var T=C(Array.isArray(e)?e:[e]);return T.forEach(function(O){var A=typeof O=="string"&&!r?{}:O;if(typeof A=="string")v+="".concat(A,`
`);else if(A._keyframe)b(A);else{var N=m.reduce(function(x,$){var L;return($==null||(L=$.visit)===null||L===void 0?void 0:L.call($,x))||x},A);Object.keys(N).forEach(function(x){var $=N[x];if(ii($)==="object"&&$&&(x!=="animationName"||!$._keyframe)&&!MQ($)){var L=!1,P=x.trim(),Q=!1;(r||o)&&u?P.startsWith("@")?L=!0:P==="&"?P=JB("",u,d):P=JB(x,u,d):r&&!u&&(P==="&"||P==="")&&(P="",Q=!0);var ue=t($,n,{root:Q,injectHash:L,parentSelectors:[].concat(Pd(a),[P])}),X=ln(ue,2),me=X[0],re=X[1];y=Tt(Tt({},y),re),v+="".concat(P).concat(me)}else{let _e=function(ie,de){var Te=ie.replace(/[A-Z]/g,function(De){return"-".concat(De.toLowerCase())}),Pe=de;!oQ[ie]&&typeof Pe=="number"&&Pe!==0&&(Pe="".concat(Pe,"px")),ie==="animationName"&&de!==null&&de!==void 0&&de._keyframe&&(b(de),Pe=de.getName(u)),v+="".concat(Te,":").concat(Pe,";")};var Se,we=(Se=$?.value)!==null&&Se!==void 0?Se:$;ii($)==="object"&&$!==null&&$!==void 0&&$[fq]&&Array.isArray(we)?we.forEach(function(ie){_e(x,ie)}):_e(x,we)}})}}),r?h&&(v&&(v="@layer ".concat(h.name," {").concat(v,"}")),h.dependencies&&(y["@layer ".concat(h.name)]=h.dependencies.map(function(O){return"@layer ".concat(O,", ").concat(h.name,";")}).join(`
`))):v="{".concat(v,"}"),[v,y]};function OQ(t,e){return nw("".concat(t.join("%")).concat(e))}function xQ(){return null}var gq="style";function HQ(t,e){var n=t.token,i=t.path,r=t.hashId,o=t.layer,a=t.nonce,u=t.clientOnly,h=t.order,d=h===void 0?0:h,g=Ee.useContext(G0),m=g.autoClear;g.mock;var v=g.defaultCache,y=g.hashPriority,b=g.container,C=g.ssrInline,T=g.transformers,O=g.linters,A=g.cache,N=g.layer,x=n._tokenKey,$=[x];N&&$.push("layer"),$.push.apply($,Pd(i));var L=GB,P=iq(gq,$,function(){var re=$.join("|");if(EQ(re)){var Se=TQ(re),we=ln(Se,2),_e=we[0],ie=we[1];if(_e)return[_e,x,ie,{},u,d]}var de=e(),Te=AQ(de,{hashId:r,hashPriority:y,layer:N?o:void 0,path:i.join("-"),transformers:T,linters:O}),Pe=ln(Te,2),De=Pe[0],V=Pe[1],le=aC(De),ye=OQ($,le);return[le,x,ye,V,u,d]},function(re,Se){var we=ln(re,3),_e=we[2];(Se||m)&&GB&&AZ(_e,{mark:su,attachTo:b})},function(re){var Se=ln(re,4),we=Se[0];Se[1];var _e=Se[2],ie=Se[3];if(L&&we!==hq){var de={mark:su,prepend:N?!1:"queue",attachTo:b,priority:d},Te=typeof a=="function"?a():a;Te&&(de.csp={nonce:Te});var Pe=[],De=[];Object.keys(ie).forEach(function(le){le.startsWith("@layer")?Pe.push(le):De.push(le)}),Pe.forEach(function(le){Iv(aC(ie[le]),"_layer-".concat(le),Tt(Tt({},de),{},{prepend:!0}))});var V=Iv(we,_e,de);V[ud]=A.instanceId,V.setAttribute(iw,x),De.forEach(function(le){Iv(aC(ie[le]),"_effect-".concat(le),de)})}}),Q=ln(P,3),ue=Q[0],X=Q[1],me=Q[2];return function(re){var Se;return!C||L||!v?Se=Ee.createElement(xQ,null):Se=Ee.createElement("style",LC({},tt(tt({},iw,X),su,me),{dangerouslySetInnerHTML:{__html:ue}})),Ee.createElement(Ee.Fragment,null,Se,re)}}var IQ=function(e,n,i){var r=ln(e,6),o=r[0],a=r[1],u=r[2],h=r[3],d=r[4],g=r[5],m=i||{},v=m.plain;if(d)return null;var y=o,b={"data-rc-order":"prependQueue","data-rc-priority":"".concat(g)};return y=VC(o,a,u,b,v),h&&Object.keys(h).forEach(function(C){if(!n[C]){n[C]=!0;var T=aC(h[C]),O=VC(T,a,"_effect-".concat(C),b,v);C.startsWith("@layer")?y=O+y:y+=O}}),[g,u,y]},PQ="cssVar",NQ=function(e,n,i){var r=ln(e,4),o=r[1],a=r[2],u=r[3],h=i||{},d=h.plain;if(!o)return null;var g=-999,m={"data-rc-order":"prependQueue","data-rc-priority":"".concat(g)},v=VC(o,u,a,m,d);return[g,a,v]};tt(tt(tt({},gq,IQ),rq,rQ),PQ,NQ);function Tf(t){return t.notSplit=!0,t}Tf(["borderTop","borderBottom"]),Tf(["borderTop"]),Tf(["borderBottom"]),Tf(["borderLeft","borderRight"]),Tf(["borderLeft"]),Tf(["borderRight"]);var DQ=Ee.createContext({});function LQ(t){return Z3(t)||G3(t)||OI(t)||Q3()}function Zx(t,e){for(var n=t,i=0;i<e.length;i+=1){if(n==null)return;n=n[e[i]]}return n}function mq(t,e,n,i){if(!e.length)return n;var r=LQ(e),o=r[0],a=r.slice(1),u;return!t&&typeof o=="number"?u=[]:Array.isArray(t)?u=Pd(t):u=Tt({},t),i&&n===void 0&&a.length===1?delete u[o][a[0]]:u[o]=mq(u[o],a,n,i),u}function v_(t,e,n){var i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;return e.length&&i&&n===void 0&&!Zx(t,e.slice(0,-1))?t:mq(t,e,n,i)}function kQ(t){return ii(t)==="object"&&t!==null&&Object.getPrototypeOf(t)===Object.prototype}function eF(t){return Array.isArray(t)?[]:{}}var $Q=typeof Reflect>"u"?Object.keys:Reflect.ownKeys;function VQ(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];var i=eF(e[0]);return e.forEach(function(r){function o(a,u){var h=new Set(u),d=Zx(r,a),g=Array.isArray(d);if(g||kQ(d)){if(!h.has(d)){h.add(d);var m=Zx(i,a);g?i=v_(i,a,[]):(!m||ii(m)!=="object")&&(i=v_(i,a,eF(d))),$Q(d).forEach(function(v){o([].concat(Pd(a),[v]),h)})}}else i=v_(i,a,d)}o([])}),i}const BQ=Ee.createContext({}),FQ=Ee.createContext(void 0),So="${label} is not a valid ${type}",X0={Modal:{okText:"OK",cancelText:"Cancel",justOkText:"OK"},Form:{optional:"(optional)",defaultValidateMessages:{default:"Field validation error for ${label}",required:"Please enter ${label}",enum:"${label} must be one of [${enum}]",whitespace:"${label} cannot be a blank character",date:{format:"${label} date format is invalid",parse:"${label} cannot be converted to a date",invalid:"${label} is an invalid date"},types:{string:So,method:So,array:So,object:So,number:So,date:So,boolean:So,integer:So,float:So,regexp:So,email:So,url:So,hex:So},string:{len:"${label} must be ${len} characters",min:"${label} must be at least ${min} characters",max:"${label} must be up to ${max} characters",range:"${label} must be between ${min}-${max} characters"},number:{len:"${label} must be equal to ${len}",min:"${label} must be minimum ${min}",max:"${label} must be maximum ${max}",range:"${label} must be between ${min}-${max}"},array:{len:"Must be ${len} ${label}",min:"At least ${min} ${label}",max:"At most ${max} ${label}",range:"The amount of ${label} must be between ${min}-${max}"},pattern:{mismatch:"${label} does not match the pattern ${pattern}"}}}};Object.assign({},X0.Modal);let lC=[];const tF=()=>lC.reduce((t,e)=>Object.assign(Object.assign({},t),e),X0.Modal);function WQ(t){if(t){const e=Object.assign({},t);return lC.push(e),tF(),()=>{lC=lC.filter(n=>n!==e),tF()}}Object.assign({},X0.Modal)}const pq=Ee.createContext(void 0),jQ="internalMark",zQ=t=>{const{locale:e={},children:n,_ANT_MARK__:i}=t;Ee.useEffect(()=>WQ(e?.Modal),[e]);const r=Ee.useMemo(()=>Object.assign(Object.assign({},e),{exist:!0}),[e]);return Ee.createElement(pq.Provider,{value:r},n)},vq={blue:"#1677FF",purple:"#722ED1",cyan:"#13C2C2",green:"#52C41A",magenta:"#EB2F96",pink:"#EB2F96",red:"#F5222D",orange:"#FA8C16",yellow:"#FADB14",volcano:"#FA541C",geekblue:"#2F54EB",gold:"#FAAD14",lime:"#A0D911"},ow=Object.assign(Object.assign({},vq),{colorPrimary:"#1677ff",colorSuccess:"#52c41a",colorWarning:"#faad14",colorError:"#ff4d4f",colorInfo:"#1677ff",colorLink:"",colorTextBase:"",colorBgBase:"",fontFamily:`-apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial,
'Noto Sans', sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol',
'Noto Color Emoji'`,fontFamilyCode:"'SFMono-Regular', Consolas, 'Liberation Mono', Menlo, Courier, monospace",fontSize:14,lineWidth:1,lineType:"solid",motionUnit:.1,motionBase:0,motionEaseOutCirc:"cubic-bezier(0.08, 0.82, 0.17, 1)",motionEaseInOutCirc:"cubic-bezier(0.78, 0.14, 0.15, 0.86)",motionEaseOut:"cubic-bezier(0.215, 0.61, 0.355, 1)",motionEaseInOut:"cubic-bezier(0.645, 0.045, 0.355, 1)",motionEaseOutBack:"cubic-bezier(0.12, 0.4, 0.29, 1.46)",motionEaseInBack:"cubic-bezier(0.71, -0.46, 0.88, 0.6)",motionEaseInQuint:"cubic-bezier(0.755, 0.05, 0.855, 0.06)",motionEaseOutQuint:"cubic-bezier(0.23, 1, 0.32, 1)",borderRadius:6,sizeUnit:4,sizeStep:4,sizePopupArrow:16,controlHeight:32,zIndexBase:0,zIndexPopupBase:1e3,opacityImage:1,wireframe:!1,motion:!0}),zi=Math.round;function w_(t,e){const n=t.replace(/^[^(]*\((.*)/,"$1").replace(/\).*/,"").match(/\d*\.?\d+%?/g)||[],i=n.map(r=>parseFloat(r));for(let r=0;r<3;r+=1)i[r]=e(i[r]||0,n[r]||"",r);return n[3]?i[3]=n[3].includes("%")?i[3]/100:i[3]:i[3]=1,i}const nF=(t,e,n)=>n===0?t:t/100;function yp(t,e){const n=e||255;return t>n?n:t<0?0:t}class di{constructor(e){tt(this,"isValid",!0),tt(this,"r",0),tt(this,"g",0),tt(this,"b",0),tt(this,"a",1),tt(this,"_h",void 0),tt(this,"_s",void 0),tt(this,"_l",void 0),tt(this,"_v",void 0),tt(this,"_max",void 0),tt(this,"_min",void 0),tt(this,"_brightness",void 0);function n(r){return r[0]in e&&r[1]in e&&r[2]in e}if(e)if(typeof e=="string"){let o=function(a){return r.startsWith(a)};var i=o;const r=e.trim();/^#?[A-F\d]{3,8}$/i.test(r)?this.fromHexString(r):o("rgb")?this.fromRgbString(r):o("hsl")?this.fromHslString(r):(o("hsv")||o("hsb"))&&this.fromHsvString(r)}else if(e instanceof di)this.r=e.r,this.g=e.g,this.b=e.b,this.a=e.a,this._h=e._h,this._s=e._s,this._l=e._l,this._v=e._v;else if(n("rgb"))this.r=yp(e.r),this.g=yp(e.g),this.b=yp(e.b),this.a=typeof e.a=="number"?yp(e.a,1):1;else if(n("hsl"))this.fromHsl(e);else if(n("hsv"))this.fromHsv(e);else throw new Error("@ant-design/fast-color: unsupported input "+JSON.stringify(e))}setR(e){return this._sc("r",e)}setG(e){return this._sc("g",e)}setB(e){return this._sc("b",e)}setA(e){return this._sc("a",e,1)}setHue(e){const n=this.toHsv();return n.h=e,this._c(n)}getLuminance(){function e(o){const a=o/255;return a<=.03928?a/12.92:Math.pow((a+.055)/1.055,2.4)}const n=e(this.r),i=e(this.g),r=e(this.b);return .2126*n+.7152*i+.0722*r}getHue(){if(typeof this._h>"u"){const e=this.getMax()-this.getMin();e===0?this._h=0:this._h=zi(60*(this.r===this.getMax()?(this.g-this.b)/e+(this.g<this.b?6:0):this.g===this.getMax()?(this.b-this.r)/e+2:(this.r-this.g)/e+4))}return this._h}getSaturation(){if(typeof this._s>"u"){const e=this.getMax()-this.getMin();e===0?this._s=0:this._s=e/this.getMax()}return this._s}getLightness(){return typeof this._l>"u"&&(this._l=(this.getMax()+this.getMin())/510),this._l}getValue(){return typeof this._v>"u"&&(this._v=this.getMax()/255),this._v}getBrightness(){return typeof this._brightness>"u"&&(this._brightness=(this.r*299+this.g*587+this.b*114)/1e3),this._brightness}darken(e=10){const n=this.getHue(),i=this.getSaturation();let r=this.getLightness()-e/100;return r<0&&(r=0),this._c({h:n,s:i,l:r,a:this.a})}lighten(e=10){const n=this.getHue(),i=this.getSaturation();let r=this.getLightness()+e/100;return r>1&&(r=1),this._c({h:n,s:i,l:r,a:this.a})}mix(e,n=50){const i=this._c(e),r=n/100,o=u=>(i[u]-this[u])*r+this[u],a={r:zi(o("r")),g:zi(o("g")),b:zi(o("b")),a:zi(o("a")*100)/100};return this._c(a)}tint(e=10){return this.mix({r:255,g:255,b:255,a:1},e)}shade(e=10){return this.mix({r:0,g:0,b:0,a:1},e)}onBackground(e){const n=this._c(e),i=this.a+n.a*(1-this.a),r=o=>zi((this[o]*this.a+n[o]*n.a*(1-this.a))/i);return this._c({r:r("r"),g:r("g"),b:r("b"),a:i})}isDark(){return this.getBrightness()<128}isLight(){return this.getBrightness()>=128}equals(e){return this.r===e.r&&this.g===e.g&&this.b===e.b&&this.a===e.a}clone(){return this._c(this)}toHexString(){let e="#";const n=(this.r||0).toString(16);e+=n.length===2?n:"0"+n;const i=(this.g||0).toString(16);e+=i.length===2?i:"0"+i;const r=(this.b||0).toString(16);if(e+=r.length===2?r:"0"+r,typeof this.a=="number"&&this.a>=0&&this.a<1){const o=zi(this.a*255).toString(16);e+=o.length===2?o:"0"+o}return e}toHsl(){return{h:this.getHue(),s:this.getSaturation(),l:this.getLightness(),a:this.a}}toHslString(){const e=this.getHue(),n=zi(this.getSaturation()*100),i=zi(this.getLightness()*100);return this.a!==1?`hsla(${e},${n}%,${i}%,${this.a})`:`hsl(${e},${n}%,${i}%)`}toHsv(){return{h:this.getHue(),s:this.getSaturation(),v:this.getValue(),a:this.a}}toRgb(){return{r:this.r,g:this.g,b:this.b,a:this.a}}toRgbString(){return this.a!==1?`rgba(${this.r},${this.g},${this.b},${this.a})`:`rgb(${this.r},${this.g},${this.b})`}toString(){return this.toRgbString()}_sc(e,n,i){const r=this.clone();return r[e]=yp(n,i),r}_c(e){return new this.constructor(e)}getMax(){return typeof this._max>"u"&&(this._max=Math.max(this.r,this.g,this.b)),this._max}getMin(){return typeof this._min>"u"&&(this._min=Math.min(this.r,this.g,this.b)),this._min}fromHexString(e){const n=e.replace("#","");function i(r,o){return parseInt(n[r]+n[o||r],16)}n.length<6?(this.r=i(0),this.g=i(1),this.b=i(2),this.a=n[3]?i(3)/255:1):(this.r=i(0,1),this.g=i(2,3),this.b=i(4,5),this.a=n[6]?i(6,7)/255:1)}fromHsl({h:e,s:n,l:i,a:r}){if(this._h=e%360,this._s=n,this._l=i,this.a=typeof r=="number"?r:1,n<=0){const v=zi(i*255);this.r=v,this.g=v,this.b=v}let o=0,a=0,u=0;const h=e/60,d=(1-Math.abs(2*i-1))*n,g=d*(1-Math.abs(h%2-1));h>=0&&h<1?(o=d,a=g):h>=1&&h<2?(o=g,a=d):h>=2&&h<3?(a=d,u=g):h>=3&&h<4?(a=g,u=d):h>=4&&h<5?(o=g,u=d):h>=5&&h<6&&(o=d,u=g);const m=i-d/2;this.r=zi((o+m)*255),this.g=zi((a+m)*255),this.b=zi((u+m)*255)}fromHsv({h:e,s:n,v:i,a:r}){this._h=e%360,this._s=n,this._v=i,this.a=typeof r=="number"?r:1;const o=zi(i*255);if(this.r=o,this.g=o,this.b=o,n<=0)return;const a=e/60,u=Math.floor(a),h=a-u,d=zi(i*(1-n)*255),g=zi(i*(1-n*h)*255),m=zi(i*(1-n*(1-h))*255);switch(u){case 0:this.g=m,this.b=d;break;case 1:this.r=g,this.b=d;break;case 2:this.r=d,this.b=m;break;case 3:this.r=d,this.g=g;break;case 4:this.r=m,this.g=d;break;case 5:default:this.g=d,this.b=g;break}}fromHsvString(e){const n=w_(e,nF);this.fromHsv({h:n[0],s:n[1],v:n[2],a:n[3]})}fromHslString(e){const n=w_(e,nF);this.fromHsl({h:n[0],s:n[1],l:n[2],a:n[3]})}fromRgbString(e){const n=w_(e,(i,r)=>r.includes("%")?zi(i/100*255):i);this.r=n[0],this.g=n[1],this.b=n[2],this.a=n[3]}}var mS=2,iF=.16,UQ=.05,YQ=.05,GQ=.15,wq=5,yq=4,qQ=[{index:7,amount:15},{index:6,amount:25},{index:5,amount:30},{index:5,amount:45},{index:5,amount:65},{index:5,amount:85},{index:4,amount:90},{index:3,amount:95},{index:2,amount:97},{index:1,amount:98}];function rF(t,e,n){var i;return Math.round(t.h)>=60&&Math.round(t.h)<=240?i=n?Math.round(t.h)-mS*e:Math.round(t.h)+mS*e:i=n?Math.round(t.h)+mS*e:Math.round(t.h)-mS*e,i<0?i+=360:i>=360&&(i-=360),i}function oF(t,e,n){if(t.h===0&&t.s===0)return t.s;var i;return n?i=t.s-iF*e:e===yq?i=t.s+iF:i=t.s+UQ*e,i>1&&(i=1),n&&e===wq&&i>.1&&(i=.1),i<.06&&(i=.06),Math.round(i*100)/100}function sF(t,e,n){var i;return n?i=t.v+YQ*e:i=t.v-GQ*e,i=Math.max(0,Math.min(1,i)),Math.round(i*100)/100}function BC(t){for(var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},n=[],i=new di(t),r=i.toHsv(),o=wq;o>0;o-=1){var a=new di({h:rF(r,o,!0),s:oF(r,o,!0),v:sF(r,o,!0)});n.push(a)}n.push(i);for(var u=1;u<=yq;u+=1){var h=new di({h:rF(r,u),s:oF(r,u),v:sF(r,u)});n.push(h)}return e.theme==="dark"?qQ.map(function(d){var g=d.index,m=d.amount;return new di(e.backgroundColor||"#141414").mix(n[g],m).toHexString()}):n.map(function(d){return d.toHexString()})}var y_={red:"#F5222D",volcano:"#FA541C",orange:"#FA8C16",gold:"#FAAD14",yellow:"#FADB14",lime:"#A0D911",green:"#52C41A",cyan:"#13C2C2",blue:"#1677FF",geekblue:"#2F54EB",purple:"#722ED1",magenta:"#EB2F96",grey:"#666666"},Qx=["#fff1f0","#ffccc7","#ffa39e","#ff7875","#ff4d4f","#f5222d","#cf1322","#a8071a","#820014","#5c0011"];Qx.primary=Qx[5];var Jx=["#fff2e8","#ffd8bf","#ffbb96","#ff9c6e","#ff7a45","#fa541c","#d4380d","#ad2102","#871400","#610b00"];Jx.primary=Jx[5];var eH=["#fff7e6","#ffe7ba","#ffd591","#ffc069","#ffa940","#fa8c16","#d46b08","#ad4e00","#873800","#612500"];eH.primary=eH[5];var tH=["#fffbe6","#fff1b8","#ffe58f","#ffd666","#ffc53d","#faad14","#d48806","#ad6800","#874d00","#613400"];tH.primary=tH[5];var nH=["#feffe6","#ffffb8","#fffb8f","#fff566","#ffec3d","#fadb14","#d4b106","#ad8b00","#876800","#614700"];nH.primary=nH[5];var iH=["#fcffe6","#f4ffb8","#eaff8f","#d3f261","#bae637","#a0d911","#7cb305","#5b8c00","#3f6600","#254000"];iH.primary=iH[5];var rH=["#f6ffed","#d9f7be","#b7eb8f","#95de64","#73d13d","#52c41a","#389e0d","#237804","#135200","#092b00"];rH.primary=rH[5];var oH=["#e6fffb","#b5f5ec","#87e8de","#5cdbd3","#36cfc9","#13c2c2","#08979c","#006d75","#00474f","#002329"];oH.primary=oH[5];var sH=["#e6f4ff","#bae0ff","#91caff","#69b1ff","#4096ff","#1677ff","#0958d9","#003eb3","#002c8c","#001d66"];sH.primary=sH[5];var aH=["#f0f5ff","#d6e4ff","#adc6ff","#85a5ff","#597ef7","#2f54eb","#1d39c4","#10239e","#061178","#030852"];aH.primary=aH[5];var lH=["#f9f0ff","#efdbff","#d3adf7","#b37feb","#9254de","#722ed1","#531dab","#391085","#22075e","#120338"];lH.primary=lH[5];var uH=["#fff0f6","#ffd6e7","#ffadd2","#ff85c0","#f759ab","#eb2f96","#c41d7f","#9e1068","#780650","#520339"];uH.primary=uH[5];var cH=["#a6a6a6","#999999","#8c8c8c","#808080","#737373","#666666","#404040","#1a1a1a","#000000","#000000"];cH.primary=cH[5];var S_={red:Qx,volcano:Jx,orange:eH,gold:tH,yellow:nH,lime:iH,green:rH,cyan:oH,blue:sH,geekblue:aH,purple:lH,magenta:uH,grey:cH};function KQ(t,{generateColorPalettes:e,generateNeutralColorPalettes:n}){const{colorSuccess:i,colorWarning:r,colorError:o,colorInfo:a,colorPrimary:u,colorBgBase:h,colorTextBase:d}=t,g=e(u),m=e(i),v=e(r),y=e(o),b=e(a),C=n(h,d),T=t.colorLink||t.colorInfo,O=e(T),A=new di(y[1]).mix(new di(y[3]),50).toHexString();return Object.assign(Object.assign({},C),{colorPrimaryBg:g[1],colorPrimaryBgHover:g[2],colorPrimaryBorder:g[3],colorPrimaryBorderHover:g[4],colorPrimaryHover:g[5],colorPrimary:g[6],colorPrimaryActive:g[7],colorPrimaryTextHover:g[8],colorPrimaryText:g[9],colorPrimaryTextActive:g[10],colorSuccessBg:m[1],colorSuccessBgHover:m[2],colorSuccessBorder:m[3],colorSuccessBorderHover:m[4],colorSuccessHover:m[4],colorSuccess:m[6],colorSuccessActive:m[7],colorSuccessTextHover:m[8],colorSuccessText:m[9],colorSuccessTextActive:m[10],colorErrorBg:y[1],colorErrorBgHover:y[2],colorErrorBgFilledHover:A,colorErrorBgActive:y[3],colorErrorBorder:y[3],colorErrorBorderHover:y[4],colorErrorHover:y[5],colorError:y[6],colorErrorActive:y[7],colorErrorTextHover:y[8],colorErrorText:y[9],colorErrorTextActive:y[10],colorWarningBg:v[1],colorWarningBgHover:v[2],colorWarningBorder:v[3],colorWarningBorderHover:v[4],colorWarningHover:v[4],colorWarning:v[6],colorWarningActive:v[7],colorWarningTextHover:v[8],colorWarningText:v[9],colorWarningTextActive:v[10],colorInfoBg:b[1],colorInfoBgHover:b[2],colorInfoBorder:b[3],colorInfoBorderHover:b[4],colorInfoHover:b[4],colorInfo:b[6],colorInfoActive:b[7],colorInfoTextHover:b[8],colorInfoText:b[9],colorInfoTextActive:b[10],colorLinkHover:O[4],colorLink:O[6],colorLinkActive:O[7],colorBgMask:new di("#000").setA(.45).toRgbString(),colorWhite:"#fff"})}const XQ=t=>{let e=t,n=t,i=t,r=t;return t<6&&t>=5?e=t+1:t<16&&t>=6?e=t+2:t>=16&&(e=16),t<7&&t>=5?n=4:t<8&&t>=7?n=5:t<14&&t>=8?n=6:t<16&&t>=14?n=7:t>=16&&(n=8),t<6&&t>=2?i=1:t>=6&&(i=2),t>4&&t<8?r=4:t>=8&&(r=6),{borderRadius:t,borderRadiusXS:i,borderRadiusSM:n,borderRadiusLG:e,borderRadiusOuter:r}};function ZQ(t){const{motionUnit:e,motionBase:n,borderRadius:i,lineWidth:r}=t;return Object.assign({motionDurationFast:`${(n+e).toFixed(1)}s`,motionDurationMid:`${(n+e*2).toFixed(1)}s`,motionDurationSlow:`${(n+e*3).toFixed(1)}s`,lineWidthBold:r+1},XQ(i))}const QQ=t=>{const{controlHeight:e}=t;return{controlHeightSM:e*.75,controlHeightXS:e*.5,controlHeightLG:e*1.25}};function JQ(t){return(t+8)/t}function eJ(t){const e=Array.from({length:10}).map((n,i)=>{const r=i-1,o=t*Math.pow(Math.E,r/5),a=i>1?Math.floor(o):Math.ceil(o);return Math.floor(a/2)*2});return e[1]=t,e.map(n=>({size:n,lineHeight:JQ(n)}))}const tJ=t=>{const e=eJ(t),n=e.map(g=>g.size),i=e.map(g=>g.lineHeight),r=n[1],o=n[0],a=n[2],u=i[1],h=i[0],d=i[2];return{fontSizeSM:o,fontSize:r,fontSizeLG:a,fontSizeXL:n[3],fontSizeHeading1:n[6],fontSizeHeading2:n[5],fontSizeHeading3:n[4],fontSizeHeading4:n[3],fontSizeHeading5:n[2],lineHeight:u,lineHeightLG:d,lineHeightSM:h,fontHeight:Math.round(u*r),fontHeightLG:Math.round(d*a),fontHeightSM:Math.round(h*o),lineHeightHeading1:i[6],lineHeightHeading2:i[5],lineHeightHeading3:i[4],lineHeightHeading4:i[3],lineHeightHeading5:i[2]}};function nJ(t){const{sizeUnit:e,sizeStep:n}=t;return{sizeXXL:e*(n+8),sizeXL:e*(n+4),sizeLG:e*(n+2),sizeMD:e*(n+1),sizeMS:e*n,size:e*n,sizeSM:e*(n-1),sizeXS:e*(n-2),sizeXXS:e*(n-3)}}const os=(t,e)=>new di(t).setA(e).toRgbString(),Sp=(t,e)=>new di(t).darken(e).toHexString(),iJ=t=>{const e=BC(t);return{1:e[0],2:e[1],3:e[2],4:e[3],5:e[4],6:e[5],7:e[6],8:e[4],9:e[5],10:e[6]}},rJ=(t,e)=>{const n=t||"#fff",i=e||"#000";return{colorBgBase:n,colorTextBase:i,colorText:os(i,.88),colorTextSecondary:os(i,.65),colorTextTertiary:os(i,.45),colorTextQuaternary:os(i,.25),colorFill:os(i,.15),colorFillSecondary:os(i,.06),colorFillTertiary:os(i,.04),colorFillQuaternary:os(i,.02),colorBgSolid:os(i,1),colorBgSolidHover:os(i,.75),colorBgSolidActive:os(i,.95),colorBgLayout:Sp(n,4),colorBgContainer:Sp(n,0),colorBgElevated:Sp(n,0),colorBgSpotlight:os(i,.85),colorBgBlur:"transparent",colorBorder:Sp(n,15),colorBorderSecondary:Sp(n,6)}};function Sq(t){y_.pink=y_.magenta,S_.pink=S_.magenta;const e=Object.keys(vq).map(n=>{const i=t[n]===y_[n]?S_[n]:BC(t[n]);return Array.from({length:10},()=>1).reduce((r,o,a)=>(r[`${n}-${a+1}`]=i[a],r[`${n}${a+1}`]=i[a],r),{})}).reduce((n,i)=>(n=Object.assign(Object.assign({},n),i),n),{});return Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},t),e),KQ(t,{generateColorPalettes:iJ,generateNeutralColorPalettes:rJ})),tJ(t.fontSize)),nJ(t)),QQ(t)),ZQ(t))}const bq=qx(Sq),FC={token:ow,override:{override:ow},hashed:!0},Cq=bn.createContext(FC),hH="ant",Rq="anticon",oJ=(t,e)=>e||(t?`${hH}-${t}`:hH),Z0=Ee.createContext({getPrefixCls:oJ,iconPrefixCls:Rq}),{Consumer:cHe}=Z0,sJ=`-ant-${Date.now()}-${Math.random()}`;function aJ(t,e){const n={},i=(a,u)=>{let h=a.clone();return h=u?.(h)||h,h.toRgbString()},r=(a,u)=>{const h=new di(a),d=BC(h.toRgbString());n[`${u}-color`]=i(h),n[`${u}-color-disabled`]=d[1],n[`${u}-color-hover`]=d[4],n[`${u}-color-active`]=d[6],n[`${u}-color-outline`]=h.clone().setA(.2).toRgbString(),n[`${u}-color-deprecated-bg`]=d[0],n[`${u}-color-deprecated-border`]=d[2]};if(e.primaryColor){r(e.primaryColor,"primary");const a=new di(e.primaryColor),u=BC(a.toRgbString());u.forEach((d,g)=>{n[`primary-${g+1}`]=d}),n["primary-color-deprecated-l-35"]=i(a,d=>d.lighten(35)),n["primary-color-deprecated-l-20"]=i(a,d=>d.lighten(20)),n["primary-color-deprecated-t-20"]=i(a,d=>d.tint(20)),n["primary-color-deprecated-t-50"]=i(a,d=>d.tint(50)),n["primary-color-deprecated-f-12"]=i(a,d=>d.setA(d.a*.12));const h=new di(u[0]);n["primary-color-active-deprecated-f-30"]=i(h,d=>d.setA(d.a*.3)),n["primary-color-active-deprecated-d-02"]=i(h,d=>d.darken(2))}return e.successColor&&r(e.successColor,"success"),e.warningColor&&r(e.warningColor,"warning"),e.errorColor&&r(e.errorColor,"error"),e.infoColor&&r(e.infoColor,"info"),`
  :root {
    ${Object.keys(n).map(a=>`--${t}-${a}: ${n[a]};`).join(`
`)}
  }
  `.trim()}function lJ(t,e){const n=aJ(t,e);pu()&&Iv(n,`${sJ}-dynamic-theme`)}const dH=Ee.createContext(!1),uJ=({children:t,disabled:e})=>{const n=Ee.useContext(dH);return Ee.createElement(dH.Provider,{value:e??n},t)},sw=Ee.createContext(void 0),cJ=({children:t,size:e})=>{const n=Ee.useContext(sw);return Ee.createElement(sw.Provider,{value:e||n},t)};function hJ(){const t=Ee.useContext(dH),e=Ee.useContext(sw);return{componentDisabled:t,componentSize:e}}function fH(t){var e=Ee.useRef();e.current=t;var n=Ee.useCallback(function(){for(var i,r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return(i=e.current)===null||i===void 0?void 0:i.call.apply(i,[e].concat(o))},[]);return n}function gH(t){var e=Ee.useRef(!1),n=Ee.useState(t),i=ln(n,2),r=i[0],o=i[1];Ee.useEffect(function(){return e.current=!1,function(){e.current=!0}},[]);function a(u,h){h&&e.current||o(u)}return[r,a]}var dJ=1e3*60*10,fJ=(function(){function t(){um(this,t),tt(this,"map",new Map),tt(this,"objectIDMap",new WeakMap),tt(this,"nextID",0),tt(this,"lastAccessBeat",new Map),tt(this,"accessBeat",0)}return cm(t,[{key:"set",value:function(n,i){this.clear();var r=this.getCompositeKey(n);this.map.set(r,i),this.lastAccessBeat.set(r,Date.now())}},{key:"get",value:function(n){var i=this.getCompositeKey(n),r=this.map.get(i);return this.lastAccessBeat.set(i,Date.now()),this.accessBeat+=1,r}},{key:"getCompositeKey",value:function(n){var i=this,r=n.map(function(o){return o&&ii(o)==="object"?"obj_".concat(i.getObjectID(o)):"".concat(ii(o),"_").concat(o)});return r.join("|")}},{key:"getObjectID",value:function(n){if(this.objectIDMap.has(n))return this.objectIDMap.get(n);var i=this.nextID;return this.objectIDMap.set(n,i),this.nextID+=1,i}},{key:"clear",value:function(){var n=this;if(this.accessBeat>1e4){var i=Date.now();this.lastAccessBeat.forEach(function(r,o){i-r>dJ&&(n.map.delete(o),n.lastAccessBeat.delete(o))}),this.accessBeat=0}}}]),t})();new fJ;const gJ="5.27.6";function b_(t){return t>=0&&t<=255}function pS(t,e){const{r:n,g:i,b:r,a:o}=new di(t).toRgb();if(o<1)return t;const{r:a,g:u,b:h}=new di(e).toRgb();for(let d=.01;d<=1;d+=.01){const g=Math.round((n-a*(1-d))/d),m=Math.round((i-u*(1-d))/d),v=Math.round((r-h*(1-d))/d);if(b_(g)&&b_(m)&&b_(v))return new di({r:g,g:m,b:v,a:Math.round(d*100)/100}).toRgbString()}return new di({r:n,g:i,b:r,a:1}).toRgbString()}var mJ=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function Eq(t){const{override:e}=t,n=mJ(t,["override"]),i=Object.assign({},e);Object.keys(ow).forEach(v=>{delete i[v]});const r=Object.assign(Object.assign({},n),i),o=480,a=576,u=768,h=992,d=1200,g=1600;return r.motion===!1&&(r.motionDurationFast="0s",r.motionDurationMid="0s",r.motionDurationSlow="0s"),Object.assign(Object.assign(Object.assign({},r),{colorFillContent:r.colorFillSecondary,colorFillContentHover:r.colorFill,colorFillAlter:r.colorFillQuaternary,colorBgContainerDisabled:r.colorFillTertiary,colorBorderBg:r.colorBgContainer,colorSplit:pS(r.colorBorderSecondary,r.colorBgContainer),colorTextPlaceholder:r.colorTextQuaternary,colorTextDisabled:r.colorTextQuaternary,colorTextHeading:r.colorText,colorTextLabel:r.colorTextSecondary,colorTextDescription:r.colorTextTertiary,colorTextLightSolid:r.colorWhite,colorHighlight:r.colorError,colorBgTextHover:r.colorFillSecondary,colorBgTextActive:r.colorFill,colorIcon:r.colorTextTertiary,colorIconHover:r.colorText,colorErrorOutline:pS(r.colorErrorBg,r.colorBgContainer),colorWarningOutline:pS(r.colorWarningBg,r.colorBgContainer),fontSizeIcon:r.fontSizeSM,lineWidthFocus:r.lineWidth*3,lineWidth:r.lineWidth,controlOutlineWidth:r.lineWidth*2,controlInteractiveSize:r.controlHeight/2,controlItemBgHover:r.colorFillTertiary,controlItemBgActive:r.colorPrimaryBg,controlItemBgActiveHover:r.colorPrimaryBgHover,controlItemBgActiveDisabled:r.colorFill,controlTmpOutline:r.colorFillQuaternary,controlOutline:pS(r.colorPrimaryBg,r.colorBgContainer),lineType:r.lineType,borderRadius:r.borderRadius,borderRadiusXS:r.borderRadiusXS,borderRadiusSM:r.borderRadiusSM,borderRadiusLG:r.borderRadiusLG,fontWeightStrong:600,opacityLoading:.65,linkDecoration:"none",linkHoverDecoration:"none",linkFocusDecoration:"none",controlPaddingHorizontal:12,controlPaddingHorizontalSM:8,paddingXXS:r.sizeXXS,paddingXS:r.sizeXS,paddingSM:r.sizeSM,padding:r.size,paddingMD:r.sizeMD,paddingLG:r.sizeLG,paddingXL:r.sizeXL,paddingContentHorizontalLG:r.sizeLG,paddingContentVerticalLG:r.sizeMS,paddingContentHorizontal:r.sizeMS,paddingContentVertical:r.sizeSM,paddingContentHorizontalSM:r.size,paddingContentVerticalSM:r.sizeXS,marginXXS:r.sizeXXS,marginXS:r.sizeXS,marginSM:r.sizeSM,margin:r.size,marginMD:r.sizeMD,marginLG:r.sizeLG,marginXL:r.sizeXL,marginXXL:r.sizeXXL,boxShadow:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowSecondary:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTertiary:`
      0 1px 2px 0 rgba(0, 0, 0, 0.03),
      0 1px 6px -1px rgba(0, 0, 0, 0.02),
      0 2px 4px 0 rgba(0, 0, 0, 0.02)
    `,screenXS:o,screenXSMin:o,screenXSMax:a-1,screenSM:a,screenSMMin:a,screenSMMax:u-1,screenMD:u,screenMDMin:u,screenMDMax:h-1,screenLG:h,screenLGMin:h,screenLGMax:d-1,screenXL:d,screenXLMin:d,screenXLMax:g-1,screenXXL:g,screenXXLMin:g,boxShadowPopoverArrow:"2px 2px 5px rgba(0, 0, 0, 0.05)",boxShadowCard:`
      0 1px 2px -2px ${new di("rgba(0, 0, 0, 0.16)").toRgbString()},
      0 3px 6px 0 ${new di("rgba(0, 0, 0, 0.12)").toRgbString()},
      0 5px 12px 4px ${new di("rgba(0, 0, 0, 0.09)").toRgbString()}
    `,boxShadowDrawerRight:`
      -6px 0 16px 0 rgba(0, 0, 0, 0.08),
      -3px 0 6px -4px rgba(0, 0, 0, 0.12),
      -9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerLeft:`
      6px 0 16px 0 rgba(0, 0, 0, 0.08),
      3px 0 6px -4px rgba(0, 0, 0, 0.12),
      9px 0 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerUp:`
      0 6px 16px 0 rgba(0, 0, 0, 0.08),
      0 3px 6px -4px rgba(0, 0, 0, 0.12),
      0 9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowDrawerDown:`
      0 -6px 16px 0 rgba(0, 0, 0, 0.08),
      0 -3px 6px -4px rgba(0, 0, 0, 0.12),
      0 -9px 28px 8px rgba(0, 0, 0, 0.05)
    `,boxShadowTabsOverflowLeft:"inset 10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowRight:"inset -10px 0 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowTop:"inset 0 10px 8px -8px rgba(0, 0, 0, 0.08)",boxShadowTabsOverflowBottom:"inset 0 -10px 8px -8px rgba(0, 0, 0, 0.08)"}),i)}var aF=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const pJ={lineHeight:!0,lineHeightSM:!0,lineHeightLG:!0,lineHeightHeading1:!0,lineHeightHeading2:!0,lineHeightHeading3:!0,lineHeightHeading4:!0,lineHeightHeading5:!0,opacityLoading:!0,fontWeightStrong:!0,zIndexPopupBase:!0,zIndexBase:!0,opacityImage:!0},vJ={motionBase:!0,motionUnit:!0},wJ={screenXS:!0,screenXSMin:!0,screenXSMax:!0,screenSM:!0,screenSMMin:!0,screenSMMax:!0,screenMD:!0,screenMDMin:!0,screenMDMax:!0,screenLG:!0,screenLGMin:!0,screenLGMax:!0,screenXL:!0,screenXLMin:!0,screenXLMax:!0,screenXXL:!0,screenXXLMin:!0},Tq=(t,e,n)=>{const i=n.getDerivativeToken(t),{override:r}=e,o=aF(e,["override"]);let a=Object.assign(Object.assign({},i),{override:r});return a=Eq(a),o&&Object.entries(o).forEach(([u,h])=>{const{theme:d}=h,g=aF(h,["theme"]);let m=g;d&&(m=Tq(Object.assign(Object.assign({},a),g),{override:g},d)),a[u]=m}),a};function _q(){const{token:t,hashed:e,theme:n,override:i,cssVar:r}=bn.useContext(Cq),o=`${gJ}-${e||""}`,a=n||bq,[u,h,d]=iQ(a,[ow,t],{salt:o,override:i,getComputedToken:Tq,formatToken:Eq,cssVar:r&&{prefix:r.prefix,key:r.key,unitless:pJ,ignore:vJ,preserve:wJ}});return[a,d,e?h:"",u,r]}const yJ=()=>({display:"inline-flex",alignItems:"center",color:"inherit",fontStyle:"normal",lineHeight:0,textAlign:"center",textTransform:"none",verticalAlign:"-0.125em",textRendering:"optimizeLegibility","-webkit-font-smoothing":"antialiased","-moz-osx-font-smoothing":"grayscale","> *":{lineHeight:1},svg:{display:"inline-block"}}),SJ=t=>({[`.${t}`]:Object.assign(Object.assign({},yJ()),{[`.${t} .${t}-icon`]:{display:"block"}})}),bJ=(t,e)=>{const[n,i]=_q();return HQ({token:i,hashId:"",path:["ant-design-icons",t],nonce:()=>e?.nonce,layer:{name:"antd"}},()=>SJ(t))},CJ=Object.assign({},AI),{useId:lF}=CJ,RJ=()=>"",EJ=typeof lF>"u"?RJ:lF;function TJ(t,e,n){var i;const r=t||{},o=r.inherit===!1||!e?Object.assign(Object.assign({},FC),{hashed:(i=e?.hashed)!==null&&i!==void 0?i:FC.hashed,cssVar:e?.cssVar}):e,a=EJ();return W3(()=>{var u,h;if(!t)return e;const d=Object.assign({},o.components);Object.keys(t.components||{}).forEach(v=>{d[v]=Object.assign(Object.assign({},d[v]),t.components[v])});const g=`css-var-${a.replace(/:/g,"")}`,m=((u=r.cssVar)!==null&&u!==void 0?u:o.cssVar)&&Object.assign(Object.assign(Object.assign({prefix:n?.prefixCls},typeof o.cssVar=="object"?o.cssVar:{}),typeof r.cssVar=="object"?r.cssVar:{}),{key:typeof r.cssVar=="object"&&((h=r.cssVar)===null||h===void 0?void 0:h.key)||g});return Object.assign(Object.assign(Object.assign({},o),r),{token:Object.assign(Object.assign({},o.token),r.token),components:d,cssVar:m})},[r,o],(u,h)=>u.some((d,g)=>{const m=h[g];return!HZ(d,m,!0)}))}var _J=["children"],Mq=Ee.createContext({});function MJ(t){var e=t.children,n=Yx(t,_J);return Ee.createElement(Mq.Provider,{value:n},e)}var AJ=(function(t){z3(n,t);var e=Y3(n);function n(){return um(this,n),e.apply(this,arguments)}return cm(n,[{key:"render",value:function(){return this.props.children}}]),n})(Ee.Component);function OJ(t){var e=Ee.useReducer(function(u){return u+1},0),n=ln(e,2),i=n[1],r=Ee.useRef(t),o=fH(function(){return r.current}),a=fH(function(u){r.current=typeof u=="function"?u(r.current):u,i()});return[o,a]}var pc="none",vS="appear",wS="enter",yS="leave",uF="none",na="prepare",Tg="start",_g="active",DI="end",Aq="prepared";function cF(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit".concat(t)]="webkit".concat(e),n["Moz".concat(t)]="moz".concat(e),n["ms".concat(t)]="MS".concat(e),n["O".concat(t)]="o".concat(e.toLowerCase()),n}function xJ(t,e){var n={animationend:cF("Animation","AnimationEnd"),transitionend:cF("Transition","TransitionEnd")};return t&&("AnimationEvent"in e||delete n.animationend.animation,"TransitionEvent"in e||delete n.transitionend.transition),n}var HJ=xJ(pu(),typeof window<"u"?window:{}),Oq={};if(pu()){var IJ=document.createElement("div");Oq=IJ.style}var SS={};function xq(t){if(SS[t])return SS[t];var e=HJ[t];if(e)for(var n=Object.keys(e),i=n.length,r=0;r<i;r+=1){var o=n[r];if(Object.prototype.hasOwnProperty.call(e,o)&&o in Oq)return SS[t]=e[o],SS[t]}return""}var Hq=xq("animationend"),Iq=xq("transitionend"),Pq=!!(Hq&&Iq),hF=Hq||"animationend",dF=Iq||"transitionend";function fF(t,e){if(!t)return null;if(ii(t)==="object"){var n=e.replace(/-\w/g,function(i){return i[1].toUpperCase()});return t[n]}return"".concat(t,"-").concat(e)}const PJ=(function(t){var e=Ee.useRef();function n(r){r&&(r.removeEventListener(dF,t),r.removeEventListener(hF,t))}function i(r){e.current&&e.current!==r&&n(e.current),r&&r!==e.current&&(r.addEventListener(dF,t),r.addEventListener(hF,t),e.current=r)}return Ee.useEffect(function(){return function(){n(e.current)}},[]),[i,n]});var Nq=pu()?Ee.useLayoutEffect:Ee.useEffect;const NJ=(function(){var t=Ee.useRef(null);function e(){zx.cancel(t.current)}function n(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;e();var o=zx(function(){r<=1?i({isCanceled:function(){return o!==t.current}}):n(i,r-1)});t.current=o}return Ee.useEffect(function(){return function(){e()}},[]),[n,e]});var DJ=[na,Tg,_g,DI],LJ=[na,Aq],Dq=!1,kJ=!0;function Lq(t){return t===_g||t===DI}const $J=(function(t,e,n){var i=gH(uF),r=ln(i,2),o=r[0],a=r[1],u=NJ(),h=ln(u,2),d=h[0],g=h[1];function m(){a(na,!0)}var v=e?LJ:DJ;return Nq(function(){if(o!==uF&&o!==DI){var y=v.indexOf(o),b=v[y+1],C=n(o);C===Dq?a(b,!0):b&&d(function(T){function O(){T.isCanceled()||a(b,!0)}C===!0?O():Promise.resolve(C).then(O)})}},[t,o]),Ee.useEffect(function(){return function(){g()}},[]),[m,o]});function VJ(t,e,n,i){var r=i.motionEnter,o=r===void 0?!0:r,a=i.motionAppear,u=a===void 0?!0:a,h=i.motionLeave,d=h===void 0?!0:h,g=i.motionDeadline,m=i.motionLeaveImmediately,v=i.onAppearPrepare,y=i.onEnterPrepare,b=i.onLeavePrepare,C=i.onAppearStart,T=i.onEnterStart,O=i.onLeaveStart,A=i.onAppearActive,N=i.onEnterActive,x=i.onLeaveActive,$=i.onAppearEnd,L=i.onEnterEnd,P=i.onLeaveEnd,Q=i.onVisibleChanged,ue=gH(),X=ln(ue,2),me=X[0],re=X[1],Se=OJ(pc),we=ln(Se,2),_e=we[0],ie=we[1],de=gH(null),Te=ln(de,2),Pe=Te[0],De=Te[1],V=_e(),le=Ee.useRef(!1),ye=Ee.useRef(null);function S(){return n()}var E=Ee.useRef(!1);function M(){ie(pc),De(null,!0)}var F=fH(function(ce){var Re=_e();if(Re!==pc){var Ae=S();if(!(ce&&!ce.deadline&&ce.target!==Ae)){var Le=E.current,it;Re===vS&&Le?it=$?.(Ae,ce):Re===wS&&Le?it=L?.(Ae,ce):Re===yS&&Le&&(it=P?.(Ae,ce)),Le&&it!==!1&&M()}}}),q=PJ(F),J=ln(q,1),_=J[0],I=function(Re){switch(Re){case vS:return tt(tt(tt({},na,v),Tg,C),_g,A);case wS:return tt(tt(tt({},na,y),Tg,T),_g,N);case yS:return tt(tt(tt({},na,b),Tg,O),_g,x);default:return{}}},k=Ee.useMemo(function(){return I(V)},[V]),W=$J(V,!t,function(ce){if(ce===na){var Re=k[na];return Re?Re(S()):Dq}if(Z in k){var Ae;De(((Ae=k[Z])===null||Ae===void 0?void 0:Ae.call(k,S(),null))||null)}return Z===_g&&V!==pc&&(_(S()),g>0&&(clearTimeout(ye.current),ye.current=setTimeout(function(){F({deadline:!0})},g))),Z===Aq&&M(),kJ}),D=ln(W,2),z=D[0],Z=D[1],j=Lq(Z);E.current=j;var K=Ee.useRef(null);Nq(function(){if(!(le.current&&K.current===e)){re(e);var ce=le.current;le.current=!0;var Re;!ce&&e&&u&&(Re=vS),ce&&e&&o&&(Re=wS),(ce&&!e&&d||!ce&&m&&!e&&d)&&(Re=yS);var Ae=I(Re);Re&&(t||Ae[na])?(ie(Re),z()):ie(pc),K.current=e}},[e]),Ee.useEffect(function(){(V===vS&&!u||V===wS&&!o||V===yS&&!d)&&ie(pc)},[u,o,d]),Ee.useEffect(function(){return function(){le.current=!1,clearTimeout(ye.current)}},[]);var ne=Ee.useRef(!1);Ee.useEffect(function(){me&&(ne.current=!0),me!==void 0&&V===pc&&((ne.current||me)&&Q?.(me),ne.current=!0)},[me,V]);var ee=Pe;return k[na]&&Z===Tg&&(ee=Tt({transition:"none"},ee)),[V,Z,ee,me??e]}function BJ(t){var e=t;ii(t)==="object"&&(e=t.transitionSupport);function n(r,o){return!!(r.motionName&&e&&o!==!1)}var i=Ee.forwardRef(function(r,o){var a=r.visible,u=a===void 0?!0:a,h=r.removeOnLeave,d=h===void 0?!0:h,g=r.forceRender,m=r.children,v=r.motionName,y=r.leavedClassName,b=r.eventProps,C=Ee.useContext(Mq),T=C.motion,O=n(r,T),A=Ee.useRef(),N=Ee.useRef();function x(){try{return A.current instanceof HTMLElement?A.current:gZ(N.current)}catch{return null}}var $=VJ(O,u,x,r),L=ln($,4),P=L[0],Q=L[1],ue=L[2],X=L[3],me=Ee.useRef(X);X&&(me.current=!0);var re=Ee.useCallback(function(Te){A.current=Te,wZ(o,Te)},[o]),Se,we=Tt(Tt({},b),{},{visible:u});if(!m)Se=null;else if(P===pc)X?Se=m(Tt({},we),re):!d&&me.current&&y?Se=m(Tt(Tt({},we),{},{className:y}),re):g||!d&&!y?Se=m(Tt(Tt({},we),{},{style:{display:"none"}}),re):Se=null;else{var _e;Q===na?_e="prepare":Lq(Q)?_e="active":Q===Tg&&(_e="start");var ie=fF(v,"".concat(P,"-").concat(_e));Se=m(Tt(Tt({},we),{},{className:tZ(fF(v,P),tt(tt({},ie,ie&&_e),v,typeof v=="string")),style:ue}),re)}if(Ee.isValidElement(Se)&&yZ(Se)){var de=SZ(Se);de||(Se=Ee.cloneElement(Se,{ref:re}))}return Ee.createElement(AJ,{ref:N},Se)});return i.displayName="CSSMotion",i}const FJ=BJ(Pq);var mH="add",pH="keep",vH="remove",C_="removed";function WJ(t){var e;return t&&ii(t)==="object"&&"key"in t?e=t:e={key:t},Tt(Tt({},e),{},{key:String(e.key)})}function wH(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return t.map(WJ)}function jJ(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=[],i=0,r=e.length,o=wH(t),a=wH(e);o.forEach(function(d){for(var g=!1,m=i;m<r;m+=1){var v=a[m];if(v.key===d.key){i<m&&(n=n.concat(a.slice(i,m).map(function(y){return Tt(Tt({},y),{},{status:mH})})),i=m),n.push(Tt(Tt({},v),{},{status:pH})),i+=1,g=!0;break}}g||n.push(Tt(Tt({},d),{},{status:vH}))}),i<r&&(n=n.concat(a.slice(i).map(function(d){return Tt(Tt({},d),{},{status:mH})})));var u={};n.forEach(function(d){var g=d.key;u[g]=(u[g]||0)+1});var h=Object.keys(u).filter(function(d){return u[d]>1});return h.forEach(function(d){n=n.filter(function(g){var m=g.key,v=g.status;return m!==d||v!==vH}),n.forEach(function(g){g.key===d&&(g.status=pH)})}),n}var zJ=["component","children","onVisibleChanged","onAllRemoved"],UJ=["status"],YJ=["eventProps","visible","children","motionName","motionAppear","motionEnter","motionLeave","motionLeaveImmediately","motionDeadline","removeOnLeave","leavedClassName","onAppearPrepare","onAppearStart","onAppearActive","onAppearEnd","onEnterStart","onEnterActive","onEnterEnd","onLeaveStart","onLeaveActive","onLeaveEnd"];function GJ(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:FJ,n=(function(i){z3(o,i);var r=Y3(o);function o(){var a;um(this,o);for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return a=r.call.apply(r,[this].concat(h)),tt(Wx(a),"state",{keyEntities:[]}),tt(Wx(a),"removeKey",function(g){a.setState(function(m){var v=m.keyEntities.map(function(y){return y.key!==g?y:Tt(Tt({},y),{},{status:C_})});return{keyEntities:v}},function(){var m=a.state.keyEntities,v=m.filter(function(y){var b=y.status;return b!==C_}).length;v===0&&a.props.onAllRemoved&&a.props.onAllRemoved()})}),a}return cm(o,[{key:"render",value:function(){var u=this,h=this.state.keyEntities,d=this.props,g=d.component,m=d.children,v=d.onVisibleChanged;d.onAllRemoved;var y=Yx(d,zJ),b=g||Ee.Fragment,C={};return YJ.forEach(function(T){C[T]=y[T],delete y[T]}),delete y.keys,Ee.createElement(b,y,h.map(function(T,O){var A=T.status,N=Yx(T,UJ),x=A===mH||A===pH;return Ee.createElement(e,LC({},C,{key:N.key,visible:x,eventProps:N,onVisibleChanged:function(L){v?.(L,{key:N.key}),L||u.removeKey(N.key)}}),function($,L){return m(Tt(Tt({},$),{},{index:O}),L)})}))}}],[{key:"getDerivedStateFromProps",value:function(u,h){var d=u.keys,g=h.keyEntities,m=wH(d),v=jJ(g,m);return{keyEntities:v.filter(function(y){var b=g.find(function(C){var T=C.key;return y.key===T});return!(b&&b.status===C_&&y.status===vH)})}}}]),o})(Ee.Component);return tt(n,"defaultProps",{component:"div"}),n}GJ(Pq);const gF=Ee.createContext(!0);function qJ(t){const e=Ee.useContext(gF),{children:n}=t,[,i]=_q(),{motion:r}=i,o=Ee.useRef(!1);return o.current||(o.current=e!==r),o.current?Ee.createElement(gF.Provider,{value:r},Ee.createElement(MJ,{motion:r},n)):n}const KJ=()=>null;var XJ=function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};const ZJ=["getTargetContainer","getPopupContainer","renderEmpty","input","pagination","form","select","button"];let kq;function QJ(){return kq||hH}function JJ(t){return Object.keys(t).some(e=>e.endsWith("Color"))}const eee=t=>{const{prefixCls:e,iconPrefixCls:n,theme:i,holderRender:r}=t;e!==void 0&&(kq=e),i&&JJ(i)&&lJ(QJ(),i)},tee=t=>{const{children:e,csp:n,autoInsertSpaceInButton:i,alert:r,anchor:o,form:a,locale:u,componentSize:h,direction:d,space:g,splitter:m,virtual:v,dropdownMatchSelectWidth:y,popupMatchSelectWidth:b,popupOverflow:C,legacyLocale:T,parentContext:O,iconPrefixCls:A,theme:N,componentDisabled:x,segmented:$,statistic:L,spin:P,calendar:Q,carousel:ue,cascader:X,collapse:me,typography:re,checkbox:Se,descriptions:we,divider:_e,drawer:ie,skeleton:de,steps:Te,image:Pe,layout:De,list:V,mentions:le,modal:ye,progress:S,result:E,slider:M,breadcrumb:F,menu:q,pagination:J,input:_,textArea:I,empty:k,badge:W,radio:D,rate:z,switch:Z,transfer:j,avatar:K,message:ne,tag:ee,table:ce,card:Re,tabs:Ae,timeline:Le,timePicker:it,upload:bt,notification:Ze,tree:Je,colorPicker:Ct,datePicker:Gn,rangePicker:Zi,flex:Qi,wave:Rn,dropdown:un,warning:Mt,tour:nt,tooltip:Lt,popover:Lr,popconfirm:Ds,floatButton:wr,floatButtonGroup:qn,variant:pi,inputNumber:Wi,treeSelect:Ls}=t,pa=Ee.useCallback((_n,tn)=>{const{prefixCls:Kt}=t;if(tn)return tn;const kt=Kt||O.getPrefixCls("");return _n?`${kt}-${_n}`:kt},[O.getPrefixCls,t.prefixCls]),Tn=A||O.iconPrefixCls||Rq,kr=n||O.csp;bJ(Tn,kr);const cl=TJ(N,O.theme,{prefixCls:pa("")}),Uo={csp:kr,autoInsertSpaceInButton:i,alert:r,anchor:o,locale:u||T,direction:d,space:g,splitter:m,virtual:v,popupMatchSelectWidth:b??y,popupOverflow:C,getPrefixCls:pa,iconPrefixCls:Tn,theme:cl,segmented:$,statistic:L,spin:P,calendar:Q,carousel:ue,cascader:X,collapse:me,typography:re,checkbox:Se,descriptions:we,divider:_e,drawer:ie,skeleton:de,steps:Te,image:Pe,input:_,textArea:I,layout:De,list:V,mentions:le,modal:ye,progress:S,result:E,slider:M,breadcrumb:F,menu:q,pagination:J,empty:k,badge:W,radio:D,rate:z,switch:Z,transfer:j,avatar:K,message:ne,tag:ee,table:ce,card:Re,tabs:Ae,timeline:Le,timePicker:it,upload:bt,notification:Ze,tree:Je,colorPicker:Ct,datePicker:Gn,rangePicker:Zi,flex:Qi,wave:Rn,dropdown:un,warning:Mt,tour:nt,tooltip:Lt,popover:Lr,popconfirm:Ds,floatButton:wr,floatButtonGroup:qn,variant:pi,inputNumber:Wi,treeSelect:Ls},Yo=Object.assign({},O);Object.keys(Uo).forEach(_n=>{Uo[_n]!==void 0&&(Yo[_n]=Uo[_n])}),ZJ.forEach(_n=>{const tn=t[_n];tn&&(Yo[_n]=tn)}),typeof i<"u"&&(Yo.button=Object.assign({autoInsertSpace:i},Yo.button));const Go=W3(()=>Yo,Yo,(_n,tn)=>{const Kt=Object.keys(_n),kt=Object.keys(tn);return Kt.length!==kt.length||Kt.some(Vr=>_n[Vr]!==tn[Vr])}),{layer:Cu}=Ee.useContext(G0),zd=Ee.useMemo(()=>({prefixCls:Tn,csp:kr,layer:Cu?"antd":void 0}),[Tn,kr,Cu]);let Wt=Ee.createElement(Ee.Fragment,null,Ee.createElement(KJ,{dropdownMatchSelectWidth:y}),e);const $r=Ee.useMemo(()=>{var _n,tn,Kt,kt;return VQ(((_n=X0.Form)===null||_n===void 0?void 0:_n.defaultValidateMessages)||{},((Kt=(tn=Go.locale)===null||tn===void 0?void 0:tn.Form)===null||Kt===void 0?void 0:Kt.defaultValidateMessages)||{},((kt=Go.form)===null||kt===void 0?void 0:kt.validateMessages)||{},a?.validateMessages||{})},[Go,a?.validateMessages]);Object.keys($r).length>0&&(Wt=Ee.createElement(FQ.Provider,{value:$r},Wt)),u&&(Wt=Ee.createElement(zQ,{locale:u,_ANT_MARK__:jQ},Wt)),Wt=Ee.createElement(DQ.Provider,{value:zd},Wt),h&&(Wt=Ee.createElement(cJ,{size:h},Wt)),Wt=Ee.createElement(qJ,null,Wt);const Gc=Ee.useMemo(()=>{const _n=cl||{},{algorithm:tn,token:Kt,components:kt,cssVar:Vr}=_n,Ru=XJ(_n,["algorithm","token","components","cssVar"]),qc=tn&&(!Array.isArray(tn)||tn.length>0)?qx(tn):bq,Eu={};Object.entries(kt||{}).forEach(([je,Y])=>{const be=Object.assign({},Y);"algorithm"in be&&(be.algorithm===!0?be.theme=qc:(Array.isArray(be.algorithm)||typeof be.algorithm=="function")&&(be.theme=qx(be.algorithm)),delete be.algorithm),Eu[je]=be});const Kc=Object.assign(Object.assign({},ow),Kt);return Object.assign(Object.assign({},Ru),{theme:qc,token:Kc,components:Eu,override:Object.assign({override:Kc},Eu),cssVar:Vr})},[cl]);return N&&(Wt=Ee.createElement(Cq.Provider,{value:Gc},Wt)),Go.warning&&(Wt=Ee.createElement(BQ.Provider,{value:Go.warning},Wt)),x!==void 0&&(Wt=Ee.createElement(uJ,{disabled:x},Wt)),Ee.createElement(Z0.Provider,{value:Go},Wt)},dm=t=>{const e=Ee.useContext(Z0),n=Ee.useContext(pq);return Ee.createElement(tee,Object.assign({parentContext:e,legacyLocale:n},t))};dm.ConfigContext=Z0;dm.SizeContext=sw;dm.config=eee;dm.useConfig=hJ;Object.defineProperty(dm,"SizeContext",{get:()=>sw});const nee={defaultSeed:FC.token,defaultAlgorithm:Sq};var mF={},bp,pF;function fi(){if(pF)return bp;pF=1;var t=function(e){return e&&e.Math===Math&&e};return bp=t(typeof globalThis=="object"&&globalThis)||t(typeof window=="object"&&window)||t(typeof self=="object"&&self)||t(typeof EB=="object"&&EB)||t(typeof bp=="object"&&bp)||(function(){return this})()||Function("return this")(),bp}var R_={},E_,vF;function Ai(){return vF||(vF=1,E_=function(t){try{return!!t()}catch{return!0}}),E_}var T_,wF;function As(){if(wF)return T_;wF=1;var t=Ai();return T_=!t(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),T_}var __,yF;function Q0(){if(yF)return __;yF=1;var t=Ai();return __=!t(function(){var e=(function(){}).bind();return typeof e!="function"||e.hasOwnProperty("prototype")}),__}var M_,SF;function Oi(){if(SF)return M_;SF=1;var t=Q0(),e=Function.prototype.call;return M_=t?e.bind(e):function(){return e.apply(e,arguments)},M_}var A_={},bF;function iee(){if(bF)return A_;bF=1;var t={}.propertyIsEnumerable,e=Object.getOwnPropertyDescriptor,n=e&&!t.call({1:2},1);return A_.f=n?function(r){var o=e(this,r);return!!o&&o.enumerable}:t,A_}var O_,CF;function J0(){return CF||(CF=1,O_=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}}),O_}var x_,RF;function gi(){if(RF)return x_;RF=1;var t=Q0(),e=Function.prototype,n=e.call,i=t&&e.bind.bind(n,n);return x_=t?i:function(r){return function(){return n.apply(r,arguments)}},x_}var H_,EF;function Nd(){if(EF)return H_;EF=1;var t=gi(),e=t({}.toString),n=t("".slice);return H_=function(i){return n(e(i),8,-1)},H_}var I_,TF;function ree(){if(TF)return I_;TF=1;var t=gi(),e=Ai(),n=Nd(),i=Object,r=t("".split);return I_=e(function(){return!i("z").propertyIsEnumerable(0)})?function(o){return n(o)==="String"?r(o,""):i(o)}:i,I_}var P_,_F;function LI(){return _F||(_F=1,P_=function(t){return t==null}),P_}var N_,MF;function Ow(){if(MF)return N_;MF=1;var t=LI(),e=TypeError;return N_=function(n){if(t(n))throw new e("Can't call method on "+n);return n},N_}var D_,AF;function xw(){if(AF)return D_;AF=1;var t=ree(),e=Ow();return D_=function(n){return t(e(n))},D_}var L_,OF;function xi(){if(OF)return L_;OF=1;var t=typeof document=="object"&&document.all;return L_=typeof t>"u"&&t!==void 0?function(e){return typeof e=="function"||e===t}:function(e){return typeof e=="function"},L_}var k_,xF;function Os(){if(xF)return k_;xF=1;var t=xi();return k_=function(e){return typeof e=="object"?e!==null:t(e)},k_}var $_,HF;function fm(){if(HF)return $_;HF=1;var t=fi(),e=xi(),n=function(i){return e(i)?i:void 0};return $_=function(i,r){return arguments.length<2?n(t[i]):t[i]&&t[i][r]},$_}var V_,IF;function Hw(){if(IF)return V_;IF=1;var t=gi();return V_=t({}.isPrototypeOf),V_}var B_,PF;function eR(){if(PF)return B_;PF=1;var t=fi(),e=t.navigator,n=e&&e.userAgent;return B_=n?String(n):"",B_}var F_,NF;function oee(){if(NF)return F_;NF=1;var t=fi(),e=eR(),n=t.process,i=t.Deno,r=n&&n.versions||i&&i.version,o=r&&r.v8,a,u;return o&&(a=o.split("."),u=a[0]>0&&a[0]<4?1:+(a[0]+a[1])),!u&&e&&(a=e.match(/Edge\/(\d+)/),(!a||a[1]>=74)&&(a=e.match(/Chrome\/(\d+)/),a&&(u=+a[1]))),F_=u,F_}var W_,DF;function kI(){if(DF)return W_;DF=1;var t=oee(),e=Ai(),n=fi(),i=n.String;return W_=!!Object.getOwnPropertySymbols&&!e(function(){var r=Symbol("symbol detection");return!i(r)||!(Object(r)instanceof Symbol)||!Symbol.sham&&t&&t<41}),W_}var j_,LF;function $q(){if(LF)return j_;LF=1;var t=kI();return j_=t&&!Symbol.sham&&typeof Symbol.iterator=="symbol",j_}var z_,kF;function $I(){if(kF)return z_;kF=1;var t=fm(),e=xi(),n=Hw(),i=$q(),r=Object;return z_=i?function(o){return typeof o=="symbol"}:function(o){var a=t("Symbol");return e(a)&&n(a.prototype,r(o))},z_}var U_,$F;function tR(){if($F)return U_;$F=1;var t=String;return U_=function(e){try{return t(e)}catch{return"Object"}},U_}var Y_,VF;function uo(){if(VF)return Y_;VF=1;var t=xi(),e=tR(),n=TypeError;return Y_=function(i){if(t(i))return i;throw new n(e(i)+" is not a function")},Y_}var G_,BF;function Iw(){if(BF)return G_;BF=1;var t=uo(),e=LI();return G_=function(n,i){var r=n[i];return e(r)?void 0:t(r)},G_}var q_,FF;function see(){if(FF)return q_;FF=1;var t=Oi(),e=xi(),n=Os(),i=TypeError;return q_=function(r,o){var a,u;if(o==="string"&&e(a=r.toString)&&!n(u=t(a,r))||e(a=r.valueOf)&&!n(u=t(a,r))||o!=="string"&&e(a=r.toString)&&!n(u=t(a,r)))return u;throw new i("Can't convert object to primitive value")},q_}var K_={exports:{}},X_,WF;function Fc(){return WF||(WF=1,X_=!1),X_}var Z_,jF;function VI(){if(jF)return Z_;jF=1;var t=fi(),e=Object.defineProperty;return Z_=function(n,i){try{e(t,n,{value:i,configurable:!0,writable:!0})}catch{t[n]=i}return i},Z_}var zF;function BI(){if(zF)return K_.exports;zF=1;var t=Fc(),e=fi(),n=VI(),i="__core-js_shared__",r=K_.exports=e[i]||n(i,{});return(r.versions||(r.versions=[])).push({version:"3.46.0",mode:t?"pure":"global",copyright:"© 2014-2025 Denis Pushkarev (zloirock.ru), 2025 CoreJS Company (core-js.io)",license:"https://github.com/zloirock/core-js/blob/v3.46.0/LICENSE",source:"https://github.com/zloirock/core-js"}),K_.exports}var Q_,UF;function Vq(){if(UF)return Q_;UF=1;var t=BI();return Q_=function(e,n){return t[e]||(t[e]=n||{})},Q_}var J_,YF;function gm(){if(YF)return J_;YF=1;var t=Ow(),e=Object;return J_=function(n){return e(t(n))},J_}var e1,GF;function xs(){if(GF)return e1;GF=1;var t=gi(),e=gm(),n=t({}.hasOwnProperty);return e1=Object.hasOwn||function(r,o){return n(e(r),o)},e1}var t1,qF;function Bq(){if(qF)return t1;qF=1;var t=gi(),e=0,n=Math.random(),i=t(1.1.toString);return t1=function(r){return"Symbol("+(r===void 0?"":r)+")_"+i(++e+n,36)},t1}var n1,KF;function fa(){if(KF)return n1;KF=1;var t=fi(),e=Vq(),n=xs(),i=Bq(),r=kI(),o=$q(),a=t.Symbol,u=e("wks"),h=o?a.for||a:a&&a.withoutSetter||i;return n1=function(d){return n(u,d)||(u[d]=r&&n(a,d)?a[d]:h("Symbol."+d)),u[d]},n1}var i1,XF;function aee(){if(XF)return i1;XF=1;var t=Oi(),e=Os(),n=$I(),i=Iw(),r=see(),o=fa(),a=TypeError,u=o("toPrimitive");return i1=function(h,d){if(!e(h)||n(h))return h;var g=i(h,u),m;if(g){if(d===void 0&&(d="default"),m=t(g,h,d),!e(m)||n(m))return m;throw new a("Can't convert object to primitive value")}return d===void 0&&(d="number"),r(h,d)},i1}var r1,ZF;function Fq(){if(ZF)return r1;ZF=1;var t=aee(),e=$I();return r1=function(n){var i=t(n,"string");return e(i)?i:i+""},r1}var o1,QF;function FI(){if(QF)return o1;QF=1;var t=fi(),e=Os(),n=t.document,i=e(n)&&e(n.createElement);return o1=function(r){return i?n.createElement(r):{}},o1}var s1,JF;function Wq(){if(JF)return s1;JF=1;var t=As(),e=Ai(),n=FI();return s1=!t&&!e(function(){return Object.defineProperty(n("div"),"a",{get:function(){return 7}}).a!==7}),s1}var eW;function jq(){if(eW)return R_;eW=1;var t=As(),e=Oi(),n=iee(),i=J0(),r=xw(),o=Fq(),a=xs(),u=Wq(),h=Object.getOwnPropertyDescriptor;return R_.f=t?h:function(g,m){if(g=r(g),m=o(m),u)try{return h(g,m)}catch{}if(a(g,m))return i(!e(n.f,g,m),g[m])},R_}var a1={},l1,tW;function zq(){if(tW)return l1;tW=1;var t=As(),e=Ai();return l1=t&&e(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),l1}var u1,nW;function Hi(){if(nW)return u1;nW=1;var t=Os(),e=String,n=TypeError;return u1=function(i){if(t(i))return i;throw new n(e(i)+" is not an object")},u1}var iW;function Wc(){if(iW)return a1;iW=1;var t=As(),e=Wq(),n=zq(),i=Hi(),r=Fq(),o=TypeError,a=Object.defineProperty,u=Object.getOwnPropertyDescriptor,h="enumerable",d="configurable",g="writable";return a1.f=t?n?function(v,y,b){if(i(v),y=r(y),i(b),typeof v=="function"&&y==="prototype"&&"value"in b&&g in b&&!b[g]){var C=u(v,y);C&&C[g]&&(v[y]=b.value,b={configurable:d in b?b[d]:C[d],enumerable:h in b?b[h]:C[h],writable:!1})}return a(v,y,b)}:a:function(v,y,b){if(i(v),y=r(y),i(b),e)try{return a(v,y,b)}catch{}if("get"in b||"set"in b)throw new o("Accessors not supported");return"value"in b&&(v[y]=b.value),v},a1}var c1,rW;function mm(){if(rW)return c1;rW=1;var t=As(),e=Wc(),n=J0();return c1=t?function(i,r,o){return e.f(i,r,n(1,o))}:function(i,r,o){return i[r]=o,i},c1}var h1={exports:{}},d1,oW;function lee(){if(oW)return d1;oW=1;var t=As(),e=xs(),n=Function.prototype,i=t&&Object.getOwnPropertyDescriptor,r=e(n,"name"),o=r&&(function(){}).name==="something",a=r&&(!t||t&&i(n,"name").configurable);return d1={EXISTS:r,PROPER:o,CONFIGURABLE:a},d1}var f1,sW;function uee(){if(sW)return f1;sW=1;var t=gi(),e=xi(),n=BI(),i=t(Function.toString);return e(n.inspectSource)||(n.inspectSource=function(r){return i(r)}),f1=n.inspectSource,f1}var g1,aW;function cee(){if(aW)return g1;aW=1;var t=fi(),e=xi(),n=t.WeakMap;return g1=e(n)&&/native code/.test(String(n)),g1}var m1,lW;function WI(){if(lW)return m1;lW=1;var t=Vq(),e=Bq(),n=t("keys");return m1=function(i){return n[i]||(n[i]=e(i))},m1}var p1,uW;function jI(){return uW||(uW=1,p1={}),p1}var v1,cW;function Uq(){if(cW)return v1;cW=1;var t=cee(),e=fi(),n=Os(),i=mm(),r=xs(),o=BI(),a=WI(),u=jI(),h="Object already initialized",d=e.TypeError,g=e.WeakMap,m,v,y,b=function(A){return y(A)?v(A):m(A,{})},C=function(A){return function(N){var x;if(!n(N)||(x=v(N)).type!==A)throw new d("Incompatible receiver, "+A+" required");return x}};if(t||o.state){var T=o.state||(o.state=new g);T.get=T.get,T.has=T.has,T.set=T.set,m=function(A,N){if(T.has(A))throw new d(h);return N.facade=A,T.set(A,N),N},v=function(A){return T.get(A)||{}},y=function(A){return T.has(A)}}else{var O=a("state");u[O]=!0,m=function(A,N){if(r(A,O))throw new d(h);return N.facade=A,i(A,O,N),N},v=function(A){return r(A,O)?A[O]:{}},y=function(A){return r(A,O)}}return v1={set:m,get:v,has:y,enforce:b,getterFor:C},v1}var hW;function Yq(){if(hW)return h1.exports;hW=1;var t=gi(),e=Ai(),n=xi(),i=xs(),r=As(),o=lee().CONFIGURABLE,a=uee(),u=Uq(),h=u.enforce,d=u.get,g=String,m=Object.defineProperty,v=t("".slice),y=t("".replace),b=t([].join),C=r&&!e(function(){return m(function(){},"length",{value:8}).length!==8}),T=String(String).split("String"),O=h1.exports=function(A,N,x){v(g(N),0,7)==="Symbol("&&(N="["+y(g(N),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),x&&x.getter&&(N="get "+N),x&&x.setter&&(N="set "+N),(!i(A,"name")||o&&A.name!==N)&&(r?m(A,"name",{value:N,configurable:!0}):A.name=N),C&&x&&i(x,"arity")&&A.length!==x.arity&&m(A,"length",{value:x.arity});try{x&&i(x,"constructor")&&x.constructor?r&&m(A,"prototype",{writable:!1}):A.prototype&&(A.prototype=void 0)}catch{}var $=h(A);return i($,"source")||($.source=b(T,typeof N=="string"?N:"")),A};return Function.prototype.toString=O(function(){return n(this)&&d(this).source||a(this)},"toString"),h1.exports}var w1,dW;function zI(){if(dW)return w1;dW=1;var t=xi(),e=Wc(),n=Yq(),i=VI();return w1=function(r,o,a,u){u||(u={});var h=u.enumerable,d=u.name!==void 0?u.name:o;if(t(a)&&n(a,d,u),u.global)h?r[o]=a:i(o,a);else{try{u.unsafe?r[o]&&(h=!0):delete r[o]}catch{}h?r[o]=a:e.f(r,o,{value:a,enumerable:!1,configurable:!u.nonConfigurable,writable:!u.nonWritable})}return r},w1}var y1={},S1,fW;function hee(){if(fW)return S1;fW=1;var t=Math.ceil,e=Math.floor;return S1=Math.trunc||function(i){var r=+i;return(r>0?e:t)(r)},S1}var b1,gW;function Pw(){if(gW)return b1;gW=1;var t=hee();return b1=function(e){var n=+e;return n!==n||n===0?0:t(n)},b1}var C1,mW;function dee(){if(mW)return C1;mW=1;var t=Pw(),e=Math.max,n=Math.min;return C1=function(i,r){var o=t(i);return o<0?e(o+r,0):n(o,r)},C1}var R1,pW;function fee(){if(pW)return R1;pW=1;var t=Pw(),e=Math.min;return R1=function(n){var i=t(n);return i>0?e(i,9007199254740991):0},R1}var E1,vW;function pm(){if(vW)return E1;vW=1;var t=fee();return E1=function(e){return t(e.length)},E1}var T1,wW;function gee(){if(wW)return T1;wW=1;var t=xw(),e=dee(),n=pm(),i=function(r){return function(o,a,u){var h=t(o),d=n(h);if(d===0)return!r&&-1;var g=e(u,d),m;if(r&&a!==a){for(;d>g;)if(m=h[g++],m!==m)return!0}else for(;d>g;g++)if((r||g in h)&&h[g]===a)return r||g||0;return!r&&-1}};return T1={includes:i(!0),indexOf:i(!1)},T1}var _1,yW;function Gq(){if(yW)return _1;yW=1;var t=gi(),e=xs(),n=xw(),i=gee().indexOf,r=jI(),o=t([].push);return _1=function(a,u){var h=n(a),d=0,g=[],m;for(m in h)!e(r,m)&&e(h,m)&&o(g,m);for(;u.length>d;)e(h,m=u[d++])&&(~i(g,m)||o(g,m));return g},_1}var M1,SW;function UI(){return SW||(SW=1,M1=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"]),M1}var bW;function mee(){if(bW)return y1;bW=1;var t=Gq(),e=UI(),n=e.concat("length","prototype");return y1.f=Object.getOwnPropertyNames||function(r){return t(r,n)},y1}var A1={},CW;function pee(){return CW||(CW=1,A1.f=Object.getOwnPropertySymbols),A1}var O1,RW;function vee(){if(RW)return O1;RW=1;var t=fm(),e=gi(),n=mee(),i=pee(),r=Hi(),o=e([].concat);return O1=t("Reflect","ownKeys")||function(u){var h=n.f(r(u)),d=i.f;return d?o(h,d(u)):h},O1}var x1,EW;function qq(){if(EW)return x1;EW=1;var t=xs(),e=vee(),n=jq(),i=Wc();return x1=function(r,o,a){for(var u=e(o),h=i.f,d=n.f,g=0;g<u.length;g++){var m=u[g];!t(r,m)&&!(a&&t(a,m))&&h(r,m,d(o,m))}},x1}var H1,TW;function wee(){if(TW)return H1;TW=1;var t=Ai(),e=xi(),n=/#|\.prototype\./,i=function(h,d){var g=o[r(h)];return g===u?!0:g===a?!1:e(d)?t(d):!!d},r=i.normalize=function(h){return String(h).replace(n,".").toLowerCase()},o=i.data={},a=i.NATIVE="N",u=i.POLYFILL="P";return H1=i,H1}var I1,_W;function Cn(){if(_W)return I1;_W=1;var t=fi(),e=jq().f,n=mm(),i=zI(),r=VI(),o=qq(),a=wee();return I1=function(u,h){var d=u.target,g=u.global,m=u.stat,v,y,b,C,T,O;if(g?y=t:m?y=t[d]||r(d,{}):y=t[d]&&t[d].prototype,y)for(b in h){if(T=h[b],u.dontCallGetSet?(O=e(y,b),C=O&&O.value):C=y[b],v=a(g?b:d+(m?".":"#")+b,u.forced),!v&&C!==void 0){if(typeof T==typeof C)continue;o(T,C)}(u.sham||C&&C.sham)&&n(T,"sham",!0),i(y,b,T,u)}},I1}var P1,MW;function Nw(){if(MW)return P1;MW=1;var t=Q0(),e=Function.prototype,n=e.apply,i=e.call;return P1=typeof Reflect=="object"&&Reflect.apply||(t?i.bind(n):function(){return i.apply(n,arguments)}),P1}var N1,AW;function Kq(){if(AW)return N1;AW=1;var t=gi(),e=uo();return N1=function(n,i,r){try{return t(e(Object.getOwnPropertyDescriptor(n,i)[r]))}catch{}},N1}var D1,OW;function yee(){if(OW)return D1;OW=1;var t=Os();return D1=function(e){return t(e)||e===null},D1}var L1,xW;function See(){if(xW)return L1;xW=1;var t=yee(),e=String,n=TypeError;return L1=function(i){if(t(i))return i;throw new n("Can't set "+e(i)+" as a prototype")},L1}var k1,HW;function Xq(){if(HW)return k1;HW=1;var t=Kq(),e=Os(),n=Ow(),i=See();return k1=Object.setPrototypeOf||("__proto__"in{}?(function(){var r=!1,o={},a;try{a=t(Object.prototype,"__proto__","set"),a(o,[]),r=o instanceof Array}catch{}return function(h,d){return n(h),i(d),e(h)&&(r?a(h,d):h.__proto__=d),h}})():void 0),k1}var $1,IW;function bee(){if(IW)return $1;IW=1;var t=Wc().f;return $1=function(e,n,i){i in e||t(e,i,{configurable:!0,get:function(){return n[i]},set:function(r){n[i]=r}})},$1}var V1,PW;function Cee(){if(PW)return V1;PW=1;var t=xi(),e=Os(),n=Xq();return V1=function(i,r,o){var a,u;return n&&t(a=r.constructor)&&a!==o&&e(u=a.prototype)&&u!==o.prototype&&n(i,u),i},V1}var B1,NW;function Ree(){if(NW)return B1;NW=1;var t=fa(),e=t("toStringTag"),n={};return n[e]="z",B1=String(n)==="[object z]",B1}var F1,DW;function Zq(){if(DW)return F1;DW=1;var t=Ree(),e=xi(),n=Nd(),i=fa(),r=i("toStringTag"),o=Object,a=n((function(){return arguments})())==="Arguments",u=function(h,d){try{return h[d]}catch{}};return F1=t?n:function(h){var d,g,m;return h===void 0?"Undefined":h===null?"Null":typeof(g=u(d=o(h),r))=="string"?g:a?n(d):(m=n(d))==="Object"&&e(d.callee)?"Arguments":m},F1}var W1,LW;function nR(){if(LW)return W1;LW=1;var t=Zq(),e=String;return W1=function(n){if(t(n)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return e(n)},W1}var j1,kW;function Eee(){if(kW)return j1;kW=1;var t=nR();return j1=function(e,n){return e===void 0?arguments.length<2?"":n:t(e)},j1}var z1,$W;function Tee(){if($W)return z1;$W=1;var t=Os(),e=mm();return z1=function(n,i){t(i)&&"cause"in i&&e(n,"cause",i.cause)},z1}var U1,VW;function _ee(){if(VW)return U1;VW=1;var t=gi(),e=Error,n=t("".replace),i=(function(a){return String(new e(a).stack)})("zxcasd"),r=/\n\s*at [^:]*:[^\n]*/,o=r.test(i);return U1=function(a,u){if(o&&typeof a=="string"&&!e.prepareStackTrace)for(;u--;)a=n(a,r,"");return a},U1}var Y1,BW;function Mee(){if(BW)return Y1;BW=1;var t=Ai(),e=J0();return Y1=!t(function(){var n=new Error("a");return"stack"in n?(Object.defineProperty(n,"stack",e(1,7)),n.stack!==7):!0}),Y1}var G1,FW;function Aee(){if(FW)return G1;FW=1;var t=mm(),e=_ee(),n=Mee(),i=Error.captureStackTrace;return G1=function(r,o,a,u){n&&(i?i(r,o):t(r,"stack",e(a,u)))},G1}var q1,WW;function Oee(){if(WW)return q1;WW=1;var t=fm(),e=xs(),n=mm(),i=Hw(),r=Xq(),o=qq(),a=bee(),u=Cee(),h=Eee(),d=Tee(),g=Aee(),m=As(),v=Fc();return q1=function(y,b,C,T){var O="stackTraceLimit",A=T?2:1,N=y.split("."),x=N[N.length-1],$=t.apply(null,N);if($){var L=$.prototype;if(!v&&e(L,"cause")&&delete L.cause,!C)return $;var P=t("Error"),Q=b(function(ue,X){var me=h(T?X:ue,void 0),re=T?new $(ue):new $;return me!==void 0&&n(re,"message",me),g(re,Q,re.stack,2),this&&i(L,this)&&u(re,this,Q),arguments.length>A&&d(re,arguments[A]),re});if(Q.prototype=L,x!=="Error"?r?r(Q,P):o(Q,P,{name:!0}):m&&O in $&&(a(Q,$,O),a(Q,$,"prepareStackTrace")),o(Q,$),!v)try{L.name!==x&&n(L,"name",x),L.constructor=Q}catch{}return Q}},q1}var jW;function xee(){if(jW)return mF;jW=1;var t=Cn(),e=fi(),n=Nw(),i=Oee(),r="WebAssembly",o=e[r],a=new Error("e",{cause:7}).cause!==7,u=function(d,g){var m={};m[d]=i(d,g,a),t({global:!0,constructor:!0,arity:1,forced:a},m)},h=function(d,g){if(o&&o[d]){var m={};m[d]=i(r+"."+d,g,a),t({target:r,stat:!0,constructor:!0,arity:1,forced:a},m)}};return u("Error",function(d){return function(m){return n(d,this,arguments)}}),u("EvalError",function(d){return function(m){return n(d,this,arguments)}}),u("RangeError",function(d){return function(m){return n(d,this,arguments)}}),u("ReferenceError",function(d){return function(m){return n(d,this,arguments)}}),u("SyntaxError",function(d){return function(m){return n(d,this,arguments)}}),u("TypeError",function(d){return function(m){return n(d,this,arguments)}}),u("URIError",function(d){return function(m){return n(d,this,arguments)}}),h("CompileError",function(d){return function(m){return n(d,this,arguments)}}),h("LinkError",function(d){return function(m){return n(d,this,arguments)}}),h("RuntimeError",function(d){return function(m){return n(d,this,arguments)}}),mF}xee();var zW={},K1,UW;function Qq(){if(UW)return K1;UW=1;var t=Nd();return K1=Array.isArray||function(n){return t(n)==="Array"},K1}var X1,YW;function Jq(){if(YW)return X1;YW=1;var t=As(),e=Qq(),n=TypeError,i=Object.getOwnPropertyDescriptor,r=t&&!(function(){if(this!==void 0)return!0;try{Object.defineProperty([],"length",{writable:!1}).length=1}catch(o){return o instanceof TypeError}})();return X1=r?function(o,a){if(e(o)&&!i(o,"length").writable)throw new n("Cannot set read only .length");return o.length=a}:function(o,a){return o.length=a},X1}var Z1,GW;function e6(){if(GW)return Z1;GW=1;var t=TypeError,e=9007199254740991;return Z1=function(n){if(n>e)throw t("Maximum allowed index exceeded");return n},Z1}var qW;function Hee(){if(qW)return zW;qW=1;var t=Cn(),e=gm(),n=pm(),i=Jq(),r=e6(),o=Ai(),a=o(function(){return[].push.call({length:4294967296},1)!==4294967297}),u=function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(d){return d instanceof TypeError}},h=a||!u();return t({target:"Array",proto:!0,arity:1,forced:h},{push:function(g){var m=e(this),v=n(m),y=arguments.length;r(v+y);for(var b=0;b<y;b++)m[v]=arguments[b],v++;return i(m,v),v}}),zW}Hee();var KW={},Q1,XW;function Iee(){if(XW)return Q1;XW=1;var t=Nd(),e=gi();return Q1=function(n){if(t(n)==="Function")return e(n)},Q1}var J1,ZW;function t6(){if(ZW)return J1;ZW=1;var t=Iee(),e=uo(),n=Q0(),i=t(t.bind);return J1=function(r,o){return e(r),o===void 0?r:n?i(r,o):function(){return r.apply(o,arguments)}},J1}var eM,QW;function n6(){return QW||(QW=1,eM={}),eM}var tM,JW;function Pee(){if(JW)return tM;JW=1;var t=fa(),e=n6(),n=t("iterator"),i=Array.prototype;return tM=function(r){return r!==void 0&&(e.Array===r||i[n]===r)},tM}var nM,e2;function YI(){if(e2)return nM;e2=1;var t=Zq(),e=Iw(),n=LI(),i=n6(),r=fa(),o=r("iterator");return nM=function(a){if(!n(a))return e(a,o)||e(a,"@@iterator")||i[t(a)]},nM}var iM,t2;function Nee(){if(t2)return iM;t2=1;var t=Oi(),e=uo(),n=Hi(),i=tR(),r=YI(),o=TypeError;return iM=function(a,u){var h=arguments.length<2?r(a):u;if(e(h))return n(t(h,a));throw new o(i(a)+" is not iterable")},iM}var rM,n2;function co(){if(n2)return rM;n2=1;var t=Oi(),e=Hi(),n=Iw();return rM=function(i,r,o){var a,u;e(i);try{if(a=n(i,"return"),!a){if(r==="throw")throw o;return o}a=t(a,i)}catch(h){u=!0,a=h}if(r==="throw")throw o;if(u)throw a;return e(a),o},rM}var oM,i2;function vm(){if(i2)return oM;i2=1;var t=t6(),e=Oi(),n=Hi(),i=tR(),r=Pee(),o=pm(),a=Hw(),u=Nee(),h=YI(),d=co(),g=TypeError,m=function(y,b){this.stopped=y,this.result=b},v=m.prototype;return oM=function(y,b,C){var T=C&&C.that,O=!!(C&&C.AS_ENTRIES),A=!!(C&&C.IS_RECORD),N=!!(C&&C.IS_ITERATOR),x=!!(C&&C.INTERRUPTED),$=t(b,T),L,P,Q,ue,X,me,re,Se=function(_e){return L&&d(L,"normal"),new m(!0,_e)},we=function(_e){return O?(n(_e),x?$(_e[0],_e[1],Se):$(_e[0],_e[1])):x?$(_e,Se):$(_e)};if(A)L=y.iterator;else if(N)L=y;else{if(P=h(y),!P)throw new g(i(y)+" is not iterable");if(r(P)){for(Q=0,ue=o(y);ue>Q;Q++)if(X=we(y[Q]),X&&a(v,X))return X;return new m(!1)}L=u(y,P)}for(me=A?y.next:L.next;!(re=e(me,L)).done;){try{X=we(re.value)}catch(_e){d(L,"throw",_e)}if(typeof X=="object"&&X&&a(v,X))return X}return new m(!1)},oM}var sM,r2;function i6(){if(r2)return sM;r2=1;var t=As(),e=Wc(),n=J0();return sM=function(i,r,o){t?e.f(i,r,n(0,o)):i[r]=o},sM}var o2;function Dee(){if(o2)return KW;o2=1;var t=Cn(),e=vm(),n=i6();return t({target:"Object",stat:!0},{fromEntries:function(r){var o={};return e(r,function(a,u){n(o,a,u)},{AS_ENTRIES:!0}),o}}),KW}Dee();var s2={},aM,a2;function rl(){if(a2)return aM;a2=1;var t=gi(),e=Set.prototype;return aM={Set,add:t(e.add),has:t(e.has),remove:t(e.delete),proto:e},aM}var lM,l2;function Dd(){if(l2)return lM;l2=1;var t=rl().has;return lM=function(e){return t(e),e},lM}var uM,u2;function Ld(){if(u2)return uM;u2=1;var t=Oi();return uM=function(e,n,i){for(var r=i?e:e.iterator,o=e.next,a,u;!(a=t(o,r)).done;)if(u=n(a.value),u!==void 0)return u},uM}var cM,c2;function Dw(){if(c2)return cM;c2=1;var t=gi(),e=Ld(),n=rl(),i=n.Set,r=n.proto,o=t(r.forEach),a=t(r.keys),u=a(new i).next;return cM=function(h,d,g){return g?e({iterator:a(h),next:u},d):o(h,d)},cM}var hM,h2;function GI(){if(h2)return hM;h2=1;var t=rl(),e=Dw(),n=t.Set,i=t.add;return hM=function(r){var o=new n;return e(r,function(a){i(o,a)}),o},hM}var dM,d2;function Lw(){if(d2)return dM;d2=1;var t=Kq(),e=rl();return dM=t(e.proto,"size","get")||function(n){return n.size},dM}var fM,f2;function ol(){return f2||(f2=1,fM=function(t){return{iterator:t,next:t.next,done:!1}}),fM}var gM,g2;function kd(){if(g2)return gM;g2=1;var t=uo(),e=Hi(),n=Oi(),i=Pw(),r=ol(),o="Invalid size",a=RangeError,u=TypeError,h=Math.max,d=function(g,m){this.set=g,this.size=h(m,0),this.has=t(g.has),this.keys=t(g.keys)};return d.prototype={getIterator:function(){return r(e(n(this.keys,this.set)))},includes:function(g){return n(this.has,this.set,g)}},gM=function(g){e(g);var m=+g.size;if(m!==m)throw new u(o);var v=i(m);if(v<0)throw new a(o);return new d(g,v)},gM}var mM,m2;function Lee(){if(m2)return mM;m2=1;var t=Dd(),e=rl(),n=GI(),i=Lw(),r=kd(),o=Dw(),a=Ld(),u=e.has,h=e.remove;return mM=function(g){var m=t(this),v=r(g),y=n(m);return i(m)<=v.size?o(m,function(b){v.includes(b)&&h(y,b)}):a(v.getIterator(),function(b){u(y,b)&&h(y,b)}),y},mM}var pM,p2;function $d(){if(p2)return pM;p2=1;var t=fm(),e=function(i){return{size:i,has:function(){return!1},keys:function(){return{next:function(){return{done:!0}}}}}},n=function(i){return{size:i,has:function(){return!0},keys:function(){throw new Error("e")}}};return pM=function(i,r){var o=t("Set");try{new o()[i](e(0));try{return new o()[i](e(-1)),!1}catch{if(!r)return!0;try{return new o()[i](n(-1/0)),!1}catch{var a=new o;return a.add(1),a.add(2),r(a[i](n(1/0)))}}}catch{return!1}},pM}var v2;function kee(){if(v2)return s2;v2=1;var t=Cn(),e=Lee(),n=Ai(),i=$d(),r=!i("difference",function(a){return a.size===0}),o=r||n(function(){var a={size:1,has:function(){return!0},keys:function(){var h=0;return{next:function(){var d=h++>1;return u.has(1)&&u.clear(),{done:d,value:2}}}}},u=new Set([1,2,3,4]);return u.difference(a).size!==3});return t({target:"Set",proto:!0,real:!0,forced:o},{difference:e}),s2}kee();var w2={},vM,y2;function $ee(){if(y2)return vM;y2=1;var t=Dd(),e=rl(),n=Lw(),i=kd(),r=Dw(),o=Ld(),a=e.Set,u=e.add,h=e.has;return vM=function(g){var m=t(this),v=i(g),y=new a;return n(m)>v.size?o(v.getIterator(),function(b){h(m,b)&&u(y,b)}):r(m,function(b){v.includes(b)&&u(y,b)}),y},vM}var S2;function Vee(){if(S2)return w2;S2=1;var t=Cn(),e=Ai(),n=$ee(),i=$d(),r=!i("intersection",function(o){return o.size===2&&o.has(1)&&o.has(2)})||e(function(){return String(Array.from(new Set([1,2,3]).intersection(new Set([3,2]))))!=="3,2"});return t({target:"Set",proto:!0,real:!0,forced:r},{intersection:n}),w2}Vee();var b2={},wM,C2;function Bee(){if(C2)return wM;C2=1;var t=Dd(),e=rl().has,n=Lw(),i=kd(),r=Dw(),o=Ld(),a=co();return wM=function(h){var d=t(this),g=i(h);if(n(d)<=g.size)return r(d,function(v){if(g.includes(v))return!1},!0)!==!1;var m=g.getIterator();return o(m,function(v){if(e(d,v))return a(m,"normal",!1)})!==!1},wM}var R2;function Fee(){if(R2)return b2;R2=1;var t=Cn(),e=Bee(),n=$d(),i=!n("isDisjointFrom",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isDisjointFrom:e}),b2}Fee();var E2={},yM,T2;function Wee(){if(T2)return yM;T2=1;var t=Dd(),e=Lw(),n=Dw(),i=kd();return yM=function(o){var a=t(this),u=i(o);return e(a)>u.size?!1:n(a,function(h){if(!u.includes(h))return!1},!0)!==!1},yM}var _2;function jee(){if(_2)return E2;_2=1;var t=Cn(),e=Wee(),n=$d(),i=!n("isSubsetOf",function(r){return r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSubsetOf:e}),E2}jee();var M2={},SM,A2;function zee(){if(A2)return SM;A2=1;var t=Dd(),e=rl().has,n=Lw(),i=kd(),r=Ld(),o=co();return SM=function(u){var h=t(this),d=i(u);if(n(h)<d.size)return!1;var g=d.getIterator();return r(g,function(m){if(!e(h,m))return o(g,"normal",!1)})!==!1},SM}var O2;function Uee(){if(O2)return M2;O2=1;var t=Cn(),e=zee(),n=$d(),i=!n("isSupersetOf",function(r){return!r});return t({target:"Set",proto:!0,real:!0,forced:i},{isSupersetOf:e}),M2}Uee();var x2={},bM,H2;function Yee(){if(H2)return bM;H2=1;var t=Dd(),e=rl(),n=GI(),i=kd(),r=Ld(),o=e.add,a=e.has,u=e.remove;return bM=function(d){var g=t(this),m=i(d).getIterator(),v=n(g);return r(m,function(y){a(g,y)?u(v,y):o(v,y)}),v},bM}var CM,I2;function r6(){return I2||(I2=1,CM=function(t){try{var e=new Set,n={size:0,has:function(){return!0},keys:function(){return Object.defineProperty({},"next",{get:function(){return e.clear(),e.add(4),function(){return{done:!0}}}})}},i=e[t](n);return i.size===1&&i.values().next().value===4}catch{return!1}}),CM}var P2;function Gee(){if(P2)return x2;P2=1;var t=Cn(),e=Yee(),n=r6(),i=$d(),r=!i("symmetricDifference")||!n("symmetricDifference");return t({target:"Set",proto:!0,real:!0,forced:r},{symmetricDifference:e}),x2}Gee();var N2={},RM,D2;function qee(){if(D2)return RM;D2=1;var t=Dd(),e=rl().add,n=GI(),i=kd(),r=Ld();return RM=function(a){var u=t(this),h=i(a).getIterator(),d=n(u);return r(h,function(g){e(d,g)}),d},RM}var L2;function Kee(){if(L2)return N2;L2=1;var t=Cn(),e=qee(),n=r6(),i=$d(),r=!i("union")||!n("union");return t({target:"Set",proto:!0,real:!0,forced:r},{union:e}),N2}Kee();var k2={},$2={},EM,V2;function Xee(){if(V2)return EM;V2=1;var t=Hw(),e=TypeError;return EM=function(n,i){if(t(i,n))return n;throw new e("Incorrect invocation")},EM}var TM,B2;function Zee(){if(B2)return TM;B2=1;var t=Ai();return TM=!t(function(){function e(){}return e.prototype.constructor=null,Object.getPrototypeOf(new e)!==e.prototype}),TM}var _M,F2;function o6(){if(F2)return _M;F2=1;var t=xs(),e=xi(),n=gm(),i=WI(),r=Zee(),o=i("IE_PROTO"),a=Object,u=a.prototype;return _M=r?a.getPrototypeOf:function(h){var d=n(h);if(t(d,o))return d[o];var g=d.constructor;return e(g)&&d instanceof g?g.prototype:d instanceof a?u:null},_M}var MM,W2;function Qee(){if(W2)return MM;W2=1;var t=Yq(),e=Wc();return MM=function(n,i,r){return r.get&&t(r.get,i,{getter:!0}),r.set&&t(r.set,i,{setter:!0}),e.f(n,i,r)},MM}var AM={},OM,j2;function Jee(){if(j2)return OM;j2=1;var t=Gq(),e=UI();return OM=Object.keys||function(i){return t(i,e)},OM}var z2;function ete(){if(z2)return AM;z2=1;var t=As(),e=zq(),n=Wc(),i=Hi(),r=xw(),o=Jee();return AM.f=t&&!e?Object.defineProperties:function(u,h){i(u);for(var d=r(h),g=o(h),m=g.length,v=0,y;m>v;)n.f(u,y=g[v++],d[y]);return u},AM}var xM,U2;function s6(){if(U2)return xM;U2=1;var t=fm();return xM=t("document","documentElement"),xM}var HM,Y2;function qI(){if(Y2)return HM;Y2=1;var t=Hi(),e=ete(),n=UI(),i=jI(),r=s6(),o=FI(),a=WI(),u=">",h="<",d="prototype",g="script",m=a("IE_PROTO"),v=function(){},y=function(A){return h+g+u+A+h+"/"+g+u},b=function(A){A.write(y("")),A.close();var N=A.parentWindow.Object;return A=null,N},C=function(){var A=o("iframe"),N="java"+g+":",x;return A.style.display="none",r.appendChild(A),A.src=String(N),x=A.contentWindow.document,x.open(),x.write(y("document.F=Object")),x.close(),x.F},T,O=function(){try{T=new ActiveXObject("htmlfile")}catch{}O=typeof document<"u"?document.domain&&T?b(T):C():b(T);for(var A=n.length;A--;)delete O[d][n[A]];return O()};return i[m]=!0,HM=Object.create||function(N,x){var $;return N!==null?(v[d]=t(N),$=new v,v[d]=null,$[m]=N):$=O(),x===void 0?$:e.f($,x)},HM}var IM,G2;function a6(){if(G2)return IM;G2=1;var t=Ai(),e=xi(),n=Os(),i=qI(),r=o6(),o=zI(),a=fa(),u=Fc(),h=a("iterator"),d=!1,g,m,v;[].keys&&(v=[].keys(),"next"in v?(m=r(r(v)),m!==Object.prototype&&(g=m)):d=!0);var y=!n(g)||t(function(){var b={};return g[h].call(b)!==b});return y?g={}:u&&(g=i(g)),e(g[h])||o(g,h,function(){return this}),IM={IteratorPrototype:g,BUGGY_SAFARI_ITERATORS:d},IM}var q2;function tte(){if(q2)return $2;q2=1;var t=Cn(),e=fi(),n=Xee(),i=Hi(),r=xi(),o=o6(),a=Qee(),u=i6(),h=Ai(),d=xs(),g=fa(),m=a6().IteratorPrototype,v=As(),y=Fc(),b="constructor",C="Iterator",T=g("toStringTag"),O=TypeError,A=e[C],N=y||!r(A)||A.prototype!==m||!h(function(){A({})}),x=function(){if(n(this,m),o(this)===m)throw new O("Abstract class Iterator not directly constructable")},$=function(L,P){v?a(m,L,{configurable:!0,get:function(){return P},set:function(Q){if(i(this),this===m)throw new O("You can't redefine this property");d(this,L)?this[L]=Q:u(this,L,Q)}}):m[L]=P};return d(m,T)||$(T,C),(N||!d(m,b)||m[b]===Object)&&$(b,x),x.prototype=m,t({global:!0,constructor:!0,forced:N},{Iterator:x}),$2}var K2;function nte(){return K2||(K2=1,tte()),k2}nte();var X2={},Z2={},PM,Q2;function ite(){if(Q2)return PM;Q2=1;var t=zI();return PM=function(e,n,i){for(var r in n)t(e,r,n[r],i);return e},PM}var NM,J2;function rte(){return J2||(J2=1,NM=function(t,e){return{value:t,done:e}}),NM}var DM,ej;function ote(){if(ej)return DM;ej=1;var t=co();return DM=function(e,n,i){for(var r=e.length-1;r>=0;r--)if(e[r]!==void 0)try{i=t(e[r].iterator,n,i)}catch(o){n="throw",i=o}if(n==="throw")throw i;return i},DM}var LM,tj;function KI(){if(tj)return LM;tj=1;var t=Oi(),e=qI(),n=mm(),i=ite(),r=fa(),o=Uq(),a=Iw(),u=a6().IteratorPrototype,h=rte(),d=co(),g=ote(),m=r("toStringTag"),v="IteratorHelper",y="WrapForValidIterator",b="normal",C="throw",T=o.set,O=function(x){var $=o.getterFor(x?y:v);return i(e(u),{next:function(){var P=$(this);if(x)return P.nextHandler();if(P.done)return h(void 0,!0);try{var Q=P.nextHandler();return P.returnHandlerResult?Q:h(Q,P.done)}catch(ue){throw P.done=!0,ue}},return:function(){var L=$(this),P=L.iterator;if(L.done=!0,x){var Q=a(P,"return");return Q?t(Q,P):h(void 0,!0)}if(L.inner)try{d(L.inner.iterator,b)}catch(ue){return d(P,C,ue)}if(L.openIters)try{g(L.openIters,b)}catch(ue){return d(P,C,ue)}return P&&d(P,b),h(void 0,!0)}})},A=O(!0),N=O(!1);return n(N,m,"Iterator Helper"),LM=function(x,$,L){var P=function(ue,X){X?(X.iterator=ue.iterator,X.next=ue.next):X=ue,X.type=$?y:v,X.returnHandlerResult=!!L,X.nextHandler=x,X.counter=0,X.done=!1,T(this,X)};return P.prototype=$?A:N,P},LM}var kM,nj;function l6(){if(nj)return kM;nj=1;var t=Hi(),e=co();return kM=function(n,i,r,o){try{return o?i(t(r)[0],r[1]):i(r)}catch(a){e(n,"throw",a)}},kM}var $M,ij;function XI(){return ij||(ij=1,$M=function(t,e){var n=typeof Iterator=="function"&&Iterator.prototype[t];if(n)try{n.call({next:null},e).next()}catch{return!0}}),$M}var VM,rj;function jc(){if(rj)return VM;rj=1;var t=fi();return VM=function(e,n){var i=t.Iterator,r=i&&i.prototype,o=r&&r[e],a=!1;if(o)try{o.call({next:function(){return{done:!0}},return:function(){a=!0}},-1)}catch(u){u instanceof n||(a=!1)}if(!a)return o},VM}var oj;function ste(){if(oj)return Z2;oj=1;var t=Cn(),e=Oi(),n=uo(),i=Hi(),r=ol(),o=KI(),a=l6(),u=Fc(),h=co(),d=XI(),g=jc(),m=!u&&!d("filter",function(){}),v=!u&&!m&&g("filter",TypeError),y=u||m||v,b=o(function(){for(var C=this.iterator,T=this.predicate,O=this.next,A,N,x;;){if(A=i(e(O,C)),N=this.done=!!A.done,N)return;if(x=A.value,a(C,T,[x,this.counter++],!0))return x}});return t({target:"Iterator",proto:!0,real:!0,forced:y},{filter:function(T){i(this);try{n(T)}catch(O){h(this,"throw",O)}return v?e(v,this,T):new b(r(this),{predicate:T})}}),Z2}var sj;function ate(){return sj||(sj=1,ste()),X2}ate();var aj={},lj={},uj;function lte(){if(uj)return lj;uj=1;var t=Cn(),e=Oi(),n=vm(),i=uo(),r=Hi(),o=ol(),a=co(),u=jc(),h=u("forEach",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:h},{forEach:function(g){r(this);try{i(g)}catch(y){a(this,"throw",y)}if(h)return e(h,this,g);var m=o(this),v=0;n(m,function(y){g(y,v++)},{IS_RECORD:!0})}}),lj}var cj;function ute(){return cj||(cj=1,lte()),aj}ute();var hj={},dj={},fj;function cte(){if(fj)return dj;fj=1;var t=Cn(),e=Oi(),n=uo(),i=Hi(),r=ol(),o=KI(),a=l6(),u=co(),h=XI(),d=jc(),g=Fc(),m=!g&&!h("map",function(){}),v=!g&&!m&&d("map",TypeError),y=g||m||v,b=o(function(){var C=this.iterator,T=i(e(this.next,C)),O=this.done=!!T.done;if(!O)return a(C,this.mapper,[T.value,this.counter++],!0)});return t({target:"Iterator",proto:!0,real:!0,forced:y},{map:function(T){i(this);try{n(T)}catch(O){u(this,"throw",O)}return v?e(v,this,T):new b(r(this),{mapper:T})}}),dj}var gj;function hte(){return gj||(gj=1,cte()),hj}hte();var mj={},pj={},BM,vj;function ZI(){if(vj)return BM;vj=1;var t=gi();return BM=t([].slice),BM}var FM,wj;function u6(){if(wj)return FM;wj=1;var t=TypeError;return FM=function(e,n){if(e<n)throw new t("Not enough arguments");return e},FM}var WM,yj;function dte(){if(yj)return WM;yj=1;var t=eR();return WM=/(?:ipad|iphone|ipod).*applewebkit/i.test(t),WM}var jM,Sj;function c6(){if(Sj)return jM;Sj=1;var t=fi(),e=eR(),n=Nd(),i=function(r){return e.slice(0,r.length)===r};return jM=(function(){return i("Bun/")?"BUN":i("Cloudflare-Workers")?"CLOUDFLARE":i("Deno/")?"DENO":i("Node.js/")?"NODE":t.Bun&&typeof Bun.version=="string"?"BUN":t.Deno&&typeof Deno.version=="object"?"DENO":n(t.process)==="process"?"NODE":t.window&&t.document?"BROWSER":"REST"})(),jM}var zM,bj;function fte(){if(bj)return zM;bj=1;var t=c6();return zM=t==="NODE",zM}var UM,Cj;function h6(){if(Cj)return UM;Cj=1;var t=fi(),e=Nw(),n=t6(),i=xi(),r=xs(),o=Ai(),a=s6(),u=ZI(),h=FI(),d=u6(),g=dte(),m=fte(),v=t.setImmediate,y=t.clearImmediate,b=t.process,C=t.Dispatch,T=t.Function,O=t.MessageChannel,A=t.String,N=0,x={},$="onreadystatechange",L,P,Q,ue;o(function(){L=t.location});var X=function(we){if(r(x,we)){var _e=x[we];delete x[we],_e()}},me=function(we){return function(){X(we)}},re=function(we){X(we.data)},Se=function(we){t.postMessage(A(we),L.protocol+"//"+L.host)};return(!v||!y)&&(v=function(_e){d(arguments.length,1);var ie=i(_e)?_e:T(_e),de=u(arguments,1);return x[++N]=function(){e(ie,void 0,de)},P(N),N},y=function(_e){delete x[_e]},m?P=function(we){b.nextTick(me(we))}:C&&C.now?P=function(we){C.now(me(we))}:O&&!g?(Q=new O,ue=Q.port2,Q.port1.onmessage=re,P=n(ue.postMessage,ue)):t.addEventListener&&i(t.postMessage)&&!t.importScripts&&L&&L.protocol!=="file:"&&!o(Se)?(P=Se,t.addEventListener("message",re,!1)):$ in h("script")?P=function(we){a.appendChild(h("script"))[$]=function(){a.removeChild(this),X(we)}}:P=function(we){setTimeout(me(we),0)}),UM={set:v,clear:y},UM}var Rj;function gte(){if(Rj)return pj;Rj=1;var t=Cn(),e=fi(),n=h6().clear;return t({global:!0,bind:!0,enumerable:!0,forced:e.clearImmediate!==n},{clearImmediate:n}),pj}var Ej={},YM,Tj;function mte(){if(Tj)return YM;Tj=1;var t=fi(),e=Nw(),n=xi(),i=c6(),r=eR(),o=ZI(),a=u6(),u=t.Function,h=/MSIE .\./.test(r)||i==="BUN"&&(function(){var d=t.Bun.version.split(".");return d.length<3||d[0]==="0"&&(d[1]<3||d[1]==="3"&&d[2]==="0")})();return YM=function(d,g){var m=g?2:1;return h?function(v,y){var b=a(arguments.length,1)>m,C=n(v)?v:u(v),T=b?o(arguments,m):[],O=b?function(){e(C,this,T)}:C;return g?d(O,y):d(O)}:d},YM}var _j;function pte(){if(_j)return Ej;_j=1;var t=Cn(),e=fi(),n=h6().set,i=mte(),r=e.setImmediate?i(n,!1):n;return t({global:!0,bind:!0,enumerable:!0,forced:e.setImmediate!==r},{setImmediate:r}),Ej}var Mj;function vte(){return Mj||(Mj=1,gte(),pte()),mj}vte();/*! @license DOMPurify 3.3.0 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.3.0/LICENSE */const{entries:d6,setPrototypeOf:Aj,isFrozen:wte,getPrototypeOf:yte,getOwnPropertyDescriptor:Ste}=Object;let{freeze:Ir,seal:Ms,create:yH}=Object,{apply:SH,construct:bH}=typeof Reflect<"u"&&Reflect;Ir||(Ir=function(e){return e});Ms||(Ms=function(e){return e});SH||(SH=function(e,n){for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];return e.apply(n,r)});bH||(bH=function(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return new e(...i)});const bS=Pr(Array.prototype.forEach),bte=Pr(Array.prototype.lastIndexOf),Oj=Pr(Array.prototype.pop),Cp=Pr(Array.prototype.push),Cte=Pr(Array.prototype.splice),uC=Pr(String.prototype.toLowerCase),GM=Pr(String.prototype.toString),qM=Pr(String.prototype.match),Rp=Pr(String.prototype.replace),Rte=Pr(String.prototype.indexOf),Ete=Pr(String.prototype.trim),Xs=Pr(Object.prototype.hasOwnProperty),Sr=Pr(RegExp.prototype.test),Ep=Tte(TypeError);function Pr(t){return function(e){e instanceof RegExp&&(e.lastIndex=0);for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return SH(t,e,i)}}function Tte(t){return function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return bH(t,n)}}function xt(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:uC;Aj&&Aj(t,null);let i=e.length;for(;i--;){let r=e[i];if(typeof r=="string"){const o=n(r);o!==r&&(wte(e)||(e[i]=o),r=o)}t[r]=!0}return t}function _te(t){for(let e=0;e<t.length;e++)Xs(t,e)||(t[e]=null);return t}function Wl(t){const e=yH(null);for(const[n,i]of d6(t))Xs(t,n)&&(Array.isArray(i)?e[n]=_te(i):i&&typeof i=="object"&&i.constructor===Object?e[n]=Wl(i):e[n]=i);return e}function Tp(t,e){for(;t!==null;){const i=Ste(t,e);if(i){if(i.get)return Pr(i.get);if(typeof i.value=="function")return Pr(i.value)}t=yte(t)}function n(){return null}return n}const xj=Ir(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","search","section","select","shadow","slot","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),KM=Ir(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","enterkeyhint","exportparts","filter","font","g","glyph","glyphref","hkern","image","inputmode","line","lineargradient","marker","mask","metadata","mpath","part","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),XM=Ir(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Mte=Ir(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),ZM=Ir(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),Ate=Ir(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Hj=Ir(["#text"]),Ij=Ir(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","exportparts","face","for","headers","height","hidden","high","href","hreflang","id","inert","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","part","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","slot","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),QM=Ir(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","mask-type","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),Pj=Ir(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),CS=Ir(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),Ote=Ms(/\{\{[\w\W]*|[\w\W]*\}\}/gm),xte=Ms(/<%[\w\W]*|[\w\W]*%>/gm),Hte=Ms(/\$\{[\w\W]*/gm),Ite=Ms(/^data-[\-\w.\u00B7-\uFFFF]+$/),Pte=Ms(/^aria-[\-\w]+$/),f6=Ms(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),Nte=Ms(/^(?:\w+script|data):/i),Dte=Ms(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),g6=Ms(/^html$/i),Lte=Ms(/^[a-z][.\w]*(-[.\w]+)+$/i);var Nj=Object.freeze({__proto__:null,ARIA_ATTR:Pte,ATTR_WHITESPACE:Dte,CUSTOM_ELEMENT:Lte,DATA_ATTR:Ite,DOCTYPE_NAME:g6,ERB_EXPR:xte,IS_ALLOWED_URI:f6,IS_SCRIPT_OR_DATA:Nte,MUSTACHE_EXPR:Ote,TMPLIT_EXPR:Hte});const _p={element:1,text:3,progressingInstruction:7,comment:8,document:9},kte=function(){return typeof window>"u"?null:window},$te=function(e,n){if(typeof e!="object"||typeof e.createPolicy!="function")return null;let i=null;const r="data-tt-policy-suffix";n&&n.hasAttribute(r)&&(i=n.getAttribute(r));const o="dompurify"+(i?"#"+i:"");try{return e.createPolicy(o,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+o+" could not be created."),null}},Dj=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function m6(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:kte();const e=je=>m6(je);if(e.version="3.3.0",e.removed=[],!t||!t.document||t.document.nodeType!==_p.document||!t.Element)return e.isSupported=!1,e;let{document:n}=t;const i=n,r=i.currentScript,{DocumentFragment:o,HTMLTemplateElement:a,Node:u,Element:h,NodeFilter:d,NamedNodeMap:g=t.NamedNodeMap||t.MozNamedAttrMap,HTMLFormElement:m,DOMParser:v,trustedTypes:y}=t,b=h.prototype,C=Tp(b,"cloneNode"),T=Tp(b,"remove"),O=Tp(b,"nextSibling"),A=Tp(b,"childNodes"),N=Tp(b,"parentNode");if(typeof a=="function"){const je=n.createElement("template");je.content&&je.content.ownerDocument&&(n=je.content.ownerDocument)}let x,$="";const{implementation:L,createNodeIterator:P,createDocumentFragment:Q,getElementsByTagName:ue}=n,{importNode:X}=i;let me=Dj();e.isSupported=typeof d6=="function"&&typeof N=="function"&&L&&L.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:re,ERB_EXPR:Se,TMPLIT_EXPR:we,DATA_ATTR:_e,ARIA_ATTR:ie,IS_SCRIPT_OR_DATA:de,ATTR_WHITESPACE:Te,CUSTOM_ELEMENT:Pe}=Nj;let{IS_ALLOWED_URI:De}=Nj,V=null;const le=xt({},[...xj,...KM,...XM,...ZM,...Hj]);let ye=null;const S=xt({},[...Ij,...QM,...Pj,...CS]);let E=Object.seal(yH(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),M=null,F=null;const q=Object.seal(yH(null,{tagCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeCheck:{writable:!0,configurable:!1,enumerable:!0,value:null}}));let J=!0,_=!0,I=!1,k=!0,W=!1,D=!0,z=!1,Z=!1,j=!1,K=!1,ne=!1,ee=!1,ce=!0,Re=!1;const Ae="user-content-";let Le=!0,it=!1,bt={},Ze=null;const Je=xt({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ct=null;const Gn=xt({},["audio","video","img","source","image","track"]);let Zi=null;const Qi=xt({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),Rn="http://www.w3.org/1998/Math/MathML",un="http://www.w3.org/2000/svg",Mt="http://www.w3.org/1999/xhtml";let nt=Mt,Lt=!1,Lr=null;const Ds=xt({},[Rn,un,Mt],GM);let wr=xt({},["mi","mo","mn","ms","mtext"]),qn=xt({},["annotation-xml"]);const pi=xt({},["title","style","font","a","script"]);let Wi=null;const Ls=["application/xhtml+xml","text/html"],pa="text/html";let Tn=null,kr=null;const cl=n.createElement("form"),Uo=function(Y){return Y instanceof RegExp||Y instanceof Function},Yo=function(){let Y=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(kr&&kr===Y)){if((!Y||typeof Y!="object")&&(Y={}),Y=Wl(Y),Wi=Ls.indexOf(Y.PARSER_MEDIA_TYPE)===-1?pa:Y.PARSER_MEDIA_TYPE,Tn=Wi==="application/xhtml+xml"?GM:uC,V=Xs(Y,"ALLOWED_TAGS")?xt({},Y.ALLOWED_TAGS,Tn):le,ye=Xs(Y,"ALLOWED_ATTR")?xt({},Y.ALLOWED_ATTR,Tn):S,Lr=Xs(Y,"ALLOWED_NAMESPACES")?xt({},Y.ALLOWED_NAMESPACES,GM):Ds,Zi=Xs(Y,"ADD_URI_SAFE_ATTR")?xt(Wl(Qi),Y.ADD_URI_SAFE_ATTR,Tn):Qi,Ct=Xs(Y,"ADD_DATA_URI_TAGS")?xt(Wl(Gn),Y.ADD_DATA_URI_TAGS,Tn):Gn,Ze=Xs(Y,"FORBID_CONTENTS")?xt({},Y.FORBID_CONTENTS,Tn):Je,M=Xs(Y,"FORBID_TAGS")?xt({},Y.FORBID_TAGS,Tn):Wl({}),F=Xs(Y,"FORBID_ATTR")?xt({},Y.FORBID_ATTR,Tn):Wl({}),bt=Xs(Y,"USE_PROFILES")?Y.USE_PROFILES:!1,J=Y.ALLOW_ARIA_ATTR!==!1,_=Y.ALLOW_DATA_ATTR!==!1,I=Y.ALLOW_UNKNOWN_PROTOCOLS||!1,k=Y.ALLOW_SELF_CLOSE_IN_ATTR!==!1,W=Y.SAFE_FOR_TEMPLATES||!1,D=Y.SAFE_FOR_XML!==!1,z=Y.WHOLE_DOCUMENT||!1,K=Y.RETURN_DOM||!1,ne=Y.RETURN_DOM_FRAGMENT||!1,ee=Y.RETURN_TRUSTED_TYPE||!1,j=Y.FORCE_BODY||!1,ce=Y.SANITIZE_DOM!==!1,Re=Y.SANITIZE_NAMED_PROPS||!1,Le=Y.KEEP_CONTENT!==!1,it=Y.IN_PLACE||!1,De=Y.ALLOWED_URI_REGEXP||f6,nt=Y.NAMESPACE||Mt,wr=Y.MATHML_TEXT_INTEGRATION_POINTS||wr,qn=Y.HTML_INTEGRATION_POINTS||qn,E=Y.CUSTOM_ELEMENT_HANDLING||{},Y.CUSTOM_ELEMENT_HANDLING&&Uo(Y.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(E.tagNameCheck=Y.CUSTOM_ELEMENT_HANDLING.tagNameCheck),Y.CUSTOM_ELEMENT_HANDLING&&Uo(Y.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(E.attributeNameCheck=Y.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),Y.CUSTOM_ELEMENT_HANDLING&&typeof Y.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(E.allowCustomizedBuiltInElements=Y.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),W&&(_=!1),ne&&(K=!0),bt&&(V=xt({},Hj),ye=[],bt.html===!0&&(xt(V,xj),xt(ye,Ij)),bt.svg===!0&&(xt(V,KM),xt(ye,QM),xt(ye,CS)),bt.svgFilters===!0&&(xt(V,XM),xt(ye,QM),xt(ye,CS)),bt.mathMl===!0&&(xt(V,ZM),xt(ye,Pj),xt(ye,CS))),Y.ADD_TAGS&&(typeof Y.ADD_TAGS=="function"?q.tagCheck=Y.ADD_TAGS:(V===le&&(V=Wl(V)),xt(V,Y.ADD_TAGS,Tn))),Y.ADD_ATTR&&(typeof Y.ADD_ATTR=="function"?q.attributeCheck=Y.ADD_ATTR:(ye===S&&(ye=Wl(ye)),xt(ye,Y.ADD_ATTR,Tn))),Y.ADD_URI_SAFE_ATTR&&xt(Zi,Y.ADD_URI_SAFE_ATTR,Tn),Y.FORBID_CONTENTS&&(Ze===Je&&(Ze=Wl(Ze)),xt(Ze,Y.FORBID_CONTENTS,Tn)),Le&&(V["#text"]=!0),z&&xt(V,["html","head","body"]),V.table&&(xt(V,["tbody"]),delete M.tbody),Y.TRUSTED_TYPES_POLICY){if(typeof Y.TRUSTED_TYPES_POLICY.createHTML!="function")throw Ep('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof Y.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Ep('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');x=Y.TRUSTED_TYPES_POLICY,$=x.createHTML("")}else x===void 0&&(x=$te(y,r)),x!==null&&typeof $=="string"&&($=x.createHTML(""));Ir&&Ir(Y),kr=Y}},Go=xt({},[...KM,...XM,...Mte]),Cu=xt({},[...ZM,...Ate]),zd=function(Y){let be=N(Y);(!be||!be.tagName)&&(be={namespaceURI:nt,tagName:"template"});const ke=uC(Y.tagName),nn=uC(be.tagName);return Lr[Y.namespaceURI]?Y.namespaceURI===un?be.namespaceURI===Mt?ke==="svg":be.namespaceURI===Rn?ke==="svg"&&(nn==="annotation-xml"||wr[nn]):!!Go[ke]:Y.namespaceURI===Rn?be.namespaceURI===Mt?ke==="math":be.namespaceURI===un?ke==="math"&&qn[nn]:!!Cu[ke]:Y.namespaceURI===Mt?be.namespaceURI===un&&!qn[nn]||be.namespaceURI===Rn&&!wr[nn]?!1:!Cu[ke]&&(pi[ke]||!Go[ke]):!!(Wi==="application/xhtml+xml"&&Lr[Y.namespaceURI]):!1},Wt=function(Y){Cp(e.removed,{element:Y});try{N(Y).removeChild(Y)}catch{T(Y)}},$r=function(Y,be){try{Cp(e.removed,{attribute:be.getAttributeNode(Y),from:be})}catch{Cp(e.removed,{attribute:null,from:be})}if(be.removeAttribute(Y),Y==="is")if(K||ne)try{Wt(be)}catch{}else try{be.setAttribute(Y,"")}catch{}},Gc=function(Y){let be=null,ke=null;if(j)Y="<remove></remove>"+Y;else{const yt=qM(Y,/^[\r\n\t ]+/);ke=yt&&yt[0]}Wi==="application/xhtml+xml"&&nt===Mt&&(Y='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+Y+"</body></html>");const nn=x?x.createHTML(Y):Y;if(nt===Mt)try{be=new v().parseFromString(nn,Wi)}catch{}if(!be||!be.documentElement){be=L.createDocument(nt,"template",null);try{be.documentElement.innerHTML=Lt?$:nn}catch{}}const Vn=be.body||be.documentElement;return Y&&ke&&Vn.insertBefore(n.createTextNode(ke),Vn.childNodes[0]||null),nt===Mt?ue.call(be,z?"html":"body")[0]:z?be.documentElement:Vn},_n=function(Y){return P.call(Y.ownerDocument||Y,Y,d.SHOW_ELEMENT|d.SHOW_COMMENT|d.SHOW_TEXT|d.SHOW_PROCESSING_INSTRUCTION|d.SHOW_CDATA_SECTION,null)},tn=function(Y){return Y instanceof m&&(typeof Y.nodeName!="string"||typeof Y.textContent!="string"||typeof Y.removeChild!="function"||!(Y.attributes instanceof g)||typeof Y.removeAttribute!="function"||typeof Y.setAttribute!="function"||typeof Y.namespaceURI!="string"||typeof Y.insertBefore!="function"||typeof Y.hasChildNodes!="function")},Kt=function(Y){return typeof u=="function"&&Y instanceof u};function kt(je,Y,be){bS(je,ke=>{ke.call(e,Y,be,kr)})}const Vr=function(Y){let be=null;if(kt(me.beforeSanitizeElements,Y,null),tn(Y))return Wt(Y),!0;const ke=Tn(Y.nodeName);if(kt(me.uponSanitizeElement,Y,{tagName:ke,allowedTags:V}),D&&Y.hasChildNodes()&&!Kt(Y.firstElementChild)&&Sr(/<[/\w!]/g,Y.innerHTML)&&Sr(/<[/\w!]/g,Y.textContent)||Y.nodeType===_p.progressingInstruction||D&&Y.nodeType===_p.comment&&Sr(/<[/\w]/g,Y.data))return Wt(Y),!0;if(!(q.tagCheck instanceof Function&&q.tagCheck(ke))&&(!V[ke]||M[ke])){if(!M[ke]&&qc(ke)&&(E.tagNameCheck instanceof RegExp&&Sr(E.tagNameCheck,ke)||E.tagNameCheck instanceof Function&&E.tagNameCheck(ke)))return!1;if(Le&&!Ze[ke]){const nn=N(Y)||Y.parentNode,Vn=A(Y)||Y.childNodes;if(Vn&&nn){const yt=Vn.length;for(let Ji=yt-1;Ji>=0;--Ji){const qo=C(Vn[Ji],!0);qo.__removalCount=(Y.__removalCount||0)+1,nn.insertBefore(qo,O(Y))}}}return Wt(Y),!0}return Y instanceof h&&!zd(Y)||(ke==="noscript"||ke==="noembed"||ke==="noframes")&&Sr(/<\/no(script|embed|frames)/i,Y.innerHTML)?(Wt(Y),!0):(W&&Y.nodeType===_p.text&&(be=Y.textContent,bS([re,Se,we],nn=>{be=Rp(be,nn," ")}),Y.textContent!==be&&(Cp(e.removed,{element:Y.cloneNode()}),Y.textContent=be)),kt(me.afterSanitizeElements,Y,null),!1)},Ru=function(Y,be,ke){if(ce&&(be==="id"||be==="name")&&(ke in n||ke in cl))return!1;if(!(_&&!F[be]&&Sr(_e,be))){if(!(J&&Sr(ie,be))){if(!(q.attributeCheck instanceof Function&&q.attributeCheck(be,Y))){if(!ye[be]||F[be]){if(!(qc(Y)&&(E.tagNameCheck instanceof RegExp&&Sr(E.tagNameCheck,Y)||E.tagNameCheck instanceof Function&&E.tagNameCheck(Y))&&(E.attributeNameCheck instanceof RegExp&&Sr(E.attributeNameCheck,be)||E.attributeNameCheck instanceof Function&&E.attributeNameCheck(be,Y))||be==="is"&&E.allowCustomizedBuiltInElements&&(E.tagNameCheck instanceof RegExp&&Sr(E.tagNameCheck,ke)||E.tagNameCheck instanceof Function&&E.tagNameCheck(ke))))return!1}else if(!Zi[be]){if(!Sr(De,Rp(ke,Te,""))){if(!((be==="src"||be==="xlink:href"||be==="href")&&Y!=="script"&&Rte(ke,"data:")===0&&Ct[Y])){if(!(I&&!Sr(de,Rp(ke,Te,"")))){if(ke)return!1}}}}}}}return!0},qc=function(Y){return Y!=="annotation-xml"&&qM(Y,Pe)},Eu=function(Y){kt(me.beforeSanitizeAttributes,Y,null);const{attributes:be}=Y;if(!be||tn(Y))return;const ke={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:ye,forceKeepAttr:void 0};let nn=be.length;for(;nn--;){const Vn=be[nn],{name:yt,namespaceURI:Ji,value:qo}=Vn,Br=Tn(yt),va=qo;let Ii=yt==="value"?va:Ete(va);if(ke.attrName=Br,ke.attrValue=Ii,ke.keepAttr=!0,ke.forceKeepAttr=void 0,kt(me.uponSanitizeAttribute,Y,ke),Ii=ke.attrValue,Re&&(Br==="id"||Br==="name")&&($r(yt,Y),Ii=Ae+Ii),D&&Sr(/((--!?|])>)|<\/(style|title|textarea)/i,Ii)){$r(yt,Y);continue}if(Br==="attributename"&&qM(Ii,"href")){$r(yt,Y);continue}if(ke.forceKeepAttr)continue;if(!ke.keepAttr){$r(yt,Y);continue}if(!k&&Sr(/\/>/i,Ii)){$r(yt,Y);continue}W&&bS([re,Se,we],Om=>{Ii=Rp(Ii,Om," ")});const Am=Tn(Y.nodeName);if(!Ru(Am,Br,Ii)){$r(yt,Y);continue}if(x&&typeof y=="object"&&typeof y.getAttributeType=="function"&&!Ji)switch(y.getAttributeType(Am,Br)){case"TrustedHTML":{Ii=x.createHTML(Ii);break}case"TrustedScriptURL":{Ii=x.createScriptURL(Ii);break}}if(Ii!==va)try{Ji?Y.setAttributeNS(Ji,yt,Ii):Y.setAttribute(yt,Ii),tn(Y)?Wt(Y):Oj(e.removed)}catch{$r(yt,Y)}}kt(me.afterSanitizeAttributes,Y,null)},Kc=function je(Y){let be=null;const ke=_n(Y);for(kt(me.beforeSanitizeShadowDOM,Y,null);be=ke.nextNode();)kt(me.uponSanitizeShadowNode,be,null),Vr(be),Eu(be),be.content instanceof o&&je(be.content);kt(me.afterSanitizeShadowDOM,Y,null)};return e.sanitize=function(je){let Y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},be=null,ke=null,nn=null,Vn=null;if(Lt=!je,Lt&&(je="<!-->"),typeof je!="string"&&!Kt(je))if(typeof je.toString=="function"){if(je=je.toString(),typeof je!="string")throw Ep("dirty is not a string, aborting")}else throw Ep("toString is not a function");if(!e.isSupported)return je;if(Z||Yo(Y),e.removed=[],typeof je=="string"&&(it=!1),it){if(je.nodeName){const qo=Tn(je.nodeName);if(!V[qo]||M[qo])throw Ep("root node is forbidden and cannot be sanitized in-place")}}else if(je instanceof u)be=Gc("<!---->"),ke=be.ownerDocument.importNode(je,!0),ke.nodeType===_p.element&&ke.nodeName==="BODY"||ke.nodeName==="HTML"?be=ke:be.appendChild(ke);else{if(!K&&!W&&!z&&je.indexOf("<")===-1)return x&&ee?x.createHTML(je):je;if(be=Gc(je),!be)return K?null:ee?$:""}be&&j&&Wt(be.firstChild);const yt=_n(it?je:be);for(;nn=yt.nextNode();)Vr(nn),Eu(nn),nn.content instanceof o&&Kc(nn.content);if(it)return je;if(K){if(ne)for(Vn=Q.call(be.ownerDocument);be.firstChild;)Vn.appendChild(be.firstChild);else Vn=be;return(ye.shadowroot||ye.shadowrootmode)&&(Vn=X.call(i,Vn,!0)),Vn}let Ji=z?be.outerHTML:be.innerHTML;return z&&V["!doctype"]&&be.ownerDocument&&be.ownerDocument.doctype&&be.ownerDocument.doctype.name&&Sr(g6,be.ownerDocument.doctype.name)&&(Ji="<!DOCTYPE "+be.ownerDocument.doctype.name+`>
`+Ji),W&&bS([re,Se,we],qo=>{Ji=Rp(Ji,qo," ")}),x&&ee?x.createHTML(Ji):Ji},e.setConfig=function(){let je=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Yo(je),Z=!0},e.clearConfig=function(){kr=null,Z=!1},e.isValidAttribute=function(je,Y,be){kr||Yo({});const ke=Tn(je),nn=Tn(Y);return Ru(ke,nn,be)},e.addHook=function(je,Y){typeof Y=="function"&&Cp(me[je],Y)},e.removeHook=function(je,Y){if(Y!==void 0){const be=bte(me[je],Y);return be===-1?void 0:Cte(me[je],be,1)[0]}return Oj(me[je])},e.removeHooks=function(je){me[je]=[]},e.removeAllHooks=function(){me=Dj()},e}var Vte=m6();//! moment.js
//! version : 2.30.1
//! authors : Tim Wood, Iskren Chernev, Moment.js contributors
//! license : MIT
//! momentjs.com
var p6;function Ce(){return p6.apply(null,arguments)}function Bte(t){p6=t}function ua(t){return t instanceof Array||Object.prototype.toString.call(t)==="[object Array]"}function Sd(t){return t!=null&&Object.prototype.toString.call(t)==="[object Object]"}function Gt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function QI(t){if(Object.getOwnPropertyNames)return Object.getOwnPropertyNames(t).length===0;var e;for(e in t)if(Gt(t,e))return!1;return!0}function no(t){return t===void 0}function hu(t){return typeof t=="number"||Object.prototype.toString.call(t)==="[object Number]"}function kw(t){return t instanceof Date||Object.prototype.toString.call(t)==="[object Date]"}function v6(t,e){var n=[],i,r=t.length;for(i=0;i<r;++i)n.push(e(t[i],i));return n}function Oc(t,e){for(var n in e)Gt(e,n)&&(t[n]=e[n]);return Gt(e,"toString")&&(t.toString=e.toString),Gt(e,"valueOf")&&(t.valueOf=e.valueOf),t}function sl(t,e,n,i){return B6(t,e,n,i,!0).utc()}function Fte(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidEra:null,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],era:null,meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function gt(t){return t._pf==null&&(t._pf=Fte()),t._pf}var CH;Array.prototype.some?CH=Array.prototype.some:CH=function(t){var e=Object(this),n=e.length>>>0,i;for(i=0;i<n;i++)if(i in e&&t.call(this,e[i],i,e))return!0;return!1};function JI(t){var e=null,n=!1,i=t._d&&!isNaN(t._d.getTime());if(i&&(e=gt(t),n=CH.call(e.parsedDateParts,function(r){return r!=null}),i=e.overflow<0&&!e.empty&&!e.invalidEra&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n),t._strict&&(i=i&&e.charsLeftOver===0&&e.unusedTokens.length===0&&e.bigHour===void 0)),Object.isFrozen==null||!Object.isFrozen(t))t._isValid=i;else return i;return t._isValid}function iR(t){var e=sl(NaN);return t!=null?Oc(gt(e),t):gt(e).userInvalidated=!0,e}var Lj=Ce.momentProperties=[],JM=!1;function eP(t,e){var n,i,r,o=Lj.length;if(no(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),no(e._i)||(t._i=e._i),no(e._f)||(t._f=e._f),no(e._l)||(t._l=e._l),no(e._strict)||(t._strict=e._strict),no(e._tzm)||(t._tzm=e._tzm),no(e._isUTC)||(t._isUTC=e._isUTC),no(e._offset)||(t._offset=e._offset),no(e._pf)||(t._pf=gt(e)),no(e._locale)||(t._locale=e._locale),o>0)for(n=0;n<o;n++)i=Lj[n],r=e[i],no(r)||(t[i]=r);return t}function $w(t){eP(this,t),this._d=new Date(t._d!=null?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),JM===!1&&(JM=!0,Ce.updateOffset(this),JM=!1)}function ca(t){return t instanceof $w||t!=null&&t._isAMomentObject!=null}function w6(t){Ce.suppressDeprecationWarnings===!1&&typeof console<"u"&&console.warn&&console.warn("Deprecation warning: "+t)}function Hs(t,e){var n=!0;return Oc(function(){if(Ce.deprecationHandler!=null&&Ce.deprecationHandler(null,t),n){var i=[],r,o,a,u=arguments.length;for(o=0;o<u;o++){if(r="",typeof arguments[o]=="object"){r+=`
[`+o+"] ";for(a in arguments[0])Gt(arguments[0],a)&&(r+=a+": "+arguments[0][a]+", ");r=r.slice(0,-2)}else r=arguments[o];i.push(r)}w6(t+`
Arguments: `+Array.prototype.slice.call(i).join("")+`
`+new Error().stack),n=!1}return e.apply(this,arguments)},e)}var kj={};function y6(t,e){Ce.deprecationHandler!=null&&Ce.deprecationHandler(t,e),kj[t]||(w6(e),kj[t]=!0)}Ce.suppressDeprecationWarnings=!1;Ce.deprecationHandler=null;function al(t){return typeof Function<"u"&&t instanceof Function||Object.prototype.toString.call(t)==="[object Function]"}function Wte(t){var e,n;for(n in t)Gt(t,n)&&(e=t[n],al(e)?this[n]=e:this["_"+n]=e);this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function RH(t,e){var n=Oc({},t),i;for(i in e)Gt(e,i)&&(Sd(t[i])&&Sd(e[i])?(n[i]={},Oc(n[i],t[i]),Oc(n[i],e[i])):e[i]!=null?n[i]=e[i]:delete n[i]);for(i in t)Gt(t,i)&&!Gt(e,i)&&Sd(t[i])&&(n[i]=Oc({},n[i]));return n}function tP(t){t!=null&&this.set(t)}var EH;Object.keys?EH=Object.keys:EH=function(t){var e,n=[];for(e in t)Gt(t,e)&&n.push(e);return n};var jte={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"};function zte(t,e,n){var i=this._calendar[t]||this._calendar.sameElse;return al(i)?i.call(e,n):i}function nl(t,e,n){var i=""+Math.abs(t),r=e-i.length,o=t>=0;return(o?n?"+":"":"-")+Math.pow(10,Math.max(0,r)).toString().substr(1)+i}var nP=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|N{1,5}|YYYYYY|YYYYY|YYYY|YY|y{2,4}|yo?|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,RS=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,eA={},Vg={};function Ke(t,e,n,i){var r=i;typeof i=="string"&&(r=function(){return this[i]()}),t&&(Vg[t]=r),e&&(Vg[e[0]]=function(){return nl(r.apply(this,arguments),e[1],e[2])}),n&&(Vg[n]=function(){return this.localeData().ordinal(r.apply(this,arguments),t)})}function Ute(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function Yte(t){var e=t.match(nP),n,i;for(n=0,i=e.length;n<i;n++)Vg[e[n]]?e[n]=Vg[e[n]]:e[n]=Ute(e[n]);return function(r){var o="",a;for(a=0;a<i;a++)o+=al(e[a])?e[a].call(r,t):e[a];return o}}function cC(t,e){return t.isValid()?(e=S6(e,t.localeData()),eA[e]=eA[e]||Yte(e),eA[e](t)):t.localeData().invalidDate()}function S6(t,e){var n=5;function i(r){return e.longDateFormat(r)||r}for(RS.lastIndex=0;n>=0&&RS.test(t);)t=t.replace(RS,i),RS.lastIndex=0,n-=1;return t}var Gte={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"};function qte(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.match(nP).map(function(i){return i==="MMMM"||i==="MM"||i==="DD"||i==="dddd"?i.slice(1):i}).join(""),this._longDateFormat[t])}var Kte="Invalid date";function Xte(){return this._invalidDate}var Zte="%d",Qte=/\d{1,2}/;function Jte(t){return this._ordinal.replace("%d",t)}var ene={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",w:"a week",ww:"%d weeks",M:"a month",MM:"%d months",y:"a year",yy:"%d years"};function tne(t,e,n,i){var r=this._relativeTime[n];return al(r)?r(t,e,n,i):r.replace(/%d/i,t)}function nne(t,e){var n=this._relativeTime[t>0?"future":"past"];return al(n)?n(e):n.replace(/%s/i,e)}var $j={D:"date",dates:"date",date:"date",d:"day",days:"day",day:"day",e:"weekday",weekdays:"weekday",weekday:"weekday",E:"isoWeekday",isoweekdays:"isoWeekday",isoweekday:"isoWeekday",DDD:"dayOfYear",dayofyears:"dayOfYear",dayofyear:"dayOfYear",h:"hour",hours:"hour",hour:"hour",ms:"millisecond",milliseconds:"millisecond",millisecond:"millisecond",m:"minute",minutes:"minute",minute:"minute",M:"month",months:"month",month:"month",Q:"quarter",quarters:"quarter",quarter:"quarter",s:"second",seconds:"second",second:"second",gg:"weekYear",weekyears:"weekYear",weekyear:"weekYear",GG:"isoWeekYear",isoweekyears:"isoWeekYear",isoweekyear:"isoWeekYear",w:"week",weeks:"week",week:"week",W:"isoWeek",isoweeks:"isoWeek",isoweek:"isoWeek",y:"year",years:"year",year:"year"};function Is(t){return typeof t=="string"?$j[t]||$j[t.toLowerCase()]:void 0}function iP(t){var e={},n,i;for(i in t)Gt(t,i)&&(n=Is(i),n&&(e[n]=t[i]));return e}var ine={date:9,day:11,weekday:11,isoWeekday:11,dayOfYear:4,hour:13,millisecond:16,minute:14,month:8,quarter:7,second:15,weekYear:1,isoWeekYear:1,week:5,isoWeek:5,year:1};function rne(t){var e=[],n;for(n in t)Gt(t,n)&&e.push({unit:n,priority:ine[n]});return e.sort(function(i,r){return i.priority-r.priority}),e}var b6=/\d/,zo=/\d\d/,C6=/\d{3}/,rP=/\d{4}/,rR=/[+-]?\d{6}/,In=/\d\d?/,R6=/\d\d\d\d?/,E6=/\d\d\d\d\d\d?/,oR=/\d{1,3}/,oP=/\d{1,4}/,sR=/[+-]?\d{1,6}/,wm=/\d+/,aR=/[+-]?\d+/,one=/Z|[+-]\d\d:?\d\d/gi,lR=/Z|[+-]\d\d(?::?\d\d)?/gi,sne=/[+-]?\d+(\.\d{1,3})?/,Vw=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ym=/^[1-9]\d?/,sP=/^([1-9]\d|\d)/,WC;WC={};function $e(t,e,n){WC[t]=al(e)?e:function(i,r){return i&&n?n:e}}function ane(t,e){return Gt(WC,t)?WC[t](e._strict,e._locale):new RegExp(lne(t))}function lne(t){return au(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,n,i,r,o){return n||i||r||o}))}function au(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function Cs(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function Nt(t){var e=+t,n=0;return e!==0&&isFinite(e)&&(n=Cs(e)),n}var TH={};function wn(t,e){var n,i=e,r;for(typeof t=="string"&&(t=[t]),hu(e)&&(i=function(o,a){a[e]=Nt(o)}),r=t.length,n=0;n<r;n++)TH[t[n]]=i}function Bw(t,e){wn(t,function(n,i,r,o){r._w=r._w||{},e(n,r._w,r,o)})}function une(t,e,n){e!=null&&Gt(TH,t)&&TH[t](e,n._a,n,t)}function uR(t){return t%4===0&&t%100!==0||t%400===0}var vr=0,Jl=1,Ka=2,Bi=3,sa=4,eu=5,cd=6,cne=7,hne=8;Ke("Y",0,0,function(){var t=this.year();return t<=9999?nl(t,4):"+"+t});Ke(0,["YY",2],0,function(){return this.year()%100});Ke(0,["YYYY",4],0,"year");Ke(0,["YYYYY",5],0,"year");Ke(0,["YYYYYY",6,!0],0,"year");$e("Y",aR);$e("YY",In,zo);$e("YYYY",oP,rP);$e("YYYYY",sR,rR);$e("YYYYYY",sR,rR);wn(["YYYYY","YYYYYY"],vr);wn("YYYY",function(t,e){e[vr]=t.length===2?Ce.parseTwoDigitYear(t):Nt(t)});wn("YY",function(t,e){e[vr]=Ce.parseTwoDigitYear(t)});wn("Y",function(t,e){e[vr]=parseInt(t,10)});function Nv(t){return uR(t)?366:365}Ce.parseTwoDigitYear=function(t){return Nt(t)+(Nt(t)>68?1900:2e3)};var T6=Sm("FullYear",!0);function dne(){return uR(this.year())}function Sm(t,e){return function(n){return n!=null?(_6(this,t,n),Ce.updateOffset(this,e),this):aw(this,t)}}function aw(t,e){if(!t.isValid())return NaN;var n=t._d,i=t._isUTC;switch(e){case"Milliseconds":return i?n.getUTCMilliseconds():n.getMilliseconds();case"Seconds":return i?n.getUTCSeconds():n.getSeconds();case"Minutes":return i?n.getUTCMinutes():n.getMinutes();case"Hours":return i?n.getUTCHours():n.getHours();case"Date":return i?n.getUTCDate():n.getDate();case"Day":return i?n.getUTCDay():n.getDay();case"Month":return i?n.getUTCMonth():n.getMonth();case"FullYear":return i?n.getUTCFullYear():n.getFullYear();default:return NaN}}function _6(t,e,n){var i,r,o,a,u;if(!(!t.isValid()||isNaN(n))){switch(i=t._d,r=t._isUTC,e){case"Milliseconds":return void(r?i.setUTCMilliseconds(n):i.setMilliseconds(n));case"Seconds":return void(r?i.setUTCSeconds(n):i.setSeconds(n));case"Minutes":return void(r?i.setUTCMinutes(n):i.setMinutes(n));case"Hours":return void(r?i.setUTCHours(n):i.setHours(n));case"Date":return void(r?i.setUTCDate(n):i.setDate(n));case"FullYear":break;default:return}o=n,a=t.month(),u=t.date(),u=u===29&&a===1&&!uR(o)?28:u,r?i.setUTCFullYear(o,a,u):i.setFullYear(o,a,u)}}function fne(t){return t=Is(t),al(this[t])?this[t]():this}function gne(t,e){if(typeof t=="object"){t=iP(t);var n=rne(t),i,r=n.length;for(i=0;i<r;i++)this[n[i].unit](t[n[i].unit])}else if(t=Is(t),al(this[t]))return this[t](e);return this}function mne(t,e){return(t%e+e)%e}var ci;Array.prototype.indexOf?ci=Array.prototype.indexOf:ci=function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1};function aP(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=mne(e,12);return t+=(e-n)/12,n===1?uR(t)?29:28:31-n%7%2}Ke("M",["MM",2],"Mo",function(){return this.month()+1});Ke("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)});Ke("MMMM",0,0,function(t){return this.localeData().months(this,t)});$e("M",In,ym);$e("MM",In,zo);$e("MMM",function(t,e){return e.monthsShortRegex(t)});$e("MMMM",function(t,e){return e.monthsRegex(t)});wn(["M","MM"],function(t,e){e[Jl]=Nt(t)-1});wn(["MMM","MMMM"],function(t,e,n,i){var r=n._locale.monthsParse(t,i,n._strict);r!=null?e[Jl]=r:gt(n).invalidMonth=t});var pne="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),M6="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),A6=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,vne=Vw,wne=Vw;function yne(t,e){return t?ua(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||A6).test(e)?"format":"standalone"][t.month()]:ua(this._months)?this._months:this._months.standalone}function Sne(t,e){return t?ua(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[A6.test(e)?"format":"standalone"][t.month()]:ua(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function bne(t,e,n){var i,r,o,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],i=0;i<12;++i)o=sl([2e3,i]),this._shortMonthsParse[i]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[i]=this.months(o,"").toLocaleLowerCase();return n?e==="MMM"?(r=ci.call(this._shortMonthsParse,a),r!==-1?r:null):(r=ci.call(this._longMonthsParse,a),r!==-1?r:null):e==="MMM"?(r=ci.call(this._shortMonthsParse,a),r!==-1?r:(r=ci.call(this._longMonthsParse,a),r!==-1?r:null)):(r=ci.call(this._longMonthsParse,a),r!==-1?r:(r=ci.call(this._shortMonthsParse,a),r!==-1?r:null))}function Cne(t,e,n){var i,r,o;if(this._monthsParseExact)return bne.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),i=0;i<12;i++){if(r=sl([2e3,i]),n&&!this._longMonthsParse[i]&&(this._longMonthsParse[i]=new RegExp("^"+this.months(r,"").replace(".","")+"$","i"),this._shortMonthsParse[i]=new RegExp("^"+this.monthsShort(r,"").replace(".","")+"$","i")),!n&&!this._monthsParse[i]&&(o="^"+this.months(r,"")+"|^"+this.monthsShort(r,""),this._monthsParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="MMMM"&&this._longMonthsParse[i].test(t))return i;if(n&&e==="MMM"&&this._shortMonthsParse[i].test(t))return i;if(!n&&this._monthsParse[i].test(t))return i}}function O6(t,e){if(!t.isValid())return t;if(typeof e=="string"){if(/^\d+$/.test(e))e=Nt(e);else if(e=t.localeData().monthsParse(e),!hu(e))return t}var n=e,i=t.date();return i=i<29?i:Math.min(i,aP(t.year(),n)),t._isUTC?t._d.setUTCMonth(n,i):t._d.setMonth(n,i),t}function x6(t){return t!=null?(O6(this,t),Ce.updateOffset(this,!0),this):aw(this,"Month")}function Rne(){return aP(this.year(),this.month())}function Ene(t){return this._monthsParseExact?(Gt(this,"_monthsRegex")||H6.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(Gt(this,"_monthsShortRegex")||(this._monthsShortRegex=vne),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function Tne(t){return this._monthsParseExact?(Gt(this,"_monthsRegex")||H6.call(this),t?this._monthsStrictRegex:this._monthsRegex):(Gt(this,"_monthsRegex")||(this._monthsRegex=wne),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function H6(){function t(h,d){return d.length-h.length}var e=[],n=[],i=[],r,o,a,u;for(r=0;r<12;r++)o=sl([2e3,r]),a=au(this.monthsShort(o,"")),u=au(this.months(o,"")),e.push(a),n.push(u),i.push(u),i.push(a);e.sort(t),n.sort(t),i.sort(t),this._monthsRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+e.join("|")+")","i")}function _ne(t,e,n,i,r,o,a){var u;return t<100&&t>=0?(u=new Date(t+400,e,n,i,r,o,a),isFinite(u.getFullYear())&&u.setFullYear(t)):u=new Date(t,e,n,i,r,o,a),u}function lw(t){var e,n;return t<100&&t>=0?(n=Array.prototype.slice.call(arguments),n[0]=t+400,e=new Date(Date.UTC.apply(null,n)),isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t)):e=new Date(Date.UTC.apply(null,arguments)),e}function jC(t,e,n){var i=7+e-n,r=(7+lw(t,0,i).getUTCDay()-e)%7;return-r+i-1}function I6(t,e,n,i,r){var o=(7+n-i)%7,a=jC(t,i,r),u=1+7*(e-1)+o+a,h,d;return u<=0?(h=t-1,d=Nv(h)+u):u>Nv(t)?(h=t+1,d=u-Nv(t)):(h=t,d=u),{year:h,dayOfYear:d}}function uw(t,e,n){var i=jC(t.year(),e,n),r=Math.floor((t.dayOfYear()-i-1)/7)+1,o,a;return r<1?(a=t.year()-1,o=r+lu(a,e,n)):r>lu(t.year(),e,n)?(o=r-lu(t.year(),e,n),a=t.year()+1):(a=t.year(),o=r),{week:o,year:a}}function lu(t,e,n){var i=jC(t,e,n),r=jC(t+1,e,n);return(Nv(t)-i+r)/7}Ke("w",["ww",2],"wo","week");Ke("W",["WW",2],"Wo","isoWeek");$e("w",In,ym);$e("ww",In,zo);$e("W",In,ym);$e("WW",In,zo);Bw(["w","ww","W","WW"],function(t,e,n,i){e[i.substr(0,1)]=Nt(t)});function Mne(t){return uw(t,this._week.dow,this._week.doy).week}var Ane={dow:0,doy:6};function One(){return this._week.dow}function xne(){return this._week.doy}function Hne(t){var e=this.localeData().week(this);return t==null?e:this.add((t-e)*7,"d")}function Ine(t){var e=uw(this,1,4).week;return t==null?e:this.add((t-e)*7,"d")}Ke("d",0,"do","day");Ke("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)});Ke("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)});Ke("dddd",0,0,function(t){return this.localeData().weekdays(this,t)});Ke("e",0,0,"weekday");Ke("E",0,0,"isoWeekday");$e("d",In);$e("e",In);$e("E",In);$e("dd",function(t,e){return e.weekdaysMinRegex(t)});$e("ddd",function(t,e){return e.weekdaysShortRegex(t)});$e("dddd",function(t,e){return e.weekdaysRegex(t)});Bw(["dd","ddd","dddd"],function(t,e,n,i){var r=n._locale.weekdaysParse(t,i,n._strict);r!=null?e.d=r:gt(n).invalidWeekday=t});Bw(["d","e","E"],function(t,e,n,i){e[i]=Nt(t)});function Pne(t,e){return typeof t!="string"?t:isNaN(t)?(t=e.weekdaysParse(t),typeof t=="number"?t:null):parseInt(t,10)}function Nne(t,e){return typeof t=="string"?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function lP(t,e){return t.slice(e,7).concat(t.slice(0,e))}var Dne="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),P6="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Lne="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),kne=Vw,$ne=Vw,Vne=Vw;function Bne(t,e){var n=ua(this._weekdays)?this._weekdays:this._weekdays[t&&t!==!0&&this._weekdays.isFormat.test(e)?"format":"standalone"];return t===!0?lP(n,this._week.dow):t?n[t.day()]:n}function Fne(t){return t===!0?lP(this._weekdaysShort,this._week.dow):t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Wne(t){return t===!0?lP(this._weekdaysMin,this._week.dow):t?this._weekdaysMin[t.day()]:this._weekdaysMin}function jne(t,e,n){var i,r,o,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],i=0;i<7;++i)o=sl([2e3,1]).day(i),this._minWeekdaysParse[i]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[i]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[i]=this.weekdays(o,"").toLocaleLowerCase();return n?e==="dddd"?(r=ci.call(this._weekdaysParse,a),r!==-1?r:null):e==="ddd"?(r=ci.call(this._shortWeekdaysParse,a),r!==-1?r:null):(r=ci.call(this._minWeekdaysParse,a),r!==-1?r:null):e==="dddd"?(r=ci.call(this._weekdaysParse,a),r!==-1||(r=ci.call(this._shortWeekdaysParse,a),r!==-1)?r:(r=ci.call(this._minWeekdaysParse,a),r!==-1?r:null)):e==="ddd"?(r=ci.call(this._shortWeekdaysParse,a),r!==-1||(r=ci.call(this._weekdaysParse,a),r!==-1)?r:(r=ci.call(this._minWeekdaysParse,a),r!==-1?r:null)):(r=ci.call(this._minWeekdaysParse,a),r!==-1||(r=ci.call(this._weekdaysParse,a),r!==-1)?r:(r=ci.call(this._shortWeekdaysParse,a),r!==-1?r:null))}function zne(t,e,n){var i,r,o;if(this._weekdaysParseExact)return jne.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),i=0;i<7;i++){if(r=sl([2e3,1]).day(i),n&&!this._fullWeekdaysParse[i]&&(this._fullWeekdaysParse[i]=new RegExp("^"+this.weekdays(r,"").replace(".","\\.?")+"$","i"),this._shortWeekdaysParse[i]=new RegExp("^"+this.weekdaysShort(r,"").replace(".","\\.?")+"$","i"),this._minWeekdaysParse[i]=new RegExp("^"+this.weekdaysMin(r,"").replace(".","\\.?")+"$","i")),this._weekdaysParse[i]||(o="^"+this.weekdays(r,"")+"|^"+this.weekdaysShort(r,"")+"|^"+this.weekdaysMin(r,""),this._weekdaysParse[i]=new RegExp(o.replace(".",""),"i")),n&&e==="dddd"&&this._fullWeekdaysParse[i].test(t))return i;if(n&&e==="ddd"&&this._shortWeekdaysParse[i].test(t))return i;if(n&&e==="dd"&&this._minWeekdaysParse[i].test(t))return i;if(!n&&this._weekdaysParse[i].test(t))return i}}function Une(t){if(!this.isValid())return t!=null?this:NaN;var e=aw(this,"Day");return t!=null?(t=Pne(t,this.localeData()),this.add(t-e,"d")):e}function Yne(t){if(!this.isValid())return t!=null?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return t==null?e:this.add(t-e,"d")}function Gne(t){if(!this.isValid())return t!=null?this:NaN;if(t!=null){var e=Nne(t,this.localeData());return this.day(this.day()%7?e:e-7)}else return this.day()||7}function qne(t){return this._weekdaysParseExact?(Gt(this,"_weekdaysRegex")||uP.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(Gt(this,"_weekdaysRegex")||(this._weekdaysRegex=kne),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function Kne(t){return this._weekdaysParseExact?(Gt(this,"_weekdaysRegex")||uP.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(Gt(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=$ne),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Xne(t){return this._weekdaysParseExact?(Gt(this,"_weekdaysRegex")||uP.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(Gt(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Vne),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function uP(){function t(g,m){return m.length-g.length}var e=[],n=[],i=[],r=[],o,a,u,h,d;for(o=0;o<7;o++)a=sl([2e3,1]).day(o),u=au(this.weekdaysMin(a,"")),h=au(this.weekdaysShort(a,"")),d=au(this.weekdays(a,"")),e.push(u),n.push(h),i.push(d),r.push(u),r.push(h),r.push(d);e.sort(t),n.sort(t),i.sort(t),r.sort(t),this._weekdaysRegex=new RegExp("^("+r.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+n.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+e.join("|")+")","i")}function cP(){return this.hours()%12||12}function Zne(){return this.hours()||24}Ke("H",["HH",2],0,"hour");Ke("h",["hh",2],0,cP);Ke("k",["kk",2],0,Zne);Ke("hmm",0,0,function(){return""+cP.apply(this)+nl(this.minutes(),2)});Ke("hmmss",0,0,function(){return""+cP.apply(this)+nl(this.minutes(),2)+nl(this.seconds(),2)});Ke("Hmm",0,0,function(){return""+this.hours()+nl(this.minutes(),2)});Ke("Hmmss",0,0,function(){return""+this.hours()+nl(this.minutes(),2)+nl(this.seconds(),2)});function N6(t,e){Ke(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}N6("a",!0);N6("A",!1);function D6(t,e){return e._meridiemParse}$e("a",D6);$e("A",D6);$e("H",In,sP);$e("h",In,ym);$e("k",In,ym);$e("HH",In,zo);$e("hh",In,zo);$e("kk",In,zo);$e("hmm",R6);$e("hmmss",E6);$e("Hmm",R6);$e("Hmmss",E6);wn(["H","HH"],Bi);wn(["k","kk"],function(t,e,n){var i=Nt(t);e[Bi]=i===24?0:i});wn(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t});wn(["h","hh"],function(t,e,n){e[Bi]=Nt(t),gt(n).bigHour=!0});wn("hmm",function(t,e,n){var i=t.length-2;e[Bi]=Nt(t.substr(0,i)),e[sa]=Nt(t.substr(i)),gt(n).bigHour=!0});wn("hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Bi]=Nt(t.substr(0,i)),e[sa]=Nt(t.substr(i,2)),e[eu]=Nt(t.substr(r)),gt(n).bigHour=!0});wn("Hmm",function(t,e,n){var i=t.length-2;e[Bi]=Nt(t.substr(0,i)),e[sa]=Nt(t.substr(i))});wn("Hmmss",function(t,e,n){var i=t.length-4,r=t.length-2;e[Bi]=Nt(t.substr(0,i)),e[sa]=Nt(t.substr(i,2)),e[eu]=Nt(t.substr(r))});function Qne(t){return(t+"").toLowerCase().charAt(0)==="p"}var Jne=/[ap]\.?m?\.?/i,eie=Sm("Hours",!0);function tie(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}var L6={calendar:jte,longDateFormat:Gte,invalidDate:Kte,ordinal:Zte,dayOfMonthOrdinalParse:Qte,relativeTime:ene,months:pne,monthsShort:M6,week:Ane,weekdays:Dne,weekdaysMin:Lne,weekdaysShort:P6,meridiemParse:Jne},kn={},Mp={},cw;function nie(t,e){var n,i=Math.min(t.length,e.length);for(n=0;n<i;n+=1)if(t[n]!==e[n])return n;return i}function Vj(t){return t&&t.toLowerCase().replace("_","-")}function iie(t){for(var e=0,n,i,r,o;e<t.length;){for(o=Vj(t[e]).split("-"),n=o.length,i=Vj(t[e+1]),i=i?i.split("-"):null;n>0;){if(r=cR(o.slice(0,n).join("-")),r)return r;if(i&&i.length>=n&&nie(o,i)>=n-1)break;n--}e++}return cw}function rie(t){return!!(t&&t.match("^[^/\\\\]*$"))}function cR(t){var e=null,n;if(kn[t]===void 0&&typeof DC<"u"&&DC&&DC.exports&&rie(t))try{e=cw._abbr,n=require,n("./locale/"+t),Dc(e)}catch{kn[t]=null}return kn[t]}function Dc(t,e){var n;return t&&(no(e)?n=vu(t):n=hP(t,e),n?cw=n:typeof console<"u"&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),cw._abbr}function hP(t,e){if(e!==null){var n,i=L6;if(e.abbr=t,kn[t]!=null)y6("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),i=kn[t]._config;else if(e.parentLocale!=null)if(kn[e.parentLocale]!=null)i=kn[e.parentLocale]._config;else if(n=cR(e.parentLocale),n!=null)i=n._config;else return Mp[e.parentLocale]||(Mp[e.parentLocale]=[]),Mp[e.parentLocale].push({name:t,config:e}),null;return kn[t]=new tP(RH(i,e)),Mp[t]&&Mp[t].forEach(function(r){hP(r.name,r.config)}),Dc(t),kn[t]}else return delete kn[t],null}function oie(t,e){if(e!=null){var n,i,r=L6;kn[t]!=null&&kn[t].parentLocale!=null?kn[t].set(RH(kn[t]._config,e)):(i=cR(t),i!=null&&(r=i._config),e=RH(r,e),i==null&&(e.abbr=t),n=new tP(e),n.parentLocale=kn[t],kn[t]=n),Dc(t)}else kn[t]!=null&&(kn[t].parentLocale!=null?(kn[t]=kn[t].parentLocale,t===Dc()&&Dc(t)):kn[t]!=null&&delete kn[t]);return kn[t]}function vu(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return cw;if(!ua(t)){if(e=cR(t),e)return e;t=[t]}return iie(t)}function sie(){return EH(kn)}function dP(t){var e,n=t._a;return n&&gt(t).overflow===-2&&(e=n[Jl]<0||n[Jl]>11?Jl:n[Ka]<1||n[Ka]>aP(n[vr],n[Jl])?Ka:n[Bi]<0||n[Bi]>24||n[Bi]===24&&(n[sa]!==0||n[eu]!==0||n[cd]!==0)?Bi:n[sa]<0||n[sa]>59?sa:n[eu]<0||n[eu]>59?eu:n[cd]<0||n[cd]>999?cd:-1,gt(t)._overflowDayOfYear&&(e<vr||e>Ka)&&(e=Ka),gt(t)._overflowWeeks&&e===-1&&(e=cne),gt(t)._overflowWeekday&&e===-1&&(e=hne),gt(t).overflow=e),t}var aie=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,lie=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d|))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([+-]\d\d(?::?\d\d)?|\s*Z)?)?$/,uie=/Z|[+-]\d\d(?::?\d\d)?/,ES=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/],["YYYYMM",/\d{6}/,!1],["YYYY",/\d{4}/,!1]],tA=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],cie=/^\/?Date\((-?\d+)/i,hie=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,die={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};function k6(t){var e,n,i=t._i,r=aie.exec(i)||lie.exec(i),o,a,u,h,d=ES.length,g=tA.length;if(r){for(gt(t).iso=!0,e=0,n=d;e<n;e++)if(ES[e][1].exec(r[1])){a=ES[e][0],o=ES[e][2]!==!1;break}if(a==null){t._isValid=!1;return}if(r[3]){for(e=0,n=g;e<n;e++)if(tA[e][1].exec(r[3])){u=(r[2]||" ")+tA[e][0];break}if(u==null){t._isValid=!1;return}}if(!o&&u!=null){t._isValid=!1;return}if(r[4])if(uie.exec(r[4]))h="Z";else{t._isValid=!1;return}t._f=a+(u||"")+(h||""),gP(t)}else t._isValid=!1}function fie(t,e,n,i,r,o){var a=[gie(t),M6.indexOf(e),parseInt(n,10),parseInt(i,10),parseInt(r,10)];return o&&a.push(parseInt(o,10)),a}function gie(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function mie(t){return t.replace(/\([^()]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function pie(t,e,n){if(t){var i=P6.indexOf(t),r=new Date(e[0],e[1],e[2]).getDay();if(i!==r)return gt(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function vie(t,e,n){if(t)return die[t];if(e)return 0;var i=parseInt(n,10),r=i%100,o=(i-r)/100;return o*60+r}function $6(t){var e=hie.exec(mie(t._i)),n;if(e){if(n=fie(e[4],e[3],e[2],e[5],e[6],e[7]),!pie(e[1],n,t))return;t._a=n,t._tzm=vie(e[8],e[9],e[10]),t._d=lw.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),gt(t).rfc2822=!0}else t._isValid=!1}function wie(t){var e=cie.exec(t._i);if(e!==null){t._d=new Date(+e[1]);return}if(k6(t),t._isValid===!1)delete t._isValid;else return;if($6(t),t._isValid===!1)delete t._isValid;else return;t._strict?t._isValid=!1:Ce.createFromInputFallback(t)}Ce.createFromInputFallback=Hs("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))});function gg(t,e,n){return t??e??n}function yie(t){var e=new Date(Ce.now());return t._useUTC?[e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()]:[e.getFullYear(),e.getMonth(),e.getDate()]}function fP(t){var e,n,i=[],r,o,a;if(!t._d){for(r=yie(t),t._w&&t._a[Ka]==null&&t._a[Jl]==null&&Sie(t),t._dayOfYear!=null&&(a=gg(t._a[vr],r[vr]),(t._dayOfYear>Nv(a)||t._dayOfYear===0)&&(gt(t)._overflowDayOfYear=!0),n=lw(a,0,t._dayOfYear),t._a[Jl]=n.getUTCMonth(),t._a[Ka]=n.getUTCDate()),e=0;e<3&&t._a[e]==null;++e)t._a[e]=i[e]=r[e];for(;e<7;e++)t._a[e]=i[e]=t._a[e]==null?e===2?1:0:t._a[e];t._a[Bi]===24&&t._a[sa]===0&&t._a[eu]===0&&t._a[cd]===0&&(t._nextDay=!0,t._a[Bi]=0),t._d=(t._useUTC?lw:_ne).apply(null,i),o=t._useUTC?t._d.getUTCDay():t._d.getDay(),t._tzm!=null&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[Bi]=24),t._w&&typeof t._w.d<"u"&&t._w.d!==o&&(gt(t).weekdayMismatch=!0)}}function Sie(t){var e,n,i,r,o,a,u,h,d;e=t._w,e.GG!=null||e.W!=null||e.E!=null?(o=1,a=4,n=gg(e.GG,t._a[vr],uw(Hn(),1,4).year),i=gg(e.W,1),r=gg(e.E,1),(r<1||r>7)&&(h=!0)):(o=t._locale._week.dow,a=t._locale._week.doy,d=uw(Hn(),o,a),n=gg(e.gg,t._a[vr],d.year),i=gg(e.w,d.week),e.d!=null?(r=e.d,(r<0||r>6)&&(h=!0)):e.e!=null?(r=e.e+o,(e.e<0||e.e>6)&&(h=!0)):r=o),i<1||i>lu(n,o,a)?gt(t)._overflowWeeks=!0:h!=null?gt(t)._overflowWeekday=!0:(u=I6(n,i,r,o,a),t._a[vr]=u.year,t._dayOfYear=u.dayOfYear)}Ce.ISO_8601=function(){};Ce.RFC_2822=function(){};function gP(t){if(t._f===Ce.ISO_8601){k6(t);return}if(t._f===Ce.RFC_2822){$6(t);return}t._a=[],gt(t).empty=!0;var e=""+t._i,n,i,r,o,a,u=e.length,h=0,d,g;for(r=S6(t._f,t._locale).match(nP)||[],g=r.length,n=0;n<g;n++)o=r[n],i=(e.match(ane(o,t))||[])[0],i&&(a=e.substr(0,e.indexOf(i)),a.length>0&&gt(t).unusedInput.push(a),e=e.slice(e.indexOf(i)+i.length),h+=i.length),Vg[o]?(i?gt(t).empty=!1:gt(t).unusedTokens.push(o),une(o,i,t)):t._strict&&!i&&gt(t).unusedTokens.push(o);gt(t).charsLeftOver=u-h,e.length>0&&gt(t).unusedInput.push(e),t._a[Bi]<=12&&gt(t).bigHour===!0&&t._a[Bi]>0&&(gt(t).bigHour=void 0),gt(t).parsedDateParts=t._a.slice(0),gt(t).meridiem=t._meridiem,t._a[Bi]=bie(t._locale,t._a[Bi],t._meridiem),d=gt(t).era,d!==null&&(t._a[vr]=t._locale.erasConvertYear(d,t._a[vr])),fP(t),dP(t)}function bie(t,e,n){var i;return n==null?e:t.meridiemHour!=null?t.meridiemHour(e,n):(t.isPM!=null&&(i=t.isPM(n),i&&e<12&&(e+=12),!i&&e===12&&(e=0)),e)}function Cie(t){var e,n,i,r,o,a,u=!1,h=t._f.length;if(h===0){gt(t).invalidFormat=!0,t._d=new Date(NaN);return}for(r=0;r<h;r++)o=0,a=!1,e=eP({},t),t._useUTC!=null&&(e._useUTC=t._useUTC),e._f=t._f[r],gP(e),JI(e)&&(a=!0),o+=gt(e).charsLeftOver,o+=gt(e).unusedTokens.length*10,gt(e).score=o,u?o<i&&(i=o,n=e):(i==null||o<i||a)&&(i=o,n=e,a&&(u=!0));Oc(t,n||e)}function Rie(t){if(!t._d){var e=iP(t._i),n=e.day===void 0?e.date:e.day;t._a=v6([e.year,e.month,n,e.hour,e.minute,e.second,e.millisecond],function(i){return i&&parseInt(i,10)}),fP(t)}}function Eie(t){var e=new $w(dP(V6(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function V6(t){var e=t._i,n=t._f;return t._locale=t._locale||vu(t._l),e===null||n===void 0&&e===""?iR({nullInput:!0}):(typeof e=="string"&&(t._i=e=t._locale.preparse(e)),ca(e)?new $w(dP(e)):(kw(e)?t._d=e:ua(n)?Cie(t):n?gP(t):Tie(t),JI(t)||(t._d=null),t))}function Tie(t){var e=t._i;no(e)?t._d=new Date(Ce.now()):kw(e)?t._d=new Date(e.valueOf()):typeof e=="string"?wie(t):ua(e)?(t._a=v6(e.slice(0),function(n){return parseInt(n,10)}),fP(t)):Sd(e)?Rie(t):hu(e)?t._d=new Date(e):Ce.createFromInputFallback(t)}function B6(t,e,n,i,r){var o={};return(e===!0||e===!1)&&(i=e,e=void 0),(n===!0||n===!1)&&(i=n,n=void 0),(Sd(t)&&QI(t)||ua(t)&&t.length===0)&&(t=void 0),o._isAMomentObject=!0,o._useUTC=o._isUTC=r,o._l=n,o._i=t,o._f=e,o._strict=i,Eie(o)}function Hn(t,e,n,i){return B6(t,e,n,i,!1)}var _ie=Hs("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Hn.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:iR()}),Mie=Hs("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Hn.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:iR()});function F6(t,e){var n,i;if(e.length===1&&ua(e[0])&&(e=e[0]),!e.length)return Hn();for(n=e[0],i=1;i<e.length;++i)(!e[i].isValid()||e[i][t](n))&&(n=e[i]);return n}function Aie(){var t=[].slice.call(arguments,0);return F6("isBefore",t)}function Oie(){var t=[].slice.call(arguments,0);return F6("isAfter",t)}var xie=function(){return Date.now?Date.now():+new Date},Ap=["year","quarter","month","week","day","hour","minute","second","millisecond"];function Hie(t){var e,n=!1,i,r=Ap.length;for(e in t)if(Gt(t,e)&&!(ci.call(Ap,e)!==-1&&(t[e]==null||!isNaN(t[e]))))return!1;for(i=0;i<r;++i)if(t[Ap[i]]){if(n)return!1;parseFloat(t[Ap[i]])!==Nt(t[Ap[i]])&&(n=!0)}return!0}function Iie(){return this._isValid}function Pie(){return ga(NaN)}function hR(t){var e=iP(t),n=e.year||0,i=e.quarter||0,r=e.month||0,o=e.week||e.isoWeek||0,a=e.day||0,u=e.hour||0,h=e.minute||0,d=e.second||0,g=e.millisecond||0;this._isValid=Hie(e),this._milliseconds=+g+d*1e3+h*6e4+u*1e3*60*60,this._days=+a+o*7,this._months=+r+i*3+n*12,this._data={},this._locale=vu(),this._bubble()}function hC(t){return t instanceof hR}function _H(t){return t<0?Math.round(-1*t)*-1:Math.round(t)}function Nie(t,e,n){var i=Math.min(t.length,e.length),r=Math.abs(t.length-e.length),o=0,a;for(a=0;a<i;a++)Nt(t[a])!==Nt(e[a])&&o++;return o+r}function W6(t,e){Ke(t,0,0,function(){var n=this.utcOffset(),i="+";return n<0&&(n=-n,i="-"),i+nl(~~(n/60),2)+e+nl(~~n%60,2)})}W6("Z",":");W6("ZZ","");$e("Z",lR);$e("ZZ",lR);wn(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=mP(lR,t)});var Die=/([\+\-]|\d\d)/gi;function mP(t,e){var n=(e||"").match(t),i,r,o;return n===null?null:(i=n[n.length-1]||[],r=(i+"").match(Die)||["-",0,0],o=+(r[1]*60)+Nt(r[2]),o===0?0:r[0]==="+"?o:-o)}function pP(t,e){var n,i;return e._isUTC?(n=e.clone(),i=(ca(t)||kw(t)?t.valueOf():Hn(t).valueOf())-n.valueOf(),n._d.setTime(n._d.valueOf()+i),Ce.updateOffset(n,!1),n):Hn(t).local()}function MH(t){return-Math.round(t._d.getTimezoneOffset())}Ce.updateOffset=function(){};function Lie(t,e,n){var i=this._offset||0,r;if(!this.isValid())return t!=null?this:NaN;if(t!=null){if(typeof t=="string"){if(t=mP(lR,t),t===null)return this}else Math.abs(t)<16&&!n&&(t=t*60);return!this._isUTC&&e&&(r=MH(this)),this._offset=t,this._isUTC=!0,r!=null&&this.add(r,"m"),i!==t&&(!e||this._changeInProgress?U6(this,ga(t-i,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,Ce.updateOffset(this,!0),this._changeInProgress=null)),this}else return this._isUTC?i:MH(this)}function kie(t,e){return t!=null?(typeof t!="string"&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function $ie(t){return this.utcOffset(0,t)}function Vie(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(MH(this),"m")),this}function Bie(){if(this._tzm!=null)this.utcOffset(this._tzm,!1,!0);else if(typeof this._i=="string"){var t=mP(one,this._i);t!=null?this.utcOffset(t):this.utcOffset(0,!0)}return this}function Fie(t){return this.isValid()?(t=t?Hn(t).utcOffset():0,(this.utcOffset()-t)%60===0):!1}function Wie(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function jie(){if(!no(this._isDSTShifted))return this._isDSTShifted;var t={},e;return eP(t,this),t=V6(t),t._a?(e=t._isUTC?sl(t._a):Hn(t._a),this._isDSTShifted=this.isValid()&&Nie(t._a,e.toArray())>0):this._isDSTShifted=!1,this._isDSTShifted}function zie(){return this.isValid()?!this._isUTC:!1}function Uie(){return this.isValid()?this._isUTC:!1}function j6(){return this.isValid()?this._isUTC&&this._offset===0:!1}var Yie=/^(-|\+)?(?:(\d*)[. ])?(\d+):(\d+)(?::(\d+)(\.\d*)?)?$/,Gie=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;function ga(t,e){var n=t,i=null,r,o,a;return hC(t)?n={ms:t._milliseconds,d:t._days,M:t._months}:hu(t)||!isNaN(+t)?(n={},e?n[e]=+t:n.milliseconds=+t):(i=Yie.exec(t))?(r=i[1]==="-"?-1:1,n={y:0,d:Nt(i[Ka])*r,h:Nt(i[Bi])*r,m:Nt(i[sa])*r,s:Nt(i[eu])*r,ms:Nt(_H(i[cd]*1e3))*r}):(i=Gie.exec(t))?(r=i[1]==="-"?-1:1,n={y:dh(i[2],r),M:dh(i[3],r),w:dh(i[4],r),d:dh(i[5],r),h:dh(i[6],r),m:dh(i[7],r),s:dh(i[8],r)}):n==null?n={}:typeof n=="object"&&("from"in n||"to"in n)&&(a=qie(Hn(n.from),Hn(n.to)),n={},n.ms=a.milliseconds,n.M=a.months),o=new hR(n),hC(t)&&Gt(t,"_locale")&&(o._locale=t._locale),hC(t)&&Gt(t,"_isValid")&&(o._isValid=t._isValid),o}ga.fn=hR.prototype;ga.invalid=Pie;function dh(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Bj(t,e){var n={};return n.months=e.month()-t.month()+(e.year()-t.year())*12,t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function qie(t,e){var n;return t.isValid()&&e.isValid()?(e=pP(e,t),t.isBefore(e)?n=Bj(t,e):(n=Bj(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function z6(t,e){return function(n,i){var r,o;return i!==null&&!isNaN(+i)&&(y6(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=i,i=o),r=ga(n,i),U6(this,r,t),this}}function U6(t,e,n,i){var r=e._milliseconds,o=_H(e._days),a=_H(e._months);t.isValid()&&(i=i??!0,a&&O6(t,aw(t,"Month")+a*n),o&&_6(t,"Date",aw(t,"Date")+o*n),r&&t._d.setTime(t._d.valueOf()+r*n),i&&Ce.updateOffset(t,o||a))}var Kie=z6(1,"add"),Xie=z6(-1,"subtract");function Y6(t){return typeof t=="string"||t instanceof String}function Zie(t){return ca(t)||kw(t)||Y6(t)||hu(t)||Jie(t)||Qie(t)||t===null||t===void 0}function Qie(t){var e=Sd(t)&&!QI(t),n=!1,i=["years","year","y","months","month","M","days","day","d","dates","date","D","hours","hour","h","minutes","minute","m","seconds","second","s","milliseconds","millisecond","ms"],r,o,a=i.length;for(r=0;r<a;r+=1)o=i[r],n=n||Gt(t,o);return e&&n}function Jie(t){var e=ua(t),n=!1;return e&&(n=t.filter(function(i){return!hu(i)&&Y6(t)}).length===0),e&&n}function ere(t){var e=Sd(t)&&!QI(t),n=!1,i=["sameDay","nextDay","lastDay","nextWeek","lastWeek","sameElse"],r,o;for(r=0;r<i.length;r+=1)o=i[r],n=n||Gt(t,o);return e&&n}function tre(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function nre(t,e){arguments.length===1&&(arguments[0]?Zie(arguments[0])?(t=arguments[0],e=void 0):ere(arguments[0])&&(e=arguments[0],t=void 0):(t=void 0,e=void 0));var n=t||Hn(),i=pP(n,this).startOf("day"),r=Ce.calendarFormat(this,i)||"sameElse",o=e&&(al(e[r])?e[r].call(this,n):e[r]);return this.format(o||this.localeData().calendar(r,this,Hn(n)))}function ire(){return new $w(this)}function rre(t,e){var n=ca(t)?t:Hn(t);return this.isValid()&&n.isValid()?(e=Is(e)||"millisecond",e==="millisecond"?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf()):!1}function ore(t,e){var n=ca(t)?t:Hn(t);return this.isValid()&&n.isValid()?(e=Is(e)||"millisecond",e==="millisecond"?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf()):!1}function sre(t,e,n,i){var r=ca(t)?t:Hn(t),o=ca(e)?e:Hn(e);return this.isValid()&&r.isValid()&&o.isValid()?(i=i||"()",(i[0]==="("?this.isAfter(r,n):!this.isBefore(r,n))&&(i[1]===")"?this.isBefore(o,n):!this.isAfter(o,n))):!1}function are(t,e){var n=ca(t)?t:Hn(t),i;return this.isValid()&&n.isValid()?(e=Is(e)||"millisecond",e==="millisecond"?this.valueOf()===n.valueOf():(i=n.valueOf(),this.clone().startOf(e).valueOf()<=i&&i<=this.clone().endOf(e).valueOf())):!1}function lre(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function ure(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function cre(t,e,n){var i,r,o;if(!this.isValid())return NaN;if(i=pP(t,this),!i.isValid())return NaN;switch(r=(i.utcOffset()-this.utcOffset())*6e4,e=Is(e),e){case"year":o=dC(this,i)/12;break;case"month":o=dC(this,i);break;case"quarter":o=dC(this,i)/3;break;case"second":o=(this-i)/1e3;break;case"minute":o=(this-i)/6e4;break;case"hour":o=(this-i)/36e5;break;case"day":o=(this-i-r)/864e5;break;case"week":o=(this-i-r)/6048e5;break;default:o=this-i}return n?o:Cs(o)}function dC(t,e){if(t.date()<e.date())return-dC(e,t);var n=(e.year()-t.year())*12+(e.month()-t.month()),i=t.clone().add(n,"months"),r,o;return e-i<0?(r=t.clone().add(n-1,"months"),o=(e-i)/(i-r)):(r=t.clone().add(n+1,"months"),o=(e-i)/(r-i)),-(n+o)||0}Ce.defaultFormat="YYYY-MM-DDTHH:mm:ssZ";Ce.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";function hre(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function dre(t){if(!this.isValid())return null;var e=t!==!0,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?cC(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):al(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+this.utcOffset()*60*1e3).toISOString().replace("Z",cC(n,"Z")):cC(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function fre(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="",n,i,r,o;return this.isLocal()||(t=this.utcOffset()===0?"moment.utc":"moment.parseZone",e="Z"),n="["+t+'("]',i=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",r="-MM-DD[T]HH:mm:ss.SSS",o=e+'[")]',this.format(n+i+r+o)}function gre(t){t||(t=this.isUtc()?Ce.defaultFormatUtc:Ce.defaultFormat);var e=cC(this,t);return this.localeData().postformat(e)}function mre(t,e){return this.isValid()&&(ca(t)&&t.isValid()||Hn(t).isValid())?ga({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function pre(t){return this.from(Hn(),t)}function vre(t,e){return this.isValid()&&(ca(t)&&t.isValid()||Hn(t).isValid())?ga({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function wre(t){return this.to(Hn(),t)}function G6(t){var e;return t===void 0?this._locale._abbr:(e=vu(t),e!=null&&(this._locale=e),this)}var q6=Hs("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return t===void 0?this.localeData():this.locale(t)});function K6(){return this._locale}var zC=1e3,Bg=60*zC,UC=60*Bg,X6=(365*400+97)*24*UC;function Fg(t,e){return(t%e+e)%e}function Z6(t,e,n){return t<100&&t>=0?new Date(t+400,e,n)-X6:new Date(t,e,n).valueOf()}function Q6(t,e,n){return t<100&&t>=0?Date.UTC(t+400,e,n)-X6:Date.UTC(t,e,n)}function yre(t){var e,n;if(t=Is(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Q6:Z6,t){case"year":e=n(this.year(),0,1);break;case"quarter":e=n(this.year(),this.month()-this.month()%3,1);break;case"month":e=n(this.year(),this.month(),1);break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday());break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1));break;case"day":case"date":e=n(this.year(),this.month(),this.date());break;case"hour":e=this._d.valueOf(),e-=Fg(e+(this._isUTC?0:this.utcOffset()*Bg),UC);break;case"minute":e=this._d.valueOf(),e-=Fg(e,Bg);break;case"second":e=this._d.valueOf(),e-=Fg(e,zC);break}return this._d.setTime(e),Ce.updateOffset(this,!0),this}function Sre(t){var e,n;if(t=Is(t),t===void 0||t==="millisecond"||!this.isValid())return this;switch(n=this._isUTC?Q6:Z6,t){case"year":e=n(this.year()+1,0,1)-1;break;case"quarter":e=n(this.year(),this.month()-this.month()%3+3,1)-1;break;case"month":e=n(this.year(),this.month()+1,1)-1;break;case"week":e=n(this.year(),this.month(),this.date()-this.weekday()+7)-1;break;case"isoWeek":e=n(this.year(),this.month(),this.date()-(this.isoWeekday()-1)+7)-1;break;case"day":case"date":e=n(this.year(),this.month(),this.date()+1)-1;break;case"hour":e=this._d.valueOf(),e+=UC-Fg(e+(this._isUTC?0:this.utcOffset()*Bg),UC)-1;break;case"minute":e=this._d.valueOf(),e+=Bg-Fg(e,Bg)-1;break;case"second":e=this._d.valueOf(),e+=zC-Fg(e,zC)-1;break}return this._d.setTime(e),Ce.updateOffset(this,!0),this}function bre(){return this._d.valueOf()-(this._offset||0)*6e4}function Cre(){return Math.floor(this.valueOf()/1e3)}function Rre(){return new Date(this.valueOf())}function Ere(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Tre(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function _re(){return this.isValid()?this.toISOString():null}function Mre(){return JI(this)}function Are(){return Oc({},gt(this))}function Ore(){return gt(this).overflow}function xre(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}Ke("N",0,0,"eraAbbr");Ke("NN",0,0,"eraAbbr");Ke("NNN",0,0,"eraAbbr");Ke("NNNN",0,0,"eraName");Ke("NNNNN",0,0,"eraNarrow");Ke("y",["y",1],"yo","eraYear");Ke("y",["yy",2],0,"eraYear");Ke("y",["yyy",3],0,"eraYear");Ke("y",["yyyy",4],0,"eraYear");$e("N",vP);$e("NN",vP);$e("NNN",vP);$e("NNNN",Fre);$e("NNNNN",Wre);wn(["N","NN","NNN","NNNN","NNNNN"],function(t,e,n,i){var r=n._locale.erasParse(t,i,n._strict);r?gt(n).era=r:gt(n).invalidEra=t});$e("y",wm);$e("yy",wm);$e("yyy",wm);$e("yyyy",wm);$e("yo",jre);wn(["y","yy","yyy","yyyy"],vr);wn(["yo"],function(t,e,n,i){var r;n._locale._eraYearOrdinalRegex&&(r=t.match(n._locale._eraYearOrdinalRegex)),n._locale.eraYearOrdinalParse?e[vr]=n._locale.eraYearOrdinalParse(t,r):e[vr]=parseInt(t,10)});function Hre(t,e){var n,i,r,o=this._eras||vu("en")._eras;for(n=0,i=o.length;n<i;++n){switch(typeof o[n].since){case"string":r=Ce(o[n].since).startOf("day"),o[n].since=r.valueOf();break}switch(typeof o[n].until){case"undefined":o[n].until=1/0;break;case"string":r=Ce(o[n].until).startOf("day").valueOf(),o[n].until=r.valueOf();break}}return o}function Ire(t,e,n){var i,r,o=this.eras(),a,u,h;for(t=t.toUpperCase(),i=0,r=o.length;i<r;++i)if(a=o[i].name.toUpperCase(),u=o[i].abbr.toUpperCase(),h=o[i].narrow.toUpperCase(),n)switch(e){case"N":case"NN":case"NNN":if(u===t)return o[i];break;case"NNNN":if(a===t)return o[i];break;case"NNNNN":if(h===t)return o[i];break}else if([a,u,h].indexOf(t)>=0)return o[i]}function Pre(t,e){var n=t.since<=t.until?1:-1;return e===void 0?Ce(t.since).year():Ce(t.since).year()+(e-t.offset)*n}function Nre(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].name;return""}function Dre(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].narrow;return""}function Lre(){var t,e,n,i=this.localeData().eras();for(t=0,e=i.length;t<e;++t)if(n=this.clone().startOf("day").valueOf(),i[t].since<=n&&n<=i[t].until||i[t].until<=n&&n<=i[t].since)return i[t].abbr;return""}function kre(){var t,e,n,i,r=this.localeData().eras();for(t=0,e=r.length;t<e;++t)if(n=r[t].since<=r[t].until?1:-1,i=this.clone().startOf("day").valueOf(),r[t].since<=i&&i<=r[t].until||r[t].until<=i&&i<=r[t].since)return(this.year()-Ce(r[t].since).year())*n+r[t].offset;return this.year()}function $re(t){return Gt(this,"_erasNameRegex")||wP.call(this),t?this._erasNameRegex:this._erasRegex}function Vre(t){return Gt(this,"_erasAbbrRegex")||wP.call(this),t?this._erasAbbrRegex:this._erasRegex}function Bre(t){return Gt(this,"_erasNarrowRegex")||wP.call(this),t?this._erasNarrowRegex:this._erasRegex}function vP(t,e){return e.erasAbbrRegex(t)}function Fre(t,e){return e.erasNameRegex(t)}function Wre(t,e){return e.erasNarrowRegex(t)}function jre(t,e){return e._eraYearOrdinalRegex||wm}function wP(){var t=[],e=[],n=[],i=[],r,o,a,u,h,d=this.eras();for(r=0,o=d.length;r<o;++r)a=au(d[r].name),u=au(d[r].abbr),h=au(d[r].narrow),e.push(a),t.push(u),n.push(h),i.push(a),i.push(u),i.push(h);this._erasRegex=new RegExp("^("+i.join("|")+")","i"),this._erasNameRegex=new RegExp("^("+e.join("|")+")","i"),this._erasAbbrRegex=new RegExp("^("+t.join("|")+")","i"),this._erasNarrowRegex=new RegExp("^("+n.join("|")+")","i")}Ke(0,["gg",2],0,function(){return this.weekYear()%100});Ke(0,["GG",2],0,function(){return this.isoWeekYear()%100});function dR(t,e){Ke(0,[t,t.length],0,e)}dR("gggg","weekYear");dR("ggggg","weekYear");dR("GGGG","isoWeekYear");dR("GGGGG","isoWeekYear");$e("G",aR);$e("g",aR);$e("GG",In,zo);$e("gg",In,zo);$e("GGGG",oP,rP);$e("gggg",oP,rP);$e("GGGGG",sR,rR);$e("ggggg",sR,rR);Bw(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,i){e[i.substr(0,2)]=Nt(t)});Bw(["gg","GG"],function(t,e,n,i){e[i]=Ce.parseTwoDigitYear(t)});function zre(t){return J6.call(this,t,this.week(),this.weekday()+this.localeData()._week.dow,this.localeData()._week.dow,this.localeData()._week.doy)}function Ure(t){return J6.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Yre(){return lu(this.year(),1,4)}function Gre(){return lu(this.isoWeekYear(),1,4)}function qre(){var t=this.localeData()._week;return lu(this.year(),t.dow,t.doy)}function Kre(){var t=this.localeData()._week;return lu(this.weekYear(),t.dow,t.doy)}function J6(t,e,n,i,r){var o;return t==null?uw(this,i,r).year:(o=lu(t,i,r),e>o&&(e=o),Xre.call(this,t,e,n,i,r))}function Xre(t,e,n,i,r){var o=I6(t,e,n,i,r),a=lw(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}Ke("Q",0,"Qo","quarter");$e("Q",b6);wn("Q",function(t,e){e[Jl]=(Nt(t)-1)*3});function Zre(t){return t==null?Math.ceil((this.month()+1)/3):this.month((t-1)*3+this.month()%3)}Ke("D",["DD",2],"Do","date");$e("D",In,ym);$e("DD",In,zo);$e("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient});wn(["D","DD"],Ka);wn("Do",function(t,e){e[Ka]=Nt(t.match(In)[0])});var e4=Sm("Date",!0);Ke("DDD",["DDDD",3],"DDDo","dayOfYear");$e("DDD",oR);$e("DDDD",C6);wn(["DDD","DDDD"],function(t,e,n){n._dayOfYear=Nt(t)});function Qre(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return t==null?e:this.add(t-e,"d")}Ke("m",["mm",2],0,"minute");$e("m",In,sP);$e("mm",In,zo);wn(["m","mm"],sa);var Jre=Sm("Minutes",!1);Ke("s",["ss",2],0,"second");$e("s",In,sP);$e("ss",In,zo);wn(["s","ss"],eu);var eoe=Sm("Seconds",!1);Ke("S",0,0,function(){return~~(this.millisecond()/100)});Ke(0,["SS",2],0,function(){return~~(this.millisecond()/10)});Ke(0,["SSS",3],0,"millisecond");Ke(0,["SSSS",4],0,function(){return this.millisecond()*10});Ke(0,["SSSSS",5],0,function(){return this.millisecond()*100});Ke(0,["SSSSSS",6],0,function(){return this.millisecond()*1e3});Ke(0,["SSSSSSS",7],0,function(){return this.millisecond()*1e4});Ke(0,["SSSSSSSS",8],0,function(){return this.millisecond()*1e5});Ke(0,["SSSSSSSSS",9],0,function(){return this.millisecond()*1e6});$e("S",oR,b6);$e("SS",oR,zo);$e("SSS",oR,C6);var xc,t4;for(xc="SSSS";xc.length<=9;xc+="S")$e(xc,wm);function toe(t,e){e[cd]=Nt(("0."+t)*1e3)}for(xc="S";xc.length<=9;xc+="S")wn(xc,toe);t4=Sm("Milliseconds",!1);Ke("z",0,0,"zoneAbbr");Ke("zz",0,0,"zoneName");function noe(){return this._isUTC?"UTC":""}function ioe(){return this._isUTC?"Coordinated Universal Time":""}var Me=$w.prototype;Me.add=Kie;Me.calendar=nre;Me.clone=ire;Me.diff=cre;Me.endOf=Sre;Me.format=gre;Me.from=mre;Me.fromNow=pre;Me.to=vre;Me.toNow=wre;Me.get=fne;Me.invalidAt=Ore;Me.isAfter=rre;Me.isBefore=ore;Me.isBetween=sre;Me.isSame=are;Me.isSameOrAfter=lre;Me.isSameOrBefore=ure;Me.isValid=Mre;Me.lang=q6;Me.locale=G6;Me.localeData=K6;Me.max=Mie;Me.min=_ie;Me.parsingFlags=Are;Me.set=gne;Me.startOf=yre;Me.subtract=Xie;Me.toArray=Ere;Me.toObject=Tre;Me.toDate=Rre;Me.toISOString=dre;Me.inspect=fre;typeof Symbol<"u"&&Symbol.for!=null&&(Me[Symbol.for("nodejs.util.inspect.custom")]=function(){return"Moment<"+this.format()+">"});Me.toJSON=_re;Me.toString=hre;Me.unix=Cre;Me.valueOf=bre;Me.creationData=xre;Me.eraName=Nre;Me.eraNarrow=Dre;Me.eraAbbr=Lre;Me.eraYear=kre;Me.year=T6;Me.isLeapYear=dne;Me.weekYear=zre;Me.isoWeekYear=Ure;Me.quarter=Me.quarters=Zre;Me.month=x6;Me.daysInMonth=Rne;Me.week=Me.weeks=Hne;Me.isoWeek=Me.isoWeeks=Ine;Me.weeksInYear=qre;Me.weeksInWeekYear=Kre;Me.isoWeeksInYear=Yre;Me.isoWeeksInISOWeekYear=Gre;Me.date=e4;Me.day=Me.days=Une;Me.weekday=Yne;Me.isoWeekday=Gne;Me.dayOfYear=Qre;Me.hour=Me.hours=eie;Me.minute=Me.minutes=Jre;Me.second=Me.seconds=eoe;Me.millisecond=Me.milliseconds=t4;Me.utcOffset=Lie;Me.utc=$ie;Me.local=Vie;Me.parseZone=Bie;Me.hasAlignedHourOffset=Fie;Me.isDST=Wie;Me.isLocal=zie;Me.isUtcOffset=Uie;Me.isUtc=j6;Me.isUTC=j6;Me.zoneAbbr=noe;Me.zoneName=ioe;Me.dates=Hs("dates accessor is deprecated. Use date instead.",e4);Me.months=Hs("months accessor is deprecated. Use month instead",x6);Me.years=Hs("years accessor is deprecated. Use year instead",T6);Me.zone=Hs("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",kie);Me.isDSTShifted=Hs("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",jie);function roe(t){return Hn(t*1e3)}function ooe(){return Hn.apply(null,arguments).parseZone()}function n4(t){return t}var qt=tP.prototype;qt.calendar=zte;qt.longDateFormat=qte;qt.invalidDate=Xte;qt.ordinal=Jte;qt.preparse=n4;qt.postformat=n4;qt.relativeTime=tne;qt.pastFuture=nne;qt.set=Wte;qt.eras=Hre;qt.erasParse=Ire;qt.erasConvertYear=Pre;qt.erasAbbrRegex=Vre;qt.erasNameRegex=$re;qt.erasNarrowRegex=Bre;qt.months=yne;qt.monthsShort=Sne;qt.monthsParse=Cne;qt.monthsRegex=Tne;qt.monthsShortRegex=Ene;qt.week=Mne;qt.firstDayOfYear=xne;qt.firstDayOfWeek=One;qt.weekdays=Bne;qt.weekdaysMin=Wne;qt.weekdaysShort=Fne;qt.weekdaysParse=zne;qt.weekdaysRegex=qne;qt.weekdaysShortRegex=Kne;qt.weekdaysMinRegex=Xne;qt.isPM=Qne;qt.meridiem=tie;function YC(t,e,n,i){var r=vu(),o=sl().set(i,e);return r[n](o,t)}function i4(t,e,n){if(hu(t)&&(e=t,t=void 0),t=t||"",e!=null)return YC(t,e,n,"month");var i,r=[];for(i=0;i<12;i++)r[i]=YC(t,i,n,"month");return r}function yP(t,e,n,i){typeof t=="boolean"?(hu(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,hu(e)&&(n=e,e=void 0),e=e||"");var r=vu(),o=t?r._week.dow:0,a,u=[];if(n!=null)return YC(e,(n+o)%7,i,"day");for(a=0;a<7;a++)u[a]=YC(e,(a+o)%7,i,"day");return u}function soe(t,e){return i4(t,e,"months")}function aoe(t,e){return i4(t,e,"monthsShort")}function loe(t,e,n){return yP(t,e,n,"weekdays")}function uoe(t,e,n){return yP(t,e,n,"weekdaysShort")}function coe(t,e,n){return yP(t,e,n,"weekdaysMin")}Dc("en",{eras:[{since:"0001-01-01",until:1/0,offset:1,name:"Anno Domini",narrow:"AD",abbr:"AD"},{since:"0000-12-31",until:-1/0,offset:1,name:"Before Christ",narrow:"BC",abbr:"BC"}],dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10,n=Nt(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th";return t+n}});Ce.lang=Hs("moment.lang is deprecated. Use moment.locale instead.",Dc);Ce.langData=Hs("moment.langData is deprecated. Use moment.localeData instead.",vu);var Ol=Math.abs;function hoe(){var t=this._data;return this._milliseconds=Ol(this._milliseconds),this._days=Ol(this._days),this._months=Ol(this._months),t.milliseconds=Ol(t.milliseconds),t.seconds=Ol(t.seconds),t.minutes=Ol(t.minutes),t.hours=Ol(t.hours),t.months=Ol(t.months),t.years=Ol(t.years),this}function r4(t,e,n,i){var r=ga(e,n);return t._milliseconds+=i*r._milliseconds,t._days+=i*r._days,t._months+=i*r._months,t._bubble()}function doe(t,e){return r4(this,t,e,1)}function foe(t,e){return r4(this,t,e,-1)}function Fj(t){return t<0?Math.floor(t):Math.ceil(t)}function goe(){var t=this._milliseconds,e=this._days,n=this._months,i=this._data,r,o,a,u,h;return t>=0&&e>=0&&n>=0||t<=0&&e<=0&&n<=0||(t+=Fj(AH(n)+e)*864e5,e=0,n=0),i.milliseconds=t%1e3,r=Cs(t/1e3),i.seconds=r%60,o=Cs(r/60),i.minutes=o%60,a=Cs(o/60),i.hours=a%24,e+=Cs(a/24),h=Cs(o4(e)),n+=h,e-=Fj(AH(h)),u=Cs(n/12),n%=12,i.days=e,i.months=n,i.years=u,this}function o4(t){return t*4800/146097}function AH(t){return t*146097/4800}function moe(t){if(!this.isValid())return NaN;var e,n,i=this._milliseconds;if(t=Is(t),t==="month"||t==="quarter"||t==="year")switch(e=this._days+i/864e5,n=this._months+o4(e),t){case"month":return n;case"quarter":return n/3;case"year":return n/12}else switch(e=this._days+Math.round(AH(this._months)),t){case"week":return e/7+i/6048e5;case"day":return e+i/864e5;case"hour":return e*24+i/36e5;case"minute":return e*1440+i/6e4;case"second":return e*86400+i/1e3;case"millisecond":return Math.floor(e*864e5)+i;default:throw new Error("Unknown unit "+t)}}function wu(t){return function(){return this.as(t)}}var s4=wu("ms"),poe=wu("s"),voe=wu("m"),woe=wu("h"),yoe=wu("d"),Soe=wu("w"),boe=wu("M"),Coe=wu("Q"),Roe=wu("y"),Eoe=s4;function Toe(){return ga(this)}function _oe(t){return t=Is(t),this.isValid()?this[t+"s"]():NaN}function Vd(t){return function(){return this.isValid()?this._data[t]:NaN}}var Moe=Vd("milliseconds"),Aoe=Vd("seconds"),Ooe=Vd("minutes"),xoe=Vd("hours"),Hoe=Vd("days"),Ioe=Vd("months"),Poe=Vd("years");function Noe(){return Cs(this.days()/7)}var Yl=Math.round,Mg={ss:44,s:45,m:45,h:22,d:26,w:null,M:11};function Doe(t,e,n,i,r){return r.relativeTime(e||1,!!n,t,i)}function Loe(t,e,n,i){var r=ga(t).abs(),o=Yl(r.as("s")),a=Yl(r.as("m")),u=Yl(r.as("h")),h=Yl(r.as("d")),d=Yl(r.as("M")),g=Yl(r.as("w")),m=Yl(r.as("y")),v=o<=n.ss&&["s",o]||o<n.s&&["ss",o]||a<=1&&["m"]||a<n.m&&["mm",a]||u<=1&&["h"]||u<n.h&&["hh",u]||h<=1&&["d"]||h<n.d&&["dd",h];return n.w!=null&&(v=v||g<=1&&["w"]||g<n.w&&["ww",g]),v=v||d<=1&&["M"]||d<n.M&&["MM",d]||m<=1&&["y"]||["yy",m],v[2]=e,v[3]=+t>0,v[4]=i,Doe.apply(null,v)}function koe(t){return t===void 0?Yl:typeof t=="function"?(Yl=t,!0):!1}function $oe(t,e){return Mg[t]===void 0?!1:e===void 0?Mg[t]:(Mg[t]=e,t==="s"&&(Mg.ss=e-1),!0)}function Voe(t,e){if(!this.isValid())return this.localeData().invalidDate();var n=!1,i=Mg,r,o;return typeof t=="object"&&(e=t,t=!1),typeof t=="boolean"&&(n=t),typeof e=="object"&&(i=Object.assign({},Mg,e),e.s!=null&&e.ss==null&&(i.ss=e.s-1)),r=this.localeData(),o=Loe(this,!n,i,r),n&&(o=r.pastFuture(+this,o)),r.postformat(o)}var nA=Math.abs;function _f(t){return(t>0)-(t<0)||+t}function fR(){if(!this.isValid())return this.localeData().invalidDate();var t=nA(this._milliseconds)/1e3,e=nA(this._days),n=nA(this._months),i,r,o,a,u=this.asSeconds(),h,d,g,m;return u?(i=Cs(t/60),r=Cs(i/60),t%=60,i%=60,o=Cs(n/12),n%=12,a=t?t.toFixed(3).replace(/\.?0+$/,""):"",h=u<0?"-":"",d=_f(this._months)!==_f(u)?"-":"",g=_f(this._days)!==_f(u)?"-":"",m=_f(this._milliseconds)!==_f(u)?"-":"",h+"P"+(o?d+o+"Y":"")+(n?d+n+"M":"")+(e?g+e+"D":"")+(r||i||t?"T":"")+(r?m+r+"H":"")+(i?m+i+"M":"")+(t?m+a+"S":"")):"P0D"}var Bt=hR.prototype;Bt.isValid=Iie;Bt.abs=hoe;Bt.add=doe;Bt.subtract=foe;Bt.as=moe;Bt.asMilliseconds=s4;Bt.asSeconds=poe;Bt.asMinutes=voe;Bt.asHours=woe;Bt.asDays=yoe;Bt.asWeeks=Soe;Bt.asMonths=boe;Bt.asQuarters=Coe;Bt.asYears=Roe;Bt.valueOf=Eoe;Bt._bubble=goe;Bt.clone=Toe;Bt.get=_oe;Bt.milliseconds=Moe;Bt.seconds=Aoe;Bt.minutes=Ooe;Bt.hours=xoe;Bt.days=Hoe;Bt.weeks=Noe;Bt.months=Ioe;Bt.years=Poe;Bt.humanize=Voe;Bt.toISOString=fR;Bt.toString=fR;Bt.toJSON=fR;Bt.locale=G6;Bt.localeData=K6;Bt.toIsoString=Hs("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",fR);Bt.lang=q6;Ke("X",0,0,"unix");Ke("x",0,0,"valueOf");$e("x",aR);$e("X",sne);wn("X",function(t,e,n){n._d=new Date(parseFloat(t)*1e3)});wn("x",function(t,e,n){n._d=new Date(Nt(t))});//! moment.js
Ce.version="2.30.1";Bte(Hn);Ce.fn=Me;Ce.min=Aie;Ce.max=Oie;Ce.now=xie;Ce.utc=sl;Ce.unix=roe;Ce.months=soe;Ce.isDate=kw;Ce.locale=Dc;Ce.invalid=iR;Ce.duration=ga;Ce.isMoment=ca;Ce.weekdays=loe;Ce.parseZone=ooe;Ce.localeData=vu;Ce.isDuration=hC;Ce.monthsShort=aoe;Ce.weekdaysMin=coe;Ce.defineLocale=hP;Ce.updateLocale=oie;Ce.locales=sie;Ce.weekdaysShort=uoe;Ce.normalizeUnits=Is;Ce.relativeTimeRounding=koe;Ce.relativeTimeThreshold=$oe;Ce.calendarFormat=tre;Ce.prototype=Me;Ce.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"GGGG-[W]WW",MONTH:"YYYY-MM"};var Wj={},jj={},zj;function Boe(){if(zj)return jj;zj=1;var t=Cn(),e=vm(),n=uo(),i=Hi(),r=ol(),o=co(),a=jc(),u=Nw(),h=Ai(),d=TypeError,g=h(function(){[].keys().reduce(function(){},void 0)}),m=!g&&a("reduce",d);return t({target:"Iterator",proto:!0,real:!0,forced:g||m},{reduce:function(y){i(this);try{n(y)}catch(A){o(this,"throw",A)}var b=arguments.length<2,C=b?void 0:arguments[1];if(m)return u(m,this,b?[y]:[y,C]);var T=r(this),O=0;if(e(T,function(A){b?(b=!1,C=A):C=y(C,A,O),O++},{IS_RECORD:!0}),b)throw new d("Reduce of empty iterator with no initial value");return C}}),jj}var Uj;function Foe(){return Uj||(Uj=1,Boe()),Wj}Foe();function Woe(t){const e=t.length;let n=0;for(;n<e;)t[n]=[t[n]],n+=1}function Yj(t,e){const n=e.length;let i=0;for(;i<n;)t.push(e[i]),i+=1}function fC(t){const e=[];if(!t||t.length===0||!t[0]||t[0].length===0)return e;const n=t.length,i=t[0].length;for(let r=0;r<n;r++)for(let o=0;o<i;o++)e[o]||(e[o]=[]),e[o][r]=t[r][o];return e}function ho(t,e,n,i){let r=-1,o=t,a=n;Array.isArray(t)||(o=Array.from(t));const u=o.length;for(r+=1;r<u;)a=e(a,o[r],r,o),r+=1;return a}function Rd(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let a=-1;for(;n<r;){const u=i[n];e(u,n,i)&&(a+=1,o[a]=u),n+=1}return o}function Vt(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length,o=[];let a=-1;for(;n<r;){const u=i[n];a+=1,o[a]=e(u,n,i),n+=1}return o}function U(t,e){let n=0,i=t;Array.isArray(t)||(i=Array.from(t));const r=i.length;for(;n<r&&e(i[n],n,i)!==!1;)n+=1;return t}function joe(t){const e=[];return U(t,n=>{e.indexOf(n)===-1&&e.push(n)}),e}function Gj(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];const[i,...r]=[...e];let o=i;return U(r,a=>{o=o.filter(u=>!a.includes(u))}),o}function qj(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:" ";return t.split(e)}function Ft(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return ho(t,(o,a,u)=>{const h=a.replace(/\r?\n\s*/g,""),d=n[u]?n[u]:"";return o+h+d},"").trim()}function a4(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];const r=document.createElement("template");r.innerHTML=t.reduce((u,h,d)=>{var g;return u+h+((g=n[d])!==null&&g!==void 0?g:"")},"");const o=r.content.cloneNode(!0),a={};return o.querySelectorAll("[data-ref]").forEach(u=>{const h=u.getAttribute("data-ref");u.removeAttribute("data-ref"),a[h]=u}),{fragment:o,refs:a}}function xn(t){let e;switch(typeof t){case"string":case"number":e=`${t}`;break;case"object":e=t===null?"":t.toString();break;case"undefined":e="";break;default:e=t.toString();break}return e}function Ne(t){return typeof t<"u"}function $n(t){return typeof t>"u"}function ni(t){return t===null||t===""||$n(t)}function zoe(t){return Object.prototype.toString.call(t)==="[object RegExp]"}const Rv="length",Dv=t=>parseInt(t,16),Kj=t=>parseInt(t,10),GC=(t,e,n)=>t.substr(e,n),Lv=t=>t.codePointAt(0)-65,OH=t=>`${t}`.replace(/\-/g,""),Uoe=t=>Dv(GC(OH(t),Dv("12"),Lv("F")))/(Dv(GC(OH(t),Lv("B"),~~![][Rv]))||9),Yoe=()=>typeof location<"u"&&/^([a-z0-9\-]+\.)?\x68\x61\x6E\x64\x73\x6F\x6E\x74\x61\x62\x6C\x65\x2E\x63\x6F\x6D$/i.test(location.host);let Xj=!1;const Zj={invalid:()=>Ft`
    The license key for Handsontable is invalid.\x20
    If you need any help, contact us at support@handsontable.com.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. Renew your license key at handsontable.com or downgrade to a version released prior\x20
    to ${e}. If you need any help, contact us at sales@handsontable.com.`},missing:()=>Ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'. If you need any help, contact\x20
    us at support@handsontable.com.`,non_commercial:()=>""},Qj={invalid:()=>Ft`
    The license key for Handsontable is invalid.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> on how to\x20
    install it properly or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,expired:t=>{let{keyValidityDate:e,hotVersion:n}=t;return Ft`
    The license key for Handsontable expired on ${e}, and is not valid for the installed\x20
    version ${n}. <a href="https://handsontable.com/pricing" target="_blank">Renew</a> your\x20
    license key or downgrade to a version released prior to ${e}. If you need any\x20
    help, contact us at <a href="mailto:sales@handsontable.com">sales@handsontable.com</a>.`},missing:()=>Ft`
    The license key for Handsontable is missing. Use your purchased key to activate the product.\x20
    Alternatively, you can activate Handsontable to use for non-commercial purposes by\x20
    passing the key: 'non-commercial-and-evaluation'.\x20
    <a href="https://handsontable.com/docs/tutorial-license-key.html" target="_blank">Read more</a> about it in\x20
    the documentation or contact us at <a href="mailto:support@handsontable.com">support@handsontable.com</a>.`,non_commercial:()=>""};function Goe(t,e){const n=!ni(t),i=typeof t=="string"&&t.toLowerCase()==="non-commercial-and-evaluation",r="16.1.1";let o,a="invalid",u="invalid";t=OH(t||"");const h=qoe(t);if(n||i||h)if(h){const d=Ce("23/09/2025","DD/MM/YYYY"),g=Math.floor(d.toDate().getTime()/864e5),m=Uoe(t);o=Ce((m+1)*864e5,"x").format("MMMM DD, YYYY"),g>m?(a="expired",u="expired"):(a="valid",u="valid")}else i?(a="non_commercial",u="valid"):(a="invalid",u="invalid");else a="missing",u="missing";if(Yoe()&&(a="valid",u="valid"),!Xj&&a!=="valid"&&(Zj[a]({keyValidityDate:o,hotVersion:r})&&console[a==="non_commercial"?"info":"warn"](Zj[a]({keyValidityDate:o,hotVersion:r})),Xj=!0),u!=="valid"&&e&&Qj[u]({keyValidityDate:o,hotVersion:r})){const g=document.createElement("div");g.className="handsontable hot-display-license-info",g.innerHTML=Qj[u]({keyValidityDate:o,hotVersion:r}),e.appendChild(g)}}function qoe(t){let e=[][Rv],n=e;if(t[Rv]!==Lv("Z"))return!1;for(let i="",r="B<H4P+".split(""),o=Lv(r.shift());o;o=Lv(r.shift()||"A"))--o<""[Rv]?n=n|(Kj(`${Kj(Dv(i)+(Dv(GC(t,Math.abs(o),2))+[]).padStart(2,"0"))}`)%97||2)>>1:i=GC(t,o,o?r[Rv]===1?9:8:6);return n===e}function xH(t){const{rowIndexMapper:e,columnIndexMapper:n}=t,{navigableHeaders:i}=t.getSettings();let r=i&&t.countColHeaders()>0?-t.countColHeaders():0,o=i&&t.countRowHeaders()>0?-t.countRowHeaders():0;return r===0&&(r=e.getVisualFromRenderableIndex(r)),o===0&&(o=n.getVisualFromRenderableIndex(o)),r===null||o===null?null:t._createCellCoords(r,o)}function HH(t){var e,n;const{rowIndexMapper:i,columnIndexMapper:r}=t,{navigableHeaders:o}=t.getSettings();let a=i.getRenderableIndexesLength()-1,u=r.getRenderableIndexesLength()-1;if(a<0){if(!o||t.countColHeaders()===0)return null;a=-1}if(u<0){if(!o||t.countColHeaders()===0)return null;u=-1}return t._createCellCoords((e=i.getVisualFromRenderableIndex(a))!==null&&e!==void 0?e:a,(n=r.getVisualFromRenderableIndex(u))!==null&&n!==void 0?n:u)}function ha(t){return t[0].toUpperCase()+t.substr(1)}function l4(){function t(){return Math.floor((1+Math.random())*65536).toString(16).substring(1)}return t()+t()+t()+t()}function Koe(t){if(typeof t!="string")return!1;try{const e=JSON.parse(t);return typeof e=="object"&&e!==null}catch{return!1}}function u4(t){return/^([0-9][0-9]?%$)|(^100%$)/.test(t)}function SP(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return`${t}`.replace(/(?:\\)?\[([^[\]]+)]/g,(n,i)=>n.charAt(0)==="\\"?n.substr(1,n.length-1):e[i]===void 0?"":e[i])}function iA(t){return bP(`${t}`,{ALLOWED_TAGS:[]})}function bP(t,e){return Vte.sanitize(t,e)}const lo=t=>["tabindex",t],Xoe=()=>["role","treegrid"],tu=()=>["role","presentation"],Zoe=()=>["role","gridcell"],Qoe=()=>["role","gridcell button"],Joe=()=>["role","rowheader"],c4=()=>["role","rowgroup"],ese=()=>["role","columnheader"],h4=()=>["role","row"],tse=()=>["role","menu"],nse=()=>["role","menuitem"],ise=()=>["role","menuitemcheckbox"],rse=()=>["role","combobox"],d4=()=>["role","listbox"],ose=()=>["role","option"],sse=()=>["role","checkbox"],ase=()=>["role","dialog"],lse=()=>["role","alertdialog"],use=()=>["scope","col"],cse=()=>["scope","row"],hse=()=>["type","text"],Bo=t=>["aria-label",t],dse=t=>["aria-labelledby",t],fse=t=>["aria-describedby",t],Bd=()=>["aria-hidden","true"],Ev=function(){return["aria-disabled",arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0]},gse=()=>["aria-multiselectable","true"],f4=t=>["aria-haspopup",t],g4=t=>["aria-rowcount",t],gR=t=>["aria-colcount",t],m4=t=>["aria-rowindex",t],CP=t=>["aria-colindex",t],Ts=t=>["aria-expanded",t],mse=t=>["aria-sort",t],Jj=()=>["aria-readonly","true"],ez=()=>["aria-invalid","true"],p4=t=>["aria-checked",t],RP=()=>["aria-selected","true"],pse=()=>["aria-autocomplete","list"],vse=t=>["aria-controls",t],wse=t=>["aria-activedescendant",t],yse=t=>["aria-live",t],Sse=t=>["aria-relevant",t],bse=t=>["aria-setsize",t],Cse=t=>["aria-posinset",t],Rse=()=>["aria-modal","true"];var tz={},rA,nz;function Ese(){if(nz)return rA;nz=1;var t=gi(),e=Qq(),n=xi(),i=Nd(),r=nR(),o=t([].push);return rA=function(a){if(n(a))return a;if(e(a)){for(var u=a.length,h=[],d=0;d<u;d++){var g=a[d];typeof g=="string"?o(h,g):(typeof g=="number"||i(g)==="Number"||i(g)==="String")&&o(h,r(g))}var m=h.length,v=!0;return function(y,b){if(v)return v=!1,b;if(e(this))return b;for(var C=0;C<m;C++)if(h[C]===y)return b}}},rA}var iz;function Tse(){if(iz)return tz;iz=1;var t=Cn(),e=fm(),n=Nw(),i=Oi(),r=gi(),o=Ai(),a=xi(),u=$I(),h=ZI(),d=Ese(),g=kI(),m=String,v=e("JSON","stringify"),y=r(/./.exec),b=r("".charAt),C=r("".charCodeAt),T=r("".replace),O=r(1.1.toString),A=/[\uD800-\uDFFF]/g,N=/^[\uD800-\uDBFF]$/,x=/^[\uDC00-\uDFFF]$/,$=!g||o(function(){var ue=e("Symbol")("stringify detection");return v([ue])!=="[null]"||v({a:ue})!=="{}"||v(Object(ue))!=="{}"}),L=o(function(){return v("\uDF06\uD834")!=='"\\udf06\\ud834"'||v("\uDEAD")!=='"\\udead"'}),P=function(ue,X){var me=h(arguments),re=d(X);if(!(!a(re)&&(ue===void 0||u(ue))))return me[1]=function(Se,we){if(a(re)&&(we=i(re,this,m(Se),we)),!u(we))return we},n(v,null,me)},Q=function(ue,X,me){var re=b(me,X-1),Se=b(me,X+1);return y(N,ue)&&!y(x,Se)||y(x,ue)&&!y(N,re)?"\\u"+O(C(ue,0),16):ue};return v&&t({target:"JSON",stat:!0,arity:3,forced:$||L},{stringify:function(X,me,re){var Se=h(arguments),we=n($?P:v,null,Se);return L&&typeof we=="string"?T(we,A,Q):we}}),tz}Tse();function hw(t){let e;return Array.isArray(t)?e=t.length?new Array(t.length).fill(null):[]:(e={},wt(t,(n,i)=>{i!=="__children"&&(n&&typeof n=="object"&&!Array.isArray(n)?e[i]=hw(n):Array.isArray(n)?n.length&&typeof n[0]=="object"&&!Array.isArray(n[0])?e[i]=[hw(n[0])]:e[i]=[]:e[i]=null)})),e}function _se(t,e){return e.prototype.constructor=e,t.prototype=new e,t.prototype.constructor=t,t}function Mi(t,e,n){const i=Array.isArray(n);return wt(e,(r,o)=>{(i===!1||n.includes(o))&&(t[o]=r)}),t}function mR(t,e){wt(e,(n,i)=>{e[i]&&typeof e[i]=="object"?(t[i]||(Array.isArray(e[i])?t[i]=[]:Object.prototype.toString.call(e[i])==="[object Date]"?t[i]=e[i]:t[i]={}),mR(t[i],e[i])):t[i]=e[i]})}function Nr(t){return typeof t=="object"?JSON.parse(JSON.stringify(t)):t}function il(t){const e={};return wt(t,(n,i)=>{e[i]=n}),e}function en(t){t.MIXINS||(t.MIXINS=[]);for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return U(n,r=>{t.MIXINS.push(r.MIXIN_NAME),wt(r,(o,a)=>{if(t.prototype[a]!==void 0)throw new Error(`Mixin conflict. Property '${a}' already exist and cannot be overwritten.`);if(typeof o=="function")t.prototype[a]=o;else{const u=function(g,m){const v=`_${g}`,y=b=>{let C=b;return(Array.isArray(C)||Qe(C))&&(C=Nr(C)),C};return function(){return this[v]===void 0&&(this[v]=y(m)),this[v]}},h=function(g){const m=`_${g}`;return function(v){this[m]=v}};Object.defineProperty(t.prototype,a,{get:u(a,o),set:h(a),configurable:!0})}})}),t}function pR(t,e){return JSON.stringify(t)===JSON.stringify(e)}function Qe(t){return Object.prototype.toString.call(t)==="[object Object]"}function yu(t,e,n,i){i.value=n,i.writable=i.writable!==!1,i.enumerable=i.enumerable!==!1,i.configurable=i.configurable!==!1,Object.defineProperty(t,e,i)}function wt(t,e){for(const n in t)if((!t.hasOwnProperty||t.hasOwnProperty&&Object.prototype.hasOwnProperty.call(t,n))&&e(t[n],n,t)===!1)break;return t}function IH(t,e){const n=e.split(".");let i=t;return wt(n,r=>{if(i=i[r],i===void 0)return i=void 0,!1}),i}function oA(t,e,n){if(typeof e!="string")return;const i=e.split(".");let r=t;i.forEach((o,a)=>{o==="__proto__"||o==="constructor"||o==="prototype"||(a!==i.length-1?(ti(r,o)||(r[o]={}),r=r[o]):r[o]=n)})}function EP(t){if(!Qe(t))return 0;const e=function(n){let i=0;return Qe(n)?wt(n,(r,o)=>{o!=="__children"&&(i+=e(r))}):i+=1,i};return e(t)}function Wo(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"value";const n=`_${e}`,i={_touched:!1,[n]:t,isTouched(){return this._touched}};return Object.defineProperty(i,e,{get(){return this[n]},set(r){this._touched=!0,this[n]=r},enumerable:!0,configurable:!0}),i}function ti(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function gC(t,e){if(typeof t!="object"||t===null)return e;if(typeof e!="object"||e===null)return t;const n={};return Object.keys(e).forEach(i=>{typeof e[i]=="object"&&e[i]!==null&&!Array.isArray(e[i])?n[i]=gC(t[i],e[i]):n[i]=ti(t,i)&&t[i]!==void 0?t[i]:e[i]}),Object.keys(t).forEach(i=>{ti(n,i)||(n[i]=t[i])}),n}function qC(t){return window.requestAnimationFrame(t)}function KC(t){window.cancelAnimationFrame(t)}function v4(){return"ontouchstart"in window}function Mse(){return typeof window<"u"}let Mf;function Ase(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return Mf||(typeof Intl=="object"?Mf=new Intl.Collator(t,e).compare:typeof String.prototype.localeCompare=="function"?Mf=(n,i)=>`${n}`.localeCompare(i):Mf=(n,i)=>n===i?0:n>i?-1:1,Mf)}const ps=t=>{const e={value:!1};return e.test=(n,i)=>{e.value=t(n,i)},e},zc={chrome:ps((t,e)=>/Chrome/.test(t)&&/Google/.test(e)),chromeWebKit:ps(t=>/CriOS/.test(t)),edge:ps(t=>/Edge/.test(t)),edgeWebKit:ps(t=>/EdgiOS/.test(t)),firefox:ps(t=>/Firefox/.test(t)),firefoxWebKit:ps(t=>/FxiOS/.test(t)),mobile:ps(t=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)),safari:ps((t,e)=>/Safari/.test(t)&&/Apple Computer/.test(e))},Fw={mac:ps(t=>/^Mac/.test(t)),win:ps(t=>/^Win/.test(t)),linux:ps(t=>/^Linux/.test(t)),ios:ps(t=>/iPhone|iPad|iPod/i.test(t))};function Ose(){let{userAgent:t=navigator.userAgent,vendor:e=navigator.vendor}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wt(zc,n=>{let{test:i}=n;return void i(t,e)})}function xse(){let{platform:t=navigator.platform}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};wt(Fw,e=>{let{test:n}=e;return void n(t)})}Mse()&&(Ose(),xse());function w4(){return zc.chrome.value}function Hse(){return zc.chromeWebKit.value}function sA(){return zc.firefox.value}function Ise(){return zc.firefoxWebKit.value}function vR(){return zc.safari.value}function Pse(){return zc.edge.value}function el(){return zc.mobile.value}function y4(){return Fw.ios.value}function S4(){let{maxTouchPoints:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:navigator;return t>2&&Fw.mac.value}function PH(){return Fw.win.value}function rz(){return Fw.mac.value}function Nse(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=-1,i=null,r=t;for(;r!==null;){if(n===e){i=r;break}r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:(n+=1,r=r.parentNode)}return i}function mC(t,e){const n=t.closest(".handsontable");return!!n&&(n.parentNode===e||n===e)}function Dse(t){return Object.getPrototypeOf(t.parent)&&t.frameElement}function Zg(t){return Dse(t)&&t.parent}function Ed(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;const{ELEMENT_NODE:i,DOCUMENT_FRAGMENT_NODE:r}=Node;let o=t;for(;o!=null&&o!==n;){const{nodeType:a,nodeName:u}=o;if(a===i&&(e.includes(u)||e.includes(o)))return o;const{host:h}=o;h&&a===r?o=h:o=o.parentNode}return null}function TS(t,e,n){const i=[];let r=t;for(;r&&(r=Ed(r,e,n),!(!r||n&&!n.contains(r)));)i.push(r),r.host&&r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?r=r.host:r=r.parentNode;const o=i.length;return o?i[o-1]:null}function Lse(t,e){const n={element:void 0,classNames:[]};let i=t;for(;i!==null&&i!==t.ownerDocument.documentElement&&!n.element;){if(typeof e=="string"&&i.classList.contains(e))n.element=i,n.classNames.push(e);else if(e instanceof RegExp){const r=Array.from(i.classList).filter(o=>e.test(o));r.length&&(n.element=i,n.classNames.push(...r))}i=i.parentElement}return n}function bd(t,e){let n=t.parentNode,i=[];for(typeof e=="string"?t.defaultView?i=Array.prototype.slice.call(t.querySelectorAll(e),0):i=Array.prototype.slice.call(t.ownerDocument.querySelectorAll(e),0):i.push(e);n!==null;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1}function kse(t){let e=0,n=t;if(n.previousSibling)for(;n=n.previousSibling;)e+=1;return e}function fh(t,e,n){const i=n.parentElement.querySelector(`.ht_clone_${t}`);return i?i.contains(e):null}function b4(t){return!t||!t.length?[]:t.filter(e=>!!e)}function C4(t,e){if(!t||!t.length)return{regexFree:[],regexes:[]};const n=[],i=[];return i.push(...t.filter(r=>{const o=r instanceof RegExp;return o&&e&&n.push(r),!o})),{regexFree:i,regexes:n}}function Xe(t,e){return t.classList===void 0||typeof e!="string"||e===""?!1:t.classList.contains(e)}function fe(t,e){typeof e=="string"&&(e=e.split(" ")),e=b4(e),e.length>0&&t.classList.add(...e)}function Ve(t,e){typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);let{regexFree:n,regexes:i}=C4(e,!0);n=b4(n),n.length>0&&t.classList.remove(...n),i.forEach(r=>{t.classList.forEach(o=>{r.test(o)&&t.classList.remove(o)})})}function We(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2?arguments[2]:void 0;Array.isArray(e)||(e=[[e,n]]),e.forEach(i=>{Array.isArray(i)&&i[0]!==""&&t.setAttribute(...i)})}function uu(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];typeof e=="string"?e=e.split(" "):e instanceof RegExp&&(e=[e]);const{regexFree:n,regexes:i}=C4(e,!0);n.forEach(r=>{r!==""&&t.removeAttribute(r)}),i.forEach(r=>{t.getAttributeNames().forEach(o=>{r.test(o)&&t.removeAttribute(o)})})}function R4(t){if(t.nodeType===3)t.parentNode.removeChild(t);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(t.nodeName)>-1){const e=t.childNodes;for(let n=e.length-1;n>=0;n--)R4(e[n])}}function du(t){let e;for(;e=t.lastChild;)t.removeChild(e)}const $se=/(<(.*)>|&(.*);)/;function Fd(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;$se.test(e)?t.innerHTML=n?bP(e):e:Td(t,e)}function Td(t,e){const n=t.firstChild;n&&n.nodeType===3&&n.nextSibling===null?n.textContent=e:(du(t),t.appendChild(t.ownerDocument.createTextNode(e)))}function Qg(t){const e=t.ownerDocument.documentElement,n=t.ownerDocument.defaultView;let i=t;for(;i!==e;){if(i===null)return!1;if(i.nodeType===Node.DOCUMENT_FRAGMENT_NODE)if(i.host){if(i.host.impl)return Qg(i.host.impl);if(i.host)return Qg(i.host);throw new Error("Lost in Web Components world")}else return!1;else if(n.getComputedStyle(i).display==="none")return!1;i=i.parentNode}return!0}function Vse(t){const n=t.ownerDocument.defaultView;let i=t;for(;i.parentNode;){if(i.style.height==="0px"||i.style.height==="0")return n.getComputedStyle(i).overflow==="hidden";i=i.parentNode}return!1}function pr(t){const e=t.ownerDocument,n=e.defaultView,i=e.documentElement;let r=t,o,a,u;for(o=r.offsetLeft,a=r.offsetTop,u=r;(r=r.offsetParent)&&!(r===e.body||!("offsetLeft"in r));)o+=r.offsetLeft,a+=r.offsetTop,u=r;return u&&u.style.position==="fixed"&&(o+=n.pageXOffset||i.scrollLeft,a+=n.pageYOffset||i.scrollTop),{left:o,top:a}}function E4(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollY}function TP(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:window).scrollX}function _P(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?E4(e):t.scrollTop}function T4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;return t===e?TP(e):t.scrollLeft}function XC(t){let e=t.ownerDocument,n=e?e.defaultView:void 0;e||(e=t.document?t.document:t,n=e.defaultView);const i=["auto","scroll"];let r=t.parentNode;for(;r&&r.style&&e.body!==r;){let{overflow:o,overflowX:a,overflowY:u}=r.style;if([o,a,u].includes("scroll"))return r;if({overflow:o,overflowX:a,overflowY:u}=n.getComputedStyle(r),i.includes(o)||i.includes(a)||i.includes(u)||r.clientHeight<=r.scrollHeight+1&&(i.includes(u)||i.includes(o))||r.clientWidth<=r.scrollWidth+1&&(i.includes(a)||i.includes(o)))return r;r=r.parentNode}return n}function Bse(t){return t.scrollHeight-t.clientHeight}function Fse(t){return t.scrollWidth-t.clientWidth}function dw(t){const e=t.ownerDocument,n=e.defaultView;let i=t.parentNode;for(;i&&i.style&&e.body!==i;){if(i.style.overflow!=="visible"&&i.style.overflow!=="")return i;const r=n.getComputedStyle(i),o=["scroll","hidden","auto"],a=r.getPropertyValue("overflow"),u=r.getPropertyValue("overflow-y"),h=r.getPropertyValue("overflow-x");if(o.includes(a)||o.includes(u)||o.includes(h))return i;i=i.parentNode}return n}function ZC(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:window;if(t){if(t===n)return e==="width"?`${n.innerWidth}px`:e==="height"?`${n.innerHeight}px`:void 0}else return;const i=t.style[e];if(i!==""&&i!==void 0)return i;const r=n.getComputedStyle(t);if(r[e]!==""&&r[e]!==void 0)return r[e]}function hi(t){return t.offsetWidth}function Ti(t){return t.getBoundingClientRect().height}function kv(t){return t.clientHeight||t.innerHeight}function _4(t){return t.clientWidth||t.innerWidth}function M4(t){return t.selectionStart?t.selectionStart:0}function Wse(t){return t.selectionEnd?t.selectionEnd:0}function oz(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window;t.getSelection&&(t.getSelection().empty?t.getSelection().empty():t.getSelection().removeAllRanges&&t.getSelection().removeAllRanges())}function wR(t,e,n){if(n===void 0&&(n=e),t.setSelectionRange){t.focus();try{t.setSelectionRange(e,n)}catch{const r=t.parentNode,o=r.style.display;r.style.display="block",t.setSelectionRange(e,n),r.style.display=o}}}let aA;function jse(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return PH()?Number.isInteger(t.defaultView.devicePixelRatio||1)?0:2:0}function zse(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;const e=t.createElement("div");e.style.height="200px",e.style.width="100%";const n=t.createElement("div");vR()&&!el()&&n.classList.add("htScrollbarSafariTest"),n.style.boxSizing="content-box",n.style.height="150px",n.style.left="0px",n.style.overflow="hidden",n.style.position="absolute",n.style.top="0px",n.style.width="200px",n.style.visibility="hidden",n.appendChild(e),(t.body||t.documentElement).appendChild(n);const i=e.getBoundingClientRect().width;n.style.overflow="scroll";let r=e.getBoundingClientRect().width;return i===r&&(r=n.clientWidth),(t.body||t.documentElement).removeChild(n),parseFloat((i-r).toFixed(3))}function _i(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:document;return aA===void 0&&(aA=zse(t)),aA}function A4(t){return t instanceof Window?t.document.body.scrollHeight>t.innerHeight:t.offsetWidth!==t.clientWidth}function O4(t){return t instanceof Window?t.document.body.scrollWidth>t.innerWidth:t.offsetHeight!==t.clientHeight}function MP(t,e,n){t.style.transform=`translate3d(${e},${n},0)`}function yR(t){t.style.transform&&t.style.transform!==""&&(t.style.transform="")}function pC(t){return t&&(["INPUT","SELECT","TEXTAREA"].indexOf(t.nodeName)>-1||t.contentEditable==="true")}function x4(t){return pC(t)&&t.hasAttribute("data-hot-input")===!1}function H4(t){return!t.parentNode}function Use(t,e){new IntersectionObserver((i,r)=>{i.forEach(o=>{o.isIntersecting&&t.offsetParent!==null&&(e(),r.unobserve(t))})},{root:t.ownerDocument.body}).observe(t)}function I4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const i=t.ownerDocument,r=i.createRange(),o=i.defaultView.getSelection();We(t,"contenteditable",!0),n&&We(t,...Bd()),e&&fe(t,"invisibleSelection"),r.selectNodeContents(t),o.removeAllRanges(),o.addRange(r)}function P4(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const n=t.ownerDocument.defaultView.getSelection();t.hasAttribute("aria-hidden")&&t.removeAttribute("aria-hidden"),n.removeAllRanges(),e&&Ve(t,"invisibleSelection"),t.removeAttribute("contenteditable")}function Yse(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;I4(t,n),e(),P4(t,n)}function cu(t){var e;const n=t==null||(e=t.ownerDocument)===null||e===void 0?void 0:e.defaultView.Element;return!!(n&&n!==null&&t instanceof n)}function Yt(t){return typeof t=="function"}function SR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200,n=null,i;function r(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return n&&clearTimeout(n),n=setTimeout(()=>{i=t.apply(this,a)},e),i}return r}function N4(t){for(var e=arguments.length,n=new Array(e>1?e-1:0),i=1;i<e;i++)n[i-1]=arguments[i];return function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return t.apply(this,n.concat(a))}}function Gse(t){const e=t.length;function n(i){return function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];const h=i.concat(a);let d;return h.length>=e?d=t.apply(this,h):d=n(h),d}}return n([])}function NH(t,e,n,i,r,o,a,u){return Ne(u)?t.call(e,n,i,r,o,a,u):Ne(a)?t.call(e,n,i,r,o,a):Ne(o)?t.call(e,n,i,r,o):Ne(r)?t.call(e,n,i,r):Ne(i)?t.call(e,n,i):Ne(n)?t.call(e,n):t.call(e)}const Ge={ALT:18,ARROW_DOWN:40,ARROW_LEFT:37,ARROW_RIGHT:39,ARROW_UP:38,AUDIO_DOWN:sA()?182:174,AUDIO_MUTE:sA()?181:173,AUDIO_UP:sA()?183:175,BACKSPACE:8,CAPS_LOCK:20,COMMA:188,COMMAND_LEFT:91,COMMAND_RIGHT:93,COMMAND_FIREFOX:224,CONTROL:17,DELETE:46,END:35,ENTER:13,ESCAPE:27,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,F13:124,F14:125,F15:126,F16:127,F17:128,F18:129,F19:130,HOME:36,INSERT:45,MEDIA_NEXT:176,MEDIA_PLAY_PAUSE:179,MEDIA_PREV:177,MEDIA_STOP:178,NULL:0,NUM_LOCK:144,PAGE_DOWN:34,PAGE_UP:33,PAUSE:19,PERIOD:190,SCROLL_LOCK:145,SHIFT:16,SPACE:32,TAB:9,A:65,C:67,D:68,F:70,L:76,O:79,P:80,S:83,V:86,X:88,Y:89,Z:90},qse=[Ge.ALT,Ge.ARROW_DOWN,Ge.ARROW_LEFT,Ge.ARROW_RIGHT,Ge.ARROW_UP,Ge.AUDIO_DOWN,Ge.AUDIO_MUTE,Ge.AUDIO_UP,Ge.BACKSPACE,Ge.CAPS_LOCK,Ge.DELETE,Ge.END,Ge.ENTER,Ge.ESCAPE,Ge.F1,Ge.F2,Ge.F3,Ge.F4,Ge.F5,Ge.F6,Ge.F7,Ge.F8,Ge.F9,Ge.F10,Ge.F11,Ge.F12,Ge.F13,Ge.F14,Ge.F15,Ge.F16,Ge.F17,Ge.F18,Ge.F19,Ge.HOME,Ge.INSERT,Ge.MEDIA_NEXT,Ge.MEDIA_PLAY_PAUSE,Ge.MEDIA_PREV,Ge.MEDIA_STOP,Ge.NULL,Ge.NUM_LOCK,Ge.PAGE_DOWN,Ge.PAGE_UP,Ge.PAUSE,Ge.SCROLL_LOCK,Ge.SHIFT,Ge.TAB];function Kse(t){return t===32||t>=48&&t<=57||t>=96&&t<=111||t>=186&&t<=192||t>=219&&t<=222||t>=226||t>=65&&t<=90}function D4(t){return qse.includes(t)}function Xse(t){return[Ge.CONTROL,Ge.COMMAND_LEFT,Ge.COMMAND_RIGHT,Ge.COMMAND_FIREFOX].includes(t)}function Ww(t,e){const n=e.split("|");let i=!1;return U(n,r=>{if(t===Ge[r])return i=!0,!1}),i}function ma(t){t.isImmediatePropagationEnabled=!1,t.cancelBubble=!0}function rd(t){return t.isImmediatePropagationEnabled===!1}function _d(t){return t.button===2}function AP(t){return t.button===0}function Zse(t){return t instanceof TouchEvent}function Qse(t,e){const n={x:t.offsetX,y:t.offsetY};let i=t.target;if(!cu(e)||i!==e&&i.contains(e))return n;for(;i!==e;)n.x+=i.offsetLeft,n.y+=i.offsetTop,i=i.offsetParent;return n}function _t(){Ne(console)&&console.warn(...arguments)}function L4(t){Ne(console)&&console.warn(`Deprecated: ${t}`)}function OP(){Ne(console)&&console.error(...arguments)}const od=["afterCellMetaReset","afterChange","afterContextMenuDefaultOptions","beforeContextMenuSetItems","afterDropdownMenuDefaultOptions","beforeDropdownMenuSetItems","afterContextMenuHide","beforeContextMenuShow","afterContextMenuShow","afterCopyLimit","beforeCreateCol","afterColumnSequenceChange","afterCreateCol","beforeCreateRow","afterCreateRow","afterDeselect","afterDestroy","afterDocumentKeyDown","afterDrawSelection","beforeRemoveCellClassNames","beforeCompositionStart","afterGetCellMeta","afterGetColHeader","afterGetRowHeader","afterInit","afterLoadData","afterUpdateData","afterMomentumScroll","afterOnCellCornerMouseDown","afterOnCellCornerDblClick","afterOnCellMouseDown","afterOnCellMouseUp","afterOnCellContextMenu","afterOnCellMouseOver","afterOnCellMouseOut","afterRemoveCol","afterRemoveRow","beforeRenderer","afterRenderer","afterRowSequenceChange","beforeViewportScrollVertically","beforeViewportScrollHorizontally","beforeViewportScroll","afterScrollHorizontally","afterScrollVertically","afterScroll","afterSelection","afterSelectionByProp","afterSelectionEnd","afterSelectionEndByProp","afterSelectionFocusSet","beforeSelectColumns","afterSelectColumns","beforeSelectRows","afterSelectRows","beforeSelectAll","afterSelectAll","afterSetCellMeta","afterRemoveCellMeta","afterSetDataAtCell","afterSetDataAtRowProp","afterSetSourceDataAtCell","afterSetTheme","afterUpdateSettings","afterValidate","beforeLanguageChange","afterLanguageChange","beforeAutofill","afterAutofill","beforeCellAlignment","beforeChange","beforeChangeRender","beforeHeightChange","beforeWidthChange","beforeDrawBorders","beforeGetCellMeta","beforeRemoveCellMeta","beforeInit","beforeInitWalkontable","beforeLoadData","beforeUpdateData","beforeKeyDown","beforeOnCellMouseDown","beforeOnCellMouseUp","beforeOnCellContextMenu","beforeOnCellMouseOver","beforeOnCellMouseOut","beforeRemoveCol","beforeRemoveRow","beforeViewRender","afterViewRender","beforeRender","afterRender","beforeRowWrap","beforeColumnWrap","beforeSetCellMeta","beforeSelectionFocusSet","beforeSetRangeStartOnly","beforeSetRangeStart","beforeSetRangeEnd","beforeSelectionHighlightSet","beforeTouchScroll","beforeValidate","beforeValueRender","construct","init","modifyColHeader","modifyColWidth","modifyFiltersMultiSelectValue","modifyFocusedElement","modifyRowHeader","modifyRowHeight","modifyRowHeightByOverlayName","modifyData","modifySourceData","modifyRowData","modifyGetCellCoords","modifyGetCoordsElement","modifyFocusOnTabNavigation","beforeHighlightingRowHeader","beforeHighlightingColumnHeader","persistentStateLoad","persistentStateReset","persistentStateSave","beforeColumnSort","afterColumnSort","modifyAutofillRange","modifyCopyableRange","beforeCut","afterCut","beforeCopy","afterCopy","beforePaste","afterPaste","beforeColumnFreeze","afterColumnFreeze","beforeColumnMove","afterColumnMove","beforeColumnUnfreeze","afterColumnUnfreeze","beforeRowMove","afterRowMove","beforeColumnResize","afterColumnResize","beforeRowResize","afterRowResize","afterGetColumnHeaderRenderers","afterGetRowHeaderRenderers","beforeStretchingColumnWidth","beforeFilter","afterFilter","beforePageChange","afterPageChange","beforePageSizeChange","afterPageSizeChange","afterPageSizeVisibilityChange","afterPageCounterVisibilityChange","afterPageNavigationVisibilityChange","afterFormulasValuesUpdate","afterNamedExpressionAdded","afterNamedExpressionRemoved","afterSheetAdded","afterSheetRenamed","afterSheetRemoved","modifyColumnHeaderHeight","modifyColumnHeaderValue","beforeUndo","beforeUndoStackChange","afterUndo","afterUndoStackChange","beforeRedo","beforeRedoStackChange","afterRedo","afterRedoStackChange","modifyRowHeaderWidth","modifyTransformFocus","modifyTransformStart","modifyTransformEnd","afterModifyTransformFocus","afterModifyTransformStart","afterModifyTransformEnd","afterViewportRowCalculatorOverride","afterViewportColumnCalculatorOverride","afterPluginsInitialized","beforeHideRows","afterHideRows","beforeUnhideRows","afterUnhideRows","beforeHideColumns","afterHideColumns","beforeUnhideColumns","afterUnhideColumns","beforeTrimRow","afterTrimRow","beforeUntrimRow","afterUntrimRow","beforeDropdownMenuShow","afterDropdownMenuShow","afterDropdownMenuHide","beforeAddChild","afterAddChild","beforeDetachChild","afterDetachChild","beforeBeginEditing","afterDialogHide","afterDialogShow","beforeDialogHide","beforeDialogShow","dialogFocusPreviousElement","dialogFocusNextElement","afterDialogFocus","beforeLoadingShow","afterLoadingShow","beforeLoadingHide","afterLoadingHide","afterBeginEditing","beforeMergeCells","afterMergeCells","beforeUnmergeCells","afterUnmergeCells","afterListen","afterUnlisten","afterRefreshDimensions","beforeRefreshDimensions","beforeColumnCollapse","afterColumnCollapse","beforeColumnExpand","afterColumnExpand","modifyAutoColumnSizeSeed"],lA=new Map([["modifyRow","8.0.0"],["modifyCol","8.0.0"],["unmodifyRow","8.0.0"],["unmodifyCol","8.0.0"],["skipLengthCache","8.0.0"],["hiddenColumn","8.0.0"],["hiddenRow","8.0.0"]]),uA=new Map([[]]);var sz={},cA,az;function Jse(){if(az)return cA;az=1;var t=pm();return cA=function(e,n,i){for(var r=0,o=arguments.length>2?i:t(n),a=new e(o);o>r;)a[r]=n[r++];return a},cA}var hA,lz;function eae(){if(lz)return hA;lz=1;var t=fi();return hA=function(e,n){var i=t[e],r=i&&i.prototype;return r&&r[n]},hA}var dA,uz;function bR(){if(uz)return dA;uz=1;var t=fa(),e=qI(),n=Wc().f,i=t("unscopables"),r=Array.prototype;return r[i]===void 0&&n(r,i,{configurable:!0,value:e(null)}),dA=function(o){r[i][o]=!0},dA}var cz;function tae(){if(cz)return sz;cz=1;var t=Cn(),e=gi(),n=uo(),i=xw(),r=Jse(),o=eae(),a=bR(),u=Array,h=e(o("Array","sort"));return t({target:"Array",proto:!0},{toSorted:function(g){g!==void 0&&n(g);var m=i(this),v=r(u,m);return h(v,g)}}),a("toSorted"),sz}tae();var hz={},dz={},fz;function nae(){if(fz)return dz;fz=1;var t=Cn(),e=Oi(),n=vm(),i=uo(),r=Hi(),o=ol(),a=co(),u=jc(),h=u("find",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:h},{find:function(g){r(this);try{i(g)}catch(y){a(this,"throw",y)}if(h)return e(h,this,g);var m=o(this),v=0;return n(m,function(y,b){if(g(y,v++))return b(y)},{IS_RECORD:!0,INTERRUPTED:!0}).result}}),dz}var gz;function iae(){return gz||(gz=1,nae()),hz}iae();function rae(t,e){k4(t,e),e.add(t)}function fA(t,e,n){k4(t,e),e.set(t,n)}function k4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function mz(t,e,n){return t.set(QC(t,e),n),n}function or(t,e){return t.get(QC(t,e))}function QC(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const oae=100;var Mo=new WeakMap,mg=new WeakMap,gA=new WeakMap,mA=new WeakSet;class pz{constructor(){rae(this,mA),fA(this,Mo,new Map),fA(this,mg,new Map),fA(this,gA,new Set),od.forEach(e=>QC(mA,this,vz).call(this,e))}getHooks(e){var n;return(n=or(Mo,this).get(e))!==null&&n!==void 0?n:[]}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};or(Mo,this).has(e)||(QC(mA,this,vz).call(this,e),od.push(e));const r=or(Mo,this).get(e);if(r.find(d=>d.callback===n))return;const o=Number.isInteger(i.orderIndex)?i.orderIndex:0,a=!!i.runOnce,u=!!i.initialHook;let h=!1;if(u){const d=r.find(g=>g.initialHook);d&&(d.callback=n,h=!0)}if(!h){r.push({callback:n,orderIndex:o,runOnce:a,initialHook:u,skip:!1});let d=or(gA,this).has(e);!d&&o!==0&&(d=!0,or(gA,this).add(e)),d&&r.length>1&&or(Mo,this).set(e,r.toSorted((g,m)=>g.orderIndex-m.orderIndex))}}has(e){return or(Mo,this).has(e)&&or(Mo,this).get(e).length>0}remove(e,n){if(!or(Mo,this).has(e))return!1;const i=or(Mo,this).get(e),r=i.find(o=>o.callback===n);if(r){let o=or(mg,this).get(e);return r.skip=!0,o+=1,o>oae&&(or(Mo,this).set(e,i.filter(a=>!a.skip)),o=0),or(mg,this).set(e,o),!0}return!1}destroy(){or(Mo,this).clear(),or(mg,this).clear(),mz(Mo,this,null),mz(mg,this,null)}}function vz(t){or(Mo,this).set(t,[]),or(mg,this).set(t,0)}function sae(t,e,n){return(e=aae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function aae(t){var e=lae(t,"string");return typeof e=="symbol"?e:e+""}function lae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const uae=Ft`The plugin hook "[hookName]" was removed in Handsontable [removedInVersion].\x20
  Please consult release notes https://github.com/handsontable/handsontable/releases/tag/[removedInVersion] to\x20
  learn about the migration path.`;class He{constructor(){sae(this,"globalBucket",new pz)}static getSingleton(){return hae()}getBucket(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return e?(e.pluginHookBucket||(e.pluginHookBucket=new pz),e.pluginHookBucket):this.globalBucket}add(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?U(n,o=>this.add(e,o,i)):(lA.has(e)&&_t(SP(uae,{hookName:e,removedInVersion:lA.get(e)})),uA.has(e)&&_t(uA.get(e)),this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!1})),this}once(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null,r=arguments.length>3?arguments[3]:void 0;return Array.isArray(n)?U(n,o=>this.once(e,o,i)):this.getBucket(i).add(e,n,{orderIndex:r,runOnce:!0}),this}addAsFixed(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return Array.isArray(n)?U(n,r=>this.addAsFixed(e,r,i)):this.getBucket(i).add(e,n,{initialHook:!0}),this}remove(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:null;return this.getBucket(i).remove(e,n)}has(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;return this.getBucket(n).has(e)}run(e,n,i,r,o,a,u,h){{const d=this.getBucket().getHooks(n),g=d?d.length:0;let m=0;if(g)for(;m<g;){if(!d[m]||d[m].skip){m+=1;continue}const v=NH(d[m].callback,e,i,r,o,a,u,h);v!==void 0&&(i=v),d[m]&&d[m].runOnce&&this.remove(n,d[m].callback),m+=1}}{const d=this.getBucket(e).getHooks(n),g=d?d.length:0;let m=0;if(g)for(;m<g;){if(!d[m]||d[m].skip){m+=1;continue}const v=NH(d[m].callback,e,i,r,o,a,u,h);v!==void 0&&(i=v),d[m]&&d[m].runOnce&&this.remove(n,d[m].callback,e),m+=1}}return i}destroy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.getBucket(e).destroy()}register(e){this.isRegistered(e)||od.push(e)}deregister(e){this.isRegistered(e)&&od.splice(od.indexOf(e),1)}isDeprecated(e){return uA.has(e)||lA.has(e)}isRegistered(e){return od.indexOf(e)>=0}getRegistered(){return od}}const cae=new He;function hae(){return cae}const hd=new Map;function Ps(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"common";hd.has(t)||hd.set(t,new Map);const e=hd.get(t);function n(h,d){e.set(h,d)}function i(h){return e.get(h)}function r(h){return e.has(h)}function o(){return[...e.keys()]}function a(){return[...e.values()]}function u(){hd.delete(t),e.clear()}return{register:n,getItem:i,hasItem:r,getNames:o,getValues:a,clear:u}}function dae(t,e){var n;return hd==null||(n=hd.get(t.guid))===null||n===void 0?void 0:n.get(e)}const DH=new WeakMap,{register:fae,getItem:$4,hasItem:V4,getNames:hHe,getValues:dHe}=Ps("editors");function gae(t){const e={},n=t;this.getConstructor=function(){return t},this.getInstance=function(i){return i.guid in e||(e[i.guid]=new n(i)),e[i.guid]},He.getSingleton().add("afterDestroy",function(){e[this.guid]=null})}function B4(t,e){let n;if(typeof t=="function")DH.get(t)||xo(null,t),n=DH.get(t);else if(typeof t=="string")n=$4(t);else throw Error('Only strings and functions can be passed as "editor" parameter');if(!n)throw Error(`No editor registered under name "${t}"`);return n.getInstance(e)}function LH(t){if(typeof t=="function")return t;if(!V4(t))throw Error(`No registered editor found under "${t}" name`);return $4(t).getConstructor()}function xo(t,e){t&&typeof t!="string"&&(e=t,t=e.EDITOR_TYPE);const n=new gae(e);typeof t=="string"&&fae(t,n),DH.set(e,n)}function mae(t,e,n){return(e=pae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pae(t){var e=vae(t,"string");return typeof e=="symbol"?e:e+""}function vae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class da{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;mae(this,"context",void 0),this.context=e||this,this.context.eventListeners||(this.context.eventListeners=[])}addEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;function o(a){i.call(this,wae(a))}return this.context.eventListeners.push({element:e,event:n,callback:i,callbackProxy:o,options:r,eventManager:this}),e.addEventListener(n,o,r),()=>{this.removeEventListener(e,n,i)}}removeEventListener(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,o=this.context.eventListeners.length,a;for(;o;)if(o-=1,a=this.context.eventListeners[o],a.event===n&&a.element===e){if(i&&i!==a.callback||r&&a.eventManager!==this)continue;this.context.eventListeners.splice(o,1),a.element.removeEventListener(a.event,a.callbackProxy,a.options)}}clearEvents(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(!this.context)return;let n=this.context.eventListeners.length;for(;n;){n-=1;const i=this.context.eventListeners[n];e&&i.eventManager!==this||(this.context.eventListeners.splice(n,1),i.element.removeEventListener(i.event,i.callbackProxy,i.options))}}clear(){this.clearEvents()}destroy(){this.clearEvents(),this.context=null}destroyWithOwnEventsOnly(){this.clearEvents(!0),this.context=null}fireEvent(e,n){let i=e.document,r=e;i||(i=e.ownerDocument?e.ownerDocument:e,r=i.defaultView);const o={bubbles:!0,cancelable:n!=="mousemove",view:r,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0};let a;i.createEvent?(a=i.createEvent("MouseEvents"),a.initMouseEvent(n,o.bubbles,o.cancelable,o.view,o.detail,o.screenX,o.screenY,o.clientX,o.clientY,o.ctrlKey,o.altKey,o.shiftKey,o.metaKey,o.button,i.body.parentNode)):a=i.createEventObject(),e.dispatchEvent?e.dispatchEvent(a):e.fireEvent(`on${n}`,a)}}function wae(t){const e=t.stopImmediatePropagation;return t.stopImmediatePropagation=function(){e.apply(this),ma(this)},t}function yae(t,e){Sae(t,e),e.add(t)}function Sae(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function gh(t,e,n){return(e=bae(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function bae(t){var e=Cae(t,"string");return typeof e=="symbol"?e:e+""}function Cae(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function pA(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _S=new WeakSet;class kH{constructor(e,n,i){yae(this,_S),gh(this,"hot",void 0),gh(this,"tableMeta",void 0),gh(this,"selection",void 0),gh(this,"eventManager",void 0),gh(this,"destroyed",!1),gh(this,"activeEditor",void 0),gh(this,"cellProperties",void 0),this.hot=e,this.tableMeta=n,this.selection=i,this.eventManager=new da(e),this.hot.addHook("afterDocumentKeyDown",r=>pA(_S,this,wz).call(this,r)),this.hot.addHook("beforeCompositionStart",r=>pA(_S,this,wz).call(this,r)),this.hot.view._wt.update("onCellDblClick",(r,o,a)=>pA(_S,this,Rae).call(this,r,o,a))}getActiveEditor(){return this.activeEditor}prepareEditor(){var e;if(this.activeEditor&&this.activeEditor.isWaiting()){this.closeEditor(!1,!1,d=>{d&&this.prepareEditor()});return}const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||n.isHeader())return;const{row:i,col:r}=n,o=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");let a=i,u=r;if(Array.isArray(o)&&([a,u]=o),this.cellProperties=this.hot.getCellMeta(a,u),!this.isCellEditable()){this.clearActiveEditor();return}const h=this.hot.getCell(i,r,!0);if(h){const d=this.hot.getCellEditor(this.cellProperties),g=this.hot.colToProp(u),m=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a),u);this.activeEditor=B4(d,this.hot),this.activeEditor.prepare(i,r,g,h,m,this.cellProperties)}}isEditorOpened(){return this.activeEditor&&this.activeEditor.isOpened()}openEditor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(!this.isCellEditable()){this.clearActiveEditor();return}const r=this.hot.getSelectedRangeActive();let o=this.hot.runHooks("beforeBeginEditing",r.highlight.row,r.highlight.col,e,n,i);if(n instanceof MouseEvent&&typeof o!="boolean"&&(o=this.hot.selection.getLayerLevel()===0&&r.isSingle()),o===!1){this.clearActiveEditor();return}this.activeEditor||(this.hot.scrollToFocusedCell(),this.prepareEditor()),this.activeEditor&&(i&&this.activeEditor.enableFullEditMode(),this.activeEditor.beginEditing(e,n))}closeEditor(e,n,i){this.activeEditor?this.activeEditor.finishEditing(e,n,i):i&&i(!1)}closeEditorAndSaveChanges(e){this.closeEditor(!1,e)}closeEditorAndRestoreOriginalValue(e){this.closeEditor(!0,e)}clearActiveEditor(){this.activeEditor=void 0}isCellEditable(){const e=this.hot.getSelectedRangeActive();if(!e)return!1;const n=this.hot.getCellEditor(this.cellProperties),{row:i,col:r}=e.highlight,{rowIndexMapper:o,columnIndexMapper:a}=this.hot,u=o.isHidden(this.hot.toPhysicalRow(i))||a.isHidden(this.hot.toPhysicalColumn(r));return!(this.cellProperties.readOnly||!n||u)}moveSelectionAfterEnter(e){const n={...typeof this.tableMeta.enterMoves=="function"?this.tableMeta.enterMoves(e):this.tableMeta.enterMoves};e.shiftKey&&(n.row=-n.row,n.col=-n.col),this.hot.selection.isMultiple()?this.selection.transformFocus(n.row,n.col):this.selection.transformStart(n.row,n.col,!0)}destroy(){this.destroyed=!0,this.eventManager.destroy()}}function wz(t){const e=this.hot.getSelectedRangeActive();if(!this.hot.isListening()||!e||e.highlight.isHeader()||rd(t))return;const{keyCode:n}=t,i=(t.ctrlKey||t.metaKey)&&!t.altKey;(!this.activeEditor||this.activeEditor&&!this.activeEditor.isWaiting())&&!D4(n)&&!Xse(n)&&!i&&!this.isEditorOpened()&&this.openEditor("",t)}function Rae(t,e){e.isCell()&&(this.hot.getShortcutManager().isCtrlPressed()?this.clearActiveEditor():this.openEditor(null,t,!0))}const yz=new WeakMap;kH.getInstance=function(t,e,n){let i=yz.get(t);return i||(i=new kH(t,e,n),yz.set(t,i)),i};function Eae(t,e){F4(t,e),e.add(t)}function Op(t,e,n){F4(t,e),e.set(t,n)}function F4(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function En(t,e){return t.get(Ql(t,e))}function xp(t,e,n){return t.set(Ql(t,e),n),n}function Ql(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Wg=Object.freeze({CELL:"cell",MIXED:"mixed"});var Ci=new WeakMap,MS=new WeakMap,AS=new WeakMap,OS=new WeakMap,xS=new WeakMap,Sc=new WeakSet;class Tae{constructor(e){var n=this;Eae(this,Sc),Op(this,Ci,void 0),Op(this,MS,void 0),Op(this,AS,1),Op(this,OS,null),Op(this,xS,new Map);const i=e.getSettings();xp(Ci,this,e),xp(MS,this,i.imeFastEdit?Wg.MIXED:Wg.CELL),En(Ci,this).addHook("afterUpdateSettings",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ql(Sc,n,Mae).call(n,...o)}),En(Ci,this).addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ql(Sc,n,Sz).call(n,...o)}),En(Ci,this).addHook("afterSelectionFocusSet",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ql(Sc,n,Sz).call(n,...o)}),En(Ci,this).addHook("afterSelectionEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ql(Sc,n,_ae).call(n,...o)})}getFocusMode(){return En(MS,this)}setFocusMode(e){Object.values(Wg).includes(e)?xp(MS,this,e):_t(`"${e}" is not a valid focus mode.`)}getRefocusDelay(){return En(AS,this)}setRefocusDelay(e){xp(AS,this,e)}setRefocusElementGetter(e){xp(OS,this,e)}getRefocusElement(){var e;return typeof En(OS,this)=="function"?En(OS,this).call(this):(e=En(Ci,this).getActiveEditor())===null||e===void 0?void 0:e.TEXTAREA}focusOnHighlightedCell(e){const n=i=>{var r,o;const a=(r=En(Ci,this).getSelectedRangeActive())===null||r===void 0?void 0:r.highlight;if(!a)return;let u=En(Ci,this).runHooks("modifyFocusedElement",a.row,a.col,i);cu(u)||(u=i),u&&!((o=En(Ci,this).getActiveEditor())!==null&&o!==void 0&&o.isOpened())&&u.focus({preventScroll:!0})};e?n(e):Ql(Sc,this,xP).call(this,i=>n(i))}refocusToEditorTextarea(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:En(AS,this);if(En(Ci,this).getSettings().imeFastEdit&&!((e=En(Ci,this).getActiveEditor())!==null&&e!==void 0&&e.isOpened())){var i,r;(i=En(Ci,this).getActiveEditor())===null||i===void 0||(r=i.refreshValue)===null||r===void 0||r.call(i),En(xS,this).has(n)||En(xS,this).set(n,SR(()=>{if(!En(Ci,this).isDestroyed){var o;(o=this.getRefocusElement())===null||o===void 0||o.select()}},n)),En(xS,this).get(n)()}}}function xP(t){var e;const n=(e=En(Ci,this).getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;if(!n||!En(Ci,this).selection.isCellVisible(n)){t(null);return}const i=En(Ci,this).getCell(n.row,n.col,!0);i===null?En(Ci,this).addHookOnce("afterScroll",()=>{t(En(Ci,this).getCell(n.row,n.col,!0))}):t(i)}function Sz(){Ql(Sc,this,xP).call(this,t=>{const{activeElement:e}=En(Ci,this).rootDocument;e&&x4(e)&&e.blur(),this.focusOnHighlightedCell(t)})}function _ae(){Ql(Sc,this,xP).call(this,t=>{this.getFocusMode()===Wg.MIXED&&t?.nodeName==="TD"&&this.refocusToEditorTextarea()})}function Mae(t){typeof t.imeFastEdit=="boolean"&&this.setFocusMode(t.imeFastEdit?Wg.MIXED:Wg.CELL)}var bz={},vA,Cz;function Aae(){if(Cz)return vA;Cz=1;var t=Os(),e=Nd(),n=fa(),i=n("match");return vA=function(r){var o;return t(r)&&((o=r[i])!==void 0?!!o:e(r)==="RegExp")},vA}var wA,Rz;function Oae(){if(Rz)return wA;Rz=1;var t=fi(),e=Ai(),n=t.RegExp,i=!e(function(){var r=!0;try{n(".","d")}catch{r=!1}var o={},a="",u=r?"dgimsy":"gimsy",h=function(v,y){Object.defineProperty(o,v,{get:function(){return a+=y,!0}})},d={dotAll:"s",global:"g",ignoreCase:"i",multiline:"m",sticky:"y"};r&&(d.hasIndices="d");for(var g in d)h(g,d[g]);var m=Object.getOwnPropertyDescriptor(n.prototype,"flags").get.call(o);return m!==u||a!==u});return wA={correct:i},wA}var yA,Ez;function xae(){if(Ez)return yA;Ez=1;var t=Hi();return yA=function(){var e=t(this),n="";return e.hasIndices&&(n+="d"),e.global&&(n+="g"),e.ignoreCase&&(n+="i"),e.multiline&&(n+="m"),e.dotAll&&(n+="s"),e.unicode&&(n+="u"),e.unicodeSets&&(n+="v"),e.sticky&&(n+="y"),n},yA}var SA,Tz;function Hae(){if(Tz)return SA;Tz=1;var t=Oi(),e=xs(),n=Hw(),i=Oae(),r=xae(),o=RegExp.prototype;return SA=i.correct?function(a){return a.flags}:function(a){return!i.correct&&n(o,a)&&!e(a,"flags")?t(r,a):a.flags},SA}var bA,_z;function Iae(){if(_z)return bA;_z=1;var t=gi(),e=gm(),n=Math.floor,i=t("".charAt),r=t("".replace),o=t("".slice),a=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,u=/\$([$&'`]|\d{1,2})/g;return bA=function(h,d,g,m,v,y){var b=g+h.length,C=m.length,T=u;return v!==void 0&&(v=e(v),T=a),r(y,T,function(O,A){var N;switch(i(A,0)){case"$":return"$";case"&":return h;case"`":return o(d,0,g);case"'":return o(d,b);case"<":N=v[o(A,1,-1)];break;default:var x=+A;if(x===0)return O;if(x>C){var $=n(x/10);return $===0?O:$<=C?m[$-1]===void 0?i(A,1):m[$-1]+i(A,1):O}N=m[x-1]}return N===void 0?"":N})},bA}var Mz;function Pae(){if(Mz)return bz;Mz=1;var t=Cn(),e=Oi(),n=gi(),i=Ow(),r=xi(),o=Os(),a=Aae(),u=nR(),h=Iw(),d=Hae(),g=Iae(),m=fa(),v=Fc(),y=m("replace"),b=TypeError,C=n("".indexOf),T=n("".replace),O=n("".slice),A=Math.max;return t({target:"String",proto:!0},{replaceAll:function(x,$){var L=i(this),P,Q,ue,X,me,re,Se,we,_e,ie,de=0,Te="";if(o(x)){if(P=a(x),P&&(Q=u(i(d(x))),!~C(Q,"g")))throw new b("`.replaceAll` does not allow non-global regexes");if(ue=h(x,y),ue)return e(ue,x,L,$);if(v&&P)return T(u(L),x,$)}for(X=u(L),me=u(x),re=r($),re||($=u($)),Se=me.length,we=A(1,Se),_e=C(X,me);_e!==-1;)ie=re?u($(me,_e,X)):g(me,X,_e,[],void 0,$),Te+=O(X,de,_e)+ie,de=_e+Se,_e=_e+we>X.length?-1:C(X,me,_e+we);return de<X.length&&(Te+=O(X,de)),Te}}),bz}Pae();const W4={"&nbsp;":" ","&amp;":"&","&lt;":"<","&gt;":">"},Nae=new RegExp(Object.keys(W4).map(t=>`(${t})`).join("|"),"gi");function Dae(t){return(t&&t.nodeName||"")==="TABLE"}function Az(t){const e=t.hasColHeaders(),n=t.hasRowHeaders(),i=[e?-1:0,n?-1:0,t.countRows()-1,t.countCols()-1],r=t.getData(...i),o=r.length,a=o>0?r[0].length:0,u=["<table>","</table>"],h=e?["<thead>","</thead>"]:[],d=["<tbody>","</tbody>"],g=n?1:0,m=e?1:0;for(let v=0;v<o;v+=1){const y=e&&v===0,b=[];for(let T=0;T<a;T+=1){const O=!y&&n&&T===0;let A="";if(y)A=`<th>${t.getColHeader(T-g)}</th>`;else if(O)A=`<th>${t.getRowHeader(v-m)}</th>`;else{const N=r[v][T],{hidden:x,rowspan:$,colspan:L}=t.getCellMeta(v-m,T-g);if(!x){const P=[];if($&&P.push(`rowspan="${$}"`),L&&P.push(`colspan="${L}"`),ni(N))A=`<td ${P.join(" ")}></td>`;else{const Q=N.toString().replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20/gi,"&nbsp;").replace(/\t/gi,"&#9;");A=`<td ${P.join(" ")}>${Q}</td>`}}}b.push(A)}const C=["<tr>",...b,"</tr>"].join("");y?h.splice(1,0,C):d.splice(-1,0,C)}return u.splice(1,0,h.join(""),d.join("")),u.join("")}function Oz(t){const e=t.length,n=["<table>"];for(let i=0;i<e;i+=1){const r=t[i],o=r.length,a=[];i===0&&n.push("<tbody>");for(let u=0;u<o;u+=1){const h=r[u],d=ni(h)?"":h.toString().replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/(<br(\s*|\/)>(\r\n|\n)?|\r\n|\n)/g,`<br>\r
`).replace(/\x20{2,}/gi,g=>`<span style="mso-spacerun: yes">${"&nbsp;".repeat(g.length-1)} </span>`).replace(/\t/gi,"&#9;");a.push(`<td>${d}</td>`)}n.push("<tr>",...a,"</tr>"),i+1===e&&n.push("</tbody>")}return n.push("</table>"),n.join("")}function xz(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:document;const n={},i=e.createDocumentFragment(),r=e.createElement("div");i.appendChild(r);let o=t;if(typeof o=="string"){const N=o.replace(/<td\b[^>]*?>([\s\S]*?)<\/\s*td>/g,x=>{const $=x.match(/<td\b[^>]*?>/g)[0],L=/<p.*?>/g,P=x.substring($.length,x.lastIndexOf("<")).trim().replaceAll(/\n\s+/g," ").replaceAll(L,`
`).replace(`
`,"").replaceAll(/<\/(.*)>\s+$/mg,"</$1>").replace(/(<(?!br)([^>]+)>)/gi,"").replaceAll(/^&nbsp;$/mg,"");return`${$}${P}</td>`});r.insertAdjacentHTML("afterbegin",`${N}`),o=r.querySelector("table")}if(!o||!Dae(o))return;const a=r.querySelector('meta[name$="enerator"]'),u=o.querySelector("tbody th")!==null,h=o.querySelector("tr"),d=h?Array.from(h.cells).reduce((N,x)=>N+x.colSpan,0)-(u?1:0):0,g=o.tFoot&&Array.from(o.tFoot.rows)||[],m=[];let v=!1,y=0,b=0;if(o.tHead){const N=Array.from(o.tHead.rows).filter(x=>{const $=x.querySelector("td")!==null;return $&&m.push(x),!$});y=N.length,v=y>0,y>1?n.nestedHeaders=Array.from(N).reduce((x,$)=>{const L=Array.from($.cells).reduce((P,Q,ue)=>{if(u&&ue===0)return P;const{colSpan:X,innerHTML:me}=Q,re=X>1?{label:me,colspan:X}:me;return P.push(re),P},[]);return x.push(L),x},[]):v&&(n.colHeaders=Array.from(N[0].children).reduce((x,$,L)=>(u&&L===0||x.push($.innerHTML),x),[]))}m.length&&(n.fixedRowsTop=m.length),g.length&&(n.fixedRowsBottom=g.length);const C=[...m,...Array.from(o.tBodies).reduce((N,x)=>(N.push(...Array.from(x.rows)),N),[]),...g];b=C.length;const T=new Array(b);for(let N=0;N<b;N++)T[N]=new Array(d);const O=[],A=[];for(let N=0;N<b;N++){const x=C[N],$=Array.from(x.cells),L=$.length;for(let P=0;P<L;P++){const Q=$[P],{nodeName:ue,innerHTML:X,rowSpan:me,colSpan:re}=Q,Se=T[N].findIndex(we=>we===void 0);if(ue==="TD"){if(me>1||re>1){for(let de=N;de<N+me;de++)if(de<b)for(let Te=Se;Te<Se+re;Te++)T[de][Te]=null;const _e=Q.getAttribute("style");_e&&_e.includes("mso-ignore:colspan")||O.push({col:Se,row:N,rowspan:me,colspan:re})}let we="";a&&/excel/gi.test(a.content)?we=X.replace(/[\r\n][\x20]{0,2}/g," ").replace(/<br(\s*|\/)>[\r\n]?[\x20]{0,3}/gim,`\r
`):we=X.replace(/<br(\s*|\/)>[\r\n]?/gim,`\r
`),T[N][Se]=we.replace(Nae,_e=>W4[_e])}else A.push(X)}}return O.length&&(n.mergeCells=O),A.length&&(n.rowHeaders=A),T.length&&(n.data=T),n}function Hr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=typeof t;if(n==="number")return!isNaN(t)&&isFinite(t);if(n==="string"){if(t.length===0)return!1;if(t.length===1)return/\d/.test(t);const i=Array.from(new Set([".",...e])).map(r=>`\\${r}`).join("|");return new RegExp(`^[+-]?(((${i})?\\d+((${i})\\d+)?(e[+-]?\\d+)?)|(0x[a-f\\d]+))$`,"i").test(t.trim())}else if(n==="object")return!!t&&typeof t.valueOf()=="number"&&!(t instanceof Date);return!1}function Lae(t){return Hr(t,[","])}function ze(t,e,n){let i=-1;for(typeof e=="function"?(n=e,e=t):i=t-1;++i<=e&&n(i)!==!1;);}function Hz(t,e,n){let i=t+1;for(typeof e=="function"&&(n=e,e=0);--i>=e&&n(i)!==!1;);}function j4(t,e){return e=parseInt(e.toString().replace("%",""),10),e=isNaN(e)?0:e,parseInt(t*e/100,10)}function St(t,e,n){return Math.min(t,e)===t?e:Math.max(t,n)===t?n:t}function kae(t){const e=t.replace(",",".");return isNaN(parseFloat(e))===!1?parseFloat(e):null}function jg(t){return Number.isInteger(t)&&t>=0}const $H="asc",$ae="desc",Iz=new Map([[$H,[-1,1]],[$ae,[1,-1]]]),Vae=t=>`The priority '${t}' is already declared in a map.`,Bae=t=>`The priority '${t}' is not a number.`;function Fae(){let{errorPriorityExists:t,errorPriorityNaN:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const n=new Map;t=Yt(t)?t:Vae,e=Yt(e)?e:Bae;function i(o,a){if(!Hr(o))throw new Error(e(o));if(n.has(o))throw new Error(t(o));n.set(o,a)}function r(){let o=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$H;const[a,u]=Iz.get(o)||Iz.get($H);return[...n].sort((h,d)=>h[0]<d[0]?a:u).map(h=>h[1])}return{addItem:i,getItems:r}}const Wae=t=>`The id '${t}' is already declared in a map.`;function CR(){let{errorIdExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Map;t=Yt(t)?t:Wae;function n(d,g){if(h(d))throw new Error(t(d));e.set(d,g)}function i(d){return e.delete(d)}function r(){e.clear()}function o(d){const[g]=u().find(m=>{let[v,y]=m;return d===y?v:!1})||[null];return g}function a(d){return e.get(d)}function u(){return[...e]}function h(d){return e.has(d)}return{addItem:n,clear:r,getId:o,getItem:a,getItems:u,hasItem:h,removeItem:i}}const jae=t=>`'${t}' value is already declared in a unique set.`;function zae(){let{errorItemExists:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};const e=new Set;t=Yt(t)?t:jae;function n(o){if(e.has(o))throw new Error(t(o));e.add(o)}function i(){return[...e]}function r(){e.clear()}return{addItem:n,clear:r,getItems:i}}const HP=t=>`There is already registered "${t}" plugin.`,Uae=t=>`There is already registered plugin on priority "${t}".`,Yae=t=>`The priority "${t}" is not a number.`,z4=Fae({errorPriorityExists:Uae,errorPriorityNaN:Yae}),U4=zae({errorItemExists:HP}),VH=CR({errorIdExists:HP});function Y4(){return[...z4.getItems(),...U4.getItems()]}function IP(t){const e=ha(t);return VH.getItem(e)}function Gae(t){return!!IP(t)}function Ht(t,e,n){[t,e,n]=Kae(t,e,n),IP(t)===void 0&&qae(t,e,n)}function qae(t,e,n){const i=ha(t);if(VH.hasItem(i))throw new Error(HP(i));n===void 0?U4.addItem(i):z4.addItem(n,i),VH.addItem(i,e)}function Kae(t,e,n){return typeof t=="function"&&(e=t,t=e.PLUGIN_KEY,n=e.PLUGIN_PRIORITY),[t,e,n]}const{register:Xae,getItem:Zae,hasItem:G4,getNames:fHe,getValues:gHe}=Ps("renderers");function BH(t){if(typeof t=="function")return t;if(!G4(t))throw Error(`No registered renderer found under "${t}" name`);return Zae(t)}function ds(t,e){typeof t!="string"&&(e=t,t=e.RENDERER_TYPE),Xae(t,e)}const{register:Qae,getItem:Jae,hasItem:q4,getNames:mHe,getValues:pHe}=Ps("validators");function ele(t){if(typeof t=="function")return t;if(!q4(t))throw Error(`No registered validator found under "${t}" name`);return Jae(t)}function pg(t,e){typeof t!="string"&&(e=t,t=e.VALIDATOR_TYPE),Qae(t,e)}var Pz={},Nz;function tle(){if(Nz)return Pz;Nz=1;var t=Cn(),e=gm(),n=pm(),i=Pw(),r=bR();return t({target:"Array",proto:!0},{at:function(a){var u=e(this),h=n(u),d=i(a),g=d>=0?d:h+d;return g<0||g>=h?void 0:u[g]}}),r("at"),Pz}tle();var Dz={},Lz;function nle(){if(Lz)return Dz;Lz=1;var t=Cn(),e=gi(),n=Ow(),i=Pw(),r=nR(),o=Ai(),a=e("".charAt),u=o(function(){return"𠮷".at(-2)!=="\uD842"});return t({target:"String",proto:!0,forced:u},{at:function(d){var g=r(n(this)),m=g.length,v=i(d),y=v>=0?v:m+v;return y<0||y>=m?void 0:a(g,y)}}),Dz}nle();function Hp(t,e,n){return(e=ile(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ile(t){var e=rle(t,"string");return typeof e=="symbol"?e:e+""}function rle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ole{constructor(){Hp(this,"count",0),Hp(this,"startColumn",null),Hp(this,"endColumn",null),Hp(this,"startPosition",null),Hp(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o,columnWidth:a}=n,u=r>0?o+1:o;i>=r&&i+a<=r+u&&((this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e)}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:u,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===u-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const b=d[this.endColumn]+g-d[this.startColumn-1];if(b<=r&&(this.startColumn-=1),b>=r)break}this.startPosition=(n=d[this.startColumn])!==null&&n!==void 0?n:null;const m=a>0?r+1:r,v=i+r-m,y=this.startColumn===null?0:e.getColumnWidth(this.startColumn);v<-1*o||i>d.at(-1)||-1*i-r>-1*y?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,u<this.endColumn&&(this.endColumn=u-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Ip(t,e,n){return(e=sle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sle(t){var e=ale(t,"string");return typeof e=="symbol"?e:e+""}function ale(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class lle{constructor(){Ip(this,"count",0),Ip(this,"startRow",null),Ip(this,"endRow",null),Ip(this,"startPosition",null),Ip(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o,rowHeight:a}=n;i>=r&&i+a<=o&&(this.startRow===null&&(this.startRow=e),this.endRow=e)}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:a,needReverse:u,startPositions:h,rowHeight:d}=e;if(this.endRow===a-1&&u)for(this.startRow=this.endRow;this.startRow>0;){const v=h[this.endRow]+d-h[this.startRow-1];if(v<=r-o&&(this.startRow-=1),v>=r-o)break}this.startPosition=(n=h[this.startRow])!==null&&n!==void 0?n:null;const g=i+r-o,m=this.startRow===null?0:e.getRowHeight(this.startRow);g<m||i>h.at(-1)?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Pp(t,e,n){return(e=ule(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ule(t){var e=cle(t,"string");return typeof e=="symbol"?e:e+""}function cle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class K4{constructor(){Pp(this,"count",0),Pp(this,"startColumn",null),Pp(this,"endColumn",null),Pp(this,"startPosition",null),Pp(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedWidth:i,zeroBasedScrollOffset:r,viewportWidth:o}=n;i<=r&&(this.startColumn=e);const a=r>0?o+1:o;i>=r&&i<=r+a&&(this.startColumn===null||this.startColumn===void 0)&&(this.startColumn=e),this.endColumn=e}finalize(e){var n;const{scrollOffset:i,viewportWidth:r,inlineStartOffset:o,zeroBasedScrollOffset:a,totalColumns:u,needReverse:h,startPositions:d,columnWidth:g}=e;if(this.endColumn===u-1&&h)for(this.startColumn=this.endColumn;this.startColumn>0;){const y=d[this.endColumn]+g-d[this.startColumn-1];if(this.startColumn-=1,y>r)break}this.startPosition=(n=d[this.startColumn])!==null&&n!==void 0?n:null;const m=a>0?r+1:r;i+r-m<-1*o||i>d.at(-1)+g||-1*i-r>0?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,u<this.endColumn&&(this.endColumn=u-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function Np(t,e,n){return(e=hle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hle(t){var e=dle(t,"string");return typeof e=="symbol"?e:e+""}function dle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class X4{constructor(){Np(this,"count",0),Np(this,"startRow",null),Np(this,"endRow",null),Np(this,"startPosition",null),Np(this,"isVisibleInTrimmingContainer",!1)}initialize(){}process(e,n){const{totalCalculatedHeight:i,zeroBasedScrollOffset:r,innerViewportHeight:o}=n;i<=r&&(this.startRow=e),i>=r&&i<=o&&this.startRow===null&&(this.startRow=e),this.endRow=e}finalize(e){var n;const{scrollOffset:i,viewportHeight:r,horizontalScrollbarHeight:o,totalRows:a,needReverse:u,startPositions:h,rowHeight:d}=e;if(this.endRow===a-1&&u)for(this.startRow=this.endRow;this.startRow>0;){const m=h[this.endRow]+d-h[this.startRow-1];if(this.startRow-=1,m>=r-o)break}this.startPosition=(n=h[this.startRow])!==null&&n!==void 0?n:null,i+r-o<0||i>h.at(-1)+d?this.isVisibleInTrimmingContainer=!1:this.isVisibleInTrimmingContainer=!0,a<this.endRow&&(this.endRow=a-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Dp(t,e,n){return(e=fle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fle(t){var e=gle(t,"string");return typeof e=="symbol"?e:e+""}function gle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mle{constructor(){Dp(this,"count",0),Dp(this,"startColumn",0),Dp(this,"endColumn",0),Dp(this,"startPosition",0),Dp(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalColumns:n}=e;this.count=n,this.endColumn=this.count-1}process(){}finalize(){}}function Lp(t,e,n){return(e=ple(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ple(t){var e=vle(t,"string");return typeof e=="symbol"?e:e+""}function vle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class wle{constructor(){Lp(this,"count",0),Lp(this,"startRow",0),Lp(this,"endRow",0),Lp(this,"startPosition",0),Lp(this,"isVisibleInTrimmingContainer",!0)}initialize(e){let{totalRows:n}=e;this.count=n,this.endRow=this.count-1}process(){}finalize(){}}function kz(t,e,n){return(e=yle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yle(t){var e=Sle(t,"string");return typeof e=="symbol"?e:e+""}function Sle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ble extends K4{constructor(){super(...arguments),kz(this,"columnStartOffset",0),kz(this,"columnEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalColumns:r,startPositions:o}=e;if(this.startColumn!==null&&typeof i=="function"){const a=this.startColumn,u=this.endColumn;i(this),this.columnStartOffset=a-this.startColumn,this.columnEndOffset=this.endColumn-u}this.startColumn<0&&(this.startColumn=0),this.startPosition=(n=o[this.startColumn])!==null&&n!==void 0?n:null,r<this.endColumn&&(this.endColumn=r-1),this.startColumn!==null&&(this.count=this.endColumn-this.startColumn+1)}}function $z(t,e,n){return(e=Cle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cle(t){var e=Rle(t,"string");return typeof e=="symbol"?e:e+""}function Rle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ele extends X4{constructor(){super(...arguments),$z(this,"rowStartOffset",0),$z(this,"rowEndOffset",0)}finalize(e){var n;super.finalize(e);const{overrideFn:i,totalRows:r,startPositions:o}=e;if(this.startRow!==null&&typeof i=="function"){const a=this.startRow,u=this.endRow;i(this),this.rowStartOffset=a-this.startRow,this.rowEndOffset=this.endRow-u}this.startRow<0&&(this.startRow=0),this.startPosition=(n=o[this.startRow])!==null&&n!==void 0?n:null,r<this.endRow&&(this.endRow=r-1),this.startRow!==null&&(this.count=this.endRow-this.startRow+1)}}function Vz(t,e,n){return(e=Tle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Tle(t){var e=_le(t,"string");return typeof e=="symbol"?e:e+""}function _le(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Z4{constructor(e){Vz(this,"calculationTypes",[]),Vz(this,"calculationResults",new Map),this.calculationTypes=e}_initialize(e){this.calculationTypes.forEach(n=>{let[i,r]=n;this.calculationResults.set(i,r),r.initialize(e)})}_process(e,n){this.calculationTypes.forEach(i=>{let[,r]=i;return r.process(e,n)})}_finalize(e){this.calculationTypes.forEach(n=>{let[,i]=n;return i.finalize(e)})}getResultsFor(e){return this.calculationResults.get(e)}}function Bs(t,e,n){return(e=Mle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mle(t){var e=Ale(t,"string");return typeof e=="symbol"?e:e+""}function Ale(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Jg=50;class Ole extends Z4{constructor(e){let{calculationTypes:n,viewportWidth:i,scrollOffset:r,totalColumns:o,columnWidthFn:a,overrideFn:u,inlineStartOffset:h}=e;super(n),Bs(this,"viewportWidth",0),Bs(this,"scrollOffset",0),Bs(this,"zeroBasedScrollOffset",0),Bs(this,"totalColumns",0),Bs(this,"columnWidthFn",null),Bs(this,"columnWidth",0),Bs(this,"overrideFn",null),Bs(this,"inlineStartOffset",0),Bs(this,"totalCalculatedWidth",0),Bs(this,"startPositions",[]),Bs(this,"needReverse",!0),this.viewportWidth=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalColumns=o,this.columnWidthFn=a,this.overrideFn=u,this.inlineStartOffset=h,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalColumns;e++)if(this.columnWidth=this.getColumnWidth(e),this._process(e,this),this.startPositions.push(this.totalCalculatedWidth),this.totalCalculatedWidth+=this.columnWidth,this.totalCalculatedWidth>=this.zeroBasedScrollOffset+this.viewportWidth){this.needReverse=!1;break}this._finalize(this)}getColumnWidth(e){const n=this.columnWidthFn(e);return isNaN(n)?Jg:n}}function ss(t,e,n){return(e=xle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xle(t){var e=Hle(t,"string");return typeof e=="symbol"?e:e+""}function Hle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ile extends Z4{constructor(e){let{calculationTypes:n,viewportHeight:i,scrollOffset:r,totalRows:o,defaultRowHeight:a,rowHeightFn:u,overrideFn:h,horizontalScrollbarHeight:d}=e;super(n),ss(this,"viewportHeight",0),ss(this,"scrollOffset",0),ss(this,"zeroBasedScrollOffset",0),ss(this,"totalRows",0),ss(this,"rowHeightFn",null),ss(this,"rowHeight",0),ss(this,"overrideFn",null),ss(this,"horizontalScrollbarHeight",0),ss(this,"innerViewportHeight",0),ss(this,"totalCalculatedHeight",0),ss(this,"startPositions",[]),ss(this,"needReverse",!0),this.defaultHeight=a,this.viewportHeight=i,this.scrollOffset=r,this.zeroBasedScrollOffset=Math.max(r,0),this.totalRows=o,this.rowHeightFn=u,this.overrideFn=h,this.horizontalScrollbarHeight=d??0,this.innerViewportHeight=this.zeroBasedScrollOffset+this.viewportHeight-this.horizontalScrollbarHeight,this.calculate()}calculate(){this._initialize(this);for(let e=0;e<this.totalRows;e++)if(this.rowHeight=this.getRowHeight(e),this._process(e,this),this.startPositions.push(this.totalCalculatedHeight),this.totalCalculatedHeight+=this.rowHeight,this.totalCalculatedHeight>=this.innerViewportHeight){this.needReverse=!1;break}this._finalize(this)}getRowHeight(e){const n=this.rowHeightFn(e);return isNaN(n)?this.defaultHeight:n}}function Ple(t,e,n){Nle(t,e),e.set(t,n)}function Nle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bz(t,e,n){return(e=Dle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Dle(t){var e=Lle(t,"string");return typeof e=="symbol"?e:e+""}function Lle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Af(t,e){return t.get(Q4(t,e))}function Fz(t,e,n){return t.set(Q4(t,e),n),n}function Q4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var xl=new WeakMap;class Md{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Bz(this,"row",null),Bz(this,"col",null),Ple(this,xl,!1),Fz(xl,this,i),typeof e<"u"&&typeof n<"u"&&(this.row=e,this.col=n)}isValid(e){const{countRows:n,countCols:i,countRowHeaders:r,countColHeaders:o}={countRows:0,countCols:0,countRowHeaders:0,countColHeaders:0,...e};return!(!Number.isInteger(this.row)||!Number.isInteger(this.col)||this.row<-o||this.col<-r||this.row>=n||this.col>=i)}isEqual(e){return e===this?!0:this.row===e.row&&this.col===e.col}isHeader(){return!this.isCell()}isCell(){return this.row>=0&&this.col>=0}isRtl(){return Af(xl,this)}isSouthEastOf(e){return this.row>=e.row&&(Af(xl,this)?this.col<=e.col:this.col>=e.col)}isNorthWestOf(e){return this.row<=e.row&&(Af(xl,this)?this.col>=e.col:this.col<=e.col)}isSouthWestOf(e){return this.row>=e.row&&(Af(xl,this)?this.col>=e.col:this.col<=e.col)}isNorthEastOf(e){return this.row<=e.row&&(Af(xl,this)?this.col<=e.col:this.col>=e.col)}normalize(){return this.row=this.row===null?this.row:Math.max(this.row,0),this.col=this.col===null?this.col:Math.max(this.col,0),this}assign(e){return Number.isInteger(e?.row)&&(this.row=e.row),Number.isInteger(e?.col)&&(this.col=e.col),e instanceof Md&&Fz(xl,this,e.isRtl()),this}clone(){return new Md(this.row,this.col,Af(xl,this))}toObject(){return{row:this.row,col:this.col}}}function kle(t,e,n){$le(t,e),e.set(t,n)}function $le(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function CA(t,e,n){return(e=Vle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vle(t){var e=Ble(t,"string");return typeof e=="symbol"?e:e+""}function Ble(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function as(t,e){return t.get(J4(t,e))}function Fle(t,e,n){return t.set(J4(t,e),n),n}function J4(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gr=new WeakMap;class bm{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;CA(this,"highlight",null),CA(this,"from",null),CA(this,"to",null),kle(this,Gr,!1),this.highlight=e.clone(),this.from=n.clone(),this.to=i.clone(),Fle(Gr,this,r)}setHighlight(e){return this.highlight=e.clone(),this}setFrom(e){return this.from=e.clone(),this}setTo(e){return this.to=e.clone(),this}normalize(){return this.highlight.normalize(),this.from.normalize(),this.to.normalize(),this}isValid(e){return this.from.isValid(e)&&this.to.isValid(e)}isSingle(){return this.isSingleCell()||this.isSingleHeader()}isSingleCell(){return this.from.row>=0&&this.from.row===this.to.row&&this.from.col>=0&&this.from.col===this.to.col}isSingleHeader(){return(this.from.row<0||this.from.col<0)&&this.from.row===this.to.row&&this.from.col===this.to.col}isHeader(){return this.from.isHeader()&&this.to.isHeader()?!0:this.from.col<0&&this.to.col<0||this.from.row<0&&this.to.row<0}containsHeaders(){return this.from.isHeader()||this.to.isHeader()}getOuterHeight(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1}getOuterWidth(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1}getHeight(){if(this.from.row<0&&this.to.row<0)return 0;const e=Math.max(this.from.row,0),n=Math.max(this.to.row,0);return Math.max(e,n)-Math.min(e,n)+1}getWidth(){if(this.from.col<0&&this.to.col<0)return 0;const e=Math.max(this.from.col,0),n=Math.max(this.to.col,0);return Math.max(e,n)-Math.min(e,n)+1}getCellsCount(){return this.getWidth()*this.getHeight()}includes(e){const{row:n,col:i}=e,r=this.getOuterTopStartCorner(),o=this.getOuterBottomEndCorner();return r.row<=n&&o.row>=n&&r.col<=i&&o.col>=i}includesRange(e){return this.includes(e.getOuterTopStartCorner())&&this.includes(e.getOuterBottomEndCorner())}isEqual(e){return Math.min(this.from.row,this.to.row)===Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)===Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)===Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)===Math.max(e.from.col,e.to.col)}overlaps(e){return e.isSouthEastOf(this.getOuterTopLeftCorner())&&e.isNorthWestOf(this.getOuterBottomRightCorner())}isSouthEastOf(e){return this.getOuterTopLeftCorner().isSouthEastOf(e)||this.getOuterBottomRightCorner().isSouthEastOf(e)}isNorthWestOf(e){return this.getOuterTopLeftCorner().isNorthWestOf(e)||this.getOuterBottomRightCorner().isNorthWestOf(e)}isOverlappingHorizontally(e){return this.getOuterTopEndCorner().col>=e.getOuterTopStartCorner().col&&this.getOuterTopEndCorner().col<=e.getOuterTopEndCorner().col||this.getOuterTopStartCorner().col<=e.getOuterTopEndCorner().col&&this.getOuterTopStartCorner().col>=e.getOuterTopStartCorner().col}isOverlappingVertically(e){return this.getOuterBottomStartCorner().row>=e.getOuterTopRightCorner().row&&this.getOuterBottomStartCorner().row<=e.getOuterBottomStartCorner().row||this.getOuterTopEndCorner().row<=e.getOuterBottomStartCorner().row&&this.getOuterTopEndCorner().row>=e.getOuterTopRightCorner().row}expand(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();return e.row<n.row||e.col<n.col||e.row>i.row||e.col>i.col?(this.from=this._createCellCoords(Math.min(n.row,e.row),Math.min(n.col,e.col)),this.to=this._createCellCoords(Math.max(i.row,e.row),Math.max(i.col,e.col)),!0):!1}expandByRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(this.includesRange(e)||!this.overlaps(e))return!1;const i=this.getOuterTopStartCorner(),r=this.getOuterBottomEndCorner(),o=this.getDirection(),a=e.getOuterTopStartCorner(),u=e.getOuterBottomEndCorner(),h=Math.min(i.row,a.row),d=Math.min(i.col,a.col),g=Math.max(r.row,u.row),m=Math.max(r.col,u.col),v=this._createCellCoords(h,d),y=this._createCellCoords(g,m);return this.from=v,this.to=y,this.setDirection(o),n&&(this.highlight.row===this.getOuterBottomRightCorner().row&&this.getVerticalDirection()==="N-S"&&this.flipDirectionVertically(),this.highlight.col===this.getOuterTopRightCorner().col&&this.getHorizontalDirection()==="W-E"&&this.flipDirectionHorizontally()),!0}getDirection(){if(this.from.isNorthWestOf(this.to))return"NW-SE";if(this.from.isNorthEastOf(this.to))return"NE-SW";if(this.from.isSouthEastOf(this.to))return"SE-NW";if(this.from.isSouthWestOf(this.to))return"SW-NE"}setDirection(e){switch(e){case"NW-SE":[this.from,this.to]=[this.getOuterTopLeftCorner(),this.getOuterBottomRightCorner()];break;case"NE-SW":[this.from,this.to]=[this.getOuterTopRightCorner(),this.getOuterBottomLeftCorner()];break;case"SE-NW":[this.from,this.to]=[this.getOuterBottomRightCorner(),this.getOuterTopLeftCorner()];break;case"SW-NE":[this.from,this.to]=[this.getOuterBottomLeftCorner(),this.getOuterTopRightCorner()];break}}getVerticalDirection(){return["NE-SW","NW-SE"].indexOf(this.getDirection())>-1?"N-S":"S-N"}getHorizontalDirection(){return["NW-SE","SW-NE"].indexOf(this.getDirection())>-1?"W-E":"E-W"}flipDirectionVertically(){switch(this.getDirection()){case"NW-SE":this.setDirection("SW-NE");break;case"NE-SW":this.setDirection("SE-NW");break;case"SE-NW":this.setDirection("NE-SW");break;case"SW-NE":this.setDirection("NW-SE");break}}flipDirectionHorizontally(){switch(this.getDirection()){case"NW-SE":this.setDirection("NE-SW");break;case"NE-SW":this.setDirection("NW-SE");break;case"SE-NW":this.setDirection("SW-NE");break;case"SW-NE":this.setDirection("SE-NW");break}}getTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getTopLeftCorner(){return as(Gr,this)?this.getTopEndCorner():this.getTopStartCorner()}getBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getBottomRightCorner(){return as(Gr,this)?this.getBottomStartCorner():this.getBottomEndCorner()}getTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col)).normalize()}getTopRightCorner(){return as(Gr,this)?this.getTopStartCorner():this.getTopEndCorner()}getBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col)).normalize()}getBottomLeftCorner(){return as(Gr,this)?this.getBottomEndCorner():this.getBottomStartCorner()}getOuterTopStartCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterTopLeftCorner(){return as(Gr,this)?this.getOuterTopEndCorner():this.getOuterTopStartCorner()}getOuterBottomEndCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterBottomRightCorner(){return as(Gr,this)?this.getOuterBottomStartCorner():this.getOuterBottomEndCorner()}getOuterTopEndCorner(){return this._createCellCoords(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))}getOuterTopRightCorner(){return as(Gr,this)?this.getOuterTopStartCorner():this.getOuterTopEndCorner()}getOuterBottomStartCorner(){return this._createCellCoords(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))}getOuterBottomLeftCorner(){return as(Gr,this)?this.getOuterBottomEndCorner():this.getOuterBottomStartCorner()}isCorner(e){return e.isEqual(this.getOuterTopLeftCorner())||e.isEqual(this.getOuterTopRightCorner())||e.isEqual(this.getOuterBottomLeftCorner())||e.isEqual(this.getOuterBottomRightCorner())}getOppositeCorner(e){if(!(e instanceof Md))return!1;if(e.isEqual(this.getOuterBottomEndCorner()))return this.getOuterTopStartCorner();if(e.isEqual(this.getOuterTopStartCorner()))return this.getOuterBottomEndCorner();if(e.isEqual(this.getOuterTopEndCorner()))return this.getOuterBottomStartCorner();if(e.isEqual(this.getOuterBottomStartCorner()))return this.getOuterTopEndCorner()}getBordersSharedWith(e){if(!this.includesRange(e))return[];const n={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},i={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},r=[];return n.top===i.top&&r.push("top"),n.right===i.right&&r.push(as(Gr,this)?"left":"right"),n.bottom===i.bottom&&r.push("bottom"),n.left===i.left&&r.push(as(Gr,this)?"right":"left"),r}getInner(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)!(this.from.row===r&&this.from.col===o)&&!(this.to.row===r&&this.to.col===o)&&i.push(this._createCellCoords(r,o));return i}getAll(){const e=this.getOuterTopStartCorner(),n=this.getOuterBottomEndCorner(),i=[];for(let r=e.row;r<=n.row;r++)for(let o=e.col;o<=n.col;o++)e.row===r&&e.col===o?i.push(e):n.row===r&&n.col===o?i.push(n):i.push(this._createCellCoords(r,o));return i}forAll(e){const n=this.getOuterTopStartCorner(),i=this.getOuterBottomEndCorner();for(let r=n.row;r<=i.row;r++)for(let o=n.col;o<=i.col;o++)if(e(r,o)===!1)return}clone(){return new bm(this.highlight,this.from,this.to,as(Gr,this))}toObject(){return{from:this.from.toObject(),to:this.to.toObject()}}_createCellCoords(e,n){return new Md(e,n,as(Gr,this))}}function Ca(t,e,n){Wle(t,e),e.set(t,n)}function Wle(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ye(t,e){return t.get(e5(t,e))}function qu(t,e,n){return t.set(e5(t,e),n),n}function e5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ls=new WeakMap,RA=new WeakMap,Ui=new WeakMap,Of=new WeakMap,HS=new WeakMap,Fs=new WeakMap,EA=new WeakMap,kp=new WeakMap,mh=new WeakMap,Ra=new WeakMap;let t5=class{constructor(e,n,i,r,o,a){let u=arguments.length>6&&arguments[6]!==void 0?arguments[6]:null;Ca(this,ls,void 0),Ca(this,RA,void 0),Ca(this,Ui,void 0),Ca(this,Of,void 0),Ca(this,HS,void 0),Ca(this,Fs,void 0),Ca(this,EA,void 0),Ca(this,kp,void 0),Ca(this,mh,[null,null]),Ca(this,Ra,[null,null]),qu(ls,this,i),qu(RA,this,n),qu(Ui,this,o),qu(Of,this,a),qu(HS,this,u),qu(Fs,this,r),qu(EA,this,e),this.registerEvents()}registerEvents(){Ye(Fs,this).addEventListener(Ye(Ui,this).holder,"contextmenu",i=>this.onContextMenu(i)),Ye(Fs,this).addEventListener(Ye(Ui,this).TABLE,"mouseover",i=>this.onMouseOver(i)),Ye(Fs,this).addEventListener(Ye(Ui,this).TABLE,"mouseout",i=>this.onMouseOut(i));const e=()=>{Ye(Fs,this).addEventListener(Ye(Ui,this).holder,"touchstart",i=>this.onTouchStart(i)),Ye(Fs,this).addEventListener(Ye(Ui,this).holder,"touchend",i=>this.onTouchEnd(i)),this.momentumScrolling||(this.momentumScrolling={}),Ye(Fs,this).addEventListener(Ye(Ui,this).holder,"scroll",()=>{clearTimeout(this.momentumScrolling._timeout),this.momentumScrolling.ongoing||Ye(ls,this).getSetting("onBeforeTouchScroll"),this.momentumScrolling.ongoing=!0,this.momentumScrolling._timeout=setTimeout(()=>{this.touchApplied||(this.momentumScrolling.ongoing=!1,Ye(ls,this).getSetting("onAfterMomentumScroll"))},200)})},n=()=>{Ye(Fs,this).addEventListener(Ye(Ui,this).holder,"mouseup",i=>this.onMouseUp(i)),Ye(Fs,this).addEventListener(Ye(Ui,this).holder,"mousedown",i=>this.onMouseDown(i))};el()?e():(v4()&&e(),n())}selectedCellWasTouched(e){const i=this.parentCell(e).coords;if(Ye(kp,this)&&i){const[r,o]=[i.row,Ye(kp,this).from.row],[a,u]=[i.col,Ye(kp,this).from.col];return r===o&&a===u}return!1}parentCell(e){const n={},i=Ye(Ui,this).TABLE,r=TS(e,["TD","TH"],i);return r?(n.coords=Ye(Ui,this).getCoords(r),n.TD=r):Xe(e,"wtBorder")&&Xe(e,"current")?(n.coords=Ye(Of,this).getFocusSelection().cellRange.highlight,n.TD=Ye(Ui,this).getCell(n.coords)):Xe(e,"wtBorder")&&Xe(e,"area")&&Ye(Of,this).getAreaSelection().cellRange&&(n.coords=Ye(Of,this).getAreaSelection().cellRange.to,n.TD=Ye(Ui,this).getCell(n.coords)),n}onMouseDown(e){const n=Ye(RA,this).rootDocument.activeElement,i=N4(Nse,e.target),r=e.target;if(!["TD","TH"].includes(n.nodeName)&&(r===n||i(0)===n||i(1)===n))return;const o=this.parentCell(r);Xe(r,"corner")?Ye(ls,this).getSetting("onCellCornerMouseDown",e,r):o.TD&&Ye(ls,this).has("onCellMouseDown")&&this.callListener("onCellMouseDown",e,o.coords,o.TD),(e.button===0||this.touchApplied)&&o.TD&&(Ye(Ra,this)[0]=o.TD,clearTimeout(Ye(mh,this)[0]),Ye(mh,this)[0]=setTimeout(()=>{Ye(Ra,this)[0]=null},1e3))}onContextMenu(e){if(Ye(ls,this).has("onCellContextMenu")){const n=this.parentCell(e.target);n.TD&&this.callListener("onCellContextMenu",e,n.coords,n.TD)}}onMouseOver(e){if(!Ye(ls,this).has("onCellMouseOver"))return;const n=Ye(Ui,this).TABLE,i=TS(e.target,["TD","TH"],n),r=Ye(HS,this)||this;i&&i!==r.lastMouseOver&&bd(i,n)&&(r.lastMouseOver=i,this.callListener("onCellMouseOver",e,Ye(Ui,this).getCoords(i),i))}onMouseOut(e){if(!Ye(ls,this).has("onCellMouseOut"))return;const n=Ye(Ui,this).TABLE,i=TS(e.target,["TD","TH"],n),r=TS(e.relatedTarget,["TD","TH"],n),o=Ye(HS,this)||this;i&&i!==r&&bd(i,n)&&(this.callListener("onCellMouseOut",e,Ye(Ui,this).getCoords(i),i),r===null&&(o.lastMouseOver=null))}onMouseUp(e){const n=this.parentCell(e.target);n.TD&&Ye(ls,this).has("onCellMouseUp")&&this.callListener("onCellMouseUp",e,n.coords,n.TD),!(e.button!==0&&!this.touchApplied)&&(n.TD===Ye(Ra,this)[0]&&n.TD===Ye(Ra,this)[1]?(Xe(e.target,"corner")?this.callListener("onCellCornerDblClick",e,n.coords,n.TD):this.callListener("onCellDblClick",e,n.coords,n.TD),Ye(Ra,this)[0]=null,Ye(Ra,this)[1]=null):n.TD===Ye(Ra,this)[0]&&(Ye(Ra,this)[1]=n.TD,clearTimeout(Ye(mh,this)[1]),Ye(mh,this)[1]=setTimeout(()=>{Ye(Ra,this)[1]=null},500)))}onTouchStart(e){qu(kp,this,Ye(Of,this).getFocusSelection().cellRange),this.touchApplied=!0,this.onMouseDown(e)}onTouchEnd(e){var n;const i=e.target,r=(n=this.parentCell(i))===null||n===void 0?void 0:n.coords,o=Ne(r)&&r.row>=0&&r.col>=0;if(e.cancelable&&o&&Ye(ls,this).getSetting("isDataViewInstance")){const u=["A","BUTTON","INPUT"];y4()&&(Hse()||Ise())&&this.selectedCellWasTouched(i)&&!u.includes(i.tagName)?e.preventDefault():this.selectedCellWasTouched(i)||e.preventDefault()}this.onMouseUp(e),this.touchApplied=!1}callListener(e,n,i,r){const o=Ye(ls,this).getSettingPure(e);o&&o(n,i,r,Ye(EA,this).call(this))}destroy(){clearTimeout(Ye(mh,this)[0]),clearTimeout(Ye(mh,this)[1]),Ye(Fs,this).destroy()}};function TA(t,e,n){return(e=jle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jle(t){var e=zle(t,"string");return typeof e=="symbol"?e:e+""}function zle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ule{constructor(e,n,i){TA(this,"offset",void 0),TA(this,"total",void 0),TA(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleRowHeadedColumnToSourceColumn(e){return this.renderedToSource(this.offsettedTH(e))}sourceColumnToVisibleRowHeadedColumn(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function _A(t,e,n){return(e=Yle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yle(t){var e=Gle(t,"string");return typeof e=="symbol"?e:e+""}function Gle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qle{constructor(e,n,i){_A(this,"offset",void 0),_A(this,"total",void 0),_A(this,"countTH",void 0),this.offset=e,this.total=n,this.countTH=i}offsetted(e){return e+this.offset}unOffsetted(e){return e-this.offset}renderedToSource(e){return this.offsetted(e)}sourceToRendered(e){return this.unOffsetted(e)}offsettedTH(e){return e-this.countTH}unOffsettedTH(e){return e+this.countTH}visibleColHeadedRowToSourceRow(e){return this.renderedToSource(this.offsettedTH(e))}sourceRowToVisibleColHeadedRow(e){return this.unOffsettedTH(this.sourceToRendered(e))}}function IS(t,e,n){return(e=Kle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kle(t){var e=Xle(t,"string");return typeof e=="symbol"?e:e+""}function Xle(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Zle{constructor(){IS(this,"currentSize",0),IS(this,"nextSize",0),IS(this,"currentOffset",0),IS(this,"nextOffset",0)}setSize(e){this.currentSize=this.nextSize,this.nextSize=e}setOffset(e){this.currentOffset=this.nextOffset,this.nextOffset=e}}const Qle=0,Wz=1,FH=2;function MA(t,e,n){return(e=Jle(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jle(t){var e=eue(t,"string");return typeof e=="symbol"?e:e+""}function eue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tue{constructor(){MA(this,"size",new Zle),MA(this,"workingSpace",Qle),MA(this,"sharedSize",null)}setSize(e){this.size.setSize(e)}setOffset(e){this.size.setOffset(e)}getViewSize(){return this.size}isShared(){return this.sharedSize!==null}isPlaceOn(e){return this.workingSpace===e}append(e){this.workingSpace=Wz,e.workingSpace=FH,this.sharedSize=e.getViewSize()}prepend(e){this.workingSpace=FH,e.workingSpace=Wz,this.sharedSize=e.getViewSize()}}var jz={},AA,zz;function nue(){if(zz)return AA;zz=1;var t=tR(),e=TypeError;return AA=function(n,i){if(!delete n[i])throw new e("Cannot delete property "+t(i)+" of "+t(n))},AA}var Uz;function iue(){if(Uz)return jz;Uz=1;var t=Cn(),e=gm(),n=pm(),i=Jq(),r=nue(),o=e6(),a=[].unshift(0)!==1,u=function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(d){return d instanceof TypeError}},h=a||!u();return t({target:"Array",proto:!0,arity:1,forced:h},{unshift:function(g){var m=e(this),v=n(m),y=arguments.length;if(y){o(v+y);for(var b=v;b--;){var C=b+y;b in m?m[C]=m[b]:r(m,C)}for(var T=0;T<y;T++)m[T]=arguments[T]}return i(m,v+y)}}),jz}iue();function rue(t,e,n){return(e=oue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oue(t){var e=sue(t,"string");return typeof e=="symbol"?e:e+""}function sue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Yz{constructor(e,n){rue(this,"order",[]),this.order=[...Array(n).keys()].map(i=>e+i)}get length(){return this.order.length}has(e){return this.order.indexOf(e)>-1}get(e){return e<this.order.length?this.order[e]:-1}remove(e){this.order.splice(this.order.indexOf(e),1)}prepend(e){return this.order.unshift(e),this.order.pop()}}function aue(t,e,n){return(e=lue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lue(t){var e=uue(t,"string");return typeof e=="symbol"?e:e+""}function uue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cue{constructor(e){aue(this,"sizeSet",void 0),this.sizeSet=e}diff(){const{sizeSet:e}=this,{currentSize:n,nextSize:i}=e.getViewSize();let r=Math.max(i,n);if(r===0)return[];const{currentOffset:o,nextOffset:a}=e.getViewSize(),u=new Yz(o,n),h=new Yz(a,i),d=[];for(let g=0;g<r;g++){const m=u.get(g),v=h.get(g);if(v===-1)d.push(["remove",m]);else if(m===-1)!e.isShared()||e.isShared()&&e.isPlaceOn(FH)?d.push(["append",v]):d.push(["prepend",v]);else if(v>m)u.has(v)&&(u.remove(v),i<=u.length&&(r-=1)),d.push(["replace",v,m]);else if(v<m){const y=u.prepend(v);d.push(["insert_before",v,m,y])}else d.push(["none",v])}return d}}function xf(t,e,n){return(e=hue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hue(t){var e=due(t,"string");return typeof e=="symbol"?e:e+""}function due(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n5{constructor(e,n){xf(this,"rootNode",void 0),xf(this,"nodesPool",void 0),xf(this,"sizeSet",new tue),xf(this,"collectedNodes",[]),xf(this,"viewDiffer",new cue(this.sizeSet)),xf(this,"leads",[]),this.rootNode=e,this.nodesPool=n}setSize(e){return this.sizeSet.setSize(e),this}setOffset(e){return this.sizeSet.setOffset(e),this}isSharedViewSet(){return this.sizeSet.isShared()}getNode(e){return e<this.collectedNodes.length?this.collectedNodes[e]:null}getCurrentNode(){const e=this.collectedNodes.length;return e>0?this.collectedNodes[e-1]:null}applyCommand(e){const{rootNode:n}=this,[i,r,o,a]=e,u=this.nodesPool(r);switch(this.collectedNodes.push(u),i){case"prepend":n.insertBefore(u,n.firstChild);break;case"append":n.appendChild(u);break;case"insert_before":n.insertBefore(u,this.nodesPool(o)),n.removeChild(this.nodesPool(a));break;case"replace":n.replaceChild(u,this.nodesPool(o));break;case"remove":n.removeChild(u);break}}start(){this.collectedNodes.length=0,this.leads=this.viewDiffer.diff()}render(){this.leads.length>0&&this.applyCommand(this.leads.shift())}end(){for(;this.leads.length>0;)this.applyCommand(this.leads.shift())}}class i5 extends n5{prependView(e){return this.sizeSet.prepend(e.sizeSet),e.sizeSet.append(this.sizeSet),this}appendView(e){return this.sizeSet.append(e.sizeSet),e.sizeSet.prepend(this.sizeSet),this}}function Gz(t,e,n){return(e=fue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fue(t){var e=gue(t,"string");return typeof e=="symbol"?e:e+""}function gue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class mue{constructor(e){Gz(this,"nodeType",void 0),Gz(this,"pool",new Map),this.nodeType=e.toUpperCase()}setRootDocument(e){this.rootDocument=e}obtain(e,n){const r=typeof n=="number"?`${e}x${n}`:e.toString();if(this.pool.has(r))return this.pool.get(r);const o=this.rootDocument.createElement(this.nodeType);return this.pool.set(r,o),o}}function $p(t,e,n){return(e=pue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function pue(t){var e=vue(t,"string");return typeof e=="symbol"?e:e+""}function vue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class jw{constructor(e,n){$p(this,"nodesPool",null),$p(this,"nodeType",void 0),$p(this,"rootNode",void 0),$p(this,"table",null),$p(this,"renderedNodes",0),this.nodesPool=typeof e=="string"?new mue(e):null,this.nodeType=e,this.rootNode=n}setTable(e){this.nodesPool&&this.nodesPool.setRootDocument(e.rootDocument),this.table=e}adjust(){}render(){}}function qz(t,e,n){return(e=wue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wue(t){var e=yue(t,"string");return typeof e=="symbol"?e:e+""}function yue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Sue extends jw{constructor(){super("TH"),qz(this,"orderViews",new WeakMap),qz(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new i5(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i)),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,rowHeaderFunctions:n,rowHeadersCount:i,rows:r,cells:o}=this.table;for(let a=0;a<e;a++){const u=this.table.renderedRowToSource(a),h=r.getRenderedNode(a);this.sourceRowIndex=u;const d=this.obtainOrderView(h),g=o.obtainOrderView(h);d.appendView(g).setSize(i).setOffset(0).start();for(let m=i-1;m>=0;m--){d.render();const v=d.getCurrentNode();v.className="",v.removeAttribute("style"),uu(v,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&We(v,[Joe(),cse(),CP(m+1),lo(-1)]),n[m](u,v,m)}d.end()}}}class bue extends jw{constructor(e){super(null,e)}adjust(){const{columnHeadersCount:e,rowHeadersCount:n}=this.table;let i=this.rootNode.firstChild;if(e){const{columnsToRender:r}=this.table,o=r+n;for(let u=0,h=e;u<h;u++){for(i=this.rootNode.childNodes[u],i||(i=this.table.rootDocument.createElement("tr"),this.rootNode.appendChild(i)),this.renderedNodes=i.childNodes.length;this.renderedNodes<o;)i.appendChild(this.table.rootDocument.createElement("th")),this.renderedNodes+=1;for(;this.renderedNodes>o;)i.removeChild(i.lastChild),this.renderedNodes-=1}const a=this.rootNode.childNodes.length;if(a>e)for(let u=e;u<a;u++)this.rootNode.removeChild(this.rootNode.lastChild)}else i&&du(i)}render(){const{columnHeadersCount:e}=this.table;this.table.isAriaEnabled()&&We(this.rootNode,[c4()]);for(let n=0;n<e;n+=1){const{columnHeaderFunctions:i,columnsToRender:r,rowHeadersCount:o}=this.table,a=this.rootNode.childNodes[n];this.table.isAriaEnabled()&&We(a,[h4(),m4(n+1)]);for(let u=-1*o;u<r;u+=1){const h=this.table.renderedColumnToSource(u),d=a.childNodes[u+o];d.className="",d.removeAttribute("style"),uu(d,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.isAriaEnabled()&&We(d,[CP(u+1+this.table.rowHeadersCount),lo(-1),ese(),...u>=0?[use()]:[Qoe(),Bo("Select whole grid")]]),i[n](h,d,n)}}}}let Kz=!1;class Cue extends jw{constructor(e){super(null,e)}adjust(){const{columnsToRender:e,rowHeadersCount:n}=this.table,i=e+n;for(;this.renderedNodes<i;)this.rootNode.appendChild(this.table.rootDocument.createElement("col")),this.renderedNodes+=1;for(;this.renderedNodes>i;)this.rootNode.removeChild(this.rootNode.lastChild),this.renderedNodes-=1}render(){this.adjust();const{columnsToRender:e,rowHeadersCount:n}=this.table;!Kz&&e>1e3&&(Kz=!0,_t(Ft`Performance tip: Handsontable rendered more than 1000 visible columns.\x20
        Consider limiting the number of rendered columns by specifying the table width and/or\x20
        turning off the "renderAllColumns" option.`));for(let r=0;r<n;r++){const o=this.table.renderedColumnToSource(r),a=this.table.columnUtils.getHeaderWidth(o);this.rootNode.childNodes[r].style.width=`${a}px`}for(let r=0;r<e;r++){const o=this.table.renderedColumnToSource(r),a=this.table.columnUtils.getWidth(o);this.rootNode.childNodes[r+n].style.width=`${a}px`}const i=this.rootNode.firstChild;i&&fe(i,"rowHeader")}}function Rue(t,e,n){return(e=Eue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Eue(t){var e=Tue(t,"string");return typeof e=="symbol"?e:e+""}function Tue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Hf={rowEven:"ht__row_even",rowOdd:"ht__row_odd"};let Xz=!1;class _ue extends jw{constructor(e){super("TR",e),Rue(this,"orderView",void 0),this.orderView=new n5(e,n=>this.nodesPool.obtain(n))}getRenderedNode(e){return this.orderView.getNode(e)}hasStaleContent(e){return this.orderView.hasStaleContent(e)}render(){const{rowsToRender:e}=this.table;!Xz&&e>1e3&&(Xz=!0,_t(Ft`Performance tip: Handsontable rendered more than 1000 visible rows.\x20
        Consider limiting the number of rendered rows by specifying the table height and/or\x20
        turning off the "renderAllRows" option.`)),this.table.isAriaEnabled()&&We(this.rootNode,[c4()]),this.orderView.setSize(e).setOffset(this.table.renderedRowToSource(0)).start();for(let r=0;r<e;r++){this.orderView.render();const o=this.orderView.getCurrentNode(),a=this.table.renderedRowToSource(r);if(this.table.isAriaEnabled()){var n,i;We(o,[h4(),m4(a+((n=(i=this.table.rowUtils)===null||i===void 0||(i=i.dataAccessObject)===null||i===void 0?void 0:i.columnHeaders.length)!==null&&n!==void 0?n:0)+1)])}(a+1)%2===0?Xe(o,Hf.rowEven)||(Ve(o,Hf.rowOdd),fe(o,Hf.rowEven)):Xe(o,Hf.rowOdd)||(Ve(o,Hf.rowEven),fe(o,Hf.rowOdd))}this.orderView.end()}}function Zz(t,e,n){return(e=Mue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mue(t){var e=Aue(t,"string");return typeof e=="symbol"?e:e+""}function Aue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Oue extends jw{constructor(){super("TD"),Zz(this,"orderViews",new WeakMap),Zz(this,"sourceRowIndex",0)}obtainOrderView(e){let n;return this.orderViews.has(e)?n=this.orderViews.get(e):(n=new i5(e,i=>this.nodesPool.obtain(this.sourceRowIndex,i),this.nodeType),this.orderViews.set(e,n)),n}render(){const{rowsToRender:e,columnsToRender:n,rows:i,rowHeaders:r}=this.table;for(let u=0;u<e;u++){const h=this.table.renderedRowToSource(u),d=i.getRenderedNode(u);this.sourceRowIndex=h;const g=this.obtainOrderView(d),m=r.obtainOrderView(d);g.prependView(m).setSize(n).setOffset(0).start();for(let v=0;v<n;v++){g.render();const y=this.table.renderedColumnToSource(v),b=g.getCurrentNode();if(Xe(b,"hide")||(b.className=""),b.removeAttribute("style"),b.removeAttribute("dir"),uu(b,[new RegExp("aria-(.*)"),new RegExp("role")]),this.table.cellRenderer(h,y,b),this.table.isAriaEnabled()){var o,a;We(b,[...b.hasAttribute("role")?[]:[Zoe()],lo(-1),CP(y+((o=(a=this.table.rowUtils)===null||a===void 0||(a=a.dataAccessObject)===null||a===void 0?void 0:a.rowHeaders.length)!==null&&o!==void 0?o:0)+1)])}}g.end()}}}function bi(t,e,n){return(e=xue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xue(t){var e=Hue(t,"string");return typeof e=="symbol"?e:e+""}function Hue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Iue{constructor(e){let{cellRenderer:n,stylesHandler:i}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};bi(this,"rootNode",void 0),bi(this,"rootDocument",void 0),bi(this,"rowHeaders",null),bi(this,"columnHeaders",null),bi(this,"colGroup",null),bi(this,"rows",null),bi(this,"cells",null),bi(this,"rowFilter",null),bi(this,"columnFilter",null),bi(this,"rowUtils",null),bi(this,"columnUtils",null),bi(this,"rowsToRender",0),bi(this,"columnsToRender",0),bi(this,"rowHeaderFunctions",[]),bi(this,"rowHeadersCount",0),bi(this,"columnHeaderFunctions",[]),bi(this,"columnHeadersCount",0),bi(this,"cellRenderer",void 0),bi(this,"activeOverlayName",void 0),bi(this,"stylesHandler",void 0),this.rootNode=e,this.rootDocument=this.rootNode.ownerDocument,this.cellRenderer=n,this.stylesHandler=i}setActiveOverlayName(e){this.activeOverlayName=e}setAxisUtils(e,n){this.rowUtils=e,this.columnUtils=n}setViewportSize(e,n){this.rowsToRender=e,this.columnsToRender=n}setFilters(e,n){this.rowFilter=e,this.columnFilter=n}setHeaderContentRenderers(e,n){this.rowHeaderFunctions=e,this.rowHeadersCount=e.length,this.columnHeaderFunctions=n,this.columnHeadersCount=n.length}setRenderers(){let{rowHeaders:e,columnHeaders:n,colGroup:i,rows:r,cells:o}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};e.setTable(this),n.setTable(this),i.setTable(this),r.setTable(this),o.setTable(this),this.rowHeaders=e,this.columnHeaders=n,this.colGroup=i,this.rows=r,this.cells=o}renderedRowToSource(e){return this.rowFilter.renderedToSource(e)}renderedColumnToSource(e){return this.columnFilter.renderedToSource(e)}isAriaEnabled(){return this.rowUtils.wtSettings.getSetting("ariaTags")}render(){this.colGroup.adjust(),this.columnHeaders.adjust(),this.rows.adjust(),this.rowHeaders.adjust(),this.columnHeaders.render(),this.rows.render(),this.rowHeaders.render(),this.cells.render(),this.columnUtils.calculateWidths(),this.colGroup.render();const{rowsToRender:e,rows:n}=this;for(let i=0;i<e;i++){const r=n.getRenderedNode(i),o=this.rowUtils;if(r.firstChild){const a=this.renderedRowToSource(i),u=o.getHeightByOverlayName(a,this.activeOverlayName),d=this.stylesHandler.areCellsBorderBox()?0:1;u?r.firstChild.style.height=`${u-d}px`:r.firstChild.style.height=""}}}}class Pue{constructor(){let{TABLE:e,THEAD:n,COLGROUP:i,TBODY:r,rowUtils:o,columnUtils:a,cellRenderer:u,stylesHandler:h}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.renderer=new Iue(e,{cellRenderer:u,stylesHandler:h}),this.renderer.setRenderers({rowHeaders:new Sue,columnHeaders:new bue(n),colGroup:new Cue(i),rows:new _ue(r),cells:new Oue}),this.renderer.setAxisUtils(o,a)}setActiveOverlayName(e){return this.renderer.setActiveOverlayName(e),this}setFilters(e,n){return this.renderer.setFilters(e,n),this}setViewportSize(e,n){return this.renderer.setViewportSize(e,n),this}setHeaderContentRenderers(e,n){return this.renderer.setHeaderContentRenderers(e,n),this}adjust(){this.renderer.adjust()}render(){this.renderer.render()}}function OA(t,e,n){return(e=Nue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nue(t){var e=Due(t,"string");return typeof e=="symbol"?e:e+""}function Due(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lue{constructor(e,n){OA(this,"dataAccessObject",void 0),OA(this,"wtSettings",void 0),OA(this,"headerWidths",new Map),this.dataAccessObject=e,this.wtSettings=n}getWidth(e){return this.wtSettings.getSetting("columnWidth",e)||this.wtSettings.getSetting("defaultColumnWidth")}getHeaderHeight(e){let n=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();const i=this.dataAccessObject.wtViewport.oversizedColumnHeaders[e];return i!==void 0&&(n=n?Math.max(n,i):i),n}getHeaderWidth(e){return this.headerWidths.get(this.dataAccessObject.wtTable.columnFilter.sourceToRendered(e))}calculateWidths(){const{wtSettings:e}=this;let n=e.getSetting("rowHeaderWidth");if(n=e.getSetting("onModifyRowHeaderWidth",n),n!=null){const i=e.getSetting("rowHeaders").length,r=e.getSetting("defaultColumnWidth");for(let o=0;o<i;o++){let a=Array.isArray(n)?n[o]:n;a=a??r,this.headerWidths.set(o,a)}}}}function Qz(t,e,n){return(e=kue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kue(t){var e=$ue(t,"string");return typeof e=="symbol"?e:e+""}function $ue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vue{constructor(e,n){Qz(this,"dataAccessObject",void 0),Qz(this,"wtSettings",void 0),this.dataAccessObject=e,this.wtSettings=n}getHeight(e){let n=this.wtSettings.getSetting("rowHeight",e);const i=this.dataAccessObject.wtViewport.oversizedRows[e];return i!==void 0&&(n=n===void 0?i:Math.max(n,i)),n}getHeightByOverlayName(e,n){let i=this.wtSettings.getSetting("rowHeightByOverlayName",e,n);const r=this.dataAccessObject.wtViewport.oversizedRows[e];return r!==void 0&&(i=i===void 0?r:Math.max(i,r)),i}}function Ea(t,e,n){return(e=Bue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Bue(t){var e=Fue(t,"string");return typeof e=="symbol"?e:e+""}function Fue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Cm{constructor(e,n,i,r,o){Ea(this,"wtSettings",null),Ea(this,"domBindings",void 0),Ea(this,"TBODY",null),Ea(this,"THEAD",null),Ea(this,"COLGROUP",null),Ea(this,"hasTableHeight",!0),Ea(this,"hasTableWidth",!0),Ea(this,"isTableVisible",!1),Ea(this,"tableOffset",0),Ea(this,"holderOffset",0),this.domBindings=i,this.isMaster=o==="master",this.name=o,this.dataAccessObject=e,this.facadeGetter=n,this.wtSettings=r,this.instance=this.dataAccessObject.wot,this.wot=this.dataAccessObject.wot,this.TABLE=i.rootTable,R4(this.TABLE),this.spreader=this.createSpreader(this.TABLE),this.hider=this.createHider(this.spreader),this.holder=this.createHolder(this.hider),this.wtRootElement=this.holder.parentNode,this.isMaster&&this.alignOverlaysWithTrimmingContainer(),this.fixTableDomTree(),this.rowFilter=null,this.columnFilter=null,this.correctHeaderWidth=!1;const a=this.wtSettings.getSettingPure("rowHeaderWidth");this.wtSettings.update("rowHeaderWidth",()=>this._modifyRowHeaderWidth(a)),this.rowUtils=new Vue(this.dataAccessObject,this.wtSettings),this.columnUtils=new Lue(this.dataAccessObject,this.wtSettings),this.tableRenderer=new Pue({TABLE:this.TABLE,THEAD:this.THEAD,COLGROUP:this.COLGROUP,TBODY:this.TBODY,rowUtils:this.rowUtils,columnUtils:this.columnUtils,cellRenderer:this.wtSettings.getSettingPure("cellRenderer"),stylesHandler:this.wtSettings.getSetting("stylesHandler")})}is(e){return this.name===e}fixTableDomTree(){const e=this.domBindings.rootDocument;this.TBODY=this.TABLE.querySelector("tbody"),this.TBODY||(this.TBODY=e.createElement("tbody"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.querySelector("thead"),this.THEAD||(this.THEAD=e.createElement("thead"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.querySelector("colgroup"),this.COLGROUP||(this.COLGROUP=e.createElement("colgroup"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD))}createSpreader(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Xe(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtSpreader",n&&n.insertBefore(i,e),i.appendChild(e)),i.style.position="relative",this.wtSettings.getSetting("ariaTags")&&We(i,[tu()]),i}createHider(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Xe(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.className="wtHider",n&&n.insertBefore(i,e),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&We(i,[tu()]),i}createHolder(e){const n=e.parentNode;let i;return(!n||n.nodeType!==Node.ELEMENT_NODE||!Xe(n,"wtHolder"))&&(i=this.domBindings.rootDocument.createElement("div"),i.style.position="relative",i.className="wtHolder",this.isMaster&&We(i,[lo(-1)]),n&&n.insertBefore(i,e),this.isMaster&&(i.parentNode.className+="ht_master handsontable",i.parentNode.setAttribute("dir",this.wtSettings.getSettingPure("rtlMode")?"rtl":"ltr"),this.wtSettings.getSetting("ariaTags")&&We(i.parentNode,[tu()])),i.appendChild(e)),this.wtSettings.getSetting("ariaTags")&&We(i,[tu()]),i}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,{wtOverlays:i,wtViewport:r}=this.dataAccessObject,o=n.getSetting("totalRows"),a=n.getSetting("totalColumns"),u=n.getSetting("rowHeaders"),h=u.length,d=n.getSetting("columnHeaders"),g=d.length;let m=e;if(this.isMaster&&(i.beforeDraw(),this.holderOffset=pr(this.holder),m=r.createCalculators(m),h&&!n.getSetting("fixedColumnsStart"))){const y=i.inlineStartOverlay.getScrollPosition(),b=this.correctHeaderWidth;this.correctHeaderWidth=y!==0,b!==this.correctHeaderWidth&&(m=!1)}if(m)this.isMaster&&i.refresh(!0);else{this.isMaster?this.tableOffset=pr(this.TABLE):this.tableOffset=this.dataAccessObject.parentTableOffset;const y=Math.max(this.getFirstRenderedRow(),0),b=Math.max(this.getFirstRenderedColumn(),0);this.rowFilter=new qle(y,o,g),this.columnFilter=new Ule(b,a,h);let C=!0;if(this.isMaster){this.alignOverlaysWithTrimmingContainer();const T={};this.wtSettings.getSetting("beforeDraw",!0,T),C=T.skipRender!==!0}C&&(this.tableRenderer.setHeaderContentRenderers(u,d),(this.is(Xa)||this.is(Lc))&&this.tableRenderer.setHeaderContentRenderers(u,[]),this.resetOversizedRows(),this.tableRenderer.setActiveOverlayName(this.name).setViewportSize(this.getRenderedRowsCount(),this.getRenderedColumnsCount()).setFilters(this.rowFilter,this.columnFilter).render(),this.isMaster&&this.markOversizedColumnHeaders(),this.adjustColumnHeaderHeights(),(this.isMaster||this.is(Xa))&&this.markOversizedRows(),this.isMaster?(this.wtSettings.getSetting("externalRowCalculator")||r.createVisibleCalculators(),i.refresh(!1),i.applyToDOM(),this.wtSettings.getSetting("onDraw",!0)):this.is(Xa)&&this.dataAccessObject.cloneSource.wtOverlays.adjustElementsSize())}let v=!1;return this.isMaster&&(v=i.topOverlay.resetFixedPosition(),i.bottomOverlay.clone&&(v=i.bottomOverlay.resetFixedPosition()||v),v=i.inlineStartOverlay.resetFixedPosition()||v,i.topInlineStartCornerOverlay&&i.topInlineStartCornerOverlay.resetFixedPosition(),i.bottomInlineStartCornerOverlay&&i.bottomInlineStartCornerOverlay.clone&&i.bottomInlineStartCornerOverlay.resetFixedPosition()),v?(i.refreshAll(),i.adjustElementsSize()):this.dataAccessObject.selectionManager.setActiveOverlay(this.facadeGetter()).render(m),this.isMaster&&i.afterDraw(),this.dataAccessObject.drawn=!0,this}markIfOversizedColumnHeader(e){const n=this.columnFilter.renderedToSource(e);let i=this.wtSettings.getSetting("columnHeaders").length;const r=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let o,a,u;const h=this.wtSettings.getSetting("columnHeaderHeight")||[];for(;i;)i-=1,o=this.getColumnHeaderHeight(i),a=this.getColumnHeader(n,i),a&&(u=kv(a),(!o&&r<u||o<u)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=u),Array.isArray(h)?h[i]!==null&&h[i]!==void 0&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]):isNaN(h)||(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h),this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]<(h[i]||h)&&(this.dataAccessObject.wtViewport.oversizedColumnHeaders[i]=h[i]||h))}adjustColumnHeaderHeights(){const{wtSettings:e}=this,n=this.THEAD.childNodes,i=this.dataAccessObject.wtViewport.oversizedColumnHeaders,r=e.getSetting("columnHeaders");for(let o=0,a=r.length;o<a;o++)if(i[o]){if(!n[o]||n[o].childNodes.length===0)return;n[o].childNodes[0].style.height=`${i[o]}px`}}resetOversizedRows(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject;if(!(!this.isMaster&&!this.is(Xa))&&!e.getSetting("externalRowCalculator")){const i=this.getRenderedRowsCount();for(let r=0;r<i;r++){const o=this.rowFilter.renderedToSource(r);n.oversizedRows&&n.oversizedRows[o]&&(n.oversizedRows[o]=void 0)}}}getCell(e){let n=e.row,i=e.col;const r=this.wtSettings.getSetting("onModifyGetCellCoords",n,i,!this.isMaster,"render");if(r&&Array.isArray(r)&&([n,i]=r),this.isRowBeforeRenderedRows(n))return-1;if(this.isRowAfterRenderedRows(n))return-2;if(this.isColumnBeforeRenderedColumns(i))return-3;if(this.isColumnAfterRenderedColumns(i))return-4;const o=this.getRow(n);if(!o&&n>=0)throw new Error("TR was expected to be rendered but is not");const a=o.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(i)];if(!a&&i>=0)throw new Error("TD or TH was expected to be rendered but is not");return a}getRow(e){let n=null,i=null;if(e<0){var r;n=(r=this.rowFilter)===null||r===void 0?void 0:r.sourceRowToVisibleColHeadedRow(e),i=this.THEAD}else{var o;n=(o=this.rowFilter)===null||o===void 0?void 0:o.sourceToRendered(e),i=this.TBODY}return n!==void 0&&i!==void 0?i.childNodes.length<n+1?!1:i.childNodes[n]:!1}getColumnHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.THEAD.childNodes[n];return i?.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]}getColumnHeaders(e){const n=[],i=this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e);return this.THEAD.childNodes.forEach(r=>{const o=r.childNodes[i];o&&n.push(o)}),n}getRowHeader(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;const i=this.wtSettings.getSetting("rowHeaders").length;if(n>=i)return;const r=this.rowFilter.sourceToRendered(e),o=r<0?this.rowFilter.sourceRowToVisibleColHeadedRow(e):r,u=(r<0?this.THEAD:this.TBODY).childNodes[o];return u?.childNodes[n]}getRowHeaders(e){const n=[],i=this.wtSettings.getSetting("rowHeaders").length;for(let r=0;r<i;r++){const o=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)],a=o?.childNodes[r];a&&n.push(a)}return n}getCoords(e){let n=e;if(n.nodeName!=="TD"&&n.nodeName!=="TH"&&(n=Ed(n,["TD","TH"])),n===null)return null;const i=n.parentNode;if(!i)return null;const r=i.parentNode;let o=kse(i),a=n.cellIndex;fh(xd,n,this.wtRootElement)||fh(Ad,n,this.wtRootElement)?r.nodeName==="THEAD"&&(o-=r.childNodes.length):fh(Lc,n,this.wtRootElement)||fh(Xa,n,this.wtRootElement)?o=this.wtSettings.getSetting("totalRows")-r.childNodes.length+o:r===this.THEAD?o=this.rowFilter.visibleColHeadedRowToSourceRow(o):this.rowFilter&&(o=this.rowFilter.renderedToSource(o)),fh(xd,n,this.wtRootElement)||fh(Od,n,this.wtRootElement)||fh(Lc,n,this.wtRootElement)?a=this.columnFilter.offsettedTH(a):this.columnFilter&&(a=this.columnFilter.visibleRowHeadedColumnToSourceColumn(a));const u=this.wtSettings.getSetting("onModifyGetCoordsElement",o,a);return u&&Array.isArray(u)&&([o,a]=u),this.wot.createCellCoords(o,a)}markOversizedRows(){if(this.wtSettings.getSetting("externalRowCalculator"))return;let e=this.TBODY.childNodes.length;const n=this.wtSettings.getSetting("stylesHandler"),i=e*n.getDefaultRowHeight(),r=kv(this.TBODY)-1,o=n.areCellsBorderBox(),a=o?Ti:kv,u=o?0:1,h=o?1:0;let d,g,m,v,y;if(!(i===r&&!this.wtSettings.getSetting("fixedRowsBottom")))for(;e;){e-=1,m=this.rowFilter.renderedToSource(e),d=this.getRowHeight(m),v=this.getTrForRow(m),y=v.querySelector("th");const b=m===0?h:0;y?g=a(y):g=a(v)-u,(!d&&n.getDefaultRowHeight()<g-b||d<g)&&(o||(g+=1),this.dataAccessObject.wtViewport.oversizedRows[m]=g)}}getTrForRow(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]}isColumnHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("rowHeaders").length;return Math.abs(e)<=i}isRowHeaderRendered(e){if(e>=0)return!1;const i=this.wtSettings.getSetting("columnHeaders").length;return Math.abs(e)<=i}isRowBeforeRenderedRows(e){const n=this.getFirstRenderedRow();return e<0&&n<=0?!this.isRowHeaderRendered(e):e<n}isRowAfterRenderedRows(e){return e>this.getLastRenderedRow()}isColumnBeforeRenderedColumns(e){const n=this.getFirstRenderedColumn();return e<0&&n<=0?!this.isColumnHeaderRendered(e):e<n}isColumnAfterRenderedColumns(e){return this.columnFilter&&e>this.getLastRenderedColumn()}isColumnAfterViewport(e){return this.columnFilter&&e>this.getLastVisibleColumn()}isRowAfterViewport(e){return this.rowFilter&&e>this.getLastVisibleRow()}isColumnBeforeViewport(e){return this.columnFilter&&this.columnFilter.sourceToRendered(e)<0&&e>=0}isLastRowFullyVisible(){return this.getLastVisibleRow()===this.getLastRenderedRow()}isLastColumnFullyVisible(){return this.getLastVisibleColumn()===this.getLastRenderedColumn()}allRowsInViewport(){return this.wtSettings.getSetting("totalRows")===this.getVisibleRowsCount()}allColumnsInViewport(){return this.wtSettings.getSetting("totalColumns")===this.getVisibleColumnsCount()}getRowHeight(e){return this.rowUtils.getHeight(e)}getColumnHeaderHeight(e){return this.columnUtils.getHeaderHeight(e)}getColumnWidth(e){return this.columnUtils.getWidth(e)}hasDefinedSize(){return this.hasTableHeight&&this.hasTableWidth}getWidth(){return hi(this.TABLE)}getHeight(){return Ti(this.TABLE)}getTotalWidth(){const e=hi(this.hider);return e!==0?e:this.getWidth()}getTotalHeight(){const e=Ti(this.hider);return e!==0?e:this.getHeight()}isVisible(){return Qg(this.TABLE)}_modifyRowHeaderWidth(e){let n=Yt(e)?e():null;return Array.isArray(n)?(n=[...n],n[n.length-1]=this._correctRowHeaderWidth(n[n.length-1])):n=this._correctRowHeaderWidth(n),n}_correctRowHeaderWidth(e){let n=e;return typeof e!="number"&&(n=this.wtSettings.getSetting("defaultColumnWidth")),this.correctHeaderWidth&&(n+=1),n}}const Wue="stickyRowsBottom",PP={getFirstRenderedRow(){const t=this.getRenderedRowsCount();return t===0?-1:this.wtSettings.getSetting("totalRows")-t},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()===0?-1:this.wtSettings.getSetting("totalRows")-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsBottom"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return 0}};yu(PP,"MIXIN_NAME",Wue,{writable:!1,enumerable:!1});const jue="stickyColumnsStart",RR={getFirstRenderedColumn(){return this.getRenderedColumnsCount()===0?-1:0},getFirstVisibleColumn(){return this.getFirstRenderedColumn()},getFirstPartiallyVisibleColumn(){return this.getFirstRenderedColumn()},getLastRenderedColumn(){return this.getRenderedColumnsCount()-1},getLastVisibleColumn(){return this.getLastRenderedColumn()},getLastPartiallyVisibleColumn(){return this.getLastRenderedColumn()},getRenderedColumnsCount(){return Math.min(this.wtSettings.getSetting("totalColumns"),this.wtSettings.getSetting("fixedColumnsStart"))},getVisibleColumnsCount(){return this.getRenderedColumnsCount()},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};yu(RR,"MIXIN_NAME",jue,{writable:!1,enumerable:!1});class NP extends Cm{constructor(e,n,i,r){super(e,n,i,r,Lc)}}en(NP,PP);en(NP,RR);const Ad="top",Xa="bottom",Od="inline_start",xd="top_inline_start_corner",Lc="bottom_inline_start_corner",r5=[Ad,Xa,Od,xd,Lc],zue=new Map([[Ad,`ht_clone_${Ad}`],[Xa,`ht_clone_${Xa}`],[Od,`ht_clone_${Od} ht_clone_left`],[xd,`ht_clone_${xd} ht_clone_top_left_corner`],[Lc,`ht_clone_${Lc} ht_clone_bottom_left_corner`]]);function Uue(t,e){Yue(t,e),e.add(t)}function Yue(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Gue(t,e,n){return(e=que(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function que(t){var e=Kue(t,"string");return typeof e=="symbol"?e:e+""}function Kue(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function PS(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Vp=new WeakSet;class Xue{constructor(e){Uue(this,Vp),Gue(this,"dataAccessObject",void 0),this.dataAccessObject=e}scrollViewport(e,n,i){if(e.col<0||e.row<0)return!1;const r=this.scrollViewportHorizontally(e.col,n),o=this.scrollViewportVertically(e.row,i);return r||o}scrollViewportHorizontally(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalColumns:r}=this.dataAccessObject;if(!i)return!1;const o=Wo(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollHorizontally",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedColumnsStart:a,inlineStartOverlay:u}=this.dataAccessObject,h=n==="auto";if(h&&e<a)return!1;const d=this.getFirstVisibleColumn(),g=this.getLastVisibleColumn();let m=!1;return(h&&(e<d||e>g)||!h)&&(m=u.scrollTo(e,h?e>=this.getLastPartiallyVisibleColumn():n==="end")),m}scrollViewportVertically(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"auto";const{drawn:i,totalRows:r}=this.dataAccessObject;if(!i)return!1;const o=Wo(n);if(e=this.dataAccessObject.wtSettings.getSetting("onBeforeViewportScrollVertically",e,o),!Number.isInteger(e)||e<0||e>r)return!1;n=o.value;const{fixedRowsBottom:a,fixedRowsTop:u,topOverlay:h}=this.dataAccessObject,d=n==="auto";if(d&&(e<u||e>r-a-1))return!1;const g=this.getFirstVisibleRow(),m=this.getLastVisibleRow();let v=!1;return(d&&(e<g||e>m)||!d)&&(v=h.scrollTo(e,d?e>=this.getLastPartiallyVisibleRow():n==="bottom")),v}getFirstVisibleRow(){return this.dataAccessObject.wtTable.getFirstVisibleRow()}getLastVisibleRow(){return PS(Vp,this,eU).call(this,this.dataAccessObject.wtTable.getLastVisibleRow())}getFirstPartiallyVisibleRow(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleRow()}getLastPartiallyVisibleRow(){return PS(Vp,this,eU).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleRow())}getFirstVisibleColumn(){return this.dataAccessObject.wtTable.getFirstVisibleColumn()}getLastVisibleColumn(){return PS(Vp,this,Jz).call(this,this.dataAccessObject.wtTable.getLastVisibleColumn())}getFirstPartiallyVisibleColumn(){return this.dataAccessObject.wtTable.getFirstPartiallyVisibleColumn()}getLastPartiallyVisibleColumn(){return PS(Vp,this,Jz).call(this,this.dataAccessObject.wtTable.getLastPartiallyVisibleColumn())}}function Jz(t){const{wtSettings:e,inlineStartOverlay:n,wtTable:i,wtViewport:r,totalColumns:o,rootWindow:a}=this.dataAccessObject;if(n.mainTableScrollableElement===a){const u=e.getSetting("rtlMode");let h=null;if(u){const g=i.TABLE.getBoundingClientRect(),v=this.dataAccessObject.rootWindow.document.documentElement.offsetWidth;h=Math.abs(g.right-v)}else h=pr(i.wtRootElement).left;const d=Math.abs(T4(a,a));if(h>d){const g=_4(a);let m=r.getRowHeaderWidth();for(let v=1;v<=o;v++)if(m+=n.sumCellSizes(v-1,v),h+m-d>=g){t=v-2;break}}}return t}function eU(t){const{topOverlay:e,wtTable:n,wtViewport:i,totalRows:r,rootWindow:o}=this.dataAccessObject;if(e.mainTableScrollableElement===o){const a=pr(n.wtRootElement),u=_P(o,o);if(a.top>u){const h=kv(o);let d=i.getColumnHeaderHeight();for(let g=1;g<=r;g++)if(d+=e.sumCellSizes(g-1,g),a.top+d-u>=h){t=g-2;break}}}return t}function us(t,e,n){return(e=Zue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zue(t){var e=Que(t,"string");return typeof e=="symbol"?e:e+""}function Que(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DP{get eventManager(){return new da(this)}constructor(e,n){us(this,"wtTable",void 0),us(this,"wtScroll",void 0),us(this,"wtViewport",void 0),us(this,"wtOverlays",void 0),us(this,"selectionManager",void 0),us(this,"wtEvent",void 0),us(this,"guid",`wt_${l4()}`),us(this,"drawInterrupted",!1),us(this,"drawn",!1),us(this,"activeOverlayName","master"),us(this,"domBindings",void 0),us(this,"wtSettings",void 0),this.domBindings={rootTable:e,rootDocument:e.ownerDocument,rootWindow:e.ownerDocument.defaultView},this.wtSettings=n,this.wtScroll=new Xue(this.createScrollDao())}findOriginalHeaders(){const e=[];if(this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(let n=0,i=this.wtTable.THEAD.childNodes[0].childNodes.length;n<i;n++)e.push(this.wtTable.THEAD.childNodes[0].childNodes[n].innerHTML);this.wtSettings.getSetting("columnHeaders").length||this.wtSettings.update("columnHeaders",[function(n,i){Td(i,e[n])}])}}createCellCoords(e,n){return new Md(e,n,this.wtSettings.getSetting("rtlMode"))}createCellRange(e,n,i){return new bm(e,n,i,this.wtSettings.getSetting("rtlMode"))}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this.drawInterrupted=!1,!this.wtTable.isVisible()||Vse(this.wtTable.wtRootElement.parentNode)?this.drawInterrupted=!0:this.wtTable.draw(e),this}getCell(e){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1))return this.wtTable.getCell(e);const i=this.wtSettings.getSetting("totalRows"),r=this.wtSettings.getSetting("fixedRowsTop"),o=this.wtSettings.getSetting("fixedRowsBottom"),a=this.wtSettings.getSetting("fixedColumnsStart");if(e.row<r&&e.col<a)return this.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.getCell(e);if(e.row<r)return this.wtOverlays.topOverlay.clone.wtTable.getCell(e);if(e.col<a&&e.row>=i-o){if(this.wtOverlays.bottomInlineStartCornerOverlay&&this.wtOverlays.bottomInlineStartCornerOverlay.clone)return this.wtOverlays.bottomInlineStartCornerOverlay.clone.wtTable.getCell(e)}else{if(e.col<a)return this.wtOverlays.inlineStartOverlay.clone.wtTable.getCell(e);if(e.row<i&&e.row>=i-o&&this.wtOverlays.bottomOverlay&&this.wtOverlays.bottomOverlay.clone)return this.wtOverlays.bottomOverlay.clone.wtTable.getCell(e)}return this.wtTable.getCell(e)}scrollViewport(e,n,i){return this.wtScroll.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this.wtScroll.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this.wtScroll.scrollViewportVertically(e,n)}getViewport(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]}destroy(){this.wtOverlays.destroy(),this.wtEvent.destroy()}createScrollDao(){const e=this;return{get drawn(){return e.drawn},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get wtTable(){return e.wtTable},get wtViewport(){return e.wtViewport},get wtSettings(){return e.wtSettings},get rootWindow(){return e.domBindings.rootWindow},get totalRows(){return e.wtSettings.getSetting("totalRows")},get totalColumns(){return e.wtSettings.getSetting("totalColumns")},get fixedRowsTop(){return e.wtSettings.getSetting("fixedRowsTop")},get fixedRowsBottom(){return e.wtSettings.getSetting("fixedRowsBottom")},get fixedColumnsStart(){return e.wtSettings.getSetting("fixedColumnsStart")}}}getTableDao(){const e=this;return{get wot(){return e},get parentTableOffset(){return e.cloneSource.wtTable.tableOffset},get cloneSource(){return e.cloneSource},get workspaceWidth(){return e.wtViewport.getWorkspaceWidth()},get wtViewport(){return e.wtViewport},get wtOverlays(){return e.wtOverlays},get selectionManager(){return e.selectionManager},get drawn(){return e.drawn},set drawn(n){e.drawn=n},get wtTable(){return e.wtTable},get startColumnRendered(){return e.wtViewport.columnsRenderCalculator.startColumn},get startColumnVisible(){return e.wtViewport.columnsVisibleCalculator.startColumn},get startColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.startColumn},get endColumnRendered(){return e.wtViewport.columnsRenderCalculator.endColumn},get endColumnVisible(){return e.wtViewport.columnsVisibleCalculator.endColumn},get endColumnPartiallyVisible(){return e.wtViewport.columnsPartiallyVisibleCalculator.endColumn},get countColumnsRendered(){return e.wtViewport.columnsRenderCalculator.count},get countColumnsVisible(){return e.wtViewport.columnsVisibleCalculator.count},get startRowRendered(){return e.wtViewport.rowsRenderCalculator.startRow},get startRowVisible(){return e.wtViewport.rowsVisibleCalculator.startRow},get startRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.startRow},get endRowRendered(){return e.wtViewport.rowsRenderCalculator.endRow},get endRowVisible(){return e.wtViewport.rowsVisibleCalculator.endRow},get endRowPartiallyVisible(){return e.wtViewport.rowsPartiallyVisibleCalculator.endRow},get countRowsRendered(){return e.wtViewport.rowsRenderCalculator.count},get countRowsVisible(){return e.wtViewport.rowsVisibleCalculator.count},get columnHeaders(){return e.wtSettings.getSetting("columnHeaders")},get rowHeaders(){return e.wtSettings.getSetting("rowHeaders")}}}}function tU(t,e,n){return(e=Jue(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Jue(t){var e=ece(t,"string");return typeof e=="symbol"?e:e+""}function ece(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class tce extends DP{constructor(e,n,i){super(e,n),tU(this,"cloneSource",void 0),tU(this,"cloneOverlay",void 0);const r=this.wtSettings.getSetting("facade",this);this.cloneSource=i.source,this.cloneOverlay=i.overlay,this.wtTable=this.cloneOverlay.createTable(this.getTableDao(),r,this.domBindings,this.wtSettings),this.wtViewport=i.viewport,this.selectionManager=i.selectionManager,this.wtEvent=new t5(r,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager,i.event),this.findOriginalHeaders()}}function nce(t,e,n){return(e=ice(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ice(t){var e=rce(t,"string");return typeof e=="symbol"?e:e+""}function rce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class zw{constructor(e,n,i,r,o){nce(this,"wtSettings",null),yu(this,"wot",e,{writable:!1}),this.domBindings=o,this.facadeGetter=n,this.wtSettings=r;const{TABLE:a,hider:u,spreader:h,holder:d,wtRootElement:g}=this.wot.wtTable;this.instance=this.wot,this.type=i,this.mainTableScrollableElement=null,this.TABLE=a,this.hider=u,this.spreader=h,this.holder=d,this.wtRootElement=g,this.trimmingContainer=dw(this.hider.parentNode.parentNode),this.needFullRender=this.shouldBeRendered(),this.clone=this.makeClone()}hasRenderingStateChanged(){return this.needFullRender!==this.shouldBeRendered()}updateStateOfRendering(e){e==="before"&&this.shouldBeRendered()?this.needFullRender=!0:e==="after"&&!this.shouldBeRendered()&&(this.needFullRender=!1)}shouldBeRendered(){return!0}updateTrimmingContainer(){this.trimmingContainer=dw(this.hider.parentNode.parentNode)}updateMainScrollableElement(){const{wtTable:e}=this.wot,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=this.wot.wtTable.holder:this.mainTableScrollableElement=XC(e.TABLE)}getRelativeCellPosition(e,n,i){if(this.clone.wtTable.holder.contains(e)===!1){_t(`The provided element is not a child of the ${this.type} overlay`);return}const r=this.mainTableScrollableElement===this.domBindings.rootWindow,o=i<this.wtSettings.getSetting("fixedColumnsStart"),a=n<this.wtSettings.getSetting("fixedRowsTop"),u=n>=this.wtSettings.getSetting("totalRows")-this.wtSettings.getSetting("fixedRowsBottom"),h=this.clone.wtTable.spreader,d={start:this.getRelativeStartPosition(h),top:h.offsetTop},g={start:this.getRelativeStartPosition(e),top:e.offsetTop};let m=null;return r?m=this.getRelativeCellPositionWithinWindow(a,o,g,d):m=this.getRelativeCellPositionWithinHolder(a,u,o,g,d),m}getRelativeStartPosition(e){return this.isRtl()?e.offsetParent.offsetWidth-e.offsetLeft-e.offsetWidth:e.offsetLeft}getRelativeCellPositionWithinWindow(e,n,i,r){const o=this.wot.wtTable.wtRootElement.getBoundingClientRect();let a=0,u=0;if(!n)a=r.start;else{let h=o.left;this.isRtl()&&(h=this.domBindings.rootWindow.innerWidth-(o.left+o.width+_i())),a=h<=0?-1*h:0}return e?u=this.clone.wtTable.TABLE.getBoundingClientRect().top-o.top:u=r.top,{start:i.start+a,top:i.top+u}}getRelativeCellPositionWithinHolder(e,n,i,r,o){const a={horizontal:this.wot.wtOverlays.inlineStartOverlay.getScrollPosition(),vertical:this.wot.wtOverlays.topOverlay.getScrollPosition()};let u=0,h=0;if(i||(u=a.horizontal-o.start),n){const d=this.wot.wtTable.wtRootElement.getBoundingClientRect();h=this.clone.wtTable.TABLE.getBoundingClientRect().top*-1+d.top}else e||(h=a.vertical-o.top);return{start:r.start-u,top:r.top-h}}makeClone(){if(r5.indexOf(this.type)===-1)throw new Error(`Clone type "${this.type}" is not supported.`);const{wtTable:e,wtSettings:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,o=i.createElement("div"),a=i.createElement("table"),u=e.wtRootElement.parentNode;o.className=`${zue.get(this.type)} handsontable`,o.setAttribute("dir",this.isRtl()?"rtl":"ltr"),o.style.position="absolute",o.style.top=0,o.style.overflow="visible",this.isRtl()?o.style.right=0:o.style.left=0,n.getSetting("ariaTags")&&We(o,[tu()]),a.className=e.TABLE.className,e.TABLE.getAttribute("role")&&a.setAttribute("role",e.TABLE.getAttribute("role")),o.appendChild(a),u.appendChild(o);const d=this.wtSettings.getSetting("preventOverflow");return d===!0||d==="horizontal"&&this.type===Ad||d==="vertical"&&this.type===Od?this.mainTableScrollableElement=r:r.getComputedStyle(u).getPropertyValue("overflow")==="hidden"?this.mainTableScrollableElement=e.holder:this.mainTableScrollableElement=XC(e.TABLE),new tce(a,this.wtSettings,{source:this.wot,overlay:this,viewport:this.wot.wtViewport,event:this.wot.wtEvent,selectionManager:this.wot.selectionManager})}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.needFullRender){const n=this.clone.cloneSource;n.activeOverlayName=this.clone.wtTable.name,this.clone.draw(e),n.activeOverlayName="master"}}reset(){const e=this.clone.wtTable.holder,n=this.clone.wtTable.hider,i=e.style,r=n.style,o=e.parentNode.style;[i,r,o].forEach(a=>{a.width="",a.height=""})}isRtl(){return this.wtSettings.getSetting("rtlMode")}destroy(){this.clone.eventManager.destroy()}}class oce extends zw{constructor(e,n,i,r,o,a){super(e,n,Lc,i,r),this.bottomOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new NP(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wot:e}=this;if(this.updateTrimmingContainer(),!e.wtTable.holder.parentNode)return!1;const n=this.clone.wtTable.holder.parentNode;if(n.style.top="",this.trimmingContainer===this.domBindings.rootWindow){const o=this.inlineStartOverlay.getOverlayOffset(),a=this.bottomOverlay.getOverlayOffset();n.style[this.isRtl()?"right":"left"]=`${o}px`,n.style.bottom=`${a}px`}else yR(n),this.repositionOverlay();let i=Ti(this.clone.wtTable.TABLE);const r=hi(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(i=0),n.style.height=`${i}px`,n.style.width=`${r}px`,!1}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=_i(i)),r.style.bottom=`${o}px`}}const sce="calculatedColumns",ER={getFirstRenderedColumn(){const t=this.dataAccessObject.startColumnRendered;return t===null?-1:t},getFirstVisibleColumn(){const t=this.dataAccessObject.startColumnVisible;return t===null?-1:t},getFirstPartiallyVisibleColumn(){const t=this.dataAccessObject.startColumnPartiallyVisible;return t===null?-1:t},getLastRenderedColumn(){const t=this.dataAccessObject.endColumnRendered;return t===null?-1:t},getLastVisibleColumn(){const t=this.dataAccessObject.endColumnVisible;return t===null?-1:t},getLastPartiallyVisibleColumn(){const t=this.dataAccessObject.endColumnPartiallyVisible;return t===null?-1:t},getRenderedColumnsCount(){return this.dataAccessObject.countColumnsRendered},getVisibleColumnsCount(){return this.dataAccessObject.countColumnsVisible},getRowHeadersCount(){return this.dataAccessObject.rowHeaders.length}};yu(ER,"MIXIN_NAME",sce,{writable:!1,enumerable:!1});class LP extends Cm{constructor(e,n,i,r){super(e,n,i,r,Xa)}}en(LP,PP);en(LP,ER);function ace(t,e,n){return(e=lce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lce(t){var e=uce(t,"string");return typeof e=="symbol"?e:e+""}function uce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cce extends zw{constructor(e,n,i,r){super(e,n,Xa,i,r),ace(this,"cachedFixedRowsBottom",-1),this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new LP(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderBottomOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const{rootWindow:e}=this.domBindings,n=this.clone.wtTable.holder.parentNode;n.style.top="";let i=0;const r=this.wtSettings.getSetting("preventOverflow");this.trimmingContainer===e&&(!r||r!=="vertical")?(i=this.getOverlayOffset(),n.style.bottom=`${i}px`):(i=this.getScrollPosition(),this.repositionOverlay());const o=this.adjustHeaderBordersPosition(i);return this.adjustElementsSize(),o}repositionOverlay(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i}=this.domBindings,r=this.clone.wtTable.holder.parentNode;let o=0;n.hasVerticalScroll()||(o+=n.getWorkspaceHeight()-e.getTotalHeight()),n.hasVerticalScroll()&&n.hasHorizontalScroll()&&(o+=_i(i)),r.style.bottom=`${o}px`}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(TP(n),top),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const{wtTable:i,wtSettings:r}=this.wot,o=r.getSetting("stylesHandler").getDefaultRowHeight();let a=e,u=0;for(;a<n;){const h=i.getRowHeight(a);u+=h===void 0?o:h,a+=1}return u}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="horizontal"){let d=n.getWorkspaceWidth();n.hasVerticalScroll()&&(d-=_i(i)),d=Math.min(d,e.wtRootElement.scrollWidth),a.width=`${d}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let h=Ti(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),a.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=e.parentNode.style.height}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){let i=this.getTableParentOffset();const o=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder;let a=0;n&&o.offsetHeight!==o.clientHeight&&(a=_i(this.domBindings.rootDocument)),n?(i+=this.sumCellSizes(0,e+1),i-=this.wot.wtViewport.getViewportHeight(),i+=1):i+=this.sumCellSizes(this.wtSettings.getSetting("fixedRowsBottom"),e),i+=a,this.setScrollPosition(i)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return _P(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=r-o,u=this.domBindings.rootDocument.documentElement.clientHeight;i=Math.max(this.getTableParentOffset()-this.getScrollPosition()-u+r,0),i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){const n=this.wtSettings.getSetting("fixedRowsBottom"),i=this.cachedFixedRowsBottom!==n,r=this.wtSettings.getSetting("columnHeaders");let o=!1;if((i||n===0)&&r.length>0){const a=this.wot.wtTable.holder.parentNode,u=Xe(a,"innerBorderBottom");this.cachedFixedRowsBottom=this.wtSettings.getSetting("fixedRowsBottom"),e||this.wtSettings.getSetting("totalRows")===0?(fe(a,"innerBorderBottom"),o=!u):(Ve(a,"innerBorderBottom"),o=u)}return o}}const hce="calculatedRows",kP={getFirstRenderedRow(){const t=this.dataAccessObject.startRowRendered;return t===null?-1:t},getFirstVisibleRow(){const t=this.dataAccessObject.startRowVisible;return t===null?-1:t},getFirstPartiallyVisibleRow(){const t=this.dataAccessObject.startRowPartiallyVisible;return t===null?-1:t},getLastRenderedRow(){const t=this.dataAccessObject.endRowRendered;return t===null?-1:t},getLastVisibleRow(){const t=this.dataAccessObject.endRowVisible;return t===null?-1:t},getLastPartiallyVisibleRow(){const t=this.dataAccessObject.endRowPartiallyVisible;return t===null?-1:t},getRenderedRowsCount(){return this.dataAccessObject.countRowsRendered},getVisibleRowsCount(){return this.dataAccessObject.countRowsVisible},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};yu(kP,"MIXIN_NAME",hce,{writable:!1,enumerable:!1});class $P extends Cm{constructor(e,n,i,r){super(e,n,i,r,Od)}}en($P,kP);en($P,RR);const dce="localHooks",Fi={_localHooks:Object.create(null),addLocalHook(t,e){return this._localHooks[t]||(this._localHooks[t]=[]),this._localHooks[t].push(e),this},removeLocalHook(t,e){if(this._localHooks[t]){const n=this._localHooks[t].indexOf(e);n>-1&&this._localHooks[t].splice(n,1)}return this},runLocalHooks(t,e,n,i,r,o,a){if(this._localHooks[t]){const u=this._localHooks[t].length;for(let h=0;h<u;h++)NH(this._localHooks[t][h],this,e,n,i,r,o,a)}},clearLocalHooks(){return this._localHooks={},this}};yu(Fi,"MIXIN_NAME",dce,{writable:!1,enumerable:!1});let o5=class{constructor(e,n){this.settings=e,this.cellRange=n||null}isEmpty(){return this.cellRange===null}add(e){return this.isEmpty()?this.cellRange=this.settings.createCellRange(e):this.cellRange.expand(e),this}replace(e,n){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=n,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=n,!0}return!1}clear(){return this.cellRange=null,this}getCorners(){const e=this.cellRange.getOuterTopStartCorner(),n=this.cellRange.getOuterBottomEndCorner();return[e.row,e.col,n.row,n.col]}destroy(){this.runLocalHooks("destroy")}};en(o5,Fi);const s5="active-header",VP="header",BP="area",JC="focus",fce="fill",gce="row",mce="column",pce="custom-selection",FP=t=>{const e=t.wtSettings.getSetting("stylesHandler");if(e.isClassicTheme())return Object.freeze({width:6,height:6,borderWidth:1,borderStyle:"solid",borderColor:"#FFF"});const n=e.getCSSVariableValue("cell-autofill-size"),i=e.getCSSVariableValue("cell-autofill-border-width"),r=e.getCSSVariableValue("cell-autofill-border-color");return Object.freeze({width:n,height:n,borderWidth:i,borderStyle:"solid",borderColor:r})};var nU={},iU;function vce(){if(iU)return nU;iU=1;var t=bR();return t("flat"),nU}vce();function wce(t,e){a5(t,e),e.add(t)}function rU(t,e,n){a5(t,e),e.set(t,n)}function a5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Wn(t,e){return t.get($v(t,e))}function oU(t,e,n){return t.set($v(t,e),n),n}function $v(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gs=new WeakMap,hr=new WeakMap,NS=new WeakSet;class yce{constructor(){wce(this,NS),rU(this,Gs,void 0),rU(this,hr,void 0)}setActiveOverlay(e){return oU(hr,this,e),this}setActiveSelection(e){return oU(Gs,this,e),this}scan(){const e=Wn(Gs,this).settings.selectionType,n=new Set;return e==="active-header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="area"?this.scanCellsRange(i=>n.add(i)):e==="focus"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i)),this.scanCellsRange(i=>n.add(i))):e==="fill"?this.scanCellsRange(i=>n.add(i)):e==="header"?(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanRowsInHeadersRange(i=>n.add(i))):e==="row"?(this.scanRowsInHeadersRange(i=>n.add(i)),this.scanRowsInCellsRange(i=>n.add(i))):e==="column"&&(this.scanColumnsInHeadersRange(i=>n.add(i)),this.scanColumnsInCellsRange(i=>n.add(i))),n}scanColumnsInHeadersRange(e){const[n,i,r,o]=Wn(Gs,this).getCorners(),{wtTable:a}=Wn(hr,this),u=a.getRenderedColumnsCount(),h=a.getColumnHeadersCount();let d=0;for(let g=-a.getRowHeadersCount();g<u;g++){const m=a.columnFilter.renderedToSource(g);if(!(m<i||m>o)){for(let v=-h;v<0;v++){if(v<n||v>r)continue;const y=v+h;let b=a.getColumnHeader(m,y);const C=Wn(hr,this).getSetting("onBeforeHighlightingColumnHeader",m,y,{selectionType:Wn(Gs,this).settings.selectionType,columnCursor:d,selectionWidth:o-i+1});C!==null&&(C!==m&&(b=a.getColumnHeader(C,y)),e(b))}d+=1}}}scanRowsInHeadersRange(e){const[n,i,r,o]=Wn(Gs,this).getCorners(),{wtTable:a}=Wn(hr,this),u=a.getRenderedRowsCount(),h=a.getRowHeadersCount();let d=0;for(let g=-a.getColumnHeadersCount();g<u;g++){const m=a.rowFilter.renderedToSource(g);if(!(m<n||m>r)){for(let v=-h;v<0;v++){if(v<i||v>o)continue;const y=v+h;let b=a.getRowHeader(m,y);const C=Wn(hr,this).getSetting("onBeforeHighlightingRowHeader",m,y,{selectionType:Wn(Gs,this).settings.selectionType,rowCursor:d,selectionHeight:r-n+1});C!==null&&(C!==m&&(b=a.getRowHeader(C,y)),e(b))}d+=1}}}scanCellsRange(e){const{wtTable:n}=Wn(hr,this);$v(NS,this,Sce).call(this,(i,r)=>{const o=n.getCell(Wn(hr,this).createCellCoords(i,r)),a=Wn(hr,this).getSetting("onAfterDrawSelection",i,r,Wn(Gs,this).settings.layerLevel);typeof a=="string"&&fe(o,a),e(o)})}scanRowsInCellsRange(e){const[n,,i]=Wn(Gs,this).getCorners(),{wtTable:r}=Wn(hr,this);$v(NS,this,sU).call(this,(o,a)=>{if(o>=n&&o<=i){const u=r.getCell(Wn(hr,this).createCellCoords(o,a));e(u)}})}scanColumnsInCellsRange(e){const[,n,,i]=Wn(Gs,this).getCorners(),{wtTable:r}=Wn(hr,this);$v(NS,this,sU).call(this,(o,a)=>{if(a>=n&&a<=i){const u=r.getCell(Wn(hr,this).createCellCoords(o,a));e(u)}})}}function Sce(t){let[e,n,i,r]=Wn(Gs,this).getCorners();if(e<0&&i<0||n<0&&r<0)return;const{wtTable:o}=Wn(hr,this),a=e!==i||n!==r;if(n=Math.max(n,0),r=Math.max(r,0),e=Math.max(e,0),i=Math.max(i,0),a){if(n=Math.max(n,o.getFirstRenderedColumn()),r=Math.min(r,o.getLastRenderedColumn()),e=Math.max(e,o.getFirstRenderedRow()),i=Math.min(i,o.getLastRenderedRow()),r<n||i<e)return}else{const u=o.getCell(Wn(hr,this).createCellCoords(e,n));if(!cu(u))return}for(let u=e;u<=i;u+=1)for(let h=n;h<=r;h+=1)t(u,h)}function sU(t){const{wtTable:e}=Wn(hr,this),n=e.getRenderedRowsCount(),i=e.getRenderedColumnsCount();for(let r=0;r<n;r+=1){const o=e.rowFilter.renderedToSource(r);for(let a=0;a<i;a+=1)t(o,e.columnFilter.renderedToSource(a))}}class aU{constructor(e,n){n&&(this.eventManager=e.eventManager,this.instance=e,this.wot=e,this.settings=n,this.mouseDown=!1,this.main=null,this.top=null,this.bottom=null,this.start=null,this.end=null,this.topStyle=null,this.bottomStyle=null,this.startStyle=null,this.endStyle=null,this.cornerDefaultStyle=FP(this.instance),this.cornerCenterPointOffset=-Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),this.corner=null,this.cornerStyle=null,this.createBorders(n),this.registerListeners())}registerListeners(){const e=this.wot.rootDocument.body;this.eventManager.addEventListener(e,"mousedown",()=>this.onMouseDown()),this.eventManager.addEventListener(e,"mouseup",()=>this.onMouseUp());for(let n=0,i=this.main.childNodes.length;n<i;n++){const r=this.main.childNodes[n];this.eventManager.addEventListener(r,"mouseenter",o=>this.onMouseEnter(o,this.main.childNodes[n]))}}onMouseDown(){this.mouseDown=!0}onMouseUp(){this.mouseDown=!1}onMouseEnter(e,n){if(!this.mouseDown||!this.wot.getSetting("hideBorderOnMouseDownOver"))return;e.preventDefault(),ma(e);const i=this,r=this.wot.rootDocument.body,o=n.getBoundingClientRect();n.style.display="none";function a(h){if(h.clientY<Math.floor(o.top)||h.clientY>Math.ceil(o.top+o.height)||h.clientX<Math.floor(o.left)||h.clientX>Math.ceil(o.left+o.width))return!0}function u(h){a(h)&&(i.eventManager.removeEventListener(r,"mousemove",u),n.style.display="block")}this.eventManager.addEventListener(r,"mousemove",u)}createBorders(e){const{rootDocument:n}=this.wot;this.main=n.createElement("div");const i=["top","start","bottom","end","corner"];let r=this.main.style;r.position="absolute",r.top=0,r.left=0;for(let u=0;u<5;u++){const h=i[u],d=n.createElement("div");d.className=`wtBorder ${this.settings.className||""}`,this.settings[h]&&this.settings[h].hide&&(d.className+=" hidden"),r=d.style,r.backgroundColor=this.settings[h]&&this.settings[h].color?this.settings[h].color:e.border.color,r.height=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,r.width=this.settings[h]&&this.settings[h].width?`${this.settings[h].width}px`:`${e.border.width}px`,this.main.appendChild(d)}this.top=this.main.childNodes[0],this.start=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.end=this.main.childNodes[3],this.topStyle=this.top.style,this.startStyle=this.start.style,this.bottomStyle=this.bottom.style,this.endStyle=this.end.style,this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=`${this.cornerDefaultStyle.width}px`,this.cornerStyle.height=`${this.cornerDefaultStyle.height}px`,this.cornerStyle.border=[`${this.cornerDefaultStyle.borderWidth}px`,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),el()&&this.instance.getSetting("isDataViewInstance")&&this.createMultipleSelectorHandles(),this.disappear();const{wtTable:o}=this.wot;let a=o.bordersHolder;a||(a=n.createElement("div"),a.className="htBorders",o.bordersHolder=a,o.spreader.appendChild(a)),a.appendChild(this.main)}createMultipleSelectorHandles(){const{rootDocument:e,wtSettings:n}=this.wot,i=n.getSetting("stylesHandler"),r=i.getCSSVariableValue("cell-mobile-handle-size"),o=i.getCSSVariableValue("cell-mobile-handle-border-radius"),a=i.getCSSVariableValue("cell-mobile-handle-background-color"),u=i.getCSSVariableValue("cell-mobile-handle-border-width"),h=i.getCSSVariableValue("cell-mobile-handle-border-color");this.selectionHandles={top:e.createElement("DIV"),topHitArea:e.createElement("DIV"),bottom:e.createElement("DIV"),bottomHitArea:e.createElement("DIV")};const d=10,g=40;this.selectionHandles.top.className="topSelectionHandle topLeftSelectionHandle",this.selectionHandles.topHitArea.className="topSelectionHandle-HitArea topLeftSelectionHandle-HitArea",this.selectionHandles.bottom.className="bottomSelectionHandle bottomRightSelectionHandle",this.selectionHandles.bottomHitArea.className="bottomSelectionHandle-HitArea bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={top:this.selectionHandles.top.style,topHitArea:this.selectionHandles.topHitArea.style,bottom:this.selectionHandles.bottom.style,bottomHitArea:this.selectionHandles.bottomHitArea.style};const m={position:"absolute",height:`${g}px`,width:`${g}px`,"border-radius":`${parseInt(g/1.5,10)}px`};wt(m,(y,b)=>{this.selectionHandles.styles.bottomHitArea[b]=y,this.selectionHandles.styles.topHitArea[b]=y});const v=i.isClassicTheme()?{position:"absolute",height:`${d}px`,width:`${d}px`,"border-radius":`${parseInt(d/1.5,10)}px`,background:"#F5F5FF",border:"1px solid #4285c8"}:{position:"absolute",height:`${r}px`,width:`${r}px`,"border-radius":`${o}px`,background:`${a}`,border:`${u}px solid ${h}`};wt(v,(y,b)=>{this.selectionHandles.styles.bottom[b]=y,this.selectionHandles.styles.top[b]=y}),this.main.appendChild(this.selectionHandles.top),this.main.appendChild(this.selectionHandles.bottom),this.main.appendChild(this.selectionHandles.topHitArea),this.main.appendChild(this.selectionHandles.bottomHitArea)}isPartRange(e,n){const i=this.wot.selectionManager.getAreaSelection();return!!(i.cellRange&&(e!==i.cellRange.to.row||n!==i.cellRange.to.col))}updateMultipleSelectionHandlesPosition(e,n,i,r,o,a){const h=this.wot.wtSettings.getSetting("rtlMode")?"right":"left",{top:d,topHitArea:g,bottom:m,bottomHitArea:v}=this.selectionHandles.styles,y=parseInt(d.borderWidth,10),b=parseInt(d.width,10),C=parseInt(g.width,10),T=this.wot.wtTable.getWidth(),O=this.wot.wtTable.getHeight();d.top=`${parseInt(i-b-1,10)}px`,d[h]=`${parseInt(r-b-1,10)}px`,g.top=`${parseInt(i-C/4*3,10)}px`,g[h]=`${parseInt(r-C/4*3,10)}px`;const A=Math.min(parseInt(r+o,10),T-b-y*2),N=Math.min(parseInt(r+o-C/4,10),T-C-y*2);m[h]=`${A}px`,v[h]=`${N}px`;const x=Math.min(parseInt(i+a,10),O-b-y*2),$=Math.min(parseInt(i+a-C/4,10),O-C-y*2);m.top=`${x}px`,v.top=`${$}px`,this.settings.border.cornerVisible&&this.settings.border.cornerVisible()?(d.display="block",g.display="block",this.isPartRange(e,n)?(m.display="none",v.display="none"):(m.display="block",v.display="block")):(d.display="none",m.display="none",g.display="none",v.display="none"),e===this.wot.wtSettings.getSetting("fixedRowsTop")||n===this.wot.wtSettings.getSetting("fixedColumnsStart")?(d.zIndex="9999",g.zIndex="9999"):(d.zIndex="",g.zIndex="")}appear(e){if(this.disabled)return;let[n,i,r,o]=e;if(n<0&&r<0||i<0&&o<0){this.disappear();return}const{wtTable:a,rootDocument:u,rootWindow:h}=this.wot,d=n!==r||i!==o,g=this.wot.wtSettings.getSetting("stylesHandler").isClassicTheme(),m=a.getFirstRenderedRow(),v=a.getLastRenderedRow(),y=a.getFirstRenderedColumn(),b=a.getLastRenderedColumn();if(y<0&&b<0||m<0&&v<0){this.disappear();return}let C;if(d){if(i=Math.max(i,y),o=Math.min(o,b),n=Math.max(n,m),r=Math.min(r,v),o<i||r<n){this.disappear();return}C=a.getCell(this.wot.createCellCoords(n,i))}else if(C=a.getCell(this.wot.createCellCoords(n,i)),!cu(C)){this.disappear();return}const T=d?a.getCell(this.wot.createCellCoords(r,o)):C,O=pr(C),A=d?pr(T):O,N=pr(a.TABLE),x=O.top,$=O.left,L=this.wot.wtSettings.getSetting("rtlMode");let P=0,Q=0;if(L){const Te=hi(a.TABLE),Pe=hi(C),De=h.innerWidth-N.left-Te;Q=$+Pe-A.left,P=h.innerWidth-$-Pe-De-1}else Q=A.left+hi(T)-$,P=$-N.left-1;if(this.isEntireColumnSelected(n,r)){const Te=n,Pe=this.getDimensionsFromHeader("columns",i,o,Te,N);let De=null;Pe&&([De,P,Q]=Pe),De&&(C=De)}let ue=x-N.top-1,X=A.top+Ti(T)-x;if(this.isEntireRowSelected(i,o)){const Te=i,Pe=this.getDimensionsFromHeader("rows",n,r,Te,N);let De=null;Pe&&([De,ue,X]=Pe),De&&(C=De)}const me=h.getComputedStyle(C);parseInt(me.borderTopWidth,10)>0&&(ue+=1,X=X>0?X-1:0),parseInt(me[L?"borderRightWidth":"borderLeftWidth"],10)>0&&(P+=1,Q=Q>0?Q-1:0);const re=L?"right":"left",Se=Math.ceil(this.settings.border.width/2);this.topStyle.top=`${ue}px`,this.topStyle[re]=`${P}px`,this.topStyle.width=`${Q+Se}px`,this.topStyle.display="block",this.startStyle.top=`${ue}px`,this.startStyle[re]=`${P}px`,this.startStyle.height=`${X+Se}px`,this.startStyle.display="block",this.bottomStyle.top=`${ue+X-parseInt(this.bottomStyle.height,10)+Se}px`,this.bottomStyle[re]=`${P}px`,this.bottomStyle.width=`${Q+Se}px`,this.bottomStyle.display="block",this.endStyle.top=`${ue}px`,this.endStyle[re]=`${P+Q-parseInt(this.endStyle.width,10)+Se}px`,this.endStyle.height=`${X+Se}px`,this.endStyle.display="block";let we=this.settings.border.cornerVisible;we=typeof we=="function"?we(this.settings.layerLevel):we;const _e=this.wot.getSetting("onModifyGetCellCoords",r,o,!1,"render");let[ie,de]=[r,o];if(_e&&Array.isArray(_e)&&([,,ie,de]=_e),el()||!we||this.isPartRange(ie,de))this.cornerStyle.display="none";else{this.cornerStyle.top=`${ue+X+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle[re]=`${P+Q+this.cornerCenterPointOffset-this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderRightWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderLeftWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.borderBottomWidth=`${this.cornerDefaultStyle.borderWidth}px`,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="none";let Te=dw(a.TABLE);const Pe=Te===h;Pe&&(Te=u.documentElement);const De=parseInt(this.cornerDefaultStyle.borderWidth,10)-1,V=Math.ceil(parseInt(this.cornerDefaultStyle.width,10)/2),le=Math.ceil(parseInt(this.cornerDefaultStyle.height,10)/2);if(o===this.wot.getSetting("totalColumns")-1){const ye=Pe?T.getBoundingClientRect().left:T.offsetLeft;let S=!1,E=0;if(L?(E=ye-parseInt(this.cornerDefaultStyle.width,10)/2,S=E<0):(E=ye+hi(T)+parseInt(this.cornerDefaultStyle.width,10)/2,S=E>=_4(Te)),S){const M=Math.floor(P+Q+this.cornerCenterPointOffset-V-De);g?(this.cornerStyle[re]=`${M}px`,this.cornerStyle[L?"borderLeftWidth":"borderRightWidth"]=0):this.cornerStyle[re]=`${M-1}px`}}if(r===this.wot.getSetting("totalRows")-1&&(Pe?T.getBoundingClientRect().top:T.offsetTop)+Ti(T)+parseInt(this.cornerDefaultStyle.height,10)/2>=kv(Te)){const M=Math.floor(ue+X+this.cornerCenterPointOffset-le-De);g?(this.cornerStyle.top=`${M}px`,this.cornerStyle.borderBottomWidth=0):this.cornerStyle.top=`${M-1}px`}this.cornerStyle.display="block"}el()&&this.instance.getSetting("isDataViewInstance")&&this.updateMultipleSelectionHandlesPosition(r,o,ue,P,Q,X)}isEntireColumnSelected(e,n){return e===this.wot.wtTable.getFirstRenderedRow()&&n===this.wot.wtTable.getLastRenderedRow()}isEntireRowSelected(e,n){return e===this.wot.wtTable.getFirstRenderedColumn()&&n===this.wot.wtTable.getLastRenderedColumn()}getDimensionsFromHeader(e,n,i,r,o){const{wtTable:a}=this.wot,u=a.wtRootElement.parentNode;let h=null,d=null,g=null,m=null,v=null,y=null,b=null,C=null;switch(e){case"rows":h=function(){return a.getRowHeader(...arguments)},d=function(){return Ti(...arguments)},g="ht__selection--rows",y="top";break;case"columns":h=function(){return a.getColumnHeader(...arguments)},d=function(){return hi(...arguments)},g="ht__selection--columns",y="left";break}if(u.classList.contains(g)){const T=this.wot.getSetting("columnHeaders").length;if(b=h(n,T-r),C=h(i,T-r),!b||!C)return!1;const O=pr(b),A=pr(C);return b&&C&&(m=O[y]-o[y]-1,v=A[y]+d(C)-O[y]),[b,m,v]}return!1}changeBorderStyle(e,n){const i=this[e].style,r=n[e];!r||r.hide?fe(this[e],"hidden"):(Xe(this[e],"hidden")&&Ve(this[e],"hidden"),i.backgroundColor=r.color,(e==="top"||e==="bottom")&&(i.height=`${r.width}px`),(e==="start"||e==="end")&&(i.width=`${r.width}px`))}changeBorderToDefaultStyle(e){const n={width:1,color:"#000"},i=this[e].style;i.backgroundColor=n.color,i.width=`${n.width}px`,i.height=`${n.width}px`}toggleHiddenClass(e,n){this.changeBorderToDefaultStyle(e),n?fe(this[e],"hidden"):Ve(this[e],"hidden")}disappear(){this.topStyle.display="none",this.bottomStyle.display="none",this.startStyle.display="none",this.endStyle.display="none",this.cornerStyle.display="none",el()&&this.instance.getSetting("isDataViewInstance")&&(this.selectionHandles.styles.top.display="none",this.selectionHandles.styles.topHitArea.display="none",this.selectionHandles.styles.bottom.display="none",this.selectionHandles.styles.bottomHitArea.display="none")}destroy(){this.eventManager.destroyWithOwnEventsOnly(),this.main.parentNode.removeChild(this.main)}}function bce(t,e){l5(t,e),e.add(t)}function If(t,e,n){l5(t,e),e.set(t,n)}function l5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pt(t,e){return t.get(WP(t,e))}function lU(t,e,n){return t.set(WP(t,e),n),n}function WP(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dr=new WeakMap,io=new WeakMap,xA=new WeakMap,Tv=new WeakMap,HA=new WeakMap,ph=new WeakMap,uU=new WeakSet;class Cce{constructor(e){bce(this,uU),If(this,dr,void 0),If(this,io,void 0),If(this,xA,new yce),If(this,Tv,new WeakMap),If(this,HA,new WeakSet),If(this,ph,new Map),lU(io,this,e)}setActiveOverlay(e){return lU(dr,this,e),pt(xA,this).setActiveOverlay(pt(dr,this)),pt(Tv,this).has(pt(dr,this))||pt(Tv,this).set(pt(dr,this),new Set),this}getFocusSelection(){return pt(io,this)!==null?pt(io,this).getFocus():null}getAreaSelection(){return pt(io,this)!==null?pt(io,this).createLayeredArea():null}getBorderInstance(e){if(!e.settings.border)return null;if(pt(ph,this).has(e)){const i=pt(ph,this).get(e);if(i.has(pt(dr,this)))return i.get(pt(dr,this));const r=new aU(pt(dr,this),e.settings);return i.set(pt(dr,this),r),r}const n=new aU(pt(dr,this),e.settings);return pt(ph,this).set(e,new Map([[pt(dr,this),n]])),n}getBorderInstances(e){var n,i;return Array.from((n=(i=pt(ph,this).get(e))===null||i===void 0?void 0:i.values())!==null&&n!==void 0?n:[])}destroyBorders(e){pt(ph,this).get(e).forEach(n=>n.destroy()),pt(ph,this).delete(e)}render(e){if(pt(io,this)===null)return;e&&WP(uU,this,Rce).call(this);const n=Array.from(pt(io,this)),i=new Map,r=new Map;for(let o=0;o<n.length;o++){const a=n[o],{className:u,headerAttributes:h,createLayers:d,selectionType:g}=a.settings;pt(HA,this).has(a)||(pt(HA,this).add(a),a.addLocalHook("destroy",()=>this.destroyBorders(a)));const m=this.getBorderInstance(a);if(a.isEmpty()){m?.disappear();continue}u&&pt(xA,this).setActiveSelection(a).scan().forEach(b=>{if(i.has(b)){const C=i.get(b);C.has(u)&&d===!0?C.set(u,C.get(u)+1):C.set(u,1)}else i.set(b,new Map([[u,1]]));h&&(r.has(b)||r.set(b,[]),b.nodeName==="TH"&&r.get(b).push(...h))});const v=a.getCorners();pt(dr,this).getSetting("onBeforeDrawBorders",v,g),m?.appear(v)}i.forEach((o,a)=>{var u;const h=Array.from(o).map(d=>{let[g,m]=d;return m===1?g:[g,...Array.from({length:m-1},(v,y)=>`${g}-${y+1}`)]}).flat();h.forEach(d=>pt(Tv,this).get(pt(dr,this)).add(d)),fe(a,h),a.nodeName==="TD"&&Array.isArray((u=pt(io,this).options)===null||u===void 0?void 0:u.cellAttributes)&&We(a,pt(io,this).options.cellAttributes)}),Array.from(r.keys()).forEach(o=>{We(o,[...r.get(o)])})}}function Rce(){const t=pt(Tv,this).get(pt(dr,this)),e=pt(dr,this).wtSettings.getSetting("onBeforeRemoveCellClassNames");if(Array.isArray(e))for(let n=0;n<e.length;n++)t.add(e[n]);t.forEach(n=>{var i,r;const o=pt(dr,this).wtTable.TABLE.querySelectorAll(`.${n}`);let a=[];Array.isArray((i=pt(io,this).options)===null||i===void 0?void 0:i.cellAttributes)&&(a=pt(io,this).options.cellAttributes.map(u=>u[0])),Array.isArray((r=pt(io,this).options)===null||r===void 0?void 0:r.headerAttributes)&&(a=[...a,...pt(io,this).options.headerAttributes.map(u=>u[0])]);for(let u=0,h=o.length;u<h;u++)Ve(o[u],n),uu(o[u],a)}),t.clear()}class Ece extends zw{constructor(e,n,i,r){super(e,n,Od,i,r)}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new $P(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){const{wtTable:e}=this.wot;if(!this.needFullRender||!this.shouldBeRendered()||!e.holder.parentNode)return!1;const{rootWindow:n}=this.domBindings,i=this.clone.wtTable.holder.parentNode,r=this.wtSettings.getSetting("preventOverflow");let o=0;this.trimmingContainer===n&&(!r||r!=="horizontal")?(o=this.getOverlayOffset()*(this.isRtl()?-1:1),MP(i,`${o}px`,"0px")):(o=this.getScrollPosition(),yR(i));const a=this.adjustHeaderBordersPosition(o);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:n}=this.domBindings;let i=!1;this.isRtl()&&(e=-e);const r=this.mainTableScrollableElement;if(r===n&&e!==n.scrollX){const o=n.scrollX;n.scrollTo(e,E4(n)),i=o!==n.scrollX}else if(e!==r.scrollLeft){const o=r.scrollLeft;r.scrollLeft=e,i=o!==r.scrollLeft}return i}onScroll(){this.wtSettings.getSetting("onScrollVertically")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("defaultColumnWidth");let r=e,o=0;for(;r<n;)o+=this.wot.wtTable.getColumnWidth(r)||i,r+=1;return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="vertical"){let d=n.getWorkspaceHeight();n.hasHorizontalScroll()&&(d-=_i(i)),d=Math.min(d,e.wtRootElement.scrollHeight),a.height=`${d}px`}else a.height="";this.clone.wtTable.holder.style.height=a.height;const h=hi(this.clone.wtTable.TABLE);a.width=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=FP(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.width,10)/2:0;this.clone.wtTable.hider.style.height=this.hider.style.height,e.style.height=e.parentNode.style.height,e.style.width=`${parseInt(e.parentNode.style.width,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalColumns"),n=this.isRtl()?"right":"left";if(typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number")this.spreader.style[n]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style[n]="0";else throw new Error("Incorrect value of the columnsRenderCalculator");this.isRtl()?this.spreader.style.left="":this.spreader.style.right="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number"?this.clone.wtTable.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`:this.clone.wtTable.spreader.style.top=""}scrollTo(e,n){const{wtSettings:i}=this,r=i.getSetting("rowHeaders"),o=i.getSetting("fixedColumnsStart"),u=(this.wot.cloneSource?this.wot.cloneSource:this.wot).wtTable.holder,h=o===0&&r.length>0&&!Xe(u.parentNode,"innerBorderInlineStart")?1:0;let d=this.getTableParentOffset(),g=0;if(n){const m=this.wot.wtTable.getColumnWidth(e),v=this.wot.wtViewport.getViewportWidth();m>v&&(n=!1)}return n&&u.offsetWidth!==u.clientWidth&&(g=_i(this.domBindings.rootDocument)),n?(d+=this.sumCellSizes(0,e+1),d-=this.wot.wtViewport.getViewportWidth(),d+=h):d+=this.sumCellSizes(this.wtSettings.getSetting("fixedColumnsStart"),e),d+=g,Fse(this.mainTableScrollableElement)===d-h&&h>0&&this.wot.wtOverlays.expandHiderHorizontallyBy(h),this.setScrollPosition(d)}getTableParentOffset(){const e=this.wtSettings.getSetting("preventOverflow");let n=0;return!e&&this.trimmingContainer===this.domBindings.rootWindow&&(n=this.wot.wtTable.holderOffset.left),n}getScrollPosition(){return Math.abs(T4(this.mainTableScrollableElement,this.domBindings.rootWindow))}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="horizontal")){this.isRtl()?i=Math.abs(Math.min(this.getTableParentOffset()-this.getScrollPosition(),0)):i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0);const r=this.wot.wtTable.getTotalWidth(),o=this.clone.wtTable.getTotalWidth(),a=r-o;i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){const{wtSettings:n}=this,i=this.wot.wtTable.holder.parentNode,r=n.getSetting("rowHeaders"),o=n.getSetting("fixedColumnsStart"),a=n.getSetting("totalRows"),u=n.getSetting("preventOverflow")==="vertical";a?Ve(i,"emptyRows"):fe(i,"emptyRows");let h=!1;if(!u){if(o&&!r.length)fe(i,"innerBorderLeft innerBorderInlineStart");else if(!o&&r.length){const d=Xe(i,"innerBorderInlineStart");e?(fe(i,"innerBorderLeft innerBorderInlineStart"),h=!d):(Ve(i,"innerBorderLeft innerBorderInlineStart"),h=d)}}return h}}const Tce="stickyRowsTop",jP={getFirstRenderedRow(){return this.getRenderedRowsCount()===0?-1:0},getFirstVisibleRow(){return this.getFirstRenderedRow()},getFirstPartiallyVisibleRow(){return this.getFirstRenderedRow()},getLastRenderedRow(){return this.getRenderedRowsCount()-1},getLastVisibleRow(){return this.getLastRenderedRow()},getLastPartiallyVisibleRow(){return this.getLastRenderedRow()},getRenderedRowsCount(){return Math.min(this.wtSettings.getSetting("totalRows"),this.wtSettings.getSetting("fixedRowsTop"))},getVisibleRowsCount(){return this.getRenderedRowsCount()},getColumnHeadersCount(){return this.dataAccessObject.columnHeaders.length}};yu(jP,"MIXIN_NAME",Tce,{writable:!1,enumerable:!1});class zP extends Cm{constructor(e,n,i,r){super(e,n,i,r,xd)}}en(zP,jP);en(zP,RR);function cU(t,e,n){return(e=_ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _ce(t){var e=Mce(t,"string");return typeof e=="symbol"?e:e+""}function Mce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ace extends zw{constructor(e,n,i,r,o,a){super(e,n,xd,i,r),cU(this,"topOverlay",void 0),cU(this,"inlineStartOverlay",void 0),this.topOverlay=o,this.inlineStartOverlay=a}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new zP(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")&&this.wtSettings.getSetting("shouldRenderInlineStartOverlay")}resetFixedPosition(){if(this.updateTrimmingContainer(),!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode;if(this.trimmingContainer===this.domBindings.rootWindow){const r=this.inlineStartOverlay.getOverlayOffset()*(this.isRtl()?-1:1),o=this.topOverlay.getOverlayOffset();MP(e,`${r}px`,`${o}px`)}else yR(e);let n=Ti(this.clone.wtTable.TABLE);const i=hi(this.clone.wtTable.TABLE);return this.wot.wtTable.hasDefinedSize()||(n=0),e.style.height=`${n}px`,e.style.width=`${i}px`,!1}}class UP extends Cm{constructor(e,n,i,r){super(e,n,i,r,Ad)}}en(UP,jP);en(UP,ER);function Oce(t,e,n){return(e=xce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function xce(t){var e=Hce(t,"string");return typeof e=="symbol"?e:e+""}function Hce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ice extends zw{constructor(e,n,i,r){super(e,n,Ad,i,r),Oce(this,"cachedFixedRowsTop",-1),this.cachedFixedRowsTop=this.wtSettings.getSetting("fixedRowsTop")}createTable(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return new UP(...n)}shouldBeRendered(){return this.wtSettings.getSetting("shouldRenderTopOverlay")}resetFixedPosition(){if(!this.needFullRender||!this.shouldBeRendered()||!this.wot.wtTable.holder.parentNode)return!1;const e=this.clone.wtTable.holder.parentNode,{rootWindow:n}=this.domBindings,i=this.wtSettings.getSetting("preventOverflow");let r=0,o=!1;if(this.trimmingContainer===n&&(!i||i!=="vertical")){const{wtTable:u}=this.wot,h=u.hider.getBoundingClientRect(),d=Math.ceil(h.bottom),g=e.offsetHeight;o=d===g,r=this.getOverlayOffset(),MP(e,"0px",`${r}px`)}else r=this.getScrollPosition(),yR(e);const a=this.adjustHeaderBordersPosition(r,o);return this.adjustElementsSize(),a}setScrollPosition(e){const{rootWindow:n}=this.domBindings,i=this.mainTableScrollableElement;let r=!1;if(i===n&&e!==n.scrollY){const o=n.scrollY;n.scrollTo(TP(n),e),r=o!==n.scrollY}else if(e!==i.scrollTop){const o=i.scrollTop;i.scrollTop=e,r=o!==i.scrollTop}return r}onScroll(){this.wtSettings.getSetting("onScrollHorizontally")}sumCellSizes(e,n){const i=this.wtSettings.getSetting("stylesHandler").getDefaultRowHeight();let r=e,o=0;for(;r<n;){const a=this.wot.wtTable.getRowHeight(r);o+=a===void 0?i:a,r+=1}return o}adjustElementsSize(){this.updateTrimmingContainer(),this.needFullRender&&(this.adjustRootElementSize(),this.adjustRootChildrenSize())}adjustRootElementSize(){const{wtTable:e,wtViewport:n}=this.wot,{rootDocument:i,rootWindow:r}=this.domBindings,a=this.clone.wtTable.holder.parentNode.style,u=this.wtSettings.getSetting("preventOverflow");if(this.trimmingContainer!==r||u==="horizontal"){let d=n.getWorkspaceWidth();n.hasVerticalScroll()&&(d-=_i(i)),d=Math.min(d,e.wtRootElement.scrollWidth),a.width=`${d}px`}else a.width="";this.clone.wtTable.holder.style.width=a.width;let h=Ti(this.clone.wtTable.TABLE);e.hasDefinedSize()||(h=0),a.height=`${h}px`}adjustRootChildrenSize(){const{holder:e}=this.clone.wtTable,n=FP(this.wot),i=this.wot.selectionManager.getFocusSelection()?parseInt(n.height,10)/2:0;this.clone.wtTable.hider.style.width=this.hider.style.width,e.style.width=e.parentNode.style.width,e.style.height=`${parseInt(e.parentNode.style.height,10)+i}px`}applyToDOM(){const e=this.wtSettings.getSetting("totalRows");if(typeof this.wot.wtViewport.rowsRenderCalculator.startPosition=="number")this.spreader.style.top=`${this.wot.wtViewport.rowsRenderCalculator.startPosition}px`;else if(e===0)this.spreader.style.top="0";else throw new Error("Incorrect value of the rowsRenderCalculator");this.spreader.style.bottom="",this.needFullRender&&this.syncOverlayOffset()}syncOverlayOffset(){const e=this.isRtl()?"right":"left",{spreader:n}=this.clone.wtTable;typeof this.wot.wtViewport.columnsRenderCalculator.startPosition=="number"?n.style[e]=`${this.wot.wtViewport.columnsRenderCalculator.startPosition}px`:n.style[e]=""}scrollTo(e,n){const{wot:i,wtSettings:r}=this,a=(i.cloneSource?i.cloneSource:i).wtTable.holder,u=r.getSetting("columnHeaders"),d=r.getSetting("fixedRowsTop")===0&&u.length>0&&!Xe(a.parentNode,"innerBorderTop")?1:0;let g=this.getTableParentOffset(),m=0;if(n){const v=this.wot.wtTable.getRowHeight(e),y=this.wot.wtViewport.getViewportHeight();v>y&&(n=!1)}if(n&&a.offsetHeight!==a.clientHeight&&(m=_i(this.domBindings.rootDocument)),n){const v=r.getSetting("fixedRowsBottom"),y=r.getSetting("totalRows");g+=this.sumCellSizes(0,e+1),g-=i.wtViewport.getViewportHeight()-this.sumCellSizes(y-v,y),g+=1,g+=d}else g+=this.sumCellSizes(r.getSetting("fixedRowsTop"),e);return g+=m,Bse(this.mainTableScrollableElement)===g-d&&d>0&&this.wot.wtOverlays.expandHiderVerticallyBy(d),this.setScrollPosition(g)}getTableParentOffset(){return this.mainTableScrollableElement===this.domBindings.rootWindow?this.wot.wtTable.holderOffset.top:0}getScrollPosition(){return _P(this.mainTableScrollableElement,this.domBindings.rootWindow)}getOverlayOffset(){const{rootWindow:e}=this.domBindings,n=this.wtSettings.getSetting("preventOverflow");let i=0;if(this.trimmingContainer===e&&(!n||n!=="vertical")){const r=this.wot.wtTable.getTotalHeight(),o=this.clone.wtTable.getTotalHeight(),a=r-o;i=Math.max(this.getScrollPosition()-this.getTableParentOffset(),0),i>a&&(i=0)}return i}adjustHeaderBordersPosition(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{wtSettings:i}=this,r=this.wot.wtTable.holder.parentNode,o=i.getSetting("totalColumns"),a=i.getSetting("preventOverflow")==="horizontal";o?Ve(r,"emptyColumns"):fe(r,"emptyColumns");let u=!1;if(!n&&!a){const h=i.getSetting("fixedRowsTop"),d=this.cachedFixedRowsTop!==h,g=i.getSetting("columnHeaders");if((d||h===0)&&g.length>0){const m=Xe(r,"innerBorderTop");this.cachedFixedRowsTop=i.getSetting("fixedRowsTop"),e||i.getSetting("totalRows")===0?(fe(r,"innerBorderTop"),u=!m):(Ve(r,"innerBorderTop"),u=m)}}return u}}function DS(t,e,n){Pce(t,e),e.set(t,n)}function Pce(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Hl(t,e,n){return(e=Nce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nce(t){var e=Dce(t,"string");return typeof e=="symbol"?e:e+""}function Dce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function vh(t,e,n){return t.set(u5(t,e),n),n}function Il(t,e){return t.get(u5(t,e))}function u5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pf=new WeakMap,LS=new WeakMap,Nf=new WeakMap,kS=new WeakMap;class Lce{constructor(e,n,i,r,o,a){Hl(this,"wot",null),DS(this,Pf,[]),Hl(this,"topOverlay",null),Hl(this,"bottomOverlay",null),Hl(this,"inlineStartOverlay",null),Hl(this,"topInlineStartCornerOverlay",null),Hl(this,"bottomInlineStartCornerOverlay",null),Hl(this,"browserLineHeight",void 0),Hl(this,"wtSettings",null),DS(this,LS,!1),DS(this,Nf,0),DS(this,kS,null),Hl(this,"resizeObserver",new ResizeObserver(g=>{qC(()=>{!Array.isArray(g)||!g.length||(vh(Nf,this,Il(Nf,this)+1),Il(Nf,this)===300&&(_t("The ResizeObserver callback was fired too many times in direct succession.\nThis may be due to an infinite loop caused by setting a dynamic height/width (for example, with the `dvh` units) to a Handsontable container's parent. \nThe observer will be disconnected."),this.resizeObserver.disconnect()),Il(kS,this)!==null&&clearTimeout(Il(kS,this)),vh(kS,this,setTimeout(()=>{vh(Nf,this,0)},100)),this.wtSettings.getSetting("onContainerElementResize"))})})),this.wot=e,this.wtSettings=r,this.domBindings=i,this.facadeGetter=n,this.wtTable=a;const{rootDocument:u,rootWindow:h}=this.domBindings;this.instance=this.wot,this.eventManager=o,this.scrollbarSize=_i(u);const d=h.getComputedStyle(a.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden";this.scrollableElement=d?a.holder:XC(a.TABLE),this.initOverlays(),this.destroyed=!1,this.keyPressed=!1,this.spreaderLastSize={width:null,height:null},this.verticalScrolling=!1,this.horizontalScrolling=!1,this.initBrowserLineHeight(),this.registerListeners(),this.lastScrollX=h.scrollX,this.lastScrollY=h.scrollY}getOverlays(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=[...Il(Pf,this)];return e&&n.push(this.wtTable),n}initBrowserLineHeight(){const{rootWindow:e,rootDocument:n}=this.domBindings,i=e.getComputedStyle(n.body),r=parseInt(i.lineHeight,10),o=parseInt(i.fontSize,10)*1.2;this.browserLineHeight=r||o}initOverlays(){const e=[this.wot,this.facadeGetter,this.wtSettings,this.domBindings];this.topOverlay=new Ice(...e),this.bottomOverlay=new cce(...e),this.inlineStartOverlay=new Ece(...e),this.topInlineStartCornerOverlay=new Ace(...e,this.topOverlay,this.inlineStartOverlay),this.bottomInlineStartCornerOverlay=new oce(...e,this.bottomOverlay,this.inlineStartOverlay),vh(Pf,this,[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay])}beforeDraw(){vh(LS,this,Il(Pf,this).reduce((e,n)=>n.hasRenderingStateChanged()||e,!1)),Il(Pf,this).forEach(e=>e.updateStateOfRendering("before"))}afterDraw(){this.syncScrollWithMaster(),Il(Pf,this).forEach(e=>{const n=e.hasRenderingStateChanged();e.updateStateOfRendering("after"),n&&!e.needFullRender&&e.reset()})}refreshAll(){if(this.wot.drawn){if(!this.wtTable.holder.parentNode){this.destroy();return}this.wot.draw(!0),this.verticalScrolling&&this.inlineStartOverlay.onScroll(),this.horizontalScrolling&&this.topOverlay.onScroll(),this.verticalScrolling=!1,this.horizontalScrolling=!1}}registerListeners(){const{rootDocument:e,rootWindow:n}=this.domBindings,{mainTableScrollableElement:i}=this.topOverlay,{mainTableScrollableElement:r}=this.inlineStartOverlay;this.eventManager.addEventListener(e.documentElement,"keydown",m=>this.onKeyDown(m)),this.eventManager.addEventListener(e.documentElement,"keyup",()=>this.onKeyUp()),this.eventManager.addEventListener(e,"visibilitychange",()=>this.onKeyUp()),this.eventManager.addEventListener(i,"scroll",m=>this.onTableScroll(m),{passive:!0}),i!==r&&this.eventManager.addEventListener(r,"scroll",m=>this.onTableScroll(m),{passive:!0});const o=n.devicePixelRatio&&n.devicePixelRatio>1,a=this.scrollableElement===n,u=this.wtSettings.getSetting("preventWheel"),h={passive:a};(u||o||!w4())&&this.eventManager.addEventListener(this.wtTable.wtRootElement,"wheel",m=>this.onCloneWheel(m,u),h),[this.topOverlay,this.bottomOverlay,this.inlineStartOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay].forEach(m=>{this.eventManager.addEventListener(m.clone.wtTable.holder,"wheel",v=>this.onCloneWheel(v,u),h)});let g;this.eventManager.addEventListener(n,"resize",()=>{qC(()=>{clearTimeout(g),this.wtSettings.getSetting("onWindowResize"),g=setTimeout(()=>{vh(Nf,this,0)},200)})}),a||this.resizeObserver.observe(this.wtTable.wtRootElement.parentElement)}onTableScroll(e){const n=this.domBindings.rootWindow,i=this.inlineStartOverlay.mainTableScrollableElement,r=this.topOverlay.mainTableScrollableElement,o=e.target;this.keyPressed&&(r!==n&&o!==n&&!e.target.contains(r)||i!==n&&o!==n&&!e.target.contains(i))||this.syncScrollPositions(e)}onCloneWheel(e,n){if(e.ctrlKey)return;const{rootWindow:i}=this.domBindings,r=this.inlineStartOverlay.mainTableScrollableElement,o=this.topOverlay.mainTableScrollableElement,a=e.target,u=o!==i&&a!==i&&!a.contains(o),h=r!==i&&a!==i&&!a.contains(r);if(this.keyPressed&&(u||h)||this.scrollableElement===i)return;const d=this.translateMouseWheelToScroll(e);(n||this.scrollableElement!==i&&d)&&e.preventDefault()}onKeyDown(e){this.keyPressed=Ww(e.keyCode,"ARROW_UP|ARROW_RIGHT|ARROW_DOWN|ARROW_LEFT")}onKeyUp(){this.keyPressed=!1}translateMouseWheelToScroll(e){let n=isNaN(e.deltaY)?-1*e.wheelDeltaY:e.deltaY,i=isNaN(e.deltaX)?-1*e.wheelDeltaX:e.deltaX;e.deltaMode===1&&(i+=i*this.browserLineHeight,n+=n*this.browserLineHeight);const r=this.scrollVertically(n),o=this.scrollHorizontally(i);return r||o}scrollVertically(e){const n=this.scrollableElement.scrollTop;return this.scrollableElement.scrollTop+=e,n!==this.scrollableElement.scrollTop}scrollHorizontally(e){const n=this.scrollableElement.scrollLeft;return this.scrollableElement.scrollLeft+=e,n!==this.scrollableElement.scrollLeft}syncScrollPositions(){if(this.destroyed)return;const e=this.topOverlay.clone.wtTable.holder,n=this.inlineStartOverlay.clone.wtTable.holder;let i=this.scrollableElement.scrollLeft,r=this.scrollableElement.scrollTop;if(this.wot.wtViewport.isHorizontallyScrollableByWindow()&&(i=this.scrollableElement.scrollX),this.wot.wtViewport.isVerticallyScrollableByWindow()&&(r=this.scrollableElement.scrollY),this.horizontalScrolling=this.lastScrollX!==i,this.verticalScrolling=this.lastScrollY!==r,this.lastScrollX=i,this.lastScrollY=r,this.horizontalScrolling){e.scrollLeft=i;const o=this.bottomOverlay.needFullRender?this.bottomOverlay.clone.wtTable.holder:null;o&&(o.scrollLeft=i)}this.verticalScrolling&&(n.scrollTop=r),this.refreshAll()}syncScrollWithMaster(){if(!Il(LS,this))return;const e=this.topOverlay.mainTableScrollableElement,{scrollLeft:n,scrollTop:i}=e;this.topOverlay.needFullRender&&(this.topOverlay.clone.wtTable.holder.scrollLeft=n),this.bottomOverlay.needFullRender&&(this.bottomOverlay.clone.wtTable.holder.scrollLeft=n),this.inlineStartOverlay.needFullRender&&(this.inlineStartOverlay.clone.wtTable.holder.scrollTop=i),vh(LS,this,!1)}updateMainScrollableElements(){this.eventManager.clearEvents(!0),this.inlineStartOverlay.updateMainScrollableElement(),this.topOverlay.updateMainScrollableElement(),this.bottomOverlay.needFullRender&&this.bottomOverlay.updateMainScrollableElement();const{wtTable:e}=this,{rootWindow:n}=this.domBindings;n.getComputedStyle(e.wtRootElement.parentNode).getPropertyValue("overflow")==="hidden"?this.scrollableElement=e.holder:this.scrollableElement=XC(e.TABLE),this.registerListeners()}destroy(){this.resizeObserver.disconnect(),this.eventManager.destroy(),this.topOverlay.destroy(),this.bottomOverlay.clone&&this.bottomOverlay.destroy(),this.inlineStartOverlay.destroy(),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.destroy(),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.destroy(),this.destroyed=!0}refresh(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;this.updateLastSpreaderSize()&&this.adjustElementsSize(),this.bottomOverlay.clone&&this.bottomOverlay.refresh(e),this.inlineStartOverlay.refresh(e),this.topOverlay.refresh(e),this.topInlineStartCornerOverlay&&this.topInlineStartCornerOverlay.refresh(e),this.bottomInlineStartCornerOverlay&&this.bottomInlineStartCornerOverlay.clone&&this.bottomInlineStartCornerOverlay.refresh(e)}updateLastSpreaderSize(){const e=this.wtTable.spreader,n=e.clientWidth,i=e.clientHeight,r=n!==this.spreaderLastSize.width||i!==this.spreaderLastSize.height;return r&&(this.spreaderLastSize.width=n,this.spreaderLastSize.height=i),r}adjustElementsSize(){const{wtViewport:e}=this.wot,{wtTable:n}=this,{rootWindow:i}=this.domBindings,r=this.scrollableElement===i,o=this.wtSettings.getSetting("totalColumns"),a=this.wtSettings.getSetting("totalRows"),u=e.getRowHeaderWidth(),h=e.getColumnHeaderHeight(),d=this.wtSettings.getSetting("externalRowCalculator")?0:1,g=h+this.topOverlay.sumCellSizes(0,a)+d,m=u+this.inlineStartOverlay.sumCellSizes(0,o),y=n.hider.style,b=()=>r?!1:this.scrollableElement.scrollTop>Math.max(0,g-n.holder.clientHeight),C=()=>r?!1:this.scrollableElement.scrollLeft>Math.max(0,m-n.holder.clientWidth),T=b()?1:0,O=C()?1:0;y.width=`${m+O}px`,y.height=`${g+T}px`,this.topOverlay.adjustElementsSize(),this.inlineStartOverlay.adjustElementsSize(),this.bottomOverlay.adjustElementsSize()}expandHiderVerticallyBy(e){const{wtTable:n}=this;n.hider.style.height=`${parseInt(n.hider.style.height,10)+e}px`}expandHiderHorizontallyBy(e){const{wtTable:n}=this;n.hider.style.width=`${parseInt(n.hider.style.width,10)+e}px`}applyToDOM(){this.wtTable.isVisible()&&(this.topOverlay.applyToDOM(),this.bottomOverlay.clone&&this.bottomOverlay.applyToDOM(),this.inlineStartOverlay.applyToDOM())}getParentOverlay(e){if(!e)return null;const n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];let i=null;return U(n,r=>{r&&r.clone&&r.clone.wtTable.TABLE.contains(e)&&(i=r.clone)}),i}syncOverlayTableClassNames(){const e=this.wtTable.TABLE,n=[this.topOverlay,this.inlineStartOverlay,this.bottomOverlay,this.topInlineStartCornerOverlay,this.bottomInlineStartCornerOverlay];U(n,i=>{i&&(i.clone.wtTable.TABLE.className=e.className)})}}function hU(t,e,n){return(e=kce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kce(t){var e=$ce(t,"string");return typeof e=="symbol"?e:e+""}function $ce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Vce{constructor(e){hU(this,"settings",{}),hU(this,"defaults",Object.freeze(this.getDefaults())),wt(this.defaults,(n,i)=>{if(e[i]!==void 0)this.settings[i]=e[i];else{if(n===void 0)throw new Error(`A required setting "${i}" was not provided`);this.settings[i]=n}})}getDefaults(){return{facade:void 0,table:void 0,isDataViewInstance:!0,externalRowCalculator:!1,currentRowClassName:null,currentColumnClassName:null,preventOverflow(){return!1},preventWheel:!1,data:void 0,fixedColumnsStart:0,fixedRowsTop:0,fixedRowsBottom:0,shouldRenderInlineStartOverlay:()=>this.getSetting("fixedColumnsStart")>0||this.getSetting("rowHeaders").length>0,shouldRenderTopOverlay:()=>this.getSetting("fixedRowsTop")>0||this.getSetting("columnHeaders").length>0,shouldRenderBottomOverlay:()=>this.getSetting("fixedRowsBottom")>0,minSpareRows:0,rowHeaders(){return[]},columnHeaders(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:(e,n,i)=>{const r=this.getSetting("data",e,n);Td(i,r??"")},columnWidth(){},rowHeight(){},rowHeightByOverlayName(){},defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,viewportRowRenderingThreshold:null,viewportColumnRenderingThreshold:null,onCellMouseDown:null,onCellContextMenu:null,onCellMouseOver:null,onCellMouseOut:null,onCellMouseUp:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeRemoveCellClassNames:null,onAfterDrawSelection:null,onBeforeDrawBorders:null,onBeforeViewportScrollHorizontally:e=>e,onBeforeViewportScrollVertically:e=>e,onScrollHorizontally:null,onScrollVertically:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,onModifyRowHeaderWidth:null,onModifyGetCellCoords:null,onModifyGetCoordsElement:null,onModifyGetCoords:null,onBeforeHighlightingRowHeader:e=>e,onBeforeHighlightingColumnHeader:e=>e,onWindowResize:null,onContainerElementResize:null,renderAllColumns:!1,renderAllRows:!1,groups:!1,rowHeaderWidth:null,columnHeaderHeight:null,headerClassName:null,rtlMode:!1,ariaTags:!0,stylesHandler:null}}update(e,n){return n===void 0?wt(e,(i,r)=>{this.settings[r]=i}):this.settings[e]=n,this}getSetting(e,n,i,r,o){return typeof this.settings[e]=="function"?this.settings[e](n,i,r,o):n!==void 0&&Array.isArray(this.settings[e])?this.settings[e][n]:this.settings[e]}getSettingPure(e){return this.settings[e]}has(e){return!!this.settings[e]}}class YP extends Cm{constructor(e,n,i,r){super(e,n,i,r,"master")}alignOverlaysWithTrimmingContainer(){const e=dw(this.wtRootElement),{rootWindow:n}=this.domBindings;if(e===n)this.wtSettings.getSetting("preventOverflow")||(this.holder.style.overflow="visible",this.wtRootElement.style.overflow="visible");else{const i=e.parentElement,r=ZC(e,"height",n),o=ZC(e,"overflow",n),a=this.holder.style,{scrollWidth:u,scrollHeight:h}=e;let d=e.offsetWidth,g=e.offsetHeight;if(i&&["auto","hidden","scroll"].includes(o)){const v=e.cloneNode(!1);v.style.overflow="auto",v.style.position="absolute",e.nextElementSibling?i.insertBefore(v,e.nextElementSibling):i.appendChild(v);const y=parseInt(n.getComputedStyle(v).height,10);i.removeChild(v),y===0&&(g=0)}g=Math.min(g,h),a.height=r==="auto"?"auto":`${g}px`,d=Math.min(d,u),a.width=`${d}px`,a.overflow="",this.hasTableHeight=a.height==="auto"?!0:g>0,this.hasTableWidth=d>0}this.isTableVisible=Qg(this.TABLE)}markOversizedColumnHeaders(){const{wtSettings:e}=this,{wtViewport:n}=this.dataAccessObject,i="master",o=e.getSetting("columnHeaders").length;if(o&&!n.hasOversizedColumnHeadersMarked[i]){const u=e.getSetting("rowHeaders").length,h=this.getRenderedColumnsCount();for(let d=0;d<o;d++)for(let g=-1*u;g<h;g++)this.markIfOversizedColumnHeader(g);n.hasOversizedColumnHeadersMarked[i]=!0}}}en(YP,kP);en(YP,ER);class Bce{constructor(e,n,i,r,o){this.dataAccessObject=e,this.wot=e.wot,this.instance=this.wot,this.domBindings=n,this.wtSettings=i,this.wtTable=o,this.oversizedRows=[],this.oversizedColumnHeaders=[],this.hasOversizedColumnHeadersMarked={},this.clientHeight=0,this.rowHeaderWidth=NaN,this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,this.rowsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllRows")?new wle:new Ele],["fullyVisible",()=>new lle],["partiallyVisible",()=>new X4]]),this.columnsCalculatorTypes=new Map([["rendered",()=>this.wtSettings.getSetting("renderAllColumns")?new mle:new ble],["fullyVisible",()=>new ole],["partiallyVisible",()=>new K4]]),this.eventManager=r,this.eventManager.addEventListener(this.domBindings.rootWindow,"resize",()=>{this.clientHeight=this.getWorkspaceHeight()})}getWorkspaceHeight(){const e=this.domBindings.rootDocument,n=this.dataAccessObject.topOverlayTrimmingContainer;let i=0;return n===this.domBindings.rootWindow?i=e.documentElement.clientHeight:i=Ti(n)>0&&n.clientHeight>0?n.clientHeight:1/0,i}getViewportHeight(){let e=this.getWorkspaceHeight();if(e===1/0)return e;const n=this.getColumnHeaderHeight();return n>0&&(e-=n),e}getWorkspaceWidth(){const{rootDocument:e,rootWindow:n}=this.domBindings,i=this.dataAccessObject.inlineStartOverlayTrimmingContainer;let r;if(i===n){const o=this.wtSettings.getSetting("totalColumns");r=this.wtTable.holder.offsetWidth,this.getRowHeaderWidth()+this.sumColumnWidths(0,o)>r&&(r=e.documentElement.clientWidth)}else r=i.clientWidth;return r}getViewportWidth(){const e=this.getWorkspaceWidth();if(e===1/0)return e;const n=this.getRowHeaderWidth();return n>0?e-n:e}hasVerticalScroll(){if(this.isVerticallyScrollableByWindow()){const o=this.domBindings.rootDocument.documentElement;return o.scrollHeight>o.clientHeight}const{holder:e,hider:n}=this.wtTable,i=e.clientHeight,r=n.offsetHeight;return i<r?!0:r>this.getWorkspaceHeight()}hasHorizontalScroll(){if(this.isVerticallyScrollableByWindow()){const r=this.domBindings.rootDocument.documentElement;return r.scrollWidth>r.clientWidth}const{hider:e}=this.wtTable,n=e.offsetWidth,i=this.hasVerticalScroll()?_i():0;return n>this.getWorkspaceWidth()-i}isVerticallyScrollableByWindow(){return this.dataAccessObject.topOverlayTrimmingContainer===this.domBindings.rootWindow}isHorizontallyScrollableByWindow(){return this.dataAccessObject.inlineStartOverlayTrimmingContainer===this.domBindings.rootWindow}sumColumnWidths(e,n){let i=0,r=e;for(;r<n;)i+=this.wtTable.getColumnWidth(r),r+=1;return i}getWorkspaceOffset(){return pr(this.wtTable.holder)}getColumnHeaderHeight(){return this.wtSettings.getSetting("columnHeaders").length?isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=Ti(this.wtTable.THEAD)):this.columnHeaderHeight=0,this.columnHeaderHeight}getRowHeaderWidth(){const e=this.wtSettings.getSetting("rowHeaderWidth"),n=this.wtSettings.getSetting("rowHeaders");if(e){this.rowHeaderWidth=0;for(let i=0,r=n.length;i<r;i++)this.rowHeaderWidth+=e[i]||e}if(isNaN(this.rowHeaderWidth))if(n.length){let i=this.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(let r=0,o=n.length;r<o;r++)i?(this.rowHeaderWidth+=hi(i),i=i.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0;return this.rowHeaderWidth=this.wtSettings.getSetting("onModifyRowHeaderWidth",this.rowHeaderWidth)||this.rowHeaderWidth,this.rowHeaderWidth}createRowsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportHeight(),o,a;this.rowHeaderWidth=NaN;let u=this.dataAccessObject.topScrollPosition-this.dataAccessObject.topParentOffset;const h=n.getSetting("fixedRowsTop"),d=n.getSetting("fixedRowsBottom"),g=n.getSetting("totalRows");return h&&u>=0&&(a=this.dataAccessObject.topOverlay.sumCellSizes(0,h),u+=a,r-=a),d&&this.dataAccessObject.bottomOverlay.clone&&(a=this.dataAccessObject.bottomOverlay.sumCellSizes(g-d,g),r-=a),i.holder.clientHeight===i.holder.offsetHeight?o=0:o=_i(this.domBindings.rootDocument),new Ile({calculationTypes:e.map(m=>[m,this.rowsCalculatorTypes.get(m)()]),viewportHeight:r,scrollOffset:u,totalRows:n.getSetting("totalRows"),defaultRowHeight:n.getSetting("stylesHandler").getDefaultRowHeight(),rowHeightFn:m=>i.getRowHeight(m),overrideFn:n.getSettingPure("viewportRowCalculatorOverride"),horizontalScrollbarHeight:o})}createColumnsCalculator(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["rendered","fullyVisible","partiallyVisible"];const{wtSettings:n,wtTable:i}=this;let r=this.getViewportWidth(),o=Math.abs(this.dataAccessObject.inlineStartScrollPosition)-this.dataAccessObject.inlineStartParentOffset;this.columnHeaderHeight=NaN;const a=n.getSetting("fixedColumnsStart");if(a&&o>=0){const u=this.dataAccessObject.inlineStartOverlay.sumCellSizes(0,a);o+=u,r-=u}return i.holder.clientWidth!==i.holder.offsetWidth&&(r-=_i(this.domBindings.rootDocument)),new Ole({calculationTypes:e.map(u=>[u,this.columnsCalculatorTypes.get(u)()]),viewportWidth:r,scrollOffset:o,totalColumns:n.getSetting("totalColumns"),columnWidthFn:u=>i.getColumnWidth(u),overrideFn:n.getSettingPure("viewportColumnCalculatorOverride"),inlineStartOffset:this.dataAccessObject.inlineStartParentOffset})}createCalculators(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const{wtSettings:n}=this,i=this.createRowsCalculator(),r=this.createColumnsCalculator();if(e&&!n.getSetting("renderAllRows")){const o=i.getResultsFor("fullyVisible"),a=i.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleRowsAlreadyRendered(o,a)}if(e&&!n.getSetting("renderAllColumns")){const o=r.getResultsFor("fullyVisible"),a=r.getResultsFor("partiallyVisible");e=this.areAllProposedVisibleColumnsAlreadyRendered(o,a)}return e||(this.rowsRenderCalculator=i.getResultsFor("rendered"),this.columnsRenderCalculator=r.getResultsFor("rendered")),this.rowsVisibleCalculator=i.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=r.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=i.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=r.getResultsFor("partiallyVisible"),e}createVisibleCalculators(){const e=this.createRowsCalculator(["fullyVisible","partiallyVisible"]),n=this.createColumnsCalculator(["fullyVisible","partiallyVisible"]);this.rowsVisibleCalculator=e.getResultsFor("fullyVisible"),this.columnsVisibleCalculator=n.getResultsFor("fullyVisible"),this.rowsPartiallyVisibleCalculator=e.getResultsFor("partiallyVisible"),this.columnsPartiallyVisibleCalculator=n.getResultsFor("partiallyVisible")}areAllProposedVisibleRowsAlreadyRendered(e,n){if(!this.rowsVisibleCalculator)return!1;let{startRow:i,endRow:r}=e;const{startRow:o,endRow:a}=n;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isRowBeforeRenderedRows(o)&&!this.wtTable.isRowAfterRenderedRows(a))return!0;i=o,r=a}const{startRow:u,endRow:h,rowStartOffset:d,rowEndOffset:g}=this.rowsRenderCalculator,m=this.wtSettings.getSetting("totalRows")-1,v=this.wtSettings.getSetting("viewportRowRenderingThreshold");return Number.isInteger(v)&&v>0?(i=Math.max(0,i-Math.min(d,v)),r=Math.min(m,r+Math.min(g,v))):v==="auto"&&(i=Math.max(0,i-Math.ceil(d/2)),r=Math.min(m,r+Math.ceil(g/2))),i<u||i===u&&i>0?!1:!(r>h||r===h&&r<m)}areAllProposedVisibleColumnsAlreadyRendered(e,n){if(!this.columnsVisibleCalculator)return!1;let{startColumn:i,endColumn:r}=e;const{startColumn:o,endColumn:a}=n;if(i===null&&r===null){if(!e.isVisibleInTrimmingContainer&&!this.wtTable.isColumnBeforeRenderedColumns(o)&&!this.wtTable.isColumnAfterRenderedColumns(a))return!0;i=o,r=a}const{startColumn:u,endColumn:h,columnStartOffset:d,columnEndOffset:g}=this.columnsRenderCalculator,m=this.wtSettings.getSetting("totalColumns")-1,v=this.wtSettings.getSetting("viewportColumnRenderingThreshold");return Number.isInteger(v)&&v>0?(i=Math.max(0,i-Math.min(d,v)),r=Math.min(m,r+Math.min(g,v))):v==="auto"&&(i=Math.max(0,i-Math.ceil(d/2)),r=Math.min(m,r+Math.ceil(g/2))),i<u||i===u&&i>0?!1:!(r>h||r===h&&r<m)}resetHasOversizedColumnHeadersMarked(){wt(this.hasOversizedColumnHeadersMarked,(e,n,i)=>{i[n]=void 0})}}class Fce extends DP{constructor(e,n){super(e,new Vce(n));const i=this.wtSettings.getSetting("facade",this);this.wtTable=new YP(this.getTableDao(),i,this.domBindings,this.wtSettings),this.wtViewport=new Bce(this.getViewportDao(),this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.selectionManager=new Cce(this.wtSettings.getSetting("selections")),this.wtEvent=new t5(i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable,this.selectionManager),this.wtOverlays=new Lce(this,i,this.domBindings,this.wtSettings,this.eventManager,this.wtTable),this.exportSettingsAsClassNames(),this.findOriginalHeaders()}exportSettingsAsClassNames(){const e={rowHeaders:"htRowHeaders",columnHeaders:"htColumnHeaders"},n=[],i=[];wt(e,(r,o)=>{this.wtSettings.getSetting(o).length&&i.push(r),n.push(r)}),Ve(this.wtTable.wtRootElement.parentNode,n),fe(this.wtTable.wtRootElement.parentNode,i)}getOverlayByName(e){var n;if(!r5.includes(e))return null;const i=e.replace(/_([a-z])/g,r=>r[1].toUpperCase());return(n=this.wtOverlays[`${i}Overlay`])!==null&&n!==void 0?n:null}getViewportDao(){const e=this;return{get wot(){return e},get topOverlayTrimmingContainer(){return e.wtOverlays.topOverlay.trimmingContainer},get inlineStartOverlayTrimmingContainer(){return e.wtOverlays.inlineStartOverlay.trimmingContainer},get topScrollPosition(){return e.wtOverlays.topOverlay.getScrollPosition()},get topParentOffset(){return e.wtOverlays.topOverlay.getTableParentOffset()},get inlineStartScrollPosition(){return e.wtOverlays.inlineStartOverlay.getScrollPosition()},get inlineStartParentOffset(){return e.wtOverlays.inlineStartOverlay.getTableParentOffset()},get topOverlay(){return e.wtOverlays.topOverlay},get inlineStartOverlay(){return e.wtOverlays.inlineStartOverlay},get bottomOverlay(){return e.wtOverlays.bottomOverlay}}}}class GP{constructor(e){e instanceof DP?this._wot=e:this._initFromSettings(e)}_initFromSettings(e){e.facade=n=>{const i=new GP(n);return()=>i},this._wot=new Fce(e.table,e)}get guid(){return this._wot.guid}get rootDocument(){return this._wot.domBindings.rootDocument}get rootWindow(){return this._wot.domBindings.rootWindow}get wtSettings(){return this._wot.wtSettings}get cloneSource(){return this._wot.cloneSource}get cloneOverlay(){return this._wot.cloneOverlay}get selectionManager(){return this._wot.selectionManager}get wtViewport(){return this._wot.wtViewport}get wtOverlays(){return this._wot.wtOverlays}get wtTable(){return this._wot.wtTable}get wtEvent(){return this._wot.wtEvent}get wtScroll(){return this._wot.wtScroll}get drawn(){return this._wot.drawn}set drawn(e){this._wot.drawn=e}get activeOverlayName(){return this._wot.activeOverlayName}get drawInterrupted(){return this._wot.drawInterrupted}set drawInterrupted(e){this._wot.drawInterrupted=e}get lastMouseOver(){return this._wot.lastMouseOver}set lastMouseOver(e){this._wot.lastMouseOver=e}get momentumScrolling(){return this._wot.momentumScrolling}set momentumScrolling(e){this._wot.momentumScrolling=e}get touchApplied(){return this._wot.touchApplied}set touchApplied(e){this._wot.touchApplied=e}get domBindings(){return this._wot.domBindings}get eventListeners(){return this._wot.eventListeners}set eventListeners(e){this._wot.eventListeners=e}get eventManager(){return this._wot.eventManager}createCellCoords(e,n){return this._wot.createCellCoords(e,n)}createCellRange(e,n,i){return this._wot.createCellRange(e,n,i)}draw(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return this._wot.draw(e),this}getCell(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return this._wot.getCell(e,n)}scrollViewport(e,n,i){return this._wot.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wot.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wot.scrollViewportVertically(e,n)}getViewport(){return this._wot.getViewport()}getOverlayName(){return this._wot.cloneOverlay?this._wot.cloneOverlay.type:"master"}getOverlayByName(e){return this._wot.getOverlayByName(e)}exportSettingsAsClassNames(){return this._wot.exportSettingsAsClassNames()}update(e,n){return this._wot.wtSettings.update(e,n),this}getSetting(e,n,i,r,o){return this._wot.wtSettings.getSetting(e,n,i,r,o)}hasSetting(e){return this._wot.wtSettings.hasSetting(e)}destroy(){this._wot.destroy()}}function dU(t){let{isShiftKey:e,isLeftClick:n,isRightClick:i,coords:r,selection:o,controller:a,cellCoordsFactory:u}=t;const h=o.isSelected()?o.getSelectedRange().current():null,d=o.isSelectedByCorner(),g=o.isSelectedByRowHeader();if(o.markSource("mouse"),e&&h)r.row>=0&&r.col>=0&&!a.cell?o.setRangeEnd(r):(d||g)&&r.row>=0&&r.col>=0&&!a.cell?o.setRangeEnd(u(r.row,r.col)):d&&r.row<0&&!a.column?o.setRangeEnd(u(h.to.row,r.col)):g&&r.col<0&&!a.row?o.setRangeEnd(u(r.row,h.to.col)):(!d&&!g&&r.col<0||d&&r.col<0)&&!a.row?o.selectRows(Math.max(h.from.row,0),r.row,r.col):(!d&&!g&&r.row<0||g&&r.row<0)&&!a.column&&o.selectColumns(Math.max(h.from.col,0),r.col,r.row);else{const m=!o.inInSelection(r),v=n||i&&m;r.row<0&&r.col>=0&&!a.column?v&&o.selectColumns(r.col,r.col,r.row):r.col<0&&r.row>=0&&!a.row?v&&o.selectRows(r.row,r.row,r.col):r.col>=0&&r.row>=0&&!a.cell?v&&o.setRangeStart(r):r.col<0&&r.row<0&&o.selectAll(!0,!0,{disableHeadersHighlight:!0,focusPosition:{row:0,col:0}})}o.markEndSource()}function Wce(t){let{isLeftClick:e,coords:n,selection:i,controller:r,cellCoordsFactory:o}=t;if(!e)return;const a=i.isSelectedByRowHeader(),u=i.isSelectedByColumnHeader(),h=i.tableProps.countCols(),d=i.tableProps.countRows();i.markSource("mouse"),u&&!r.column?i.setRangeEnd(o(d-1,n.col)):a&&!r.row?i.setRangeEnd(o(n.row,h-1)):r.cell||i.setRangeEnd(n),i.markEndSource()}function fU(t){let{isLeftClick:e,selection:n,cellRangeMapper:i}=t;if(!e||n.settings.selectionMode!=="multiple")return;const r=n.getSelectedRange(),o=r.clone().map(u=>i.toRenderable(u)),a=o.current();if(o.size()>1&&!a.isHeader()&&!n.isMultiple(a)){const u=o.findAll(a);u.length===o.size()?(r.pop(),n.refresh()):u.length>1&&(r.removeLayers(u.map(h=>{let{layer:d}=h;return d})),n.refresh())}}const jce=new Map([["touchstart",dU],["touchend",fU],["mousedown",dU],["mouseover",Wce],["mouseup",fU]]);function IA(t,e){jce.get(t.type)({isShiftKey:t.shiftKey,isLeftClick:AP(t)||t.type==="touchstart",isRightClick:_d(t),...e})}const c5=new WeakMap,qP=Symbol("rootInstance");function zce(t){c5.set(t,!0)}function Uce(t){return t===qP}function Qh(t){return c5.has(t)}function Yce(t,e){h5(t,e),e.add(t)}function Ku(t,e,n){h5(t,e),e.set(t,n)}function h5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Xu(t,e,n){return(e=Gce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gce(t){var e=qce(t,"string");return typeof e=="symbol"?e:e+""}function qce(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ai(t,e){return t.get(zg(t,e))}function qr(t,e,n){return t.set(zg(t,e),n),n}function zg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var PA=new WeakMap,$S=new WeakMap,VS=new WeakMap,Pl=new WeakMap,Ws=new WeakMap,NA=new WeakMap,DA=new WeakMap,Df=new WeakMap,_v=new WeakSet;class Kce{constructor(e){Yce(this,_v),Xu(this,"hot",void 0),Xu(this,"eventManager",void 0),Xu(this,"settings",void 0),Xu(this,"THEAD",void 0),Xu(this,"TBODY",void 0),Xu(this,"_wt",void 0),Xu(this,"activeWt",void 0),Ku(this,PA,0),Ku(this,$S,0),Xu(this,"postponedAdjustElementsSize",!1),Ku(this,VS,!1),Ku(this,Pl,void 0),Ku(this,Ws,void 0),Ku(this,NA,0),Ku(this,DA,0),Ku(this,Df,null),this.hot=e,this.eventManager=new da(this.hot),this.settings=this.hot.getSettings(),this.createElements(),this.registerEvents(),this.initializeWalkontable()}render(){if(!this.hot.isRenderSuspended()){const e=this.hot.forceFullRender;this.hot.runHooks("beforeRender",e),this._wt.draw(!e),zg(_v,this,Zce).call(this),this.postponedAdjustElementsSize&&(this.postponedAdjustElementsSize=!1,this.adjustElementsSize(!0)),this.hot.runHooks("afterRender",e),this.hot.forceFullRender=!1}}adjustElementsSize(){(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)?this._wt.wtOverlays.adjustElementsSize():this.postponedAdjustElementsSize=!0}getCellAtCoords(e,n){const i=this._wt.getCell(e,n);return i<0?null:i}scrollViewport(e,n,i){return this._wt.scrollViewport(e,n,i)}scrollViewportHorizontally(e,n){return this._wt.scrollViewportHorizontally(e,n)}scrollViewportVertically(e,n){return this._wt.scrollViewportVertically(e,n)}createElements(){const{rootElement:e,rootDocument:n}=this.hot,i=e.getAttribute("style");i&&e.setAttribute("data-originalstyle",i),fe(e,"handsontable"),qr(Ws,this,n.createElement("TABLE")),fe(ai(Ws,this),"htCore"),this.hot.getSettings().tableClassName&&fe(ai(Ws,this),this.hot.getSettings().tableClassName),this.settings.ariaTags&&(We(ai(Ws,this),[tu()]),We(e,[Xoe(),g4(-1),gR(this.hot.countCols()),gse()])),this.THEAD=n.createElement("THEAD"),ai(Ws,this).appendChild(this.THEAD),this.TBODY=n.createElement("TBODY"),ai(Ws,this).appendChild(this.TBODY),this.hot.table=ai(Ws,this),this.hot.container.insertBefore(ai(Ws,this),this.hot.container.firstChild)}registerEvents(){const{rootWrapperElement:e,rootElement:n,rootDocument:i,selection:r,rootWindow:o}=this.hot,a=i.documentElement;this.eventManager.addEventListener(n,"mousedown",h=>{qr(VS,this,!0),this.isTextSelectionAllowed(h.target)||(oz(o),h.preventDefault(),o.focus())}),this.eventManager.addEventListener(n,"mouseup",()=>{qr(VS,this,!1)}),this.eventManager.addEventListener(n,"mousemove",h=>{ai(VS,this)&&!this.isTextSelectionAllowed(h.target)&&(this.settings.fragmentSelection&&oz(o),h.preventDefault())}),this.eventManager.addEventListener(a,"keyup",h=>{r.isInProgress()&&!h.shiftKey&&r.finish()}),this.eventManager.addEventListener(a,"mouseup",h=>{var d;r.isInProgress()&&AP(h)&&r.finish(),qr(Pl,this,!1);const g=x4(i.activeElement),m=(d=i.querySelector(".ht-dialog"))===null||d===void 0?void 0:d.contains(i.activeElement);pC(i.activeElement)&&!g||m||(g||!r.isSelected()&&!r.isSelectedByAnyHeader()&&!(e??n).contains(h.target)&&!_d(h))&&this.hot.unlisten()}),this.eventManager.addEventListener(a,"contextmenu",h=>{r.isInProgress()&&_d(h)&&(r.finish(),qr(Pl,this,!1))}),this.eventManager.addEventListener(a,"touchend",()=>{r.isInProgress()&&r.finish(),qr(Pl,this,!1)}),this.eventManager.addEventListener(a,"mousedown",h=>{const d=h.target,g=h.x||h.clientX,m=h.y||h.clientY;let v=h.target;if(ai(Pl,this)||!n||!this.hot.view)return;const{holder:y}=this._wt.wtTable;if(v===y){const C=_i(i);if(i.elementFromPoint(g+C,m)!==y||i.elementFromPoint(g,m+C)!==y)return}else for(;v!==a;){if(v===null){if(h.isTargetWebComponent)break;return}if(v===n)return;v=v.parentNode}(typeof this.settings.outsideClickDeselects=="function"?this.settings.outsideClickDeselects(d):this.settings.outsideClickDeselects)?this.hot.deselectCell():this.hot.destroyEditor(!1,!1)});let u=Zg(o);for(;u!==null;)this.eventManager.addEventListener(u.document.documentElement,"click",()=>{this.hot.unlisten()}),u=Zg(u);this.eventManager.addEventListener(ai(Ws,this),"selectstart",h=>{this.settings.fragmentSelection||pC(h.target)||h.preventDefault()})}translateFromRenderableToVisualCoords(e){let{row:n,col:i}=e;return this.hot._createCellCoords(...this.translateFromRenderableToVisualIndex(n,i))}translateFromRenderableToVisualIndex(e,n){let i=e>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(e):e,r=n>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(n):n;return i===null&&(i=e),r===null&&(r=n),[i,r]}countRenderableIndexes(e,n){const i=Math.min(e.getNotTrimmedIndexesLength(),n),r=e.getNearestNotHiddenIndex(i-1,-1);return r===null?0:e.getRenderableFromVisualIndex(r)+1}countRenderableColumns(){return this.countRenderableIndexes(this.hot.columnIndexMapper,this.settings.maxCols)}countRenderableRows(){return this.countRenderableIndexes(this.hot.rowIndexMapper,this.settings.maxRows)}countNotHiddenRowIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.rowIndexMapper,this.countRenderableRows())}countNotHiddenColumnIndexes(e,n){return this.countNotHiddenIndexes(e,n,this.hot.columnIndexMapper,this.countRenderableColumns())}countNotHiddenIndexes(e,n,i,r){if(isNaN(e)||e<0)return 0;const o=i.getNearestNotHiddenIndex(e,n),a=i.getRenderableFromVisualIndex(o);if(!Number.isInteger(a))return 0;let u=0;return n<0?u=a+1:n>0&&(u=r-a),u}countNotHiddenFixedColumnsStart(){const e=this.hot.countCols(),n=Math.min(parseInt(this.settings.fixedColumnsStart,10),e)-1;return this.countNotHiddenColumnIndexes(n,-1)}countNotHiddenFixedRowsTop(){const e=this.hot.countRows(),n=Math.min(parseInt(this.settings.fixedRowsTop,10),e)-1;return this.countNotHiddenRowIndexes(n,-1)}countNotHiddenFixedRowsBottom(){const e=this.hot.countRows(),n=Math.max(e-parseInt(this.settings.fixedRowsBottom,10),0);return this.countNotHiddenRowIndexes(n,1)}countRenderableColumnsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.columnIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}countRenderableRowsInRange(e,n){let i=0;for(let r=e;r<=n;r++)this.hot.rowIndexMapper.getRenderableFromVisualIndex(r)!==null&&(i+=1);return i}addClassNameToLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&fe(i,e)}removeClassNameFromLicenseElement(e){var n;const i=(n=this.hot.rootElement.parentNode)===null||n===void 0?void 0:n.querySelector(".hot-display-license-info");i&&Ve(i,e)}isMainTableNotFullyCoveredByOverlays(){const e=this.countNotHiddenFixedRowsTop()+this.countNotHiddenFixedRowsBottom(),n=this.countNotHiddenFixedColumnsStart();return this.hot.countRenderedRows()>e&&this.hot.countRenderedCols()>n}initializeWalkontable(){const e={ariaTags:this.settings.ariaTags,rtlMode:this.hot.isRtl(),externalRowCalculator:this.hot.getPlugin("autoRowSize")&&this.hot.getPlugin("autoRowSize").isEnabled(),table:ai(Ws,this),isDataViewInstance:()=>Qh(this.hot),preventOverflow:()=>this.settings.preventOverflow,preventWheel:()=>this.settings.preventWheel,viewportColumnRenderingThreshold:()=>this.settings.viewportColumnRenderingThreshold,viewportRowRenderingThreshold:()=>this.settings.viewportRowRenderingThreshold,data:(o,a)=>this.hot.getDataAtCell(...this.translateFromRenderableToVisualIndex(o,a)),totalRows:()=>this.countRenderableRows(),totalColumns:()=>this.countRenderableColumns(),fixedColumnsStart:()=>this.countNotHiddenFixedColumnsStart(),fixedRowsTop:()=>this.countNotHiddenFixedRowsTop(),fixedRowsBottom:()=>this.countNotHiddenFixedRowsBottom(),shouldRenderInlineStartOverlay:()=>this.settings.fixedColumnsStart>0||e.rowHeaders().length>0,shouldRenderTopOverlay:()=>this.settings.fixedRowsTop>0||e.columnHeaders().length>0,shouldRenderBottomOverlay:()=>this.settings.fixedRowsBottom>0,minSpareRows:()=>this.settings.minSpareRows,renderAllRows:this.settings.renderAllRows,renderAllColumns:this.settings.renderAllColumns,rowHeaders:()=>{const o=[];return this.hot.hasRowHeaders()&&o.push((a,u)=>{const h=a>=0?this.hot.rowIndexMapper.getVisualFromRenderableIndex(a):a;this.appendRowHeader(h,u)}),this.hot.runHooks("afterGetRowHeaderRenderers",o),qr($S,this,o.length),this.hot.getSettings().ariaTags&&zg(_v,this,d5).call(this)===this.hot.countCols()&&zg(_v,this,Xce).call(this,ai($S,this)),o},columnHeaders:()=>{const o=[];return this.hot.hasColHeaders()&&o.push((a,u)=>{const h=a>=0?this.hot.columnIndexMapper.getVisualFromRenderableIndex(a):a;this.appendColHeader(h,u)}),this.hot.runHooks("afterGetColumnHeaderRenderers",o),qr(PA,this,o.length),o},columnWidth:o=>{const a=this.hot.columnIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getColWidth(a===null?o:a)},rowHeight:o=>{const a=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o);return this.hot.getRowHeight(a===null?o:a)},rowHeightByOverlayName:(o,a)=>{const u=this.hot.rowIndexMapper.getVisualFromRenderableIndex(o),h=u===null?o:u;return this.hot.runHooks("modifyRowHeightByOverlayName",this.hot.getRowHeight(h),h,a)},cellRenderer:(o,a,u)=>{const[h,d]=this.translateFromRenderableToVisualIndex(o,a),g=this.hot.runHooks("modifyGetCellCoords",h,d,!1,"meta");let m=h,v=d;Array.isArray(g)&&([m,v]=g);const y=this.hot.getCellMeta(m,v),b=this.hot.colToProp(v);let C=this.hot.getDataAtRowProp(m,b);this.hot.hasHook("beforeValueRender")&&(C=this.hot.runHooks("beforeValueRender",C,y)),this.hot.runHooks("beforeRenderer",u,h,d,b,C,y),this.hot.getCellRenderer(y)(this.hot,u,h,d,b,C,y),this.hot.runHooks("afterRenderer",u,h,d,b,C,y)},selections:this.hot.selection.highlight,hideBorderOnMouseDownOver:()=>this.settings.fragmentSelection,onWindowResize:()=>{this.hot&&!this.hot.isDestroyed&&this.hot.refreshDimensions()},onContainerElementResize:()=>{this.hot&&!this.hot.isDestroyed&&Qg(this.hot.rootElement)&&this.hot.refreshDimensions()},onCellMouseDown:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.hot.listen(),this.activeWt=h,qr(Pl,this,!0),qr(Df,this,{x:o.clientX,y:o.clientY}),this.hot.runHooks("beforeOnCellMouseDown",o,d,u,g),!rd(o)&&(IA(o,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(m,v)=>this.hot._createCellCoords(m,v)}),this.hot.runHooks("afterOnCellMouseDown",o,d,u),this.activeWt=this._wt)},onCellContextMenu:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,qr(Pl,this,!1),this.hot.selection.isInProgress()&&this.hot.selection.finish(),this.hot.runHooks("beforeOnCellContextMenu",o,d,u),!rd(o)&&(this.hot.runHooks("afterOnCellContextMenu",o,d,u),this.activeWt=this._wt)},onCellMouseOut:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOut",o,d,u),!rd(o)&&(this.hot.runHooks("afterOnCellMouseOut",o,d,u),this.activeWt=this._wt)},onCellMouseOver:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a),g={row:!1,column:!1,cell:!1};this.activeWt=h,this.hot.runHooks("beforeOnCellMouseOver",o,d,u,g),!rd(o)&&(ai(Pl,this)&&(!ai(Df,this)||ai(Df,this).x!==o.clientX||ai(Df,this).y!==o.clientY)&&IA(o,{coords:d,selection:this.hot.selection,controller:g,cellCoordsFactory:(m,v)=>this.hot._createCellCoords(m,v)}),this.hot.runHooks("afterOnCellMouseOver",o,d,u),this.activeWt=this._wt,qr(Df,this,null))},onCellMouseUp:(o,a,u,h)=>{const d=this.translateFromRenderableToVisualCoords(a);this.activeWt=h,this.hot.runHooks("beforeOnCellMouseUp",o,d,u),!(rd(o)||this.hot.isDestroyed)&&(IA(o,{coords:d,selection:this.hot.selection,cellRangeMapper:dae(this.hot,"cellRangeMapper")}),this.hot.runHooks("afterOnCellMouseUp",o,d,u),this.activeWt=this._wt)},onCellCornerMouseDown:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerMouseDown",o)},onCellCornerDblClick:o=>{o.preventDefault(),this.hot.runHooks("afterOnCellCornerDblClick",o)},beforeDraw:(o,a)=>this.beforeRender(o,a),onDraw:o=>this.afterRender(o),onBeforeViewportScrollVertically:(o,a)=>{const u=this.hot.rowIndexMapper,h=o<0;let d=o;return!h&&(d=u.getVisualFromRenderableIndex(o),d===null)?o:(d=this.hot.runHooks("beforeViewportScrollVertically",d,a),this.hot.runHooks("beforeViewportScroll"),h?d:u.getRenderableFromVisualIndex(d))},onBeforeViewportScrollHorizontally:(o,a)=>{const u=this.hot.columnIndexMapper,h=o<0;let d=o;return!h&&(d=u.getVisualFromRenderableIndex(o),d===null)?o:(d=this.hot.runHooks("beforeViewportScrollHorizontally",d,a),this.hot.runHooks("beforeViewportScroll"),h?d:u.getRenderableFromVisualIndex(d))},onScrollVertically:()=>{this.hot.runHooks("afterScrollVertically"),this.hot.runHooks("afterScroll")},onScrollHorizontally:()=>{this.hot.runHooks("afterScrollHorizontally"),this.hot.runHooks("afterScroll")},onBeforeRemoveCellClassNames:()=>this.hot.runHooks("beforeRemoveCellClassNames"),onBeforeHighlightingRowHeader:(o,a,u)=>{const h=this.hot.rowIndexMapper,d=o<0;let g=o;d||(g=h.getVisualFromRenderableIndex(o));const m=this.hot.runHooks("beforeHighlightingRowHeader",g,a,u);return d?m:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(m,1))},onBeforeHighlightingColumnHeader:(o,a,u)=>{const h=this.hot.columnIndexMapper,d=o<0;let g=o;d||(g=h.getVisualFromRenderableIndex(o));const m=this.hot.runHooks("beforeHighlightingColumnHeader",g,a,u);return d?m:h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(m,1))},onAfterDrawSelection:(o,a,u)=>{let h;const[d,g]=this.translateFromRenderableToVisualIndex(o,a),m=this.hot.selection.getSelectedRange();if(m.size()>0){const y=m.peekByIndex(u??0);h=[y.from.row,y.from.col,y.to.row,y.to.col]}return this.hot.runHooks("afterDrawSelection",d,g,h,u)},onBeforeDrawBorders:(o,a)=>{const[u,h,d,g]=o,m=[this.hot.rowIndexMapper.getVisualFromRenderableIndex(u),this.hot.columnIndexMapper.getVisualFromRenderableIndex(h),this.hot.rowIndexMapper.getVisualFromRenderableIndex(d),this.hot.columnIndexMapper.getVisualFromRenderableIndex(g)];return this.hot.runHooks("beforeDrawBorders",m,a)},onBeforeTouchScroll:()=>this.hot.runHooks("beforeTouchScroll"),onAfterMomentumScroll:()=>this.hot.runHooks("afterMomentumScroll"),onModifyRowHeaderWidth:o=>this.hot.runHooks("modifyRowHeaderWidth",o),onModifyGetCellCoords:(o,a,u,h)=>{const d=this.hot.rowIndexMapper,g=this.hot.columnIndexMapper,m=a>=0?g.getVisualFromRenderableIndex(a):a,v=o>=0?d.getVisualFromRenderableIndex(o):o,y=this.hot.runHooks("modifyGetCellCoords",v,m,u,h);if(Array.isArray(y)){const[b,C,T,O]=y;return[b>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(b,1)):b,C>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(C,1)):C,T>=0?d.getRenderableFromVisualIndex(d.getNearestNotHiddenIndex(T,-1)):T,O>=0?g.getRenderableFromVisualIndex(g.getNearestNotHiddenIndex(O,-1)):O]}},onModifyGetCoordsElement:(o,a)=>{const u=this.hot.rowIndexMapper,h=this.hot.columnIndexMapper,d=a>=0?h.getVisualFromRenderableIndex(a):a,g=o>=0?u.getVisualFromRenderableIndex(o):o,m=this.hot.runHooks("modifyGetCoordsElement",g,d);if(Array.isArray(m)){const[v,y]=m;return[v>=0?u.getRenderableFromVisualIndex(u.getNearestNotHiddenIndex(v,1)):v,y>=0?h.getRenderableFromVisualIndex(h.getNearestNotHiddenIndex(y,1)):y]}},viewportRowCalculatorOverride:o=>{let a=this.settings.viewportRowRenderingOffset;if(a==="auto"&&this.settings.fixedRowsTop&&(a=10),a>0||a==="auto"){const u=this.countRenderableRows(),h=o.startRow,d=o.endRow;if(typeof a=="number")o.startRow=Math.max(h-a,0),o.endRow=Math.min(d+a,u-1);else if(a==="auto"){const g=Math.max(1,Math.ceil(d/u*12));o.startRow=Math.max(h-g,0),o.endRow=Math.min(d+g,u-1)}}this.hot.runHooks("afterViewportRowCalculatorOverride",o)},viewportColumnCalculatorOverride:o=>{let a=this.settings.viewportColumnRenderingOffset;if(a==="auto"&&this.settings.fixedColumnsStart&&(a=10),a>0||a==="auto"){const u=this.countRenderableColumns(),h=o.startColumn,d=o.endColumn;if(typeof a=="number"&&(o.startColumn=Math.max(h-a,0),o.endColumn=Math.min(d+a,u-1)),a==="auto"){const g=Math.max(1,Math.ceil(d/u*6));o.startColumn=Math.max(h-g,0),o.endColumn=Math.min(d+g,u-1)}}this.hot.runHooks("afterViewportColumnCalculatorOverride",o)},rowHeaderWidth:()=>this.settings.rowHeaderWidth,columnHeaderHeight:()=>{const o=this.hot.runHooks("modifyColumnHeaderHeight");return this.settings.columnHeaderHeight||o},stylesHandler:()=>this.hot.stylesHandler};this.hot.runHooks("beforeInitWalkontable",e),this._wt=new GP(e),this.activeWt=this._wt;const n=this._wt.wtTable.spreader,{width:i,height:r}=this.hot.rootElement.getBoundingClientRect();this.setLastSize(i,r),this.eventManager.addEventListener(n,"mousedown",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(n,"contextmenu",o=>{o.target===n&&o.which===3&&o.stopPropagation()}),this.eventManager.addEventListener(this.hot.rootDocument.documentElement,"click",()=>{this.settings.observeDOMVisibility&&this._wt.drawInterrupted&&this.hot.render()})}isTextSelectionAllowed(e){var n,i;if(pC(e))return!0;const r=bd(e,this._wt.wtTable.spreader);if(this.settings.fragmentSelection===!0&&r)return!0;const o=(n=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.isSingleCell())!==null&&n!==void 0?n:!1;return!!(this.settings.fragmentSelection==="cell"&&o&&r||!this.settings.fragmentSelection&&this.isCellEdited()&&o)}isMouseDown(){return ai(Pl,this)}isCellEdited(){const e=this.hot.getActiveEditor();return e&&e.isOpened()}beforeRender(e,n){e&&this.hot.runHooks("beforeViewRender",this.hot.forceFullRender,n)}afterRender(e){e&&this.hot.runHooks("afterViewRender",this.hot.forceFullRender)}appendRowHeader(e,n){if(n.firstChild){const i=n.firstChild;if(!Xe(i,"relative")){du(n),this.appendRowHeader(e,n);return}this.updateCellHeader(i.querySelector(".rowHeader"),e,this.hot.getRowHeader)}else{const{rootDocument:i,getRowHeader:r}=this.hot,o=i.createElement("div"),a=i.createElement("span");o.className="relative",a.className="rowHeader",this.updateCellHeader(a,e,r),o.appendChild(a),n.appendChild(o)}this.hot.runHooks("afterGetRowHeader",e,n)}appendColHeader(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getColHeader,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0;const o=()=>{const a=e>=0?this.hot.getColumnMeta(e).headerClassName:null;return a?a.split(" "):[]};if(n.firstChild){const a=n.firstChild;Xe(a,"relative")?(this.updateCellHeader(a.querySelector(".colHeader"),e,i,r),a.className="",fe(a,["relative",...o()])):(du(n),this.appendColHeader(e,n,i,r))}else{const{rootDocument:a}=this.hot,u=a.createElement("div"),h=a.createElement("span"),d=o();u.classList.add("relative",...d),h.className="colHeader",this.settings.ariaTags&&(We(u,...tu()),We(h,...tu())),this.updateCellHeader(h,e,i,r),u.appendChild(h),n.appendChild(u)}this.hot.runHooks("afterGetColHeader",e,n,r)}updateCellHeader(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,o=n;const a=this._wt.wtOverlays.getParentOverlay(e)||this._wt;e.parentNode&&(Xe(e,"colHeader")?o=a.wtTable.columnFilter.sourceToRendered(n):Xe(e,"rowHeader")&&(o=a.wtTable.rowFilter.sourceToRendered(n))),o>-1?Fd(e,i(n,r)):(Td(e," "),fe(e,"cornerHeader"))}maximumVisibleElementWidth(e){const i=this._wt.wtViewport.getWorkspaceWidth()-e;return i>0?i:0}maximumVisibleElementHeight(e){const i=this._wt.wtViewport.getWorkspaceHeight()-e;return i>0?i:0}setLastSize(e,n){qr(NA,this,e),qr(DA,this,n)}getLastSize(){return{width:ai(NA,this),height:ai(DA,this)}}getFirstRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedRow());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleRow(){if(!this._wt.wtViewport.rowsRenderCalculator)return null;const e=this.hot.rowIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedRow());return e.getNearestNotHiddenIndex(n??this.hot.countRows()-1,-1)}getFirstRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getFirstRenderedColumn());return e.getNearestNotHiddenIndex(n??0,1)}getLastRenderedVisibleColumn(){if(!this._wt.wtViewport.columnsRenderCalculator)return null;const e=this.hot.columnIndexMapper,n=e.getVisualFromRenderableIndex(this._wt.wtTable.getLastRenderedColumn());return e.getNearestNotHiddenIndex(n??this.hot.countCols()-1,-1)}getFirstFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleRow())}getLastFullyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleRow())}getFirstFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstVisibleColumn())}getLastFullyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastVisibleColumn())}getFirstPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleRow())}getLastPartiallyVisibleRow(){return this.hot.rowIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleRow())}getFirstPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getFirstPartiallyVisibleColumn())}getLastPartiallyVisibleColumn(){return this.hot.columnIndexMapper.getVisualFromRenderableIndex(this._wt.wtScroll.getLastPartiallyVisibleColumn())}getColumnHeadersCount(){return ai(PA,this)}getRowHeadersCount(){return ai($S,this)}getViewportWidth(){return this._wt.wtViewport.getViewportWidth()}getWorkspaceWidth(){return this._wt.wtViewport.getWorkspaceWidth()}getViewportHeight(){return this._wt.wtViewport.getViewportHeight()}getWorkspaceHeight(){return this._wt.wtViewport.getWorkspaceHeight()}getElementOverlayName(e){var n;return((n=this._wt.wtOverlays.getParentOverlay(e))!==null&&n!==void 0?n:this._wt).wtTable.name}getOverlayByName(e){return this._wt.getOverlayByName(e)}getActiveOverlayName(){return this._wt.activeOverlayName}isVisible(){return this._wt.wtTable.isVisible()}hasVerticalScroll(){return this._wt.wtViewport.hasVerticalScroll()}hasHorizontalScroll(){return this._wt.wtViewport.hasHorizontalScroll()}getTableWidth(){return this._wt.wtTable.getWidth()}getTableHeight(){return this._wt.wtTable.getHeight()}getTotalTableWidth(){return this._wt.wtTable.getTotalWidth()}getTotalTableHeight(){return this._wt.wtTable.getTotalHeight()}getTableOffset(){return this._wt.wtViewport.getWorkspaceOffset()}getRowHeaderWidth(){return this._wt.wtViewport.getRowHeaderWidth()}getColumnHeaderHeight(){return this._wt.wtViewport.getColumnHeaderHeight()}isVerticallyScrollableByWindow(){return this._wt.wtViewport.isVerticallyScrollableByWindow()}isHorizontallyScrollableByWindow(){return this._wt.wtViewport.isHorizontallyScrollableByWindow()}destroy(){this._wt.destroy(),this.eventManager.destroy()}}function d5(){return parseInt(this.hot.rootElement.getAttribute(gR()[0]),10)}function Xce(t){const e=zg(_v,this,d5).call(this)+t;We(this.hot.rootElement,...gR(e))}function Zce(){const t=this.hot.rootElement;this.hasVerticalScroll()?fe(t,"htHasScrollY"):Ve(t,"htHasScrollY"),this.isVerticallyScrollableByWindow()?fe(t,"htVerticallyScrollableByWindow"):Ve(t,"htVerticallyScrollableByWindow"),this.hasHorizontalScroll()?fe(t,"htHasScrollX"):Ve(t,"htHasScrollX"),this.isHorizontallyScrollableByWindow()?fe(t,"htHorizontallyScrollableByWindow"):Ve(t,"htHorizontallyScrollableByWindow")}var gU={},mU={},pU;function Qce(){if(pU)return mU;pU=1;var t=Cn(),e=Oi(),n=vm(),i=uo(),r=Hi(),o=ol(),a=co(),u=jc(),h=u("every",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:h},{every:function(g){r(this);try{i(g)}catch(y){a(this,"throw",y)}if(h)return e(h,this,g);var m=o(this),v=0;return!n(m,function(y,b){if(!g(y,v++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),mU}var vU;function Jce(){return vU||(vU=1,Qce()),gU}Jce();const ehe="ABCDEFGHIJKLMNOPQRSTUVWXYZ",wU=ehe.length;function the(t){let e=t+1,n="",i;for(;e>0;)i=(e-1)%wU,n=String.fromCharCode(65+i)+n,e=parseInt((e-i)/wU,10);return n}function f5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=t;const i=[];return(!Array.isArray(t)||!Array.isArray(t[0]))&&(n=[t]),n.forEach((r,o)=>{Array.isArray(r)?r.forEach((a,u)=>{i.push([o+e,u,a])}):Object.keys(r).forEach(a=>{i.push([o+e,a,r[a]])})}),i}function g5(t){let e=0;return Array.isArray(t)&&(t[0]&&Array.isArray(t[0])?e=t[0].length:t[0]&&Qe(t[0])&&(e=EP(t[0]))),e}function nhe(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>Array.isArray(e)))}function ihe(t){return!!(Array.isArray(t)&&t.length&&t.every(e=>typeof e=="object"&&!Array.isArray(e)&&e!==null))}function Bp(t,e,n){return(e=rhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rhe(t){var e=ohe(t,"string");return typeof e=="symbol"?e:e+""}function ohe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class she{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];Bp(this,"hot",void 0),Bp(this,"data",void 0),Bp(this,"dataType","array"),Bp(this,"colToProp",()=>{}),Bp(this,"propToCol",()=>{}),this.hot=e,this.data=n}modifyRowData(e){let n;return this.hot.hasHook("modifyRowData")&&(n=this.hot.runHooks("modifyRowData",e)),n!==void 0&&!Number.isInteger(n)?n:this.data[e]}getData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;return!this.data||this.data.length===0?this.data:this.getByRange(null,null,e)}setData(e){this.data=e}getAtColumn(e){const n=[];return U(this.data,(i,r)=>{const o=this.getAtCell(r,e);n.push(o)}),n}getAtRow(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const o=n===void 0&&i===void 0,{dataDotNotation:a}=this.hot.getSettings();let u=null,h=null;if(u=this.modifyRowData(e),Array.isArray(u))h=[],o?u.forEach((d,g)=>{h[g]=this.getAtPhysicalCell(e,g,u)}):ze(n,i,d=>{h[d-n]=this.getAtPhysicalCell(e,d,u)});else if(Qe(u)||Yt(u))if(r?h=[]:h={},!o||r){const g=this.countFirstRowKeys()-1;ze(0,g,m=>{const v=this.colToProp(m);if(m>=(n||0)&&m<=(i||g)&&!Number.isInteger(v)){const y=this.getAtPhysicalCell(e,v,u);r?h.push(y):a?oA(h,v,y):h[v]=y}})}else wt(u,(d,g)=>{const m=this.getAtPhysicalCell(e,g,u);a?oA(h,g,m):h[g]=m});return h}setAtCell(e,n,i){if(!(e>=this.countRows()||n>=this.countFirstRowKeys())){if(this.hot.hasHook("modifySourceData")){const r=Wo(i);this.hot.runHooks("modifySourceData",e,n,r,"set"),r.isTouched()&&(i=r.value)}["__proto__","constructor","prototype"].includes(e)||(Number.isInteger(n)?this.data[e][n]=i:oA(this.data[e],n,i))}}getAtPhysicalCell(e,n,i){let r=null;if(i)if(typeof n=="string"){const{dataDotNotation:o}=this.hot.getSettings();r=o?IH(i,n):i[n]}else typeof n=="function"?r=n(i):r=i[n];if(this.hot.hasHook("modifySourceData")){const o=Wo(r);this.hot.runHooks("modifySourceData",e,n,o,"get"),o.isTouched()&&(r=o.value)}return r}getAtCell(e,n){const i=this.modifyRowData(e);return this.getAtPhysicalCell(e,this.colToProp(n),i)}getByRange(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=!1,o=null,a=null,u=null,h=null;e===null||n===null?(r=!0,o=0,u=this.countRows()-1):(o=Math.min(e.row,n.row),a=Math.min(e.col,n.col),u=Math.max(e.row,n.row),h=Math.max(e.col,n.col));const d=[];return ze(o,u,g=>{d.push(r?this.getAtRow(g,void 0,void 0,i):this.getAtRow(g,a,h,i))}),d}getCopyable(e,n){const i=this.propToCol(n);return this.hot.getCellMeta(e,i).copyable?this.getAtCell(this.hot.toPhysicalRow(e),i):""}countRows(){if(this.hot.hasHook("modifySourceLength")){const e=this.hot.runHooks("modifySourceLength");if(Number.isInteger(e))return e}return this.data.length}countFirstRowKeys(){return g5(this.data)}destroy(){this.data=null,this.hot=null}}var yU={},SU={},bU;function ahe(){if(bU)return SU;bU=1;var t=Cn(),e=Oi(),n=vm(),i=uo(),r=Hi(),o=ol(),a=co(),u=jc(),h=u("some",TypeError);return t({target:"Iterator",proto:!0,real:!0,forced:h},{some:function(g){r(this);try{i(g)}catch(y){a(this,"throw",y)}if(h)return e(h,this,g);var m=o(this),v=0;return n(m,function(y,b){if(g(y,v++))return b()},{IS_RECORD:!0,INTERRUPTED:!0}).stopped}}),SU}var CU;function lhe(){return CU||(CU=1,ahe()),yU}lhe();function RU(t,e,n){return(e=uhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uhe(t){var e=che(t,"string");return typeof e=="symbol"?e:e+""}function che(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Wd{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;RU(this,"indexedValues",[]),RU(this,"initValueOrFn",void 0),this.initValueOrFn=e}getValues(){return this.indexedValues}getValueAtIndex(e){const n=this.indexedValues;if(e<n.length)return n[e]}setValues(e){this.indexedValues=e.slice(),this.runLocalHooks("change")}setValueAtIndex(e,n){return e<this.indexedValues.length?(this.indexedValues[e]=n,this.runLocalHooks("change"),!0):!1}clear(){this.setDefaultValues()}getLength(){return this.getValues().length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.indexedValues.length=0,Yt(this.initValueOrFn)?ze(e-1,n=>this.indexedValues.push(this.initValueOrFn(n))):ze(e-1,()=>this.indexedValues.push(this.initValueOrFn)),this.runLocalHooks("change")}init(e){return this.setDefaultValues(e),this.runLocalHooks("init"),this}insert(){this.runLocalHooks("change")}remove(){this.runLocalHooks("change")}destroy(){this.clearLocalHooks(),this.indexedValues=null,this.initValueOrFn=null}}en(Wd,Fi);function KP(t,e,n,i){const r=n.length?n[0]:void 0;return[...t.slice(0,r),...n.map((o,a)=>Yt(i)?i(o,a):i),...r===void 0?[]:t.slice(r)]}function XP(t,e){return Rd(t,(n,i)=>e.includes(i)===!1)}class Uc extends Wd{insert(e,n){this.indexedValues=KP(this.indexedValues,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){this.indexedValues=XP(this.indexedValues,e),super.remove(e)}}class TR extends Uc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getHiddenIndexes(){return ho(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}function ZP(t,e,n){return[...t.slice(0,e),...n,...t.slice(e)]}function fw(t,e){return Rd(t,n=>e.includes(n)===!1)}function QP(t,e){return Vt(t,n=>n-e.filter(i=>i<n).length)}function JP(t,e){const n=e[0],i=e.length;return Vt(t,r=>r>=n?r+i:r)}function hhe(t,e,n){return(e=dhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dhe(t){var e=fhe(t,"string");return typeof e=="symbol"?e:e+""}function fhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _R extends Wd{constructor(){super(...arguments),hhe(this,"orderOfIndexes",[])}getValues(){return this.orderOfIndexes.map(e=>this.indexedValues[e])}setValues(e){this.orderOfIndexes=[...Array(e.length).keys()],super.setValues(e)}setValueAtIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.orderOfIndexes.length;return e<this.indexedValues.length?(this.indexedValues[e]=n,this.orderOfIndexes.includes(e)===!1&&this.orderOfIndexes.splice(i,0,e),this.runLocalHooks("change"),!0):!1}clearValue(e){this.orderOfIndexes=fw(this.orderOfIndexes,[e]),Yt(this.initValueOrFn)?super.setValueAtIndex(e,this.initValueOrFn(e)):super.setValueAtIndex(e,this.initValueOrFn)}getLength(){return this.orderOfIndexes.length}setDefaultValues(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.indexedValues.length;this.orderOfIndexes.length=0,super.setDefaultValues(e)}insert(e,n){this.indexedValues=KP(this.indexedValues,e,n,this.initValueOrFn),this.orderOfIndexes=JP(this.orderOfIndexes,n),super.insert(e,n)}remove(e){this.indexedValues=XP(this.indexedValues,e),this.orderOfIndexes=fw(this.orderOfIndexes,e),this.orderOfIndexes=QP(this.orderOfIndexes,e),super.remove(e)}getEntries(){return this.orderOfIndexes.map(e=>[e,this.getValueAtIndex(e)])}}class Uw extends Uc{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;super(e)}getTrimmedIndexes(){return ho(this.getValues(),(e,n,i)=>(n&&e.push(i),e),[])}}const EU=new Map([["indexesSequence",{getListWithInsertedItems:ZP,getListWithRemovedItems:fw}],["physicallyIndexed",{getListWithInsertedItems:KP,getListWithRemovedItems:XP}]]),m5=t=>{if(EU.has(t)===!1)throw new Error(`Alter strategy with ID '${t}' does not exist.`);return EU.get(t)};class p5 extends Wd{constructor(){super(e=>e)}insert(e,n){const i=JP(this.indexedValues,n);this.indexedValues=ZP(i,e,n),super.insert(e,n)}remove(e){const n=fw(this.indexedValues,e);this.indexedValues=QP(n,e),super.remove(e)}}const TU=new Map([["hiding",TR],["index",Wd],["linkedPhysicalIndexToValue",_R],["physicalIndexToValue",Uc],["trimming",Uw]]);function ghe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;if(!TU.has(t))throw new Error(`The provided map type ("${t}") does not exist.`);return new(TU.get(t))(e)}function mhe(t,e,n){return(e=phe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function phe(t){var e=vhe(t,"string");return typeof e=="symbol"?e:e+""}function vhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class eN{constructor(){mhe(this,"collection",new Map)}register(e,n){this.collection.has(e)===!1&&(this.collection.set(e,n),n.addLocalHook("change",()=>this.runLocalHooks("change",n)))}unregister(e){const n=this.collection.get(e);Ne(n)&&(n.destroy(),this.collection.delete(e),this.runLocalHooks("change",n))}unregisterAll(){this.collection.forEach((e,n)=>this.unregister(n)),this.collection.clear()}get(e){return $n(e)?Array.from(this.collection.values()):this.collection.get(e)}getLength(){return this.collection.size}removeFromEvery(e){this.collection.forEach(n=>{n.remove(e)})}insertToEvery(e,n){this.collection.forEach(i=>{i.insert(e,n)})}initEvery(e){this.collection.forEach(n=>{n.init(e)})}}en(eN,Fi);function LA(t,e,n){return(e=whe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function whe(t){var e=yhe(t,"string");return typeof e=="symbol"?e:e+""}function yhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _U extends eN{constructor(e,n){super(),LA(this,"mergedValuesCache",[]),LA(this,"aggregationFunction",void 0),LA(this,"fallbackValue",void 0),this.aggregationFunction=e,this.fallbackValue=n}getMergedValues(){if((arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0)return this.mergedValuesCache;if(this.getLength()===0)return[];const n=Vt(this.get(),o=>o.getValues()),i=[],r=Ne(n[0])&&n[0].length||0;for(let o=0;o<r;o+=1){const a=[];for(let u=0;u<this.getLength();u+=1)a.push(n[u][o]);i.push(a)}return Vt(i,this.aggregationFunction)}getMergedValueAtIndex(e,n){const i=this.getMergedValues(n)[e];return Ne(i)?i:this.fallbackValue}updateCache(){this.mergedValuesCache=this.getMergedValues(!1)}}function She(t,e,n){bhe(t,e),e.set(t,n)}function bhe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Che(t,e,n){return t.set(v5(t,e),n),n}function Rhe(t,e){return t.get(v5(t,e))}function v5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var kA=new WeakMap;class w5{constructor(){She(this,kA,[])}subscribe(e){return this.addLocalHook("change",e),this._write(Rhe(kA,this)),this}unsubscribe(){return this.runLocalHooks("unsubscribe"),this.clearLocalHooks(),this}_write(e){return e.length>0&&this.runLocalHooks("change",e),this}_writeInitialChanges(e){Che(kA,this,e)}}en(w5,Fi);function MU(t,e){const n=[];let i=0,r=0;for(;i<t.length&&r<e.length;i++,r++)t[i]!==e[r]&&n.push({op:"replace",index:r,oldValue:t[i],newValue:e[r]});for(;i<e.length;i++)n.push({op:"insert",index:i,oldValue:void 0,newValue:e[i]});for(;r<t.length;r++)n.push({op:"remove",index:r,oldValue:t[r],newValue:void 0});return n}function Fp(t,e,n){Ehe(t,e),e.set(t,n)}function Ehe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cs(t,e){return t.get(y5(t,e))}function BS(t,e,n){return t.set(y5(t,e),n),n}function y5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var FS=new WeakMap,Wp=new WeakMap,WS=new WeakMap,jS=new WeakMap,zS=new WeakMap;class The{constructor(){let{initialIndexValue:e}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Fp(this,FS,new Set),Fp(this,Wp,[]),Fp(this,WS,[]),Fp(this,jS,!1),Fp(this,zS,!1),BS(zS,this,e??!1)}createObserver(){const e=new w5;return cs(FS,this).add(e),e.addLocalHook("unsubscribe",()=>{cs(FS,this).delete(e)}),e._writeInitialChanges(MU(cs(Wp,this),cs(WS,this))),e}emit(e){let n=cs(WS,this);(!cs(jS,this)||cs(Wp,this).length!==e.length)&&(e.length===0?e=new Array(n.length).fill(cs(zS,this)):BS(Wp,this,new Array(e.length).fill(cs(zS,this))),cs(jS,this)||(BS(jS,this,!0),n=cs(Wp,this)));const i=MU(n,e);cs(FS,this).forEach(r=>r._write(i)),BS(WS,this,e)}}function br(t,e,n){return(e=_he(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _he(t){var e=Mhe(t,"string");return typeof e=="symbol"?e:e+""}function Mhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WH{constructor(){br(this,"indexesSequence",new p5),br(this,"trimmingMapsCollection",new _U(e=>e.some(n=>n===!0),!1)),br(this,"hidingMapsCollection",new _U(e=>e.some(n=>n===!0),!1)),br(this,"variousMapsCollection",new eN),br(this,"hidingChangesObservable",new The({initialIndexValue:!1})),br(this,"notTrimmedIndexesCache",[]),br(this,"notHiddenIndexesCache",[]),br(this,"isBatched",!1),br(this,"indexesSequenceChanged",!1),br(this,"indexesChangeSource",void 0),br(this,"trimmedIndexesChanged",!1),br(this,"hiddenIndexesChanged",!1),br(this,"renderablePhysicalIndexesCache",[]),br(this,"fromPhysicalToVisualIndexesCache",new Map),br(this,"fromVisualToRenderableIndexesCache",new Map),this.indexesSequence.addLocalHook("change",()=>{this.indexesSequenceChanged=!0,this.updateCache(),this.runLocalHooks("indexesSequenceChange",this.indexesChangeSource),this.runLocalHooks("change",this.indexesSequence,null)}),this.trimmingMapsCollection.addLocalHook("change",e=>{this.trimmedIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.trimmingMapsCollection)}),this.hidingMapsCollection.addLocalHook("change",e=>{this.hiddenIndexesChanged=!0,this.updateCache(),this.runLocalHooks("change",e,this.hidingMapsCollection)}),this.variousMapsCollection.addLocalHook("change",e=>{this.runLocalHooks("change",e,this.variousMapsCollection)})}suspendOperations(){this.isBatched=!0}resumeOperations(){this.isBatched=!1,this.updateCache()}createChangesObserver(e){if(e!=="hiding")throw new Error(`Unsupported index map type "${e}".`);return this.hidingChangesObservable.createObserver()}createAndRegisterIndexMap(e,n,i){return this.registerMap(e,ghe(n,i))}registerMap(e,n){if(this.trimmingMapsCollection.get(e)||this.hidingMapsCollection.get(e)||this.variousMapsCollection.get(e))throw Error(`Map with name "${e}" has been already registered.`);n instanceof Uw?this.trimmingMapsCollection.register(e,n):n instanceof TR?this.hidingMapsCollection.register(e,n):this.variousMapsCollection.register(e,n);const i=this.getNumberOfIndexes();return i>0&&n.init(i),n}unregisterMap(e){this.trimmingMapsCollection.unregister(e),this.hidingMapsCollection.unregister(e),this.variousMapsCollection.unregister(e)}unregisterAll(){this.trimmingMapsCollection.unregisterAll(),this.hidingMapsCollection.unregisterAll(),this.variousMapsCollection.unregisterAll()}getPhysicalFromVisualIndex(e){const n=this.notTrimmedIndexesCache[e];return Ne(n)?n:null}getPhysicalFromRenderableIndex(e){const n=this.renderablePhysicalIndexesCache[e];return Ne(n)?n:null}getVisualFromPhysicalIndex(e){const n=this.fromPhysicalToVisualIndexesCache.get(e);return Ne(n)?n:null}getVisualFromRenderableIndex(e){return this.getVisualFromPhysicalIndex(this.getPhysicalFromRenderableIndex(e))}getRenderableFromVisualIndex(e){const n=this.fromVisualToRenderableIndexesCache.get(e);return Ne(n)?n:null}getNearestNotHiddenIndex(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;if(this.getPhysicalFromVisualIndex(e)===null)return null;if(this.fromVisualToRenderableIndexesCache.has(e))return e;const o=Array.from(this.fromVisualToRenderableIndexesCache.keys());let a=-1;return n>0?a=o.findIndex(u=>u>e):a=o.reverse().findIndex(u=>u<e),a===-1?i?this.getNearestNotHiddenIndex(e,-n,!1):null:o[a]}initToLength(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getNumberOfIndexes();this.notTrimmedIndexesCache=[...new Array(e).keys()],this.notHiddenIndexesCache=[...new Array(e).keys()],this.suspendOperations(),this.indexesChangeSource="init",this.indexesSequence.init(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.initEvery(e),this.resumeOperations(),this.suspendOperations(),this.hidingMapsCollection.initEvery(e),this.variousMapsCollection.initEvery(e),this.resumeOperations(),this.runLocalHooks("init")}fitToLength(e){const n=this.getNumberOfIndexes();if(e<n){const i=[...Array(this.getNumberOfIndexes()-e).keys()].map(r=>r+e);this.removeIndexes(i)}else this.insertIndexes(n,e-n)}getIndexesSequence(){return this.indexesSequence.getValues()}setIndexesSequence(e){this.indexesChangeSource===void 0&&(this.indexesChangeSource="update"),this.indexesSequence.setValues(e),this.indexesChangeSource==="update"&&(this.indexesChangeSource=void 0)}getNotTrimmedIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notTrimmedIndexesCache:this.getIndexesSequence().filter(i=>this.isTrimmed(i)===!1)}getNotTrimmedIndexesLength(){return this.getNotTrimmedIndexes().length}getNotHiddenIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.notHiddenIndexesCache:this.getIndexesSequence().filter(i=>this.isHidden(i)===!1)}getNotHiddenIndexesLength(){return this.getNotHiddenIndexes().length}getRenderableIndexes(){return(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0)===!0?this.renderablePhysicalIndexesCache:this.getNotTrimmedIndexes().filter(i=>this.isHidden(i)===!1)}getRenderableIndexesLength(){return this.getRenderableIndexes().length}getNumberOfIndexes(){return this.getIndexesSequence().length}moveIndexes(e,n){typeof e=="number"&&(e=[e]);const i=Vt(e,d=>this.getPhysicalFromVisualIndex(d)),r=this.getNotTrimmedIndexesLength(),o=e.length,a=fw(this.getIndexesSequence(),i),u=a.filter(d=>this.isTrimmed(d)===!1);let h=a.indexOf(u[u.length-1])+1;if(n+o<r){const d=u[n];h=a.indexOf(d)}this.indexesChangeSource="move",this.setIndexesSequence(ZP(a,h,i)),this.indexesChangeSource=void 0}isTrimmed(e){return this.trimmingMapsCollection.getMergedValueAtIndex(e)}isHidden(e){return this.hidingMapsCollection.getMergedValueAtIndex(e)}insertIndexes(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"start";const r=this.getNotTrimmedIndexes()[e],o=Ne(r)?r:this.getNumberOfIndexes(),a=this.getIndexesSequence().includes(r)?this.getIndexesSequence().indexOf(r):this.getNumberOfIndexes(),u=Vt(new Array(n).fill(o),(d,g)=>d+g);this.suspendOperations(),this.indexesChangeSource="insert",this.indexesSequence.insert(a,u),this.indexesChangeSource=void 0;const h=i==="end"?u.map(d=>d+1):u;this.trimmingMapsCollection.insertToEvery(a,h),this.hidingMapsCollection.insertToEvery(a,h),this.variousMapsCollection.insertToEvery(a,h),this.resumeOperations()}removeIndexes(e){this.suspendOperations(),this.indexesChangeSource="remove",this.indexesSequence.remove(e),this.indexesChangeSource=void 0,this.trimmingMapsCollection.removeFromEvery(e),this.hidingMapsCollection.removeFromEvery(e),this.variousMapsCollection.removeFromEvery(e),this.resumeOperations()}updateCache(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.indexesSequenceChanged||this.trimmedIndexesChanged||this.hiddenIndexesChanged;(e===!0||this.isBatched===!1&&n===!0)&&(this.trimmingMapsCollection.updateCache(),this.hidingMapsCollection.updateCache(),this.notTrimmedIndexesCache=this.getNotTrimmedIndexes(!1),this.notHiddenIndexesCache=this.getNotHiddenIndexes(!1),this.renderablePhysicalIndexesCache=this.getRenderableIndexes(!1),this.cacheFromPhysicalToVisualIndexes(),this.cacheFromVisualToRenderableIndexes(),this.hiddenIndexesChanged&&this.hidingChangesObservable.emit(this.hidingMapsCollection.getMergedValues()),this.runLocalHooks("cacheUpdated",{indexesSequenceChanged:this.indexesSequenceChanged,trimmedIndexesChanged:this.trimmedIndexesChanged,hiddenIndexesChanged:this.hiddenIndexesChanged}),this.indexesSequenceChanged=!1,this.trimmedIndexesChanged=!1,this.hiddenIndexesChanged=!1)}cacheFromPhysicalToVisualIndexes(){const e=this.getNotTrimmedIndexesLength();this.fromPhysicalToVisualIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromVisualIndex(n);this.fromPhysicalToVisualIndexesCache.set(i,n)}}cacheFromVisualToRenderableIndexes(){const e=this.getRenderableIndexesLength();this.fromVisualToRenderableIndexesCache.clear();for(let n=0;n<e;n+=1){const i=this.getPhysicalFromRenderableIndex(n),r=this.getVisualFromPhysicalIndex(i);this.fromVisualToRenderableIndexesCache.set(r,n)}}}en(WH,Fi);function Ahe(t,e){return wt(e,(n,i)=>{$n(t[i])&&(t[i]=n)}),t}function S5(t){const n=/^([a-zA-Z]{2})-([a-zA-Z]{2})$/.exec(t);return n?`${n[1].toLowerCase()}-${n[2].toUpperCase()}`:t}function b5(t){Ne(t)&&OP(Ft`Language with code "${t}" was not found. You should register particular language\x20
    before using it. Read more about this issue at: https://docs.handsontable.com/i18n/missing-language-code.`)}function Ohe(t,e){return Array.isArray(t)&&Number.isInteger(e)?t[e]:t}function C5(t,e){return Array.isArray(t)?t.map(n=>C5(n,e)):SP(t,e)}const{register:xhe,getValues:Hhe}=Ps("phraseFormatters");function R5(t,e){xhe(t,e)}function Ihe(){return Hhe()}R5("pluralize",Ohe);R5("substitute",C5);const E5="ContextMenu:items",st=E5,tN=`${st}.noItems`,nN=`${st}.insertRowAbove`,iN=`${st}.insertRowBelow`,rN=`${st}.insertColumnOnTheLeft`,oN=`${st}.insertColumnOnTheRight`,sN=`${st}.removeRow`,aN=`${st}.removeColumn`,lN=`${st}.undo`,uN=`${st}.redo`,e0=`${st}.readOnly`,cN=`${st}.clearColumn`,hN=`${st}.copy`,dN=`${st}.copyWithHeaders`,fN=`${st}.copyWithGroupHeaders`,gN=`${st}.copyHeadersOnly`,mN=`${st}.cut`,pN=`${st}.freezeColumn`,vN=`${st}.unfreezeColumn`,wN=`${st}.mergeCells`,yN=`${st}.unmergeCells`,SN=`${st}.addComment`,bN=`${st}.editComment`,CN=`${st}.removeComment`,RN=`${st}.readOnlyComment`,EN=`${st}.align`,TN=`${st}.align.left`,_N=`${st}.align.center`,MN=`${st}.align.right`,AN=`${st}.align.justify`,ON=`${st}.align.top`,xN=`${st}.align.middle`,HN=`${st}.align.bottom`,IN=`${st}.borders`,PN=`${st}.borders.top`,NN=`${st}.borders.right`,DN=`${st}.borders.bottom`,LN=`${st}.borders.left`,kN=`${st}.borders.remove`,$N=`${st}.nestedHeaders.insertChildRow`,VN=`${st}.nestedHeaders.detachFromParent`,BN=`${st}.hideColumn`,FN=`${st}.showColumn`,WN=`${st}.hideRow`,jN=`${st}.showRow`,Dr="Filters:",Yn=`${Dr}conditions`,MR=`${Yn}.none`,zN=`${Yn}.isEmpty`,UN=`${Yn}.isNotEmpty`,YN=`${Yn}.isEqualTo`,GN=`${Yn}.isNotEqualTo`,qN=`${Yn}.beginsWith`,KN=`${Yn}.endsWith`,XN=`${Yn}.contains`,ZN=`${Yn}.doesNotContain`,Phe=`${Yn}.byValue`,QN=`${Yn}.greaterThan`,JN=`${Yn}.greaterThanOrEqualTo`,eD=`${Yn}.lessThan`,tD=`${Yn}.lessThanOrEqualTo`,nD=`${Yn}.isBetween`,iD=`${Yn}.isNotBetween`,rD=`${Yn}.after`,oD=`${Yn}.before`,sD=`${Yn}.today`,aD=`${Yn}.tomorrow`,lD=`${Yn}.yesterday`,uD=`${Dr}labels.filterByCondition`,cD=`${Dr}labels.filterByValue`,hD=`${Dr}labels.conjunction`,AR=`${Dr}labels.disjunction`,t0=`${Dr}values.blankCells`,dD=`${Dr}buttons.selectAll`,fD=`${Dr}buttons.clear`,gD=`${Dr}buttons.ok`,mD=`${Dr}buttons.cancel`,pD=`${Dr}buttons.placeholder.search`,vD=`${Dr}buttons.placeholder.value`,wD=`${Dr}buttons.placeholder.secondValue`,ll="Pagination:",yD=`${ll}section.pagination`,SD=`${ll}.pageSize.auto`,n0=`${ll}section.pageSize`,bD=`${ll}section.counter`,CD=`${ll}section.navigation`,RD=`${ll}firstPage`,ED=`${ll}prevPage`,TD=`${ll}nextPage`,_D=`${ll}lastPage`,MD="CheckboxRenderer:",AD=`${MD}checked`,OD=`${MD}unchecked`,T5="Loading:",xD=`${T5}title`,Nhe=Object.freeze(Object.defineProperty({__proto__:null,CHECKBOX_CHECKED:AD,CHECKBOX_RENDERER_NAMESPACE:MD,CHECKBOX_UNCHECKED:OD,CONTEXTMENU_ITEMS_ADD_COMMENT:SN,CONTEXTMENU_ITEMS_ALIGNMENT:EN,CONTEXTMENU_ITEMS_ALIGNMENT_BOTTOM:HN,CONTEXTMENU_ITEMS_ALIGNMENT_CENTER:_N,CONTEXTMENU_ITEMS_ALIGNMENT_JUSTIFY:AN,CONTEXTMENU_ITEMS_ALIGNMENT_LEFT:TN,CONTEXTMENU_ITEMS_ALIGNMENT_MIDDLE:xN,CONTEXTMENU_ITEMS_ALIGNMENT_RIGHT:MN,CONTEXTMENU_ITEMS_ALIGNMENT_TOP:ON,CONTEXTMENU_ITEMS_BORDERS:IN,CONTEXTMENU_ITEMS_BORDERS_BOTTOM:DN,CONTEXTMENU_ITEMS_BORDERS_LEFT:LN,CONTEXTMENU_ITEMS_BORDERS_RIGHT:NN,CONTEXTMENU_ITEMS_BORDERS_TOP:PN,CONTEXTMENU_ITEMS_CLEAR_COLUMN:cN,CONTEXTMENU_ITEMS_COPY:hN,CONTEXTMENU_ITEMS_COPY_COLUMN_HEADERS_ONLY:gN,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_GROUP_HEADERS:fN,CONTEXTMENU_ITEMS_COPY_WITH_COLUMN_HEADERS:dN,CONTEXTMENU_ITEMS_CUT:mN,CONTEXTMENU_ITEMS_EDIT_COMMENT:bN,CONTEXTMENU_ITEMS_FREEZE_COLUMN:pN,CONTEXTMENU_ITEMS_HIDE_COLUMN:BN,CONTEXTMENU_ITEMS_HIDE_ROW:WN,CONTEXTMENU_ITEMS_INSERT_LEFT:rN,CONTEXTMENU_ITEMS_INSERT_RIGHT:oN,CONTEXTMENU_ITEMS_MERGE_CELLS:wN,CONTEXTMENU_ITEMS_NESTED_ROWS_DETACH_CHILD:VN,CONTEXTMENU_ITEMS_NESTED_ROWS_INSERT_CHILD:$N,CONTEXTMENU_ITEMS_NO_ITEMS:tN,CONTEXTMENU_ITEMS_READ_ONLY:e0,CONTEXTMENU_ITEMS_READ_ONLY_COMMENT:RN,CONTEXTMENU_ITEMS_REDO:uN,CONTEXTMENU_ITEMS_REMOVE_BORDERS:kN,CONTEXTMENU_ITEMS_REMOVE_COLUMN:aN,CONTEXTMENU_ITEMS_REMOVE_COMMENT:CN,CONTEXTMENU_ITEMS_REMOVE_ROW:sN,CONTEXTMENU_ITEMS_ROW_ABOVE:nN,CONTEXTMENU_ITEMS_ROW_BELOW:iN,CONTEXTMENU_ITEMS_SHOW_COLUMN:FN,CONTEXTMENU_ITEMS_SHOW_ROW:jN,CONTEXTMENU_ITEMS_UNDO:lN,CONTEXTMENU_ITEMS_UNFREEZE_COLUMN:vN,CONTEXTMENU_ITEMS_UNMERGE_CELLS:yN,CONTEXT_MENU_ITEMS_NAMESPACE:E5,FILTERS_BUTTONS_CANCEL:mD,FILTERS_BUTTONS_CLEAR:fD,FILTERS_BUTTONS_OK:gD,FILTERS_BUTTONS_PLACEHOLDER_SEARCH:pD,FILTERS_BUTTONS_PLACEHOLDER_SECOND_VALUE:wD,FILTERS_BUTTONS_PLACEHOLDER_VALUE:vD,FILTERS_BUTTONS_SELECT_ALL:dD,FILTERS_CONDITIONS_AFTER:rD,FILTERS_CONDITIONS_BEFORE:oD,FILTERS_CONDITIONS_BEGINS_WITH:qN,FILTERS_CONDITIONS_BETWEEN:nD,FILTERS_CONDITIONS_BY_VALUE:Phe,FILTERS_CONDITIONS_CONTAINS:XN,FILTERS_CONDITIONS_EMPTY:zN,FILTERS_CONDITIONS_ENDS_WITH:KN,FILTERS_CONDITIONS_EQUAL:YN,FILTERS_CONDITIONS_GREATER_THAN:QN,FILTERS_CONDITIONS_GREATER_THAN_OR_EQUAL:JN,FILTERS_CONDITIONS_LESS_THAN:eD,FILTERS_CONDITIONS_LESS_THAN_OR_EQUAL:tD,FILTERS_CONDITIONS_NAMESPACE:Yn,FILTERS_CONDITIONS_NONE:MR,FILTERS_CONDITIONS_NOT_BETWEEN:iD,FILTERS_CONDITIONS_NOT_CONTAIN:ZN,FILTERS_CONDITIONS_NOT_EMPTY:UN,FILTERS_CONDITIONS_NOT_EQUAL:GN,FILTERS_CONDITIONS_TODAY:sD,FILTERS_CONDITIONS_TOMORROW:aD,FILTERS_CONDITIONS_YESTERDAY:lD,FILTERS_DIVS_FILTER_BY_CONDITION:uD,FILTERS_DIVS_FILTER_BY_VALUE:cD,FILTERS_LABELS_CONJUNCTION:hD,FILTERS_LABELS_DISJUNCTION:AR,FILTERS_NAMESPACE:Dr,FILTERS_VALUES_BLANK_CELLS:t0,LOADING_NAMESPACE:T5,LOADING_TITLE:xD,PAGINATION_COUNTER_SECTION:bD,PAGINATION_FIRST_PAGE:RD,PAGINATION_LAST_PAGE:_D,PAGINATION_NAMESPACE:ll,PAGINATION_NAV_SECTION:CD,PAGINATION_NEXT_PAGE:TD,PAGINATION_PAGE_SIZE_AUTO:SD,PAGINATION_PAGE_SIZE_SECTION:n0,PAGINATION_PREV_PAGE:ED,PAGINATION_SECTION:yD},Symbol.toStringTag,{value:"Module"}));/**
 * @preserve
 * Authors: Handsoncode
 * Last updated: Nov 15, 2017
 *
 * Description: Definition file for English - United States language-country.
 */const _5={languageCode:"en-US",[tN]:"No available options",[nN]:"Insert row above",[iN]:"Insert row below",[rN]:"Insert column left",[oN]:"Insert column right",[sN]:["Remove row","Remove rows"],[aN]:["Remove column","Remove columns"],[lN]:"Undo",[uN]:"Redo",[e0]:"Read only",[cN]:"Clear column",[EN]:"Alignment",[TN]:"Left",[_N]:"Center",[MN]:"Right",[AN]:"Justify",[ON]:"Top",[xN]:"Middle",[HN]:"Bottom",[pN]:"Freeze column",[vN]:"Unfreeze column",[IN]:"Borders",[PN]:"Top",[NN]:"Right",[DN]:"Bottom",[LN]:"Left",[kN]:"Remove border(s)",[SN]:"Add comment",[bN]:"Edit comment",[CN]:"Delete comment",[RN]:"Read-only comment",[wN]:"Merge cells",[yN]:"Unmerge cells",[hN]:"Copy",[dN]:["Copy with header","Copy with headers"],[fN]:["Copy with group header","Copy with group headers"],[gN]:["Copy header only","Copy headers only"],[mN]:"Cut",[$N]:"Insert child row",[VN]:"Detach from parent",[BN]:["Hide column","Hide columns"],[FN]:["Show column","Show columns"],[WN]:["Hide row","Hide rows"],[jN]:["Show row","Show rows"],[MR]:"None",[zN]:"Is empty",[UN]:"Is not empty",[YN]:"Is equal to",[GN]:"Is not equal to",[qN]:"Begins with",[KN]:"Ends with",[XN]:"Contains",[ZN]:"Does not contain",[QN]:"Greater than",[JN]:"Greater than or equal to",[eD]:"Less than",[tD]:"Less than or equal to",[nD]:"Is between",[iD]:"Is not between",[rD]:"After",[oD]:"Before",[sD]:"Today",[aD]:"Tomorrow",[lD]:"Yesterday",[t0]:"Blank cells",[uD]:"Filter by condition",[cD]:"Filter by value",[hD]:"And",[AR]:"Or",[dD]:"Select all",[fD]:"Clear",[gD]:"OK",[mD]:"Cancel",[pD]:"Search",[vD]:"Value",[wD]:"Second value",[yD]:"Pagination",[n0]:"Page size",[SD]:"Auto",[bD]:"[start] - [end] of [total]",[CD]:"Page [currentPage] of [totalPages]",[RD]:"Go to first page",[ED]:"Go to previous page",[TD]:"Go to next page",[_D]:"Go to last page",[AD]:"Checked",[OD]:"Unchecked",[xD]:"Loading..."},Dhe=Nhe,jH=_5.languageCode,{register:Lhe,getItem:M5,hasItem:khe,getValues:$he}=Ps("languagesDictionaries");A5(_5);function A5(t,e){let n=t,i=e;return Qe(t)&&(i=t,n=i.languageCode),Vhe(n,i),Lhe(n,Nr(i)),Nr(i)}function Vhe(t,e){t!==jH&&Ahe(e,M5(jH))}function O5(t){return HD(t)?Nr(M5(t)):null}function HD(t){return khe(t)}function Bhe(){return $he()}function x5(t,e,n){const i=O5(t);if(i===null)return null;const r=i[e];if($n(r))return null;const o=Fhe(r,n);return Array.isArray(o)?o[0]:o}function Fhe(t,e){return Ihe().reduce((n,i)=>i(n,e),t)}function Whe(t){let e=S5(t);return HD(e)||(e=jH,b5(t)),e}function jhe(t,e,n){return(e=zhe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zhe(t){var e=Uhe(t,"string");return typeof e=="symbol"?e:e+""}function Uhe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Su extends o5{constructor(e,n){super(e,null),jhe(this,"visualCellRange",null),this.visualCellRange=n||null,this.commit()}add(e){return this.visualCellRange===null?this.visualCellRange=this.settings.createCellRange(e):this.visualCellRange.expand(e),this}clear(){return this.visualCellRange=null,super.clear()}trimToVisibleCellsRangeOnly(e){let{from:n,to:i}=e,r=this.getNearestNotHiddenCoords(n,1),o=this.getNearestNotHiddenCoords(i,-1);return r===null||o===null?null:((r.row>o.row||r.col>o.col)&&(r=n,o=i),this.settings.createCellRange(r,r,o))}getNearestNotHiddenCoords(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:n;const r=this.getNearestNotHiddenIndex(this.settings.rowIndexMapper,e.row,n);if(r===null)return null;const o=this.getNearestNotHiddenIndex(this.settings.columnIndexMapper,e.col,i);return o===null?null:this.settings.createCellCoords(r,o)}getNearestNotHiddenIndex(e,n,i){return n<0?n:e.getNearestNotHiddenIndex(n,i)}commit(){if(this.visualCellRange===null)return this;const e=this.trimToVisibleCellsRangeOnly(this.visualCellRange);return e===null?this.cellRange=null:this.cellRange=this.createRenderableCellRange(e.from,e.to),this}syncWith(e){const n=e.from.clone().normalize(),i=e.getVerticalDirection()==="N-S"?1:-1,r=e.getHorizontalDirection()==="W-E"?1:-1,o=this.settings.visualToRenderableCoords(this.visualCellRange.highlight);let a=null;if((o===null||o.col===null||o.row===null)&&(a=this.getNearestNotHiddenCoords(n,i,r)),a!==null&&e.overlaps(a)){const u=e.highlight.clone();if(u.row>=0&&(u.row=a.row),u.col>=0&&(u.col=a.col),this.cellRange===null){const h=this.settings.visualToRenderableCoords(u);this.cellRange=this.settings.createCellRange(h)}e.setHighlight(u)}return this.settings.selectionType==="focus"&&o!==null&&a===null&&e.setHighlight(this.visualCellRange.highlight),this}getCorners(){const{from:e,to:n}=this.cellRange;return[Math.min(e.row,n.row),Math.min(e.col,n.col),Math.max(e.row,n.row),Math.max(e.col,n.col)]}getVisualCorners(){const e=this.settings.renderableToVisualCoords(this.cellRange.getTopStartCorner()),n=this.settings.renderableToVisualCoords(this.cellRange.getBottomEndCorner());return[e.row,e.col,n.row,n.col]}createRenderableCellRange(e,n){const i=this.settings.visualToRenderableCoords(e),r=this.settings.visualToRenderableCoords(n);return i.row===null||i.col===null||r.row===null||r.col===null?null:this.settings.createCellRange(i,i,r)}}function $A(t){let{activeHeaderClassName:e,...n}=t;return new Su({className:e,...n,selectionType:s5})}function Yhe(t){let{areaCornerVisible:e,...n}=t;return new Su({className:"area",createLayers:!0,border:{width:1,color:"#4b89ff",cornerVisible:e},...n,selectionType:BP})}function Ghe(t){let{...e}=t;return new Su({className:"highlight",...e,selectionType:BP})}function qhe(t){let{columnClassName:e,...n}=t;return new Su({className:e,...n,selectionType:mce})}function Khe(t){let{cellCornerVisible:e,...n}=t;return new Su({className:"current",headerAttributes:[RP()],border:{width:2,color:"#4b89ff",cornerVisible:e},...n,selectionType:JC})}function Xhe(t){let{border:e,visualCellRange:n,...i}=t;return new Su({...e,...i,selectionType:pce},n)}function Zhe(t){let{...e}=t;return new Su({className:"fill",border:{width:1,color:"#ff0000"},...e,selectionType:fce})}function AU(t){let{headerClassName:e,...n}=t;return new Su({className:e,...n,selectionType:VP})}function Qhe(t){let{rowClassName:e,...n}=t;return new Su({className:e,...n,selectionType:gce})}function Jhe(t,e){ede(t,e),e.add(t)}function ede(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kr(t,e,n){return(e=tde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tde(t){var e=nde(t,"string");return typeof e=="symbol"?e:e+""}function nde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ta=new WeakSet;class ide{constructor(e){Jhe(this,Ta),Kr(this,"options",void 0),Kr(this,"layerLevel",0),Kr(this,"focus",void 0),Kr(this,"fill",void 0),Kr(this,"layeredAreas",new Map),Kr(this,"areas",new Map),Kr(this,"rowHeaders",new Map),Kr(this,"columnHeaders",new Map),Kr(this,"activeRowHeaders",new Map),Kr(this,"activeColumnHeaders",new Map),Kr(this,"activeCornerHeaders",new Map),Kr(this,"rowHighlights",new Map),Kr(this,"columnHighlights",new Map),Kr(this,"customSelections",[]),this.options=e,this.focus=Khe(e),this.fill=Zhe(e)}isEnabledFor(e,n){let i=e;e===JC&&(i="current");let r=this.options.disabledCellSelection(n.row,n.col);return typeof r=="string"&&(r=[r]),r===!1||Array.isArray(r)&&!r.includes(i)}useLayerLevel(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.layerLevel=e,this}getFocus(){return this.focus}getFill(){return this.fill}createLayeredArea(){return Nl(Ta,this,Dl).call(this,this.layeredAreas,Yhe)}getLayeredAreas(){return[...this.layeredAreas.values()]}createArea(){return Nl(Ta,this,Dl).call(this,this.areas,Ghe)}getAreas(){return[...this.areas.values()]}createRowHeader(){return Nl(Ta,this,Dl).call(this,this.rowHeaders,AU)}getRowHeaders(){return[...this.rowHeaders.values()]}createColumnHeader(){return Nl(Ta,this,Dl).call(this,this.columnHeaders,AU)}getColumnHeaders(){return[...this.columnHeaders.values()]}createActiveRowHeader(){return Nl(Ta,this,Dl).call(this,this.activeRowHeaders,$A)}getActiveRowHeaders(){return[...this.activeRowHeaders.values()]}createActiveColumnHeader(){return Nl(Ta,this,Dl).call(this,this.activeColumnHeaders,$A)}getActiveColumnHeaders(){return[...this.activeColumnHeaders.values()]}createActiveCornerHeader(){return Nl(Ta,this,Dl).call(this,this.activeCornerHeaders,$A)}getActiveCornerHeaders(){return[...this.activeCornerHeaders.values()]}createRowHighlight(){return Nl(Ta,this,Dl).call(this,this.rowHighlights,Qhe)}getRowHighlights(){return[...this.rowHighlights.values()]}createColumnHighlight(){return Nl(Ta,this,Dl).call(this,this.columnHighlights,qhe)}getColumnHighlights(){return[...this.columnHighlights.values()]}getCustomSelections(){return[...this.customSelections.values()]}addCustomSelection(e){this.customSelections.push(Xhe({...this.options,...e}))}clear(){this.focus.clear(),this.fill.clear(),U(this.areas.values(),e=>void e.clear()),U(this.layeredAreas.values(),e=>void e.clear()),U(this.rowHeaders.values(),e=>void e.clear()),U(this.columnHeaders.values(),e=>void e.clear()),U(this.activeRowHeaders.values(),e=>void e.clear()),U(this.activeColumnHeaders.values(),e=>void e.clear()),U(this.activeCornerHeaders.values(),e=>void e.clear()),U(this.rowHighlights.values(),e=>void e.clear()),U(this.columnHighlights.values(),e=>void e.clear())}[Symbol.iterator](){return[this.focus,this.fill,...this.areas.values(),...this.layeredAreas.values(),...this.rowHeaders.values(),...this.columnHeaders.values(),...this.activeRowHeaders.values(),...this.activeColumnHeaders.values(),...this.activeCornerHeaders.values(),...this.rowHighlights.values(),...this.columnHighlights.values(),...this.customSelections][Symbol.iterator]()}}function Dl(t,e){const n=this.layerLevel;if(t.has(n))return t.get(n);const i=e({layerLevel:n,...this.options});return t.set(n,i),i}function OU(t,e,n){return(e=rde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rde(t){var e=ode(t,"string");return typeof e=="symbol"?e:e+""}function ode(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ID{constructor(e){OU(this,"ranges",[]),OU(this,"createCellRange",void 0),this.createCellRange=e}isEmpty(){return this.size()===0}set(e){return this.clear(),this.ranges.push(this.createCellRange(e)),this}add(e){return this.ranges.push(this.createCellRange(e)),this}push(e){return this.ranges.push(e),this}pop(){return this.ranges.pop()}current(){return this.peekByIndex(this.size()-1)}previous(){return this.peekByIndex(this.size()-2)}includes(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>!0;return this.ranges.some((i,r)=>i.includes(e)&&n(i,r))}findAll(e){const n=[];return this.ranges.forEach((i,r)=>{i.isEqual(e)&&n.push({range:i,layer:r})}),n}remove(e){return this.ranges=this.ranges.filter(n=>!e.some(i=>i.isEqual(n))),this}removeLayers(e){return this.ranges=this.ranges.filter((n,i)=>!e.includes(i)),this}clear(){return this.ranges.length=0,this}size(){return this.ranges.length}clone(){const e=new ID(this.createCellRange);return e.ranges=this.ranges.map(n=>n.clone()),e}map(e){return this.ranges=this.ranges.map((n,i)=>e(n,i)),this}peekByIndex(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0,n;return e>=0&&e<this.size()&&(n=this.ranges[e]),n}[Symbol.iterator](){return this.ranges[Symbol.iterator]()}}function sde(t,e){H5(t,e),e.add(t)}function ade(t,e,n){return(e=lde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function lde(t){var e=ude(t,"string");return typeof e=="symbol"?e:e+""}function ude(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function VA(t,e,n){H5(t,e),e.set(t,n)}function H5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ri(t,e){return t.get(Qt(t,e))}function Ag(t,e,n){return t.set(Qt(t,e),n),n}function Qt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gl=new WeakMap,sd=new WeakMap,jo=new WeakMap,sn=new WeakSet;class PD{constructor(e,n){sde(this,sn),VA(this,Gl,void 0),VA(this,sd,0),VA(this,jo,{x:0,y:0}),ade(this,"tableApi",void 0),Ag(Gl,this,e),this.tableApi=n}setActiveLayerIndex(e){Ag(sd,this,e)}getCurrentSelection(){return Ri(Gl,this).peekByIndex(Ri(sd,this))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;Ag(jo,this,this.calculateOffset());const r=this.tableApi.createCellCoords(e,n);let o=this.getCurrentSelection().highlight;const a=this.tableApi.visualToRenderableCoords(o);let u=0,h=0;if(this.runLocalHooks("beforeTransformStart",r),a.row!==null&&a.col!==null){let{width:d,height:g}=Qt(sn,this,zH).call(this);const{row:m,col:v}=Qt(sn,this,PU).call(this,o),y=this.tableApi.fixedRowsBottom(),b=this.tableApi.minSpareRows(),C=this.tableApi.minSpareCols(),T=this.tableApi.autoWrapRow(),O=this.tableApi.autoWrapCol(),A=this.tableApi.createCellCoords(m+r.row,v+r.col);if(A.row>=g){const $=Wo(i&&b>0&&y===0),L=A.col+1,P=L>=d,Q=this.tableApi.createCellCoords(A.row-g,P?L-d:L);if(this.runLocalHooks("beforeColumnWrap",$,Qt(sn,this,Lf).call(this,Q),P),$.value)this.runLocalHooks("insertRowRequire",this.countRenderableRows());else if(O){if(this.shouldSwitchSelectionLayer()&&P&&Ri(Gl,this).size()>1){Qt(sn,this,xU).call(this);const ue=Qt(sn,this,US).call(this,"forward");ue!==null&&Q.assign(ue)}A.assign(Q)}}else if(A.row<0){const $=Wo(O),L=A.col-1,P=L<0,Q=this.tableApi.createCellCoords(g+A.row,P?d+L:L);if(this.runLocalHooks("beforeColumnWrap",$,Qt(sn,this,Lf).call(this,Q),P),O){if(this.shouldSwitchSelectionLayer()&&P&&Ri(Gl,this).size()>1){Qt(sn,this,HU).call(this);const ue=Qt(sn,this,US).call(this,"backward");ue!==null&&Q.assign(ue)}A.assign(Q)}}if({width:d,height:g}=Qt(sn,this,zH).call(this),A.col>=d){const $=Wo(i&&C>0),L=A.row+1,P=L>=g,Q=this.tableApi.createCellCoords(P?L-g:L,A.col-d);if(this.runLocalHooks("beforeRowWrap",$,Qt(sn,this,Lf).call(this,Q),P),$.value)this.runLocalHooks("insertColRequire",this.countRenderableColumns());else if(T){if(this.shouldSwitchSelectionLayer()&&P&&Ri(Gl,this).size()>1){Qt(sn,this,xU).call(this);const ue=Qt(sn,this,US).call(this,"forward");ue!==null&&Q.assign(ue)}A.assign(Q)}}else if(A.col<0){const $=Wo(T),L=A.row-1,P=L<0,Q=this.tableApi.createCellCoords(P?g+L:L,d+A.col);if(this.runLocalHooks("beforeRowWrap",$,Qt(sn,this,Lf).call(this,Q),P),T){if(this.shouldSwitchSelectionLayer()&&P&&Ri(Gl,this).size()>1){Qt(sn,this,HU).call(this);const ue=Qt(sn,this,US).call(this,"backward");ue!==null&&Q.assign(ue)}A.assign(Q)}}const{rowDir:N,colDir:x}=Qt(sn,this,IU).call(this,A);u=N,h=x,o=Qt(sn,this,Lf).call(this,A)}return this.runLocalHooks("afterTransformStart",o,u,h),{selectionLayer:Ri(sd,this),visualCoords:o}}transformEnd(e,n){Ag(jo,this,this.calculateOffset());const i=this.tableApi.createCellCoords(e,n),r=this.getCurrentSelection(),o=this.tableApi.visualToRenderableCoords(r.highlight),a=Qt(sn,this,vC).call(this,r.to.row,r.from.row),u=Qt(sn,this,wC).call(this,r.to.col,r.from.col),h=r.to.clone();let d=0,g=0;if(this.runLocalHooks("beforeTransformEnd",i),o.row!==null&&o.col!==null&&a!==null&&u!==null){const{row:m,col:v}=Qt(sn,this,PU).call(this,r.highlight),y=this.tableApi.createCellCoords(a+i.row,u+i.col),b=r.getTopStartCorner(),C=r.getTopEndCorner(),T=r.getBottomEndCorner();if(i.col<0&&u>=v&&y.col<v){const x=y.col-v;y.col=Qt(sn,this,wC).call(this,b.col,C.col)+x}else if(i.col>0&&u<=v&&y.col>v){const x=Qt(sn,this,wC).call(this,C.col,b.col),$=Math.max(y.col-x,1);y.col=x+$}if(i.row<0&&a>=m&&y.row<m){const x=y.row-m;y.row=Qt(sn,this,vC).call(this,b.row,T.row)+x}else if(i.row>0&&a<=m&&y.row>m){const x=Qt(sn,this,vC).call(this,T.row,b.row),$=Math.max(y.row-x,1);y.row=x+$}const{rowDir:O,colDir:A}=Qt(sn,this,IU).call(this,y);d=O,g=A;const N=Qt(sn,this,Lf).call(this,y);i.row===0&&i.col!==0?h.col=N.col:i.row!==0&&i.col===0?h.row=N.row:(h.row=N.row,h.col=N.col)}return this.runLocalHooks("afterTransformEnd",h,d,g),{selectionLayer:Ri(sd,this),visualCoords:h}}calculateOffset(){throw new Error("`calculateOffset` is not implemented")}countRenderableRows(){throw new Error("`countRenderableRows` is not implemented")}countRenderableColumns(){throw new Error("`countRenderableColumns` is not implemented")}shouldSwitchSelectionLayer(){throw new Error("`shouldSwitchSelectionLayer` is not implemented")}}function xU(){const t=Ri(sd,this)+1;this.setActiveLayerIndex(t>=Ri(Gl,this).size()?0:t),Ag(jo,this,this.calculateOffset())}function HU(){const t=Ri(sd,this)-1;this.setActiveLayerIndex(t<0?Ri(Gl,this).size()-1:t),Ag(jo,this,this.calculateOffset())}function IU(t){const{width:e,height:n}=Qt(sn,this,zH).call(this);let i=0,r=0;return t.row<0?(i=-1,t.row=0):t.row>0&&t.row>=n&&(i=1,t.row=n-1),t.col<0?(r=-1,t.col=0):t.col>0&&t.col>=e&&(r=1,t.col=e-1),{rowDir:i,colDir:r}}function zH(){return{width:Ri(jo,this).x+this.countRenderableColumns(),height:Ri(jo,this).y+this.countRenderableRows()}}function US(t){if(!["forward","backward"].includes(t))return null;const e=this.getCurrentSelection().getTopStartCorner(),n=this.getCurrentSelection().getBottomEndCorner(),[i,r,o,a]=t==="forward"?[e.row,n.row,e.col,n.col]:[n.row,e.row,n.col,e.col],u=Qt(sn,this,vC).call(this,i,r),h=Qt(sn,this,wC).call(this,o,a);return u===null||h===null?null:this.tableApi.createCellCoords(u,h)}function vC(t,e){const n=this.tableApi.findFirstNonHiddenRenderableRow(t,e);return n===null?null:Ri(jo,this).y+n}function wC(t,e){const n=this.tableApi.findFirstNonHiddenRenderableColumn(t,e);return n===null?null:Ri(jo,this).x+n}function PU(t){const{row:e,col:n}=this.tableApi.visualToRenderableCoords(t);if(e===null||n===null)throw new Error("Renderable coords are not visible.");return this.tableApi.createCellCoords(Ri(jo,this).y+e,Ri(jo,this).x+n)}function Lf(t){const e=t.clone();return e.col=t.col-Ri(jo,this).x,e.row=t.row-Ri(jo,this).y,this.tableApi.renderableToVisualCoords(e)}en(PD,Fi);class cde extends PD{calculateOffset(){return{x:this.tableApi.navigableHeaders()?this.tableApi.countRowHeaders():0,y:this.tableApi.navigableHeaders()?this.tableApi.countColHeaders():0}}countRenderableRows(){return this.tableApi.countRenderableRows()}countRenderableColumns(){return this.tableApi.countRenderableColumns()}shouldSwitchSelectionLayer(){return!1}}class hde extends PD{calculateOffset(){const e=this.getCurrentSelection(),{row:n,col:i}=e.getOuterTopStartCorner(),r=this.tableApi.countRenderableColumnsInRange(0,i-1),o=this.tableApi.countRenderableRowsInRange(0,n-1),a=e.highlight.isHeader(),u=a?Math.abs(i):0,h=a?Math.abs(n):0;return{x:i<0?u:-r,y:n<0?h:-o}}countRenderableRows(){const e=this.getCurrentSelection();return this.tableApi.countRenderableRowsInRange(0,e.getOuterBottomEndCorner().row)}countRenderableColumns(){const e=this.getCurrentSelection();return this.tableApi.countRenderableColumnsInRange(0,e.getOuterBottomEndCorner().col)}transformEnd(){throw new Error("`transformEnd` is not valid for focus selection use `transformStart` instead")}shouldSwitchSelectionLayer(){return!0}}const OR=0,xR=1,I5=2,ND=3,dde=[ND,I5],fde=[["number"],["number","string"],["number","undefined"],["number","string","undefined"]],BA=Symbol("root"),NU=Symbol("child");function em(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:BA;if(e!==BA&&e!==NU)throw new Error("The second argument is used internally only and cannot be overwritten.");const n=Array.isArray(t),i=e===BA;let r=OR;if(n){const o=t[0];t.length===0?r=xR:i&&o instanceof bm?r=ND:i&&Array.isArray(o)?r=em(o,NU):t.length>=2&&t.length<=4&&!t.some((u,h)=>!fde[h].includes(typeof u))&&(r=I5)}return r}function gw(t){let{createCellCoords:e,createCellRange:n,keepDirection:i=!1,propToCol:r}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!dde.includes(t))throw new Error("Unsupported selection ranges schema type was provided.");return function(o){const a=t===ND;let u=a?o.from.row:o[0],h=a?o.from.col:o[1],d=a?o.to.row:o[2],g=a?o.to.col:o[3];if(typeof r=="function"&&(typeof h=="string"&&(h=r(h)),typeof g=="string"&&(g=r(g))),$n(d)&&(d=u),$n(g)&&(g=h),!i){const b=u,C=h,T=d,O=g;u=Math.min(b,T),h=Math.min(C,O),d=Math.max(b,T),g=Math.max(C,O)}const m=a?o.highlight.clone():e(u,h),v=e(u,h),y=e(d,g);return n(m,v,y)}}function gde(t){const e=em(t.getSelected());if(e===OR||e===xR)return[];const n=gw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;U(t.getSelected(),a=>{const{from:u,to:h}=n(a),d=Math.max(u.col,0),g=h.col-d+1;U(Array.from(new Array(g),(m,v)=>d+v),m=>{i.has(m)||i.add(m)})});const r=Array.from(i).sort((a,u)=>a-u);return ho(r,(a,u,h,d)=>(h!==0&&u===d[h-1]+1?a[a.length-1][1]+=1:a.push([u,1]),a),[])}function mde(t){const e=em(t.getSelected());if(e===OR||e===xR)return[];const n=gw(e,{createCellCoords:t._createCellCoords.bind(t),createCellRange:t._createCellRange.bind(t)}),i=new Set;U(t.getSelected(),a=>{const{from:u,to:h}=n(a),d=Math.max(u.row,0),g=h.row-d+1;U(Array.from(new Array(g),(m,v)=>d+v),m=>{i.has(m)||i.add(m)})});const r=Array.from(i).sort((a,u)=>a-u);return ho(r,(a,u,h,d)=>(h!==0&&u===d[h-1]+1?a[a.length-1][1]+=1:a.push([u,1]),a),[])}function wh(t,e,n){pde(t,e),e.set(t,n)}function pde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function yh(t,e,n){return(e=vde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function vde(t){var e=wde(t,"string");return typeof e=="symbol"?e:e+""}function wde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nn(t,e){return t.get(P5(t,e))}function bo(t,e,n){return t.set(P5(t,e),n),n}function P5(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Co=new WeakMap,kf=new WeakMap,YS=new WeakMap,Zu=new WeakMap,GS=new WeakMap,jp=new WeakMap,qS=new WeakMap;class N5{constructor(e,n){var i=this;yh(this,"settings",void 0),yh(this,"tableProps",void 0),yh(this,"inProgress",!1),yh(this,"selectedRange",new ID((r,o,a)=>this.tableProps.createCellRange(r,o,a))),yh(this,"highlight",void 0),wh(this,Co,void 0),wh(this,kf,void 0),yh(this,"selectedByRowHeader",new Set),yh(this,"selectedByColumnHeader",new Set),wh(this,YS,!1),wh(this,Zu,!1),wh(this,GS,"unknown"),wh(this,jp,-1),wh(this,qS,0),this.settings=e,this.tableProps=n,this.highlight=new ide({headerClassName:e.currentHeaderClassName,activeHeaderClassName:e.activeHeaderClassName,rowClassName:e.currentRowClassName,columnClassName:e.currentColClassName,cellAttributes:[RP()],rowIndexMapper:this.tableProps.rowIndexMapper,columnIndexMapper:this.tableProps.columnIndexMapper,disabledCellSelection:(r,o)=>this.tableProps.isDisabledCellSelection(r,o),cellCornerVisible:function(){return i.isCellCornerVisible(...arguments)},areaCornerVisible:function(){return i.isAreaCornerVisible(...arguments)},visualToRenderableCoords:r=>this.tableProps.visualToRenderableCoords(r),renderableToVisualCoords:r=>this.tableProps.renderableToVisualCoords(r),createCellCoords:(r,o)=>this.tableProps.createCellCoords(r,o),createCellRange:(r,o,a)=>this.tableProps.createCellRange(r,o,a)}),bo(Co,this,new cde(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>e.fixedRowsBottom,minSpareRows:()=>e.minSpareRows,minSpareCols:()=>e.minSpareCols,autoWrapRow:()=>e.autoWrapRow,autoWrapCol:()=>e.autoWrapCol})),bo(kf,this,new hde(this.selectedRange,{...this.tableProps,navigableHeaders:()=>e.navigableHeaders,fixedRowsBottom:()=>0,minSpareRows:()=>0,minSpareCols:()=>0,autoWrapRow:()=>!0,autoWrapCol:()=>!0})),Nn(Co,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformStart",...o)}),Nn(Co,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("afterModifyTransformStart",...o)}),Nn(Co,this).addLocalHook("beforeTransformEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformEnd",...o)}),Nn(Co,this).addLocalHook("afterTransformEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("afterModifyTransformEnd",...o)}),Nn(Co,this).addLocalHook("insertRowRequire",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("insertRowRequire",...o)}),Nn(Co,this).addLocalHook("insertColRequire",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("insertColRequire",...o)}),Nn(Co,this).addLocalHook("beforeRowWrap",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeRowWrap",...o)}),Nn(Co,this).addLocalHook("beforeColumnWrap",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeColumnWrap",...o)}),Nn(kf,this).addLocalHook("beforeTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("beforeModifyTransformFocus",...o)}),Nn(kf,this).addLocalHook("afterTransformStart",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.runLocalHooks("afterModifyTransformFocus",...o)})}getSelectedRange(){return this.selectedRange}getActiveSelectedRange(){return this.selectedRange.peekByIndex(Nn(qS,this))}getActiveSelectionLayerIndex(){return Nn(qS,this)}setActiveSelectionLayerIndex(e){bo(qS,this,e)}markSource(e){bo(GS,this,e)}markEndSource(){bo(GS,this,"unknown")}getSelectionSource(){return Nn(GS,this)}setExpectedLayers(e){bo(jp,this,e)}begin(){this.inProgress=!0}finish(){this.runLocalHooks("afterSelectionFinished",Array.from(this.selectedRange)),this.inProgress=!1,bo(jp,this,-1)}isInProgress(){return this.inProgress}setRangeStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:e;const o=this.settings.selectionMode==="multiple",a=$n(n)?this.tableProps.getShortcutManager().isCtrlPressed():n,u=e.clone();bo(Zu,this,!1),bo(YS,this,!1),this.runLocalHooks(`beforeSetRangeStart${i?"Only":""}`,u),(!o||o&&!a&&$n(n))&&(this.selectedRange.clear(),U(this.highlight.getAreas(),h=>void h.clear()),U(this.highlight.getLayeredAreas(),h=>void h.clear()),U(this.highlight.getRowHeaders(),h=>void h.clear()),U(this.highlight.getColumnHeaders(),h=>void h.clear()),U(this.highlight.getActiveRowHeaders(),h=>void h.clear()),U(this.highlight.getActiveColumnHeaders(),h=>void h.clear()),U(this.highlight.getActiveCornerHeaders(),h=>void h.clear()),U(this.highlight.getRowHighlights(),h=>void h.clear()),U(this.highlight.getColumnHighlights(),h=>void h.clear())),this.selectedRange.add(u).current().setHighlight(r.clone()),this.getLayerLevel()===0&&(this.selectedByRowHeader.clear(),this.selectedByColumnHeader.clear()),i||this.setRangeEnd(e)}setRangeStartOnly(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;this.setRangeStart(e,n,!0,i)}setRangeEnd(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n);const i=e.clone(),r=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.getActiveSelectedRange().clone().setTo(e).isSingleHeader();if((r>0||o>0)&&(r===0&&i.col<0&&!a||o===0&&i.row<0&&!a))return;this.runLocalHooks("beforeSetRangeEnd",i),this.begin();const u=this.getActiveSelectedRange();if(this.settings.navigableHeaders||u.highlight.normalize(),this.settings.selectionMode==="single")u.setFrom(u.highlight),u.setTo(u.highlight);else{const d=u.getHorizontalDirection(),g=u.getVerticalDirection(),m=this.isMultiple();u.setTo(i),m&&(d!==u.getHorizontalDirection()||u.getWidth()===1&&!u.includes(u.highlight))&&u.from.assign({col:u.highlight.col}),m&&(g!==u.getVerticalDirection()||u.getHeight()===1&&!u.includes(u.highlight))&&u.from.assign({row:u.highlight.row})}r>0&&o>0&&(!this.settings.navigableHeaders||this.settings.navigableHeaders&&!u.isSingleHeader())&&u.to.normalize(),this.runLocalHooks("beforeHighlightSet"),this.setRangeFocus(this.getActiveSelectedRange().highlight,n),this.applyAndCommit(this.getActiveSelectedRange(),n);const h=Nn(jp,this)===-1||this.selectedRange.size()===Nn(jp,this);this.runLocalHooks("afterSetRangeEnd",e,h)}applyAndCommit(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();const i=this.tableProps.countRows(),r=this.tableProps.countCols();this.highlight.useLayerLevel(n);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),u=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),m=this.highlight.createActiveCornerHeader(),v=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();if(o.clear(),a.clear(),u.clear(),h.clear(),d.clear(),g.clear(),m.clear(),v.clear(),y.clear(),this.highlight.isEnabledFor(BP,e.highlight)&&(this.isMultiple()||n>=1)&&(o.add(e.from).add(e.to).commit(),a.add(e.from).add(e.to).commit(),n===1)){const b=this.selectedRange.peekByIndex(n-1);this.highlight.useLayerLevel(n-1),this.highlight.createArea().add(b.from).commit().syncWith(b),this.highlight.createLayeredArea().add(b.from).commit().syncWith(b),this.highlight.useLayerLevel(n)}if(this.highlight.isEnabledFor(VP,e.highlight)){if(!e.isSingleHeader()){const T=this.tableProps.createCellCoords(Math.max(e.from.row,0),-1),O=this.tableProps.createCellCoords(e.to.row,-1),A=this.tableProps.createCellCoords(-1,Math.max(e.from.col,0)),N=this.tableProps.createCellCoords(-1,e.to.col);this.settings.selectionMode==="single"?(u.add(T).commit(),h.add(A).commit(),v.add(T).commit(),y.add(A).commit()):(u.add(T).add(O).commit(),h.add(A).add(N).commit(),v.add(T).add(O).commit(),y.add(A).add(N).commit())}const b=!Nn(Zu,this)&&this.isEntireRowSelected()&&(r>0&&r===e.getWidth()||r===0&&this.isSelectedByRowHeader()),C=!Nn(Zu,this)&&this.isEntireColumnSelected()&&(i>0&&i===e.getHeight()||i===0&&this.isSelectedByColumnHeader());b&&d.add(this.tableProps.createCellCoords(Math.max(e.from.row,0),Math.min(-this.tableProps.countRowHeaders(),-1))).add(this.tableProps.createCellCoords(Math.max(e.to.row,0),-1)).commit(),C&&g.add(this.tableProps.createCellCoords(Math.min(-this.tableProps.countColHeaders(),-1),Math.max(e.from.col,0))).add(this.tableProps.createCellCoords(-1,Math.max(e.to.col,0))).commit(),b&&C&&m.add(this.tableProps.createCellCoords(-this.tableProps.countColHeaders(),-this.tableProps.countRowHeaders())).add(this.tableProps.createCellCoords(-1,-1)).commit()}}setRangeFocus(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getLayerLevel();if(this.selectedRange.isEmpty())return;this.setActiveSelectionLayerIndex(n),Nn(Co,this).setActiveLayerIndex(n),Nn(kf,this).setActiveLayerIndex(n);const i=this.getActiveSelectedRange();this.inProgress||this.runLocalHooks("beforeSetFocus",e);const r=this.highlight.getFocus();r.clear(),i.setHighlight(e),this.inProgress||this.runLocalHooks("beforeHighlightSet"),this.highlight.isEnabledFor(JC,i.highlight)&&r.add(i.highlight).commit().syncWith(i),this.inProgress||(bo(YS,this,!0),this.runLocalHooks("afterSetFocus",i.highlight))}transformStart(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const{visualCoords:r}=Nn(Co,this).transformStart(e,n,i);this.setRangeStart(r)}transformEnd(e,n){const{visualCoords:i,selectionLayer:r}=Nn(Co,this).transformEnd(e,n);this.setRangeEnd(i,r)}transformFocus(e,n){const{selectionLayer:i,visualCoords:r}=Nn(kf,this).transformStart(e,n);this.setRangeFocus(r.normalize(),i)}shiftRows(e,n){if(!this.isSelected())return;const i=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByColumnHeader()||i.getOuterTopStartCorner().row>=e){const{from:r,to:o,highlight:a}=i,u=this.tableProps.countRows(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=d?-1:0,m=d?0:n;this.getSelectedRange().pop();const v=this.tableProps.createCellCoords(St(r.row+m,g,u-1),r.col),y=this.tableProps.createCellCoords(St(o.row+n,g,u-1),o.col);this.markSource("shift"),a.row>=e?this.setRangeStartOnly(v,!0,this.tableProps.createCellCoords(St(a.row+n,0,u-1),a.col)):this.setRangeStartOnly(v,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}shiftColumns(e,n){if(!this.isSelected())return;const i=this.getActiveSelectedRange();if(this.isSelectedByCorner())this.selectAll(!0,!0,{disableHeadersHighlight:!0});else if(this.isSelectedByRowHeader()||i.getOuterTopStartCorner().col>=e){const{from:r,to:o,highlight:a}=i,u=this.tableProps.countCols(),h=this.isSelectedByRowHeader(),d=this.isSelectedByColumnHeader(),g=h?-1:0,m=h?0:n;this.getSelectedRange().pop();const v=this.tableProps.createCellCoords(r.row,St(r.col+m,g,u-1)),y=this.tableProps.createCellCoords(o.row,St(o.col+n,g,u-1));this.markSource("shift"),a.col>=e?this.setRangeStartOnly(v,!0,this.tableProps.createCellCoords(a.row,St(a.col+n,0,u-1))):this.setRangeStartOnly(v,!0),h&&this.selectedByRowHeader.add(this.getLayerLevel()),d&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(y),this.markEndSource()}}getLayerLevel(){return this.selectedRange.size()-1}isSelected(){return!this.selectedRange.isEmpty()}isMultiple(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getActiveSelectedRange();if(!this.isSelected())return!1;const n=Wo(!e.isSingle());return this.runLocalHooks("afterIsMultipleSelection",n),n.value}isFocusSelectionChanged(){return this.isSelected()&&Nn(YS,this)}isSelectedByRowHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner(e)&&(e===-1?this.selectedByRowHeader.size>0:this.selectedByRowHeader.has(e))}isEntireRowSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{col:o}=r.getOuterTopStartCorner(),a=this.tableProps.countRowHeaders(),u=this.tableProps.countCols();return(a>0&&o<0||a===0)&&r.getWidth()===u};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByColumnHeader(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();return!this.isSelectedByCorner()&&(e===-1?this.selectedByColumnHeader.size>0:this.selectedByColumnHeader.has(e))}isEntireColumnSelected(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getLayerLevel();const n=r=>{const{row:o}=r.getOuterTopStartCorner(),a=this.tableProps.countColHeaders(),u=this.tableProps.countRows();return(a>0&&o<0||a===0)&&r.getHeight()===u};if(e===-1)return Array.from(this.selectedRange).some(r=>n(r));const i=this.selectedRange.peekByIndex(e);return i?n(i):!1}isSelectedByAnyHeader(){return this.isSelectedByRowHeader(-1)||this.isSelectedByColumnHeader(-1)||this.isSelectedByCorner()}isSelectedByCorner(){return this.selectedByColumnHeader.has(this.getLayerLevel())&&this.selectedByRowHeader.has(this.getLayerLevel())}inInSelection(e){return this.selectedRange.includes(e)}isCellCornerVisible(){return this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&!this.isMultiple()}isCellVisible(e){const n=this.tableProps.visualToRenderableCoords(e);return n.row!==null&&n.col!==null}isAreaCornerVisible(e){return Number.isInteger(e)&&e!==this.getLayerLevel()?!1:this.settings.fillHandle&&!this.tableProps.isEditorOpened()&&this.isMultiple()}clear(){this.selectedRange.clear(),this.highlight.clear()}deselect(){this.isSelected()&&(this.inProgress=!1,this.clear(),this.runLocalHooks("afterDeselect"))}selectAll(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{focusPosition:!1,disableHeadersHighlight:!1};const o=this.tableProps.countRows(),a=this.tableProps.countCols(),u=this.tableProps.countRowHeaders(),h=this.tableProps.countColHeaders(),d=i?-h:0,g=n?-u:0;if(d===0&&g===0&&(o===0||a===0))return;let m=(e=this.getActiveSelectedRange())===null||e===void 0?void 0:e.highlight;const{focusPosition:v,disableHeadersHighlight:y}=r;v&&Number.isInteger(v?.row)&&Number.isInteger(v?.col)&&(m=this.tableProps.createCellCoords(St(v.row,d,o-1),St(v.col,g,a-1)));const b=this.tableProps.createCellCoords(d,g),C=this.tableProps.createCellCoords(o-1,a-1);this.clear(),this.runLocalHooks("beforeSelectAll",b,C,m),this.setRangeStartOnly(b,void 0,m),bo(Zu,this,y),g<0&&this.selectedByRowHeader.add(this.getLayerLevel()),d<0&&this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(C),this.runLocalHooks("afterSelectAll",b,C,m),this.finish()}selectCells(e){var n=this;const i=em(e);if(i===xR)return!1;if(i===OR)throw new Error(Ft`Unsupported format of the selection ranges was passed. To select cells pass\x20
        the coordinates as an array of arrays ([[rowStart, columnStart/columnPropStart, rowEnd,\x20
        columnEnd/columnPropEnd]]) or as an array of CellRange objects.`);const r=gw(i,{createCellCoords:function(){return n.tableProps.createCellCoords(...arguments)},createCellRange:function(){return n.tableProps.createCellRange(...arguments)},propToCol:h=>this.tableProps.propToCol(h),keepDirection:!0}),o=this.settings.navigableHeaders,a={countRows:this.tableProps.countRows(),countCols:this.tableProps.countCols(),countRowHeaders:o?this.tableProps.countRowHeaders():0,countColHeaders:o?this.tableProps.countColHeaders():0},u=!e.some(h=>{const d=r(h),g=d.isValid(a);return!(g&&!d.containsHeaders()||g&&d.containsHeaders()&&d.isSingleHeader())});return u&&(this.clear(),this.setExpectedLayers(e.length),U(e,h=>{const{from:d,to:g}=r(h);this.setRangeStartOnly(d.clone(),!1),this.setRangeEnd(g.clone())}),this.finish()),u}selectColumns(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=typeof e=="string"?this.tableProps.propToCol(e):e,o=typeof n=="string"?this.tableProps.propToCol(n):n,a=this.tableProps.countRows(),u=this.tableProps.countCols(),h=this.tableProps.countColHeaders(),d=h===0?0:-h,g=this.tableProps.createCellCoords(d,r),m=this.tableProps.createCellCoords(a-1,o),v=this.tableProps.createCellRange(g,g,m).isValid({countRows:a,countCols:u,countRowHeaders:0,countColHeaders:h});if(v){let y=0,b=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(y=St(i.row,d,a-1),b=St(i.col,Math.min(r,o),Math.max(r,o))):(y=St(i,d,a-1),b=r);const C=this.tableProps.createCellCoords(y,b),T=h===0?0:St(C.row,d,-1),O=a-1,A=this.tableProps.createCellCoords(T,r),N=this.tableProps.createCellCoords(O,o);this.runLocalHooks("beforeSelectColumns",A,N,C),this.setRangeStartOnly(A,void 0,C),this.selectedByColumnHeader.add(this.getLayerLevel()),this.setRangeEnd(N),this.runLocalHooks("afterSelectColumns",A,N,C),this.finish()}return v}selectRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0;const r=this.tableProps.countRows(),o=this.tableProps.countCols(),a=this.tableProps.countRowHeaders(),u=a===0?0:-a,h=this.tableProps.createCellCoords(e,u),d=this.tableProps.createCellCoords(n,o-1),g=this.tableProps.createCellRange(h,h,d).isValid({countRows:r,countCols:o,countRowHeaders:a,countColHeaders:0});if(g){let m=0,v=0;Number.isInteger(i?.row)&&Number.isInteger(i?.col)?(m=St(i.row,Math.min(e,n),Math.max(e,n)),v=St(i.col,u,o-1)):(m=e,v=St(i,u,o-1));const y=this.tableProps.createCellCoords(m,v),b=a===0?0:St(y.col,u,-1),C=o-1,T=this.tableProps.createCellCoords(e,b),O=this.tableProps.createCellCoords(n,C);this.runLocalHooks("beforeSelectRows",T,O,y),this.setRangeStartOnly(T,void 0,y),this.selectedByRowHeader.add(this.getLayerLevel()),this.setRangeEnd(O),this.runLocalHooks("afterSelectRows",T,O,y),this.finish()}return g}importSelection(e){let{ranges:n,activeRange:i,activeSelectionLayer:r,selectedByRowHeader:o,selectedByColumnHeader:a,disableHeadersHighlight:u}=e;n.length!==0&&(this.selectedRange.clear(),this.highlight.clear(),this.inProgress=!0,bo(Zu,this,u),this.selectedByRowHeader=new Set(o),this.selectedByColumnHeader=new Set(a),this.setActiveSelectionLayerIndex(0),n.forEach((h,d)=>{this.selectedRange.push(h),this.applyAndCommit(h,d)}),this.setRangeFocus(i.highlight,r),bo(Zu,this,!1),this.inProgress=!1)}exportSelection(){return{ranges:Array.from(this.selectedRange).map(e=>e.clone()),activeRange:this.getActiveSelectedRange(),activeSelectionLayer:this.getActiveSelectionLayerIndex(),selectedByRowHeader:Array.from(this.selectedByRowHeader),selectedByColumnHeader:Array.from(this.selectedByColumnHeader),disableHeadersHighlight:Nn(Zu,this)}}refresh(){if(!this.isSelected())return;const e=this.tableProps.countRows(),n=this.tableProps.countCols();if(e===0||n===0){this.deselect();return}const i=this.selectedRange.ranges.map(a=>a.clone());this.markSource("refresh");const r=new Set(this.selectedByRowHeader),o=new Set(this.selectedByColumnHeader);this.clear(),this.setExpectedLayers(i.length),i.forEach(a=>{const{from:u,to:h,highlight:d}=a,g=e-1,m=n-1;d.assign({row:St(d.row,this.settings.navigableHeaders?-1/0:0,g),col:St(d.col,this.settings.navigableHeaders?-1/0:0,m)}),u.assign({row:St(u.row,-1/0,g),col:St(u.col,-1/0,m)}),h.assign({row:St(h.row,-1/0,g),col:St(h.col,-1/0,m)}),this.setRangeStartOnly(u,!0,d),this.setRangeEnd(h)}),this.selectedByRowHeader=r,this.selectedByColumnHeader=o,this.finish(),this.markEndSource()}commit(){if(this.highlight.getCustomSelections().forEach(r=>{r.commit()}),!this.isSelected())return;const n=this.getLayerLevel(),i=this.getActiveSelectedRange();this.highlight.isEnabledFor(JC,i.highlight)&&this.highlight.getFocus().commit().syncWith(i);for(let r=0;r<this.selectedRange.size();r+=1){this.highlight.useLayerLevel(r);const o=this.highlight.createArea(),a=this.highlight.createLayeredArea(),u=this.highlight.createRowHeader(),h=this.highlight.createColumnHeader(),d=this.highlight.createActiveRowHeader(),g=this.highlight.createActiveColumnHeader(),m=this.highlight.createActiveCornerHeader(),v=this.highlight.createRowHighlight(),y=this.highlight.createColumnHighlight();o.commit(),a.commit(),u.commit(),h.commit(),d.commit(),g.commit(),m.commit(),v.commit(),y.commit()}this.highlight.useLayerLevel(n)}}en(N5,Fi);const DU=/^(\r\n|\n\r|\r|\n)/,yde=/^[^\t\r\n]+/,LU=/^\t/;function Sde(t){const e=[[""]];if(t.length===0)return e;let n=0,i=0,r;for(;t.length>0&&r!==t.length;)if(r=t.length,t.match(LU))t=t.replace(LU,""),n+=1,e[i][n]="";else if(t.match(DU))t=t.replace(DU,""),n=0,i+=1,e[i]=[""];else{let o="";if(t.startsWith('"')){let a=0,u=!0;for(;u;){const h=t.slice(0,1);h==='"'&&(a+=1),o+=h,t=t.slice(1),(t.length===0||t.match(/^[\t\r\n]/)&&a%2===0)&&(u=!1)}o=o.replace(/^"/,"").replace(/"$/,"").replace(/["]*/g,h=>new Array(Math.floor(h.length/2)).fill('"').join(""))}else{const a=t.match(yde);o=a?a[0]:"",t=t.slice(o.length)}e[i][n]=o}return e}function i0(t){let e,n,i,r,o="",a;for(e=0,n=t.length;e<n;e+=1){for(r=t[e].length,i=0;i<r;i+=1)i>0&&(o+="	"),a=t[e][i],typeof a=="string"?a.indexOf(`
`)>-1?o+=`"${a.replace(/"/g,'""')}"`:o+=a:a==null?o+="":o+=a;e!==n-1&&(o+=`
`)}return o}function FA(t,e){const{instance:n,visualRow:i,visualCol:r,valueSetter:o}=e;return Yt(o)?o.call(n,t,i,r,e):t}function bde(t,e){const{instance:n,visualRow:i,visualCol:r,valueGetter:o}=e;return Yt(o)?o.call(n,t,i,r,e):t}function Sh(t,e,n){return(e=Cde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cde(t){var e=Rde(t,"string");return typeof e=="symbol"?e:e+""}function Rde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Og{static get DESTINATION_RENDERER(){return 1}static get DESTINATION_CLIPBOARD_GENERATOR(){return 2}constructor(e,n,i){Sh(this,"hot",void 0),Sh(this,"metaManager",void 0),Sh(this,"tableMeta",void 0),Sh(this,"dataSource",void 0),Sh(this,"duckSchema",void 0),Sh(this,"colToPropCache",void 0),Sh(this,"propToColCache",void 0),this.hot=e,this.metaManager=i,this.tableMeta=i.getTableMeta(),this.dataSource=n,this.refreshDuckSchema(),this.createMap()}createMap(){const e=this.getSchema();if(typeof e>"u")throw new Error("trying to create `columns` definition but you didn't provide `schema` nor `data`");const n=this.tableMeta.columns;let i;if(this.colToPropCache=[],this.propToColCache=new Map,n){let r=0,o=0,a=!1;if(typeof n=="function"){const u=EP(e);r=u>0?u:this.countFirstRowKeys(),a=!0}else{const u=this.tableMeta.maxCols;r=Math.min(u,n.length)}for(i=0;i<r;i++){const u=a?n(i):n[i];if(Qe(u)){if(typeof u.data<"u"){const h=a?o:i;this.colToPropCache[h]=u.data,this.propToColCache.set(u.data,h)}o+=1}}}else this.recursiveDuckColumns(e)}countFirstRowKeys(){return g5(this.dataSource)}recursiveDuckColumns(e,n,i){let r=n,o=i,a;return typeof r>"u"&&(r=0,o=""),typeof e=="object"&&!Array.isArray(e)&&wt(e,(u,h)=>{u===null?(a=o+h,this.colToPropCache.push(a),this.propToColCache.set(a,r),r+=1):r=this.recursiveDuckColumns(u,r,`${h}.`)}),r}colToProp(e){if(Number.isInteger(e)===!1)return e;const n=this.hot.toPhysicalColumn(e);return n===null?e:this.colToPropCache&&Ne(this.colToPropCache[n])?this.colToPropCache[n]:n}propToCol(e){const n=this.propToColCache.get(e);if(Ne(n))return this.hot.toVisualColumn(n);const i=this.hot.toVisualColumn(e);return i===null?e:i}getSchema(){const e=this.tableMeta.dataSchema;return e?typeof e=="function"?e():e:this.duckSchema}createDuckSchema(){return this.dataSource&&this.dataSource[0]?hw(this.dataSource[0]):{}}refreshDuckSchema(){this.duckSchema=this.createDuckSchema()}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="above"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const o=this.hot.countSourceRows();let a=o,u=0,h=e;if((typeof h!="number"||h>=o)&&(h=o),h<this.hot.countRows()&&(a=this.hot.toPhysicalRow(h)),this.hot.runHooks("beforeCreateRow",h,n,i)===!1||a===null)return{delta:0};const g=this.tableMeta.maxRows,m=this.getSchema().length,v=[];for(;u<n&&o+u<g;){let b=null;this.hot.dataType==="array"?this.tableMeta.dataSchema?b=Nr(this.getSchema()):(b=[],ze(m-1,()=>b.push(null))):this.hot.dataType==="function"?b=this.tableMeta.dataSchema(h+u):(b={},mR(b,this.getSchema())),v.push(b),u+=1}this.hot.rowIndexMapper.insertIndexes(h,u),r==="below"&&(a=Math.min(a+1,o)),this.spliceData(a,0,v);const y=this.hot.toVisualRow(a);return this.hot.countSourceRows()===v.length&&this.hot.columnIndexMapper.initToLength(this.hot.getInitialColumnCount()),u>0&&(e==null?this.metaManager.createRow(null,u):i!=="auto"&&this.metaManager.createRow(a,n)),this.hot.runHooks("afterCreateRow",y,u,i),{delta:u,startPhysicalIndex:a}}createCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,{source:i,mode:r="start"}=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(!this.hot.isColumnModificationAllowed())throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");const o=this.dataSource,a=this.tableMeta.maxCols,u=this.hot.countSourceCols(),h=this.hot.countCols(),d=this.hot.countSourceRows(),g=typeof e=="number"&&e<=u?e:h;if(this.hot.runHooks("beforeCreateCol",g,n,i)===!1)return{delta:0};const m=g<h?this.hot.toPhysicalColumn(g):u,v=r==="end"?Math.min(m+1,u):m;let y=0;for(let b=v;y<n&&h+y<a;b++){if(typeof g!="number"||g>=h+y)if(d>0)for(let C=0;C<d;C+=1)typeof o[C]>"u"&&(o[C]=[]),o[C].push(null);else o.push([null]);else for(let C=0;C<d;C++)o[C].splice(b,0,null);y+=1}return y>0&&(e==null?this.metaManager.createColumn(null,y):i!=="auto"&&this.metaManager.createColumn(v,n)),this.hot.columnIndexMapper.insertIndexes(g,y,r),this.hot.runHooks("afterCreateCol",this.hot.toVisualColumn(v),y,i),this.refreshDuckSchema(),{delta:y,startPhysicalIndex:v}}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0,r=Number.isInteger(e)?e:-n;const o=this.visualRowsToPhysical(r,n),a=this.hot.countSourceRows();if(r=(a+r)%a,this.hot.runHooks("beforeRemoveRow",r,o.length,o,i)===!1)return!1;const h=o.length;if(this.filterData(r,h,o),r<this.hot.countRows()){this.hot.rowIndexMapper.removeIndexes(o);const g=Ne(this.tableMeta.columns)||Ne(this.tableMeta.dataSchema)||this.tableMeta.colHeaders;this.hot.rowIndexMapper.getNotTrimmedIndexesLength()===0&&!g&&this.hot.columnIndexMapper.setIndexesSequence([])}return o.slice(0).sort((g,m)=>m-g).forEach(g=>{this.metaManager.removeRow(g,1)}),this.hot.runHooks("afterRemoveRow",r,h,o,i),!0}removeCol(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1,i=arguments.length>2?arguments[2]:void 0;if(this.hot.dataType==="object"||this.tableMeta.columns)throw new Error("cannot remove column with object data source or columns option specified");let r=typeof e!="number"?-n:e;r=(this.hot.countCols()+r)%this.hot.countCols();const o=this.visualColumnsToPhysical(r,n),a=o.slice(0).sort((m,v)=>v-m);if(this.hot.runHooks("beforeRemoveCol",r,n,o,i)===!1)return!1;let h=!0;const d=a.length,g=this.dataSource;for(let m=0;m<d;m++)h&&o[0]!==o[m]-m&&(h=!1);if(h)for(let m=0,v=this.hot.countSourceRows();m<v;m++)g[m].splice(o[0],n),m===0&&this.metaManager.removeColumn(o[0],n);else for(let m=0,v=this.hot.countSourceRows();m<v;m++)for(let y=0;y<d;y++)g[m].splice(a[y],1),m===0&&this.metaManager.removeColumn(a[y],1);return r<this.hot.countCols()&&(this.hot.columnIndexMapper.removeIndexes(o),!this.tableMeta.rowHeaders&&this.hot.columnIndexMapper.getNotTrimmedIndexesLength()===0&&this.hot.rowIndexMapper.setIndexesSequence([])),this.hot.runHooks("afterRemoveCol",r,n,o,i),this.refreshDuckSchema(),!0}spliceCol(e,n,i){const r=this.hot.getDataAtCol(e),o=r.slice(n,n+i),a=r.slice(n+i);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];Yj(h,a);let g=0;for(;g<i;)h.push(null),g+=1;return Woe(h),this.hot.populateFromArray(n,e,h,null,null,"spliceCol"),o}spliceRow(e,n,i){const r=this.hot.getSourceDataAtRow(e),o=r.slice(n,n+i),a=r.slice(n+i);for(var u=arguments.length,h=new Array(u>3?u-3:0),d=3;d<u;d++)h[d-3]=arguments[d];Yj(h,a);let g=0;for(;g<i;)h.push(null),g+=1;return this.hot.populateFromArray(e,n,[h],null,null,"spliceRow"),o}spliceData(e,n,i){if(this.hot.runHooks("beforeDataSplice",e,n,i)!==!1){const o=[...this.dataSource.slice(0,e),...i,...this.dataSource.slice(e)];this.dataSource.length=0,o.forEach(a=>this.dataSource.push(a))}}filterData(e,n,i){let r=this.hot.runHooks("filterData",e,n,i);Array.isArray(r)===!1&&(r=this.dataSource.filter((o,a)=>i.indexOf(a)===-1)),this.dataSource.length=0,Array.prototype.push.apply(this.dataSource,r)}get(e,n){const i=this.hot.toPhysicalRow(e);let r=this.dataSource[i];const o=this.hot.runHooks("modifyRowData",i);r=isNaN(o)?o:r;const{dataDotNotation:a}=this.hot.getSettings();let u=null;if(r&&r.hasOwnProperty&&ti(r,n))u=r[n];else if(a&&typeof n=="string"&&n.indexOf(".")>-1){let g=r;if(!g)return null;const m=n.split(".");for(let v=0,y=m.length;v<y;v++)if(g=g[m[v]],typeof g>"u")return null;u=g}else typeof n=="function"&&(u=n(this.dataSource.slice(i,i+1)[0]));const h=this.propToCol(n),d=this.hot.toPhysicalColumn(h);if(jg(i)&&jg(d)&&(u=bde(u,this.metaManager.getCellMeta(i,d,{visualRow:e,visualColumn:h,skipMetaExtension:!0}))),this.hot.hasHook("modifyData")){const g=Wo(u);this.hot.runHooks("modifyData",e,h,g,"get"),g.isTouched()&&(u=g.value)}return u}getCopyable(e,n){return this.hot.getCellMeta(e,this.propToCol(n)).copyable?this.get(e,n):""}set(e,n,i){const r=this.hot.toPhysicalRow(e);let o=i,a=this.dataSource[r];const u=this.hot.runHooks("modifyRowData",r);if(a=isNaN(u)?u:a,this.hot.hasHook("modifyData")){const d=Wo(o);this.hot.runHooks("modifyData",e,this.propToCol(n),d,"set"),d.isTouched()&&(o=d.value)}const{dataDotNotation:h}=this.hot.getSettings();if(a&&a.hasOwnProperty&&ti(a,n))a[n]=o;else if(h&&typeof n=="string"&&n.indexOf(".")>-1){let d=a,g=0,m;const v=n.split(".");for(g=0,m=v.length-1;g<m;g++){if(v[g]==="__proto__"||v[g]==="constructor"||v[g]==="prototype")return;typeof d[v[g]]>"u"&&(d[v[g]]={}),d=d[v[g]]}d[v[g]]=o}else if(typeof n=="function")n(this.dataSource.slice(r,r+1)[0],o);else{if(n==="__proto__"||n==="constructor"||n==="prototype")return;a[n]=o}}visualRowsToPhysical(e,n){const i=this.hot.countSourceRows(),r=[];let o=(i+e)%i,a=n,u;for(;o<i&&a;)u=this.hot.toPhysicalRow(o),r.push(u),a-=1,o+=1;return r}visualColumnsToPhysical(e,n){const i=this.hot.countCols(),r=[];let o=(i+e)%i,a=n;for(;o<i&&a;){const u=this.hot.toPhysicalColumn(o);r.push(u),a-=1,o+=1}return r}clear(){for(let e=0;e<this.hot.countSourceRows();e++)for(let n=0;n<this.hot.countCols();n++)this.set(e,this.colToProp(n),"")}getLength(){const e=this.tableMeta.maxRows;let n;e<0||e===0?n=0:n=e||1/0;const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength();return Math.min(i,n)}getAll(){const e={row:0,col:0},n={row:Math.max(this.hot.countRows()-1,0),col:Math.max(this.hot.countCols()-1,0)};return e.row-n.row===0&&!this.hot.countSourceRows()?[]:this.getRange(e,n,Og.DESTINATION_RENDERER)}countCachedColumns(){return this.colToPropCache.length}getRange(e,n,i){const r=[];let o,a,u;const h=this.tableMeta.maxRows,d=this.tableMeta.maxCols;if(h===0||d===0)return[];const g=i===Og.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get,m=Math.min(Math.max(h-1,0),Math.max(e.row,n.row)),v=Math.min(Math.max(d-1,0),Math.max(e.col,n.col));for(o=Math.min(e.row,n.row);o<=m;o++){u=[];const y=o>=0?this.hot.toPhysicalRow(o):o;for(a=Math.min(e.col,n.col);a<=v&&y!==null;a++)u.push(g.call(this,o,this.colToProp(a)));y!==null&&r.push(u)}return r}getText(e,n){return i0(this.getRange(e,n,Og.DESTINATION_RENDERER))}getCopyableText(e,n){return i0(this.getRange(e,n,Og.DESTINATION_CLIPBOARD_GENERATOR))}destroy(){this.hot=null,this.metaManager=null,this.dataSource=null,this.duckSchema=null,this.colToPropCache.length=0,this.propToColCache.clear(),this.propToColCache=void 0}}const{register:Ede,getItem:Tde,hasItem:D5,getNames:yHe,getValues:SHe}=Ps("cellTypes");function _de(t){if(!D5(t))throw Error(`You declared cell type "${t}" as a string that is not mapped to a known object.
                 Cell type must be an object or a string mapped to an object registered by
                 "Handsontable.cellTypes.registerCellType" method`);return Tde(t)}function qs(t,e){typeof t!="string"&&(e=t,t=e.CELL_TYPE);const{editor:n,renderer:i,validator:r}=e;n&&xo(t,n),i&&ds(t,i),r&&pg(t,r),Ede(t,e)}function Mde(t,e){var n;return t==="CELL_TYPE"?!1:((n=e._automaticallyAssignedMetaProps)===null||n===void 0?void 0:n.has(t))||!ti(e,t)}function HR(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:t;const i=typeof e.type=="string"?_de(e.type):e.type;if(t._automaticallyAssignedMetaProps&&wt(e,(o,a)=>void t._automaticallyAssignedMetaProps.delete(a)),!Qe(i))return;n===t&&!t._automaticallyAssignedMetaProps&&(t._automaticallyAssignedMetaProps=new Set);const r={};wt(i,(o,a)=>{if(Mde(a,n)){var u;r[a]=o,(u=t._automaticallyAssignedMetaProps)===null||u===void 0||u.add(a)}}),Mi(t,r)}function Ade(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];function n(){}_se(n,t);for(let i=0;i<e.length;i++)n.prototype[e[i]]=void 0;return n}function yC(t,e){if(!t())throw new Error(`Assertion failed: ${e}`)}function Mv(t){return t==null}const L5=()=>({_automaticallyAssignedMetaProps:void 0,activeHeaderClassName:"ht__active_highlight",allowEmpty:!0,allowHtml:!1,allowInsertColumn:!0,allowInsertRow:!0,allowInvalid:!0,allowRemoveColumn:!0,allowRemoveRow:!0,ariaTags:!0,autoColumnSize:void 0,autoRowSize:void 0,autoWrapCol:!1,autoWrapRow:!1,bindRowsWithHeaders:void 0,cell:[],cells:void 0,checkedTemplate:void 0,className:void 0,colHeaders:null,collapsibleColumns:void 0,columnHeaderHeight:void 0,columns:void 0,columnSorting:void 0,columnSummary:void 0,colWidths:void 0,commentedCellClassName:"htCommentCell",comments:!1,contextMenu:void 0,copyable:!0,copyPaste:!0,correctFormat:!1,currentColClassName:void 0,currentHeaderClassName:"ht__highlight",currentRowClassName:void 0,customBorders:!1,data:void 0,dataDotNotation:!0,dataSchema:void 0,dateFormat:"DD/MM/YYYY",timeFormat:"h:mm:ss a",datePickerConfig:void 0,defaultDate:void 0,disableVisualSelection:!1,dialog:!1,dragToScroll:!0,dropdownMenu:void 0,editor:void 0,enterBeginsEditing:!0,enterMoves:{col:0,row:1},fillHandle:{autoInsertRow:!1},filter:!0,filteringCaseSensitive:!1,filters:void 0,fixedColumnsLeft:0,fixedColumnsStart:0,fixedRowsBottom:0,fixedRowsTop:0,formulas:void 0,fragmentSelection:!1,headerClassName:void 0,height:void 0,hiddenColumns:void 0,hiddenRows:void 0,initialState:void 0,invalidCellClassName:"htInvalid",imeFastEdit:!1,isEmptyCol(t){let e,n,i;for(e=0,n=this.countRows();e<n;e++)if(i=this.getDataAtCell(e,t),ni(i)===!1)return!1;return!0},isEmptyRow(t){let e,n,i,r;for(e=0,n=this.countCols();e<n;e++)if(i=this.getDataAtCell(t,e),ni(i)===!1)return typeof i=="object"?(r=this.getCellMeta(t,e),pR(this.getSchema()[r.prop],i)):!1;return!0},label:void 0,language:"en-US",layoutDirection:"inherit",licenseKey:void 0,locale:"en-US",loading:!1,manualColumnFreeze:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,maxCols:1/0,maxRows:1/0,mergeCells:!1,minCols:0,minRows:0,minSpareCols:0,minSpareRows:0,multiColumnSorting:void 0,navigableHeaders:!1,tabNavigation:!0,nestedHeaders:void 0,nestedRows:void 0,noWordWrapClassName:"htNoWrap",numericFormat:void 0,observeDOMVisibility:!0,outsideClickDeselects:!0,pagination:void 0,persistentState:void 0,placeholder:void 0,placeholderCellClassName:"htPlaceholder",preventOverflow:!1,preventWheel:!1,readOnly:!1,readOnlyCellClassName:"htDimmed",renderAllRows:!1,renderAllColumns:!1,renderer:void 0,rowHeaders:void 0,rowHeaderWidth:void 0,rowHeights:void 0,search:!1,selectionMode:"multiple",selectOptions:void 0,skipColumnOnPaste:!1,skipRowOnPaste:!1,sortByRelevance:!0,source:void 0,startCols:5,startRows:5,stretchH:"none",strict:void 0,tableClassName:void 0,textEllipsis:!1,themeName:void 0,tabMoves:{row:0,col:1},title:void 0,trimDropdown:!0,trimRows:void 0,trimWhitespace:!0,type:"text",uncheckedTemplate:void 0,undo:!0,validator:void 0,valueGetter:void 0,valueSetter:void 0,viewportColumnRenderingOffset:"auto",viewportRowRenderingOffset:"auto",viewportColumnRenderingThreshold:0,viewportRowRenderingThreshold:0,visibleRows:10,width:void 0,wordWrap:!0});function kU(t,e,n){return(e=Ode(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ode(t){var e=xde(t,"string");return typeof e=="symbol"?e:e+""}function xde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Hde(){return class{}}class Ide{constructor(e){kU(this,"metaCtor",Hde()),kU(this,"meta",void 0),this.meta=this.metaCtor.prototype,Mi(this.meta,L5()),this.meta.instance=e}getMetaConstructor(){return this.metaCtor}getMeta(){return this.meta}updateMeta(e){var n;Mi(this.meta,e),HR(this.meta,{...e,type:(n=e.type)!==null&&n!==void 0?n:this.meta.type},e)}}function Pde(t,e,n){return(e=Nde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nde(t){var e=Dde(t,"string");return typeof e=="symbol"?e:e+""}function Dde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Lde{constructor(e){Pde(this,"meta",void 0);const n=e.getMetaConstructor();this.meta=new n}getMeta(){return this.meta}updateMeta(e){Mi(this.meta,e),HR(this.meta,e,e)}}function KS(t,e,n){return(e=kde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kde(t){var e=$de(t,"string");return typeof e=="symbol"?e:e+""}function $de(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class r0{constructor(e){KS(this,"valueFactory",void 0),KS(this,"data",[]),KS(this,"index",[]),KS(this,"holes",new Set),this.valueFactory=e}obtain(e){yC(()=>jg(e),"Expecting an unsigned number.");const n=this._getStorageIndexByKey(e);let i;if(n>=0)i=this.data[n],i===void 0&&(i=this.valueFactory(e),this.data[n]=i);else if(i=this.valueFactory(e),this.holes.size>0){const r=this.holes.values().next().value;this.holes.delete(r),this.data[r]=i,this.index[e]=r}else this.data.push(i),this.index[e]=this.data.length-1;return i}insert(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;yC(()=>jg(e)||Mv(e),"Expecting an unsigned number or null/undefined argument.");const i=[],r=this.data.length;for(let a=0;a<n;a++)i.push(r+a),this.data.push(void 0);const o=Mv(e)?this.index.length:e;this.index=[...this.index.slice(0,o),...i,...this.index.slice(o)]}remove(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;yC(()=>jg(e)||Mv(e),"Expecting an unsigned number or null/undefined argument.");const i=this.index.splice(Mv(e)?this.index.length-n:e,n);for(let r=0;r<i.length;r++){const o=i[r];typeof o=="number"&&this.holes.add(o)}}size(){return this.data.length-this.holes.size}values(){return this.data.filter((e,n)=>e!==void 0&&!this.holes.has(n))[Symbol.iterator]()}entries(){const e=[];for(let i=0;i<this.data.length;i++){const r=this._getKeyByStorageIndex(i);r!==-1&&this.data[i]!==void 0&&e.push([r,this.data[i]])}let n=0;return{next:()=>{if(n<e.length){const i=e[n];return n+=1,{value:i,done:!1}}return{done:!0}}}}clear(){this.data=[],this.index=[],this.holes.clear()}_getStorageIndexByKey(e){return this.index.length>e?this.index[e]:-1}_getKeyByStorageIndex(e){return this.index.indexOf(e)}[Symbol.iterator](){return this.entries()}}function $U(t,e,n){return(e=Vde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Vde(t){var e=Bde(t,"string");return typeof e=="symbol"?e:e+""}function Bde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Fde=["data","width"];class Wde{constructor(e){$U(this,"globalMeta",void 0),$U(this,"metas",new r0(()=>this._createMeta())),this.globalMeta=e,this.metas=new r0(()=>this._createMeta())}updateMeta(e,n){const i=this.getMeta(e);Mi(i,n),HR(i,n)}createColumn(e,n){this.metas.insert(e,n)}removeColumn(e,n){this.metas.remove(e,n)}getMeta(e){return this.metas.obtain(e)}getMetaConstructor(e){return this.metas.obtain(e).constructor}clearCache(){this.metas.clear()}_createMeta(){return Ade(this.globalMeta.getMetaConstructor(),Fde).prototype}}function VU(t,e,n){return(e=jde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jde(t){var e=zde(t,"string");return typeof e=="symbol"?e:e+""}function zde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ude{constructor(e){VU(this,"columnMeta",void 0),VU(this,"metas",new r0(()=>this._createRow())),this.columnMeta=e}updateMeta(e,n,i){const r=this.getMeta(e,n);Mi(r,i),HR(r,i)}createRow(e,n){this.metas.insert(e,n)}createColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).insert(e,n)}removeRow(e,n){this.metas.remove(e,n)}removeColumn(e,n){for(let i=0;i<this.metas.size();i++)this.metas.obtain(i).remove(e,n)}getMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);return i===void 0?r:r[i]}setMeta(e,n,i,r){var o;const a=this.metas.obtain(e).obtain(n);(o=a._automaticallyAssignedMetaProps)===null||o===void 0||o.delete(i),a[i]=r}removeMeta(e,n,i){const r=this.metas.obtain(e).obtain(n);delete r[i]}getMetas(){const e=[],n=Array.from(this.metas.values());for(let i=0;i<n.length;i++)Ne(n[i])&&e.push(...n[i].values());return e}getMetasAtRow(e){yC(()=>jg(e),"Expecting an unsigned number.");const n=new Map(this.metas);return n.has(e)?Array.from(n.get(e).values()):[]}clearCache(){this.metas.clear()}_createRow(){return new r0(e=>this._createMeta(e))}_createMeta(e){const n=this.columnMeta.getMetaConstructor(e);return new n}}class k5{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];this.hot=e,this.globalMeta=new Ide(e),this.tableMeta=new Lde(this.globalMeta),this.columnMeta=new Wde(this.globalMeta),this.cellMeta=new Ude(this.columnMeta),i.forEach(r=>new r(this)),this.globalMeta.updateMeta(n)}getGlobalMeta(){return this.globalMeta.getMeta()}updateGlobalMeta(e){this.globalMeta.updateMeta(e)}getTableMeta(){return this.tableMeta.getMeta()}updateTableMeta(e){this.tableMeta.updateMeta(e)}getColumnMeta(e){return this.columnMeta.getMeta(e)}updateColumnMeta(e,n){this.columnMeta.updateMeta(e,n)}getCellMeta(e,n,i){const r=this.cellMeta.getMeta(e,n);return r.visualRow=i.visualRow,r.visualCol=i.visualColumn,r.row=e,r.col=n,i.skipMetaExtension||this.runLocalHooks("afterGetCellMeta",r),r}getCellMetaKeyValue(e,n,i){if(typeof i!="string")throw new Error("The passed cell meta object key is not a string");return this.cellMeta.getMeta(e,n,i)}setCellMeta(e,n,i,r){this.cellMeta.setMeta(e,n,i,r)}updateCellMeta(e,n,i){this.cellMeta.updateMeta(e,n,i)}removeCellMeta(e,n,i){this.cellMeta.removeMeta(e,n,i)}getCellsMeta(){return this.cellMeta.getMetas()}getCellsMetaAtRow(e){return this.cellMeta.getMetasAtRow(e)}createRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createRow(e,n)}removeRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeRow(e,n)}createColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.createColumn(e,n),this.columnMeta.createColumn(e,n)}removeColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1;this.cellMeta.removeColumn(e,n),this.columnMeta.removeColumn(e,n)}clearCellsCache(){this.cellMeta.clearCache()}clearCache(){this.cellMeta.clearCache(),this.columnMeta.clearCache()}}en(k5,Fi);function BU(t,e,n,i){const{hotInstance:r,dataMap:o,dataSource:a,internalSource:u,source:h,metaManager:d,firstRun:g}=i,m=ha(u),v=r.getSettings();Array.isArray(v.dataSchema)?r.dataType="array":Yt(v.dataSchema)?r.dataType="function":r.dataType="object",o&&o.destroy(),t=r.runHooks(`before${m}`,t,g,h);const y=new Og(r,t,d);if(e(y),typeof t=="object"&&t!==null)t.push&&t.splice||(t=[t]);else if(t===null){const b=y.getSchema();t=[];let C,T=0,O=0;for(T=0,O=v.startRows;T<O;T++)if((r.dataType==="object"||r.dataType==="function")&&v.dataSchema)C=Nr(b),t.push(C);else if(r.dataType==="array")C=Nr(b[0]),t.push(C);else{C=[];for(let A=0,N=v.startCols;A<N;A++)C.push(null);t.push(C)}}else throw new Error(`${u} only accepts array of objects or array of arrays (${typeof t} given)`);Array.isArray(t[0])&&(r.dataType="array"),v.data=t,y.dataSource=t,a.data=t,a.dataType=r.dataType,a.colToProp=y.colToProp.bind(y),a.propToCol=y.propToCol.bind(y),a.countCachedColumns=y.countCachedColumns.bind(y),n(y),r.runHooks(`after${m}`,t,g,h),g||(r.runHooks("afterChange",null,u),r.view.adjustElementsSize(),r.render()),r.getSettings().ariaTags&&We(r.rootElement,[g4(-1),gR(r.countCols()+(r.view?r.countRowHeaders():0))])}function FU(t,e,n){return(e=Yde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yde(t){var e=Gde(t,"string");return typeof e=="symbol"?e:e+""}function Gde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qde{constructor(e){var n=this;FU(this,"metaManager",void 0),FU(this,"metaSyncMemo",new Map),this.metaManager=e,e.addLocalHook("afterGetCellMeta",function(){return n.extendCellMeta(...arguments)}),He.getSingleton().add("beforeRender",i=>{i&&this.metaSyncMemo.clear()},this.metaManager.hot)}extendCellMeta(e){var n;const{row:i,col:r}=e;if((n=this.metaSyncMemo.get(i))!==null&&n!==void 0&&n.has(r))return;const{visualRow:o,visualCol:a}=e,u=this.metaManager.hot,h=u.colToProp(a);e.prop=h,u.runHooks("beforeGetCellMeta",o,a,e);const d=ti(e,"type")?e.type:null;let g=Yt(e.cells)?e.cells(i,r,h):null;if(d)if(g){var m;g.type=(m=g.type)!==null&&m!==void 0?m:d}else g={type:d};g&&this.metaManager.updateCellMeta(i,r,g),u.runHooks("afterGetCellMeta",o,a,e),this.metaSyncMemo.has(i)||this.metaSyncMemo.set(i,new Set),this.metaSyncMemo.get(i).add(r)}}function Kde(t,e,n){Xde(t,e),e.set(t,n)}function Xde(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function WA(t,e,n){return(e=Zde(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Zde(t){var e=Qde(t,"string");return typeof e=="symbol"?e:e+""}function Qde(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Jde(t,e){return t.get(efe(t,e))}function efe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var WU=new WeakMap;class tfe{constructor(e){WA(this,"metaManager",void 0),WA(this,"usageTracker",new Set),WA(this,"propDescriptors",new Map([["ariaTags",{initOnly:!0}],["fixedColumnsLeft",{target:"fixedColumnsStart",onChange(n){if(this.metaManager.hot.isRtl()&&n==="fixedColumnsLeft")throw new Error("The `fixedColumnsLeft` is not supported for RTL. Please use option `fixedColumnsStart`.");if(this.usageTracker.has("fixedColumnsLeft")&&this.usageTracker.has("fixedColumnsStart"))throw new Error("The `fixedColumnsLeft` and `fixedColumnsStart` should not be used together. Please use only the option `fixedColumnsStart`.")}}],["layoutDirection",{initOnly:!0}],["renderAllColumns",{initOnly:!0}],["renderAllRows",{initOnly:!0}]])),Kde(this,WU,(n,i,r)=>{if(!r)throw new Error(`The \`${n}\` option can not be updated after the Handsontable is initialized.`)}),this.metaManager=e,this.extendMetaProps()}extendMetaProps(){this.propDescriptors.forEach((e,n)=>{const{initOnly:i,target:r,onChange:o}=e,a=typeof r=="string",u=a?r:n,h=`_${u}`;this.metaManager.globalMeta.meta[h]=this.metaManager.globalMeta.meta[u],o?(this.installPropWatcher(n,h,o),a&&this.installPropWatcher(r,h,o)):i&&(this.installPropWatcher(n,h,Jde(WU,this)),this.metaManager.globalMeta.meta._initOnlySettings||(this.metaManager.globalMeta.meta._initOnlySettings=[]),this.metaManager.globalMeta.meta._initOnlySettings.push(n))})}installPropWatcher(e,n,i){const r=this;Object.defineProperty(this.metaManager.globalMeta.meta,e,{get(){return this[n]},set(o){const a=!r.usageTracker.has(e);r.usageTracker.add(e),i.call(r,e,o,a),this[n]=o},enumerable:!0,configurable:!0})}}const $5="gridDefault",Yc="editorManager.handlingEditor",nfe={name:"editorCloseAndSave",callback(t){t._getEditorManager().closeEditorAndSaveChanges()}},ife="hooksRefRegisterer",V5={_hooksStorage:Object.create(null),addHook(t,e){return this._hooksStorage[t]||(this._hooksStorage[t]=[]),this.hot.addHook(t,e),this._hooksStorage[t].push(e),this},removeHooksByKey(t){U(this._hooksStorage[t]||[],e=>{this.hot.removeHook(t,e)})},clearHooks(){wt(this._hooksStorage,(t,e)=>this.removeHooksByKey(e)),this._hooksStorage={}}};yu(V5,"MIXIN_NAME",ife,{writable:!1,enumerable:!1});function js(t,e,n){return(e=rfe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rfe(t){var e=ofe(t,"string");return typeof e=="symbol"?e:e+""}function ofe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const sfe="base",Jn=Object.freeze({VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"});class Rm{static get EDITOR_TYPE(){return sfe}constructor(e){js(this,"hot",void 0),js(this,"state",Jn.VIRGIN),js(this,"_opened",!1),js(this,"_fullEditMode",!1),js(this,"_closeCallback",null),js(this,"TD",null),js(this,"row",null),js(this,"col",null),js(this,"prop",null),js(this,"originalValue",null),js(this,"cellProperties",null),this.hot=e,this.init()}_fireCallbacks(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)}init(){}getValue(){throw Error("Editor getValue() method unimplemented")}setValue(){throw Error("Editor setValue() method unimplemented")}open(){throw Error("Editor open() method unimplemented")}close(){throw Error("Editor close() method unimplemented")}prepare(e,n,i,r,o,a){this.TD=r,this.row=e,this.col=n,this.prop=i,this.originalValue=o,this.cellProperties=a,this.state=this.isOpened()?this.state:Jn.VIRGIN}extend(){return class extends this.constructor{}}saveValue(e,n){let i,r,o,a;if(n){const h=this.hot.getSelectedRangeActive(),d=h.getTopStartCorner(),g=h.getBottomEndCorner();i=d.row,r=d.col,o=g.row,a=g.col}else[i,r,o,a]=[this.row,this.col,null,null];const u=this.hot.runHooks("modifyGetCellCoords",i,r,!1,"meta");Array.isArray(u)&&([i,r]=u),this.hot.populateFromArray(i,r,e,o,a,"edit")}beginEditing(e,n){if(this.state!==Jn.VIRGIN)return;const i=this.hot,r=i.rowIndexMapper.getRenderableFromVisualIndex(this.row),o=i.columnIndexMapper.getRenderableFromVisualIndex(this.col),a=()=>{if(this.state=Jn.EDITING,this.isInFullEditMode()){const h=this.cellProperties.valueGetter?this.cellProperties.valueGetter(this.originalValue):this.originalValue,d=typeof e=="string"?e:xn(h);this.setValue(d)}this.open(n),this._opened=!0,this.focus(),i.view.render(),i.runHooks("afterBeginEditing",this.row,this.col)};this.hot.addHookOnce("afterScroll",a),i.view.scrollViewport(i._createCellCoords(r,o))||(this.hot.removeHook("afterScroll",a),a()),this.addHook("beforeDialogShow",()=>this.cancelChanges())}finishEditing(e,n,i){let r;if(i){const o=this._closeCallback;this._closeCallback=a=>{o&&o(a),i(a),this.hot.view.render()}}if(!this.isWaiting()){if(this.state===Jn.VIRGIN){this.hot._registerTimeout(()=>{this._fireCallbacks(!0)});return}if(this.state===Jn.EDITING){if(e){this.cancelChanges(),this.hot.view.render();return}const o=this.getValue();this.cellProperties.trimWhitespace?r=[[typeof o=="string"?String.prototype.trim.call(o||""):o]]:r=[[o]],this.state=Jn.WAITING,this.saveValue(r,n),this.hot.getCellValidator(this.cellProperties)?this.hot.addHookOnce("postAfterValidate",a=>{this.state=Jn.FINISHED,this.discardEditor(a)}):(this.state=Jn.FINISHED,this.discardEditor(!0))}}}cancelChanges(){this.state=Jn.FINISHED,this.discardEditor()}discardEditor(e){this.state===Jn.FINISHED&&(e===!1&&this.cellProperties.allowInvalid!==!0?(this.hot.selectCell(this.row,this.col),this.focus(),this.state=Jn.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this._fullEditMode=!1,this.state=Jn.VIRGIN,this._fireCallbacks(!0),this.hot.getShortcutManager().setActiveContextName("grid")))}enableFullEditMode(){this._fullEditMode=!0}isInFullEditMode(){return this._fullEditMode}isOpened(){return this._opened}isWaiting(){return this.state===Jn.WAITING}getEditedCellRect(){var e;const n=this.getEditedCell();if(!n)return;const{wtOverlays:i,wtViewport:r}=this.hot.view._wt,o=this.hot.rootWindow,a=pr(n),u=hi(n),h=pr(this.hot.rootElement),d=hi(this.hot.rootElement),g=i.topOverlay.holder,m=i.inlineStartOverlay.holder,v=g!==o?g.scrollTop:0,y=m!==o?m.scrollLeft:0,b=o.innerWidth-h.left-d,{wtTable:C}=(e=i.getParentOverlay(n))!==null&&e!==void 0?e:this.hot.view._wt,T=C.name,O=["master","inline_start"].includes(T)?v:0,A=["master","top","bottom"].includes(T)?y:0,N=a.top===h.top?0:1;let x=a.top-h.top-N-O,$=0;this.hot.isRtl()?$=o.innerWidth-a.left-u-b-1+A:$=a.left-h.left-1-A,["top","top_inline_start_corner"].includes(T)&&(x+=i.topOverlay.getOverlayOffset()),["inline_start","top_inline_start_corner"].includes(T)&&($+=Math.abs(i.inlineStartOverlay.getOverlayOffset()));const L=this.hot.hasColHeaders(),P=this.hot.rowIndexMapper.getRenderableFromVisualIndex(this.row),Q=this.hot.columnIndexMapper.getRenderableFromVisualIndex(this.col),X=this.hot.rowIndexMapper.getRenderableIndexesLength()-this.hot.view._wt.getSetting("fixedRowsBottom");(L&&P<=0||P===X)&&(x+=1),Q<=0&&($+=1);const me=r.rowsRenderCalculator.startPosition,re=r.columnsRenderCalculator.startPosition,Se=Math.abs(i.inlineStartOverlay.getScrollPosition()),we=i.topOverlay.getScrollPosition(),_e=_i(this.hot.rootDocument);let ie=n.offsetTop;if(["inline_start","master"].includes(T)&&(ie+=me-we),["bottom","bottom_inline_start_corner"].includes(T)){const{wtViewport:q,wtTable:J}=i.bottomOverlay.clone;ie+=q.getWorkspaceHeight()-J.getHeight()-_e}let de=n.offsetLeft;this.hot.isRtl()?(de>=0?de=C.getWidth()-n.offsetLeft:de=Math.abs(de),de+=re-Se-u):["top","master","bottom"].includes(T)&&(de+=re-Se);const Te=o.getComputedStyle(this.TD),Pe=this.hot.isRtl()?"borderRightWidth":"borderLeftWidth",De=parseInt(Te[Pe],10)>0?0:1,V=parseInt(Te.borderTopWidth,10)>0?0:1,le=hi(n)+De,ye=Ti(n)+V,S=A4(g)?_e:0,E=O4(m)?_e:0,M=this.hot.view.maximumVisibleElementWidth(de)-S+De,F=Math.max(this.hot.view.maximumVisibleElementHeight(ie)-E+V,this.hot.stylesHandler.getDefaultRowHeight());return{top:x,start:$,height:ye,maxHeight:F,width:le,maxWidth:M}}getEditedCellsLayerClass(){switch(this.checkEditorSection()){case"inline-start":return"ht_clone_left ht_clone_inline_start";case"bottom":return"ht_clone_bottom";case"bottom-inline-start-corner":return"ht_clone_bottom_left_corner ht_clone_bottom_inline_start_corner";case"top":return"ht_clone_top";case"top-inline-start-corner":return"ht_clone_top_left_corner ht_clone_top_inline_start_corner";default:return"ht_clone_master"}}getEditedCell(){return this.hot.getCell(this.row,this.col,!0)}checkEditorSection(){const e=this.hot.countRows();let n="";return this.row<this.hot.getSettings().fixedRowsTop?this.col<this.hot.getSettings().fixedColumnsStart?n="top-inline-start-corner":n="top":this.hot.getSettings().fixedRowsBottom&&this.row>=e-this.hot.getSettings().fixedRowsBottom?this.col<this.hot.getSettings().fixedColumnsStart?n="bottom-inline-start-corner":n="bottom":this.col<this.hot.getSettings().fixedColumnsStart&&(n="inline-start"),n}}en(Rm,V5);const afe={name:"editorCloseAndSaveByArrowKeys",callback(t,e,n){const i=t._getEditorManager(),r=i.getActiveEditor();r.isInFullEditMode()&&r.state===Jn.EDITING||(i.closeEditorAndSaveChanges(),t.getSelected()&&(n.includes("arrowdown")?t.selection.transformStart(1,0):n.includes("arrowup")?t.selection.transformStart(-1,0):n.includes("arrowleft")?t.selection.transformStart(0,-1*t.getDirectionFactor()):n.includes("arrowright")&&t.selection.transformStart(0,t.getDirectionFactor())),e.preventDefault())}},lfe={name:"editorCloseAndSaveByEnter",callback(t,e){const n=t._getEditorManager();n.closeEditorAndSaveChanges(e.ctrlKey||e.metaKey),n.moveSelectionAfterEnter(e)}},ufe={name:"editorCloseWithoutSaving",callback(t){const e=t._getEditorManager();e.closeEditorAndRestoreOriginalValue(t.getShortcutManager().isCtrlPressed()),e.activeEditor.focus()}},cfe={name:"editorFastOpen",callback(t,e){const{highlight:n}=t.getSelectedRangeActive();n.isHeader()||t._getEditorManager().openEditor(null,e,!0)}},hfe={name:"editorOpen",callback(t,e,n){const{selection:i}=t,r=t._getEditorManager(),o=t.getSelectedRange(),a=t.getSelectedRangeActive(),{highlight:u}=a;if((o.some(h=>i.isMultiple(h))||o.length>1)&&!a.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0){const h=t.getSettings(),d=typeof h.enterMoves=="function"?h.enterMoves(e):h.enterMoves;n.includes("shift")?i.transformFocus(-d.row,-d.col):i.transformFocus(d.row,d.col);return}u.isHeader()||(t.getSettings().enterBeginsEditing?r.cellProperties.readOnly?r.moveSelectionAfterEnter(e):r.openEditor(null,e,!0):r.moveSelectionAfterEnter(e),ma(e))}};function dfe(){return[nfe,afe,lfe,ufe,cfe,hfe]}const ffe={name:"extendCellsSelectionDown",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(1,0),e.markEndSource())}},gfe={name:"extendCellsSelectionDownByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeActive(),r=Math.min(i.row+t.countVisibleRows(),t.countRows()-1),o=n.getNearestNotHiddenIndex(r,-1);if(o!==null){const a=t._createCellCoords(o,i.col),u=i.row-t.getFirstFullyVisibleRow(),h=Math.min(a.row-u,t.countRows()-1);e.markSource("keyboard"),e.setRangeEnd(a,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:h,verticalSnap:"top",horizontalSnap:"start"})}}},mfe={name:"extendCellsSelectionLeft",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,-1*t.getDirectionFactor()),e.markEndSource())}},pfe={name:"extendCellsSelectionRight",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByColumnHeader())&&(e.markSource("keyboard"),e.transformEnd(0,t.getDirectionFactor()),e.markEndSource())}},vfe={name:"extendCellsSelectionToColumns",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByRowHeader()?e.selectAll(!0,!0):t.selectColumns(i.col,r.col,n),e.markEndSource()}},wfe={name:"extendCellsSelectionToMostBottom",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),a=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(t.countRows()-1,-1),h=r.clone();h.row=i.row,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(u,o.col)),e.markEndSource()}}},yfe={name:"extendCellsSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const a=n.getNearestNotHiddenIndex(t.countCols()-1,-1),u=r.clone();u.col=i.col,e.markSource("keyboard"),e.setRangeStart(u,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,a)),e.markEndSource()}}},Sfe={name:"extendCellsSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive();if(!e.isSelectedByRowHeader()&&!e.isSelectedByCorner()&&i.isCell()){const a=parseInt(t.getSettings().fixedColumnsStart,10),u=n.getNearestNotHiddenIndex(a,1),h=r.clone();h.col=i.col,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),e.setRangeEnd(t._createCellCoords(o.row,u)),e.markEndSource()}}},bfe={name:"extendCellsSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),a=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]),h=r.clone();h.col=i.col,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,u)),e.markEndSource()}}},Cfe={name:"extendCellsSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),a=i.isHeader()&&e.isSelectedByColumnHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]),h=r.clone();h.col=i.col,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByColumnHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(o.row,u)),e.markEndSource()}}},Rfe={name:"extendCellsSelectionToMostTop",callback(t){const{selection:e,rowIndexMapper:n}=t,{highlight:i,from:r,to:o}=t.getSelectedRangeActive(),a=i.isHeader()&&e.isSelectedByRowHeader();if(i.isCell()||a){const u=n.getNearestNotHiddenIndex(0,1),h=r.clone();h.row=i.row,e.markSource("keyboard"),e.setRangeStart(h,void 0,!1,i.clone()),a&&e.selectedByRowHeader.add(e.getLayerLevel()),e.setRangeEnd(t._createCellCoords(u,o.col)),e.markEndSource()}}},Efe={name:"extendCellsSelectionToRows",callback(t){const{selection:e}=t,{highlight:n,from:i,to:r}=t.getSelectedRangeActive();e.markSource("keyboard"),e.isSelectedByColumnHeader()?e.selectAll(!0,!0):t.selectRows(i.row,r.row,n),e.markEndSource()}},Tfe={name:"extendCellsSelectionUp",callback(t){const{selection:e}=t,{highlight:n}=t.getSelectedRangeActive();!e.isSelectedByColumnHeader()&&!e.isSelectedByCorner()&&(n.isCell()||n.isHeader()&&e.isSelectedByRowHeader())&&(e.markSource("keyboard"),e.transformEnd(-1,0),e.markEndSource())}},_fe={name:"extendCellsSelectionUpByViewportHeight",callback(t){const{selection:e,rowIndexMapper:n}=t,{to:i}=t.getSelectedRangeActive(),r=Math.max(i.row-t.countVisibleRows(),0),o=n.getNearestNotHiddenIndex(r,1);if(o!==null){const a=t._createCellCoords(o,i.col),u=i.row-t.getFirstFullyVisibleRow(),h=Math.max(a.row-u,0);e.markSource("keyboard"),e.setRangeEnd(a,t.getActiveSelectionLayerIndex()),e.markEndSource(),t.scrollViewportTo({row:h,verticalSnap:"top",horizontalSnap:"start"})}}};function Mfe(){return[ffe,gfe,mfe,pfe,vfe,wfe,yfe,Sfe,bfe,Cfe,Rfe,Efe,Tfe,_fe]}const Afe={name:"moveCellSelectionDown",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(1,0),e.markEndSource()}},Ofe={name:"moveCellSelectionDownByViewportHeight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+i;o=o===0?1:o,r===t.countRows()-1?o=1:r+o>t.countRows()&&(o=t.countRows()-r-1),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}},xfe={name:"moveCellSelectionInlineEnd",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRange(),o=t.getSelectedRangeActive(),a=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),(r.some(u=>n.isMultiple(u))||r.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(-a.row,-a.col):n.transformStart(-a.row,-a.col),n.markEndSource()}},Hfe={name:"moveCellSelectionInlineStart",callback(t,e){const{selection:n}=t,i=t.getSettings(),r=t.getSelectedRange(),o=t.getSelectedRangeActive(),a=typeof i.tabMoves=="function"?i.tabMoves(e):i.tabMoves;n.markSource("keyboard"),(r.some(u=>n.isMultiple(u))||r.length>1)&&!o.isHeader()&&t.countRenderedCols()>0&&t.countRenderedRows()>0?n.transformFocus(a.row,a.col):n.transformStart(a.row,a.col),n.markEndSource()}},Ife={name:"moveCellSelectionLeft",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,-1*t.getDirectionFactor()),e.markEndSource()}},Pfe={name:"moveCellSelectionRight",callback(t){const{selection:e}=t;e.markSource("keyboard"),e.transformStart(0,t.getDirectionFactor()),e.markEndSource()}},Nfe={name:"moveCellSelectionToMostBottom",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(t.countRows()-1,-1);i===null&&(i=-1),e.setRangeStart(t._createCellCoords(i,n))}},Dfe={name:"moveCellSelectionToMostBottomInlineEnd",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsBottom,10),o=n.getNearestNotHiddenIndex(t.countRows()-r-1,-1),a=i.getNearestNotHiddenIndex(t.countCols()-1,-1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(o,a)),e.markEndSource()}},Lfe={name:"moveCellSelectionToMostInlineEnd",callback(t){const{selection:e,columnIndexMapper:n}=t;e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(t.getSelectedRangeActive().highlight.row,n.getNearestNotHiddenIndex(t.countCols()-1,-1))),e.markEndSource()}},kfe={name:"moveCellSelectionToMostInlineStart",callback(t){const{selection:e,columnIndexMapper:n}=t,i=parseInt(t.getSettings().fixedColumnsStart,10),r=t.getSelectedRangeActive().highlight.row,o=n.getNearestNotHiddenIndex(i,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(r,o)),e.markEndSource()}},$fe={name:"moveCellSelectionToMostLeft",callback(t){const{selection:e,columnIndexMapper:n}=t,i=t.getSelectedRangeActive().highlight.row;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[t.countCols()-1,-1]:[0,1]);r===null&&(r=t.isRtl()?-1:-t.countRowHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},Vfe={name:"moveCellSelectionToMostRight",callback(t){const{selection:e,columnIndexMapper:n}=t,{row:i}=t.getSelectedRangeActive().highlight;let r=n.getNearestNotHiddenIndex(...t.isRtl()?[0,1]:[t.countCols()-1,-1]);r===null&&(r=t.isRtl()?-t.countRowHeaders():-1),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,r)),e.markEndSource()}},Bfe={name:"moveCellSelectionToMostTop",callback(t){const{selection:e}=t,{col:n}=t.getSelectedRangeActive().highlight;let i=t.rowIndexMapper.getNearestNotHiddenIndex(0,1);i===null&&(i=-t.countColHeaders()),e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(i,n)),e.markEndSource()}},Ffe={name:"moveCellSelectionToMostTopInlineStart",callback(t){const{selection:e,rowIndexMapper:n,columnIndexMapper:i}=t,r=parseInt(t.getSettings().fixedRowsTop,10),o=parseInt(t.getSettings().fixedColumnsStart,10),a=n.getNearestNotHiddenIndex(r,1),u=i.getNearestNotHiddenIndex(o,1);e.markSource("keyboard"),e.setRangeStart(t._createCellCoords(a,u)),e.markEndSource()}},Wfe={name:"moveCellSelectionUp",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.transformStart(-1,0),e.markEndSource()}},jfe={name:"moveCellSelectionUpByViewportHight",callback(t){const{selection:e}=t,{navigableHeaders:n}=t.getSettings(),i=n?t.countColHeaders():0,{row:r}=t.getSelectedRangeActive().highlight;let o=t.countVisibleRows()+i;o=o===0?-1:-o,r===-i?o=-1:r+o<i&&(o=-(r+i)),e.markSource("keyboard"),e.transformStart(o,0),e.markEndSource(),t.getSelectedRangeActive().highlight.row<0&&t.scrollViewportTo({row:0})}};function zfe(){return[Afe,Ofe,xfe,Hfe,Ife,Pfe,Nfe,Dfe,Lfe,kfe,$fe,Vfe,Bfe,Ffe,Wfe,jfe]}const Ufe={name:"emptySelectedCells",callback(t){t.emptySelectedCells(),t._getEditorManager().prepareEditor()}},Yfe={name:"scrollToFocusedCell",callback(t){const{highlight:e}=t.getSelectedRangeActive(),n=t.getFirstFullyVisibleRow()-1,i=t.getFirstFullyVisibleColumn()-1,r=t.getLastFullyVisibleRow()+1,o=t.getLastFullyVisibleColumn()+1,a=t._createCellCoords(n,i),u=t._createCellCoords(r,o);if(!t._createCellRange(a,a,u).includes(e)&&(e.row>=0||e.col>=0)){const d={};if(e.col>=0){const g=Math.floor(t.countVisibleCols()/2);d.col=Math.max(e.col-g,0)}if(e.row>=0){const g=Math.floor(t.countVisibleRows()/2);d.row=Math.max(e.row-g,0)}t.scrollViewportTo({...d,verticalSnap:"top",horizontalSnap:"start"})}}},Gfe={name:"selectAllCells",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!0}),e.markEndSource()}},qfe={name:"selectAllCellsAndHeaders",callback(t){let{selection:e}=t;e.markSource("keyboard"),e.selectAll(!0,!0,{disableHeadersHighlight:!1}),e.markEndSource()}},Kfe={name:"populateSelectedCellsData",callback(t){const e=t.getSelectedRange(),{row:n,col:i}=e[e.length-1].highlight.normalize(),r=t.getDataAtCell(n,i),o=new Map;for(let a=0;a<e.length;a++)e[a].forAll((u,h)=>{if(u>=0&&h>=0&&(u!==n||h!==i)){const{readOnly:d}=t.getCellMeta(u,h);d||o.set(`${u}x${h}`,[u,h,r])}});t.setDataAtCell(Array.from(o.values()))}},Xfe=[...dfe(),...Mfe(),...zfe(),Ufe,Yfe,Gfe,qfe,Kfe];function B5(t){const e={};return Xfe.forEach(n=>{let{name:i,callback:r}=n;e[i]=function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return r(t,...a)}}),e}function Zfe(t){const e=t.getShortcutManager().addContext("editor"),n=B5(t),i={group:Yc};e.addShortcuts([{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Enter","Control/Meta"],["Enter","Control/Meta","Shift"]],captureCtrl:!0,callback:(r,o)=>n.editorCloseAndSaveByEnter(r,o)},{keys:[["Tab"],["Tab","Shift"],["PageDown"],["PageUp"]],forwardToContext:t.getShortcutManager().getContext("grid"),callback:(r,o)=>n.editorCloseAndSave(r,o)},{keys:[["ArrowDown"],["ArrowUp"],["ArrowLeft"],["ArrowRight"]],preventDefault:!1,callback:(r,o)=>n.editorCloseAndSaveByArrowKeys(r,o)},{keys:[["Escape"],["Escape","Control/Meta"]],callback:()=>n.editorCloseWithoutSaving()}],i)}function Qfe(t){const e=t.getShortcutManager().addContext("grid"),n=B5(t),i={runOnlyIf:()=>{const{navigableHeaders:r}=t.getSettings();return Ne(t.getSelected())&&(r||!r&&t.countRenderedRows()>0&&t.countRenderedCols()>0)},group:$5};e.addShortcuts([{keys:[["F2"]],callback:r=>n.editorFastOpen(r)},{keys:[["Enter"],["Enter","Shift"]],callback:(r,o)=>n.editorOpen(r,o)},{keys:[["Backspace"],["Delete"]],callback:()=>n.emptySelectedCells()}],{group:Yc,runOnlyIf:()=>Ne(t.getSelected())}),e.addShortcuts([{keys:[["Control/Meta","A"]],callback:()=>n.selectAllCells(),runOnlyIf:()=>{var r;return!((r=t.getSelectedRangeActive())!==null&&r!==void 0&&r.highlight.isHeader())}},{keys:[["Control/Meta","A"]],callback:()=>{},runOnlyIf:()=>{var r;return(r=t.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight.isHeader()},preventDefault:!0},{keys:[["Control/Meta","Shift","Space"]],callback:()=>n.selectAllCellsAndHeaders()},{keys:[["Control/Meta","Enter"]],callback:()=>n.populateSelectedCellsData(),runOnlyIf:()=>{var r,o;return!((r=t.getSelectedRangeActive())!==null&&r!==void 0&&r.highlight.isHeader())&&((o=t.getSelectedRangeActive())===null||o===void 0?void 0:o.getCellsCount())>1}},{keys:[["Control","Space"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToColumns()},{keys:[["Shift","Space"]],stopPropagation:!0,callback:()=>n.extendCellsSelectionToRows()},{keys:[["ArrowUp"]],callback:()=>n.moveCellSelectionUp()},{keys:[["ArrowUp","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTop()},{keys:[["ArrowUp","Shift"]],callback:()=>n.extendCellsSelectionUp()},{keys:[["ArrowUp","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostTop(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowDown"]],callback:()=>n.moveCellSelectionDown()},{keys:[["ArrowDown","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottom()},{keys:[["ArrowDown","Shift"]],callback:()=>n.extendCellsSelectionDown()},{keys:[["ArrowDown","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostBottom(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByColumnHeader())},{keys:[["ArrowLeft"]],callback:()=>n.moveCellSelectionLeft()},{keys:[["ArrowLeft","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostLeft()},{keys:[["ArrowLeft","Shift"]],callback:()=>n.extendCellsSelectionLeft()},{keys:[["ArrowLeft","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostLeft(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["ArrowRight"]],callback:()=>n.moveCellSelectionRight()},{keys:[["ArrowRight","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostRight()},{keys:[["ArrowRight","Shift"]],callback:()=>n.extendCellsSelectionRight()},{keys:[["ArrowRight","Shift","Control/Meta"]],captureCtrl:!0,callback:()=>n.extendCellsSelectionToMostRight(),runOnlyIf:()=>!(t.selection.isSelectedByCorner()||t.selection.isSelectedByRowHeader())},{keys:[["Home"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["Home","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineStart()},{keys:[["Home","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostTopInlineStart(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["End","Shift"]],callback:()=>n.extendCellsSelectionToMostInlineEnd()},{keys:[["End","Control/Meta"]],captureCtrl:!0,callback:()=>n.moveCellSelectionToMostBottomInlineEnd(),runOnlyIf:()=>t.view.isMainTableNotFullyCoveredByOverlays()},{keys:[["PageUp"]],callback:()=>n.moveCellSelectionUpByViewportHight()},{keys:[["PageUp","Shift"]],callback:()=>n.extendCellsSelectionUpByViewportHeight()},{keys:[["PageDown"]],callback:()=>n.moveCellSelectionDownByViewportHeight()},{keys:[["PageDown","Shift"]],callback:()=>n.extendCellsSelectionDownByViewportHeight()},{keys:[["Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineStart(r)},{keys:[["Shift","Tab"]],preventDefault:!1,callback:r=>n.moveCellSelectionInlineEnd(r)},{keys:[["Control/Meta","Backspace"]],callback:()=>n.scrollToFocusedCell()}],i)}function Jfe(t){[Qfe,Zfe].forEach(e=>e(t))}function DD(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=jU(t),r=jU(t);return i.addEventListener("focus",()=>n?.onFocus("from_above")),r.addEventListener("focus",()=>n?.onFocus("from_below")),e.prepend(i),e.append(r),{focus(o){o==="from_above"?i.focus():r.focus()},activate(){t._registerTimeout(()=>{i.tabIndex=0,r.tabIndex=0},10)},deactivate(){t._registerTimeout(()=>{i.tabIndex=-1,r.tabIndex=-1},10)}}}function jU(t){const n=t.rootDocument.createElement("input");return n.type="text",n.name="htFocusCatcher",n.classList.add("htFocusCatcher"),t.getSettings().ariaTags&&We(n,[Bo("Focus catcher")]),n}function ege(t){return e=>{if(!e)return null;const{rowIndexMapper:n,columnIndexMapper:i}=t;if(n.isHidden(e.row)||i.isHidden(e.col))return null;const r=xH(t),o=HH(t);return e.row=St(e.row,r.row,o.row),e.col=St(e.col,r.col,o.col),e}}function tge(t){const e=ege(t);let n;const{activate:i,deactivate:r}=DD(t,t.rootGridElement,{onFocus(m){if(m==="from_above"){var v;const b=(v=e(n))!==null&&v!==void 0?v:xH(t),C=t.runHooks("modifyFocusOnTabNavigation","from_above",b);b&&C!==!1&&t.selectCell(b.row,b.col)}else{var y;const b=(y=e(n))!==null&&y!==void 0?y:HH(t),C=t.runHooks("modifyFocusOnTabNavigation","from_below",b);b&&C!==!1&&t.selectCell(b.row,b.col)}t.listen()}}),o={wrapped:!1,flipped:!1};let a=!0,u=!1,h=!1;t.addHook("afterListen",()=>{const m=t.getShortcutManager().getActiveContextName(),v=t.getShortcutManager().getContext(m);v?.scope==="table"&&r()}),t.addHook("afterUnlisten",()=>{const m=t.getShortcutManager().getActiveContextName(),v=t.getShortcutManager().getContext(m);v?.scope==="table"&&i()}),t.addHook("afterSelection",(m,v,y,b,C)=>{if(u&&(o.wrapped&&o.flipped||h)&&(h=!1,C.value=!0),a){var T;n=(T=t.getSelectedRangeActive())===null||T===void 0?void 0:T.highlight}}),t.addHook("beforeRowWrap",(m,v,y)=>{o.wrapped=!0,o.flipped=y});function d(){o.wrapped=!1,o.flipped=!1,t.deselectCell(),t.unlisten()}const g={keys:[["Tab"],["Shift","Tab"]],preventDefault:!1,stopPropagation:!1,relativeToGroup:$5,group:"focusCatcher"};t.getShortcutManager().getContext("grid").addShortcuts([{...g,callback:()=>{const{tabNavigation:m}=t.getSettings();u=!0,t.getSelectedRangeActive()&&!m&&(a=!1),m||(h=!0)},position:"before"},{...g,callback:m=>{const{tabNavigation:v,autoWrapRow:y}=t.getSettings();if(u=!1,a=!0,!v||!t.selection.isSelected()||y&&o.wrapped&&o.flipped||!y&&o.wrapped)return y&&o.wrapped&&o.flipped&&(n=m.shiftKey?xH(t):HH(t)),d(),!1;m.preventDefault()},position:"after"}])}function Em(t){cu(t)&&t.scrollIntoView({block:"nearest",inline:"nearest"})}function IR(t){const{selection:e,view:n}=t,i=t.getSelectedRangeActive(),r=e.getSelectionSource(),o=n.getFirstFullyVisibleColumn(),a=n.getLastFullyVisibleColumn(),u=i.getTopStartCorner().col,h=i.getBottomEndCorner().col,d=u<=o,g=h>=a,m=n.getFirstFullyVisibleRow(),v=n.getLastFullyVisibleRow(),y=i.getTopStartCorner().row,b=i.getBottomEndCorner().row,C=y<=m,T=b>=v;return{getComputedColumnTarget(O){return r==="mouse"||r==="keyboard"?O.col:d&&g?i.highlight.col:d?u:g?h:O.col},getComputedRowTarget(O){return r==="mouse"||r==="keyboard"?O.row:C&&T?i.highlight.row:C?y:T?b:O.row}}}function nge(t){return e=>{const n=IR(t).getComputedColumnTarget(e);t.scrollViewportTo({col:n},()=>{const i=!!t.getSettings().colHeaders;Em(t.getCell(i?-1:0,n,!0))})}}function ige(){return()=>{}}function rge(t){return e=>{t.scrollViewportTo(e.toObject(),()=>{const n=t.getSelectedRangeActive();if(!n)return;const{row:i,col:r}=n.highlight;Em(t.getCell(i,r,!0))})}}function oge(t){return e=>{const n=IR(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;Em(t.getCell(r,o,!0))})}}function sge(t){return e=>{const n=IR(t),i={row:n.getComputedRowTarget(e),col:n.getComputedColumnTarget(e)};t.scrollViewportTo(i,()=>{const{row:r,col:o}=i;Em(t.getCell(r,o,!0))})}}function age(t){return e=>{const n=IR(t).getComputedRowTarget(e);t.scrollViewportTo({row:n},()=>{const i=!!t.getSettings().rowHeaders;Em(t.getCell(n,i?-1:0,!0))})}}function lge(t){return e=>{const n=t.selection.getSelectionSource(),{row:i,col:r}=e,o=()=>{Em(t.getCell(i,r,!0))};if(i<0&&r>=0)t.scrollViewportTo({col:r},o);else if(r<0&&i>=0)t.scrollViewportTo({row:i},o);else{if(n==="mouse"&&(r===t.view.getLastPartiallyVisibleColumn()||i===t.view.getLastPartiallyVisibleRow()))return;t.scrollViewportTo({row:i,col:r},o)}}}function uge(t){const{selection:e}=t;let n=!1,i=!1;return{resume(){i=!1},suspend(){i=!0},skipNextScrollCycle(){n=!0},scrollTo(r){var o;if(n||i){n=!1;return}let a;e.isFocusSelectionChanged()?a=rge(t):e.isSelectedByCorner()?a=ige():e.isSelectedByRowHeader()?a=age(t):e.isSelectedByColumnHeader()?a=nge(t):e.getSelectedRange().size()===1&&e.isMultiple()?a=oge(t):e.getSelectedRange().size()===1&&!e.isMultiple()?a=lge(t):e.getSelectedRange().size()>1&&(a=sge(t)),(o=a)===null||o===void 0||o(r)}}}const zU=new Map([[" ","space"],["spacebar","space"],["scroll","scrolllock"],["del","delete"],["esc","escape"],["medianexttrack","mediatracknext"],["mediaprevioustrack","mediatrackprevious"],["volumeup","audiovolumeup"],["volumedown","audiovolumedown"],["volumemute","audiovolumemute"],["multiply","*"],["add","+"],["divide","/"],["subtract","-"],["left","arrowleft"],["right","arrowright"],["up","arrowup"],["down","arrowdown"]]),XS=t=>t.map(e=>{const n=e.toLowerCase();return zU.has(n)?zU.get(n):n}).sort().join("+"),cge=t=>t.split("+"),UU=new Map([[96,"numpad0"],[97,"numpad1"],[98,"numpad2"],[99,"numpad3"],[100,"numpad4"],[101,"numpad5"],[102,"numpad6"],[103,"numpad7"],[104,"numpad8"],[105,"numpad9"],[106,"multiply"],[107,"add"],[108,"decimal"],[109,"subtract"],[110,"decimal"],[111,"divide"],[112,"f1"],[113,"f2"],[114,"f3"],[115,"f4"],[116,"f5"],[117,"f6"],[118,"f7"],[119,"f8"],[120,"f9"],[121,"f10"],[122,"f11"],[123,"f12"],[186,"semicolon"],[187,"equal"],[188,"comma"],[189,"minus"],[190,"period"],[191,"slash"],[192,"backquote"],[219,"bracketleft"],[220,"backslash"],[221,"bracketright"],[222,"quote"]]),jA=t=>{let{which:e,key:n}=t;if(UU.has(e))return UU.get(e);const i=String.fromCharCode(e).toLowerCase();return/^[a-z0-9]$/.test(i)?i:n.toLowerCase()},F5=Symbol("shortcut-context");function UH(t){return Qe(t)&&t.__kindOf===F5}const hge=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const n=CR({errorIdExists:d=>`The "${d}" shortcut is already registered in the "${t}" context.`}),i=function(){let{keys:d,callback:g,group:m,runOnlyIf:v=()=>!0,captureCtrl:y=!1,preventDefault:b=!0,stopPropagation:C=!1,relativeToGroup:T,position:O,forwardToContext:A}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if($n(m))throw new Error("You need to define the shortcut's group.");if(Yt(g)===!1)throw new Error("The shortcut's callback needs to be a function.");if(Array.isArray(d)===!1)throw new Error(Ft`Pass the shortcut\'s keys as an array of arrays,\x20
      using the KeyboardEvent.key properties:\x20
      https://developer.mozilla.org/en-US/docs/Web/API/KeyboardEvent/key/Key_Values.`);const N={callback:g,group:m,runOnlyIf:v,captureCtrl:y,preventDefault:b,stopPropagation:C};Ne(T)&&(N.relativeToGroup=T,N.position=O),UH(A)&&(N.forwardToContext=A),d.forEach(x=>{const $=XS(x);if(n.hasItem($)){const P=n.getItem($);let Q=P.findIndex(ue=>ue.group===T);Q!==-1?O==="before"?Q-=1:Q+=1:Q=P.length,P.splice(Q,0,N)}else n.addItem($,[N])})},r=function(d){let g=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};d.forEach(m=>{wt(g,(v,y)=>{Object.prototype.hasOwnProperty.call(m,y)===!1&&(m[y]=g[y])}),i(m)})},o=d=>{const g=XS(d);n.removeItem(g)};return{__kindOf:F5,scope:e,addShortcut:i,addShortcuts:r,getShortcuts:d=>{const g=XS(d),m=n.getItem(g);return Ne(m)?m.slice():[]},hasShortcut:d=>{const g=XS(d);return n.hasItem(g)},removeShortcutsByKeys:o,removeShortcutsByGroup:d=>{n.getItems().forEach(m=>{let[v,y]=m;const b=y.filter(C=>C.group!==d);b.length===0?o(cge(v)):(y.length=0,y.push(...b))})}}};function dge(){const t=new Set;return{press(e){t.add(e)},release(e){t.delete(e)},releaseAll(){t.clear()},isPressed(e){return t.has(e)}}}const fge=["meta","alt","shift","control"],zp=dge(),Up=[];let ZS=0;function gge(t,e,n,i,r){const o=y=>fge.includes(y),a=function(y){let b=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const C=[];return y.altKey&&C.push("alt"),b&&(y.ctrlKey||y.metaKey)?C.push("control/meta"):(y.ctrlKey&&C.push("control"),y.metaKey&&C.push("meta")),y.shiftKey&&C.push("shift"),C},u=y=>{if(e(y)===!1||n(y)===!1||y.keyCode===229||typeof y.key!="string"||rd(y))return;const C=jA(y);let T=[];o(C)||(T=a(y));const O=[C].concat(T);!r(y,O)&&(rz()&&T.includes("meta")||!rz()&&T.includes("control"))&&r(y,[C].concat(a(y,!0))),i(y)},h=y=>{if(typeof y.key=="string"){const b=jA(y);o(b)&&zp.press(b)}},d=y=>{if(typeof y.key=="string"){const b=jA(y);o(b)&&zp.release(b)}},g=()=>{zp.releaseAll()};return{mount:()=>{let y=t;for(ZS+=1;y;)ZS===1&&(y.document.documentElement.addEventListener("keydown",h),Up.push({event:"keydown",listener:h}),y.document.documentElement.addEventListener("keyup",d),Up.push({event:"keyup",listener:d})),y.document.documentElement.addEventListener("keydown",u),y.document.documentElement.addEventListener("blur",g),y=Zg(y)},unmount:()=>{let y=t;for(ZS-=1;y;){if(ZS===0){for(let b=0;b<Up.length;b++){const{event:C,listener:T}=Up[b];y.document.documentElement.removeEventListener(C,T)}Up.length=0}y.document.documentElement.removeEventListener("keydown",u),y.document.documentElement.removeEventListener("blur",g),y=Zg(y)}},isPressed:y=>zp.isPressed(y),releasePressedKeys:()=>zp.releaseAll()}}const mge=t=>{let{ownerWindow:e,handleEvent:n,beforeKeyDown:i,afterKeyDown:r}=t;const o=CR({errorIdExists:C=>`The "${C}" context name is already registered.`});let a="grid";const u=function(C){let T=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"table";const O=hge(C,T);return o.addItem(C,O),O},h=()=>a,d=C=>o.getItem(C),g=C=>{if(!o.hasItem(C))throw new Error(Ft`You've tried to activate the "${C}" shortcut context\x20
        that does not exist. Before activation, register the context using the "addContext" method.`);a=C};let m=!1;const v=function(C,T){let O=arguments.length>2&&arguments[2]!==void 0?arguments[2]:h();const A=UH(O)?O:d(O);let N=!1;if(!A.hasShortcut(T))return N;const x=A.getShortcuts(T);for(let $=0;$<x.length;$++){const{callback:L,runOnlyIf:P,preventDefault:Q,stopPropagation:ue,captureCtrl:X,forwardToContext:me}=x[$];if(P(C)===!0){if(m=X,N=L(C,T)===!1,m=!1,Q&&C.preventDefault(),ue&&(ma(C),C.stopPropagation()),N)break;me&&v(C,T,me)}}return N},b=gge(e,C=>{const T=h(),O=UH(T)?T:d(T);return n(C,O.scope)},i,r,v);return b.mount(),{addContext:u,getActiveContextName:h,getContext:d,setActiveContextName:g,isCtrlPressed:()=>!m&&(b.isPressed("control")||b.isPressed("meta")),releasePressedKeys:()=>b.releasePressedKeys(),destroy:()=>b.unmount()}};function YU(t){const{classNames:e}=Lse(t,/ht-theme-[a-zA-Z0-9_-]+/);return e.pop()}function pge(t,e){W5(t,e),e.add(t)}function Qu(t,e,n){W5(t,e),e.set(t,n)}function W5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Qn(t,e){return t.get(ia(t,e))}function Po(t,e,n){return t.set(ia(t,e),n),n}function ia(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const GU=23;var _a=new WeakMap,o0=new WeakMap,LD=new WeakMap,YH=new WeakMap,vc=new WeakMap,Av=new WeakMap,mw=new WeakMap,Yp=new WeakMap,ja=new WeakSet;class vge{constructor(e){let{rootElement:n,rootDocument:i,onThemeChange:r=()=>{}}=e;pge(this,ja),Qu(this,_a,void 0),Qu(this,o0,void 0),Qu(this,LD,void 0),Qu(this,YH,void 0),Qu(this,vc,!0),Qu(this,Av,{}),Qu(this,mw,{}),Qu(this,Yp,void 0),Po(o0,this,n),Po(YH,this,i),Po(Yp,this,r)}isClassicTheme(){return Qn(vc,this)}getCSSVariableValue(e){var n;if(Qn(vc,this))return null;if(Qn(Av,this)[`--ht-${e}`])return Qn(Av,this)[`--ht-${e}`];const i=(n=ia(ja,this,Sge).call(this,`--ht-${e}`))!==null&&n!==void 0?n:ia(ja,this,j5).call(this,`--ht-${e}`);if(i!==null)return Qn(Av,this)[`--ht-${e}`]=i,i}getStyleForTD(e){var n;return(n=Qn(mw,this))===null||n===void 0?void 0:n.td[e]}getDefaultRowHeight(){if(Qn(vc,this))return GU;const e=ia(ja,this,wge).call(this);return e||GU}areCellsBorderBox(){return this.getStyleForTD("box-sizing")==="border-box"}useTheme(e){if(!e){Po(_a,this,void 0),Po(vc,this,!0),Qn(Yp,this).call(this,Qn(_a,this)),ia(ja,this,zA).call(this);return}if(e&&e!==Qn(_a,this)){if(!/ht-theme-.*/.test(e)){_t(`Invalid theme name: ${e}. Please provide a valid theme name.`),Po(_a,this,void 0),Po(vc,this,!1),Qn(Yp,this).call(this,Qn(_a,this)),ia(ja,this,zA).call(this);return}Qn(_a,this)&&ia(ja,this,bge).call(this),Po(_a,this,e),Po(vc,this,!1),Qn(Yp,this).call(this,Qn(_a,this)),ia(ja,this,zA).call(this)}}getThemeName(){return Qn(_a,this)}}function wge(){const t=this.getCSSVariableValue("line-height"),e=this.getCSSVariableValue("cell-vertical-padding"),n=Math.ceil(parseFloat(this.getStyleForTD("border-bottom-width")));return t===null||e===null||isNaN(n)?null:t+2*e+n}function zA(){this.isClassicTheme()||Po(LD,this,getComputedStyle(Qn(o0,this)));const t=ia(ja,this,yge).call(this,["box-sizing","border-bottom-width"]);Qn(mw,this).td={...Qn(mw,this).td,"box-sizing":t["box-sizing"],"border-bottom-width":t["border-bottom-width"]}}function yge(t){const e=Qn(YH,this),n=Qn(o0,this),i=e.createElement("table"),r=e.createElement("tbody"),o=e.createElement("tr"),a=e.createElement("tr"),u=e.createElement("td");a.appendChild(u),r.appendChild(o),r.appendChild(a),i.appendChild(r),n.appendChild(i);const h=getComputedStyle(u),d={};return t.forEach(g=>{d[g]=h.getPropertyValue(g)}),n.removeChild(i),d}function Sge(t){const e=Math.ceil(parseFloat(ia(ja,this,j5).call(this,t)));return Number.isNaN(e)?null:e}function j5(t){const e=Qn(LD,this).getPropertyValue(t);return e===""?null:e}function bge(){Po(mw,this,{}),Po(Av,this,{}),Po(vc,this,!0)}function Cge(t,e){z5(t,e),e.add(t)}function qU(t,e,n){z5(t,e),e.set(t,n)}function z5(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function KU(t,e){return t.get(tm(t,e))}function XU(t,e,n){return t.set(tm(t,e),n),n}function tm(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var GH=new WeakMap,qH=new WeakMap,Vv=new WeakSet;class Rge{constructor(e){let{rowIndexMapper:n,columnIndexMapper:i}=e;Cge(this,Vv),qU(this,GH,void 0),qU(this,qH,void 0),XU(GH,this,n),XU(qH,this,i)}toRenderable(e){const n=e.getVerticalDirection()==="N-S"?1:-1,i=e.getHorizontalDirection()==="W-E"?1:-1,r=tm(Vv,this,ZU).call(this,e.from,n,i);if(r===null)return null;const o=tm(Vv,this,ZU).call(this,e.to,-n,-i);if(o===null)return null;const a=e.clone();return a.from=r,a.to=o,a.includes(e.highlight)||(a.highlight=r),a}}function ZU(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:e;const i=tm(Vv,this,QU).call(this,KU(GH,this),t.row,e);if(i===null)return null;const r=tm(Vv,this,QU).call(this,KU(qH,this),t.col,n);return r===null?null:t.clone().assign({row:i,col:r})}function QU(t,e,n){return e<0?e:t.getNearestNotHiddenIndex(e,n)}let Vo=null,SC=0;function Ege(t){const e=t.ownerDocument;if(!Vo){Vo=e.createElement("div"),Vo.setAttribute("role","status"),Vo.setAttribute("aria-live","assertive"),Vo.setAttribute("aria-atomic","true");const n=Vo.style;n.position="absolute",n.width="1px",n.height="1px",n.margin="-1px",n.overflow="hidden",n.clipPath="rect(0 0 0 0)",n.whiteSpace="nowrap",t.appendChild(Vo)}SC+=1}function Tge(){SC!==0&&(SC===1&&(Vo.remove(),Vo=null),SC-=1)}function _ge(t){Vo&&(Vo.textContent="",setTimeout(()=>{Vo&&(Vo.textContent=t)},100))}let UA=null;const QS=new WeakSet,YA=new Map;function U5(t,e){var n,i,r=this;let o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,a=this;const u=new da(a);let h,d,g,m,v,y,b=!0;const C={...e.initialState,...e};Uce(o)&&zce(this),this.rootContainer=t,this.rootWrapperElement=void 0,this.rootGridElement=void 0,this.rootPortalElement=void 0,this.rootElement=Qh(this)?t.ownerDocument.createElement("div"):t,this.rootDocument=t.ownerDocument,this.rootWindow=this.rootDocument.defaultView,Qh(this)&&(this.rootWrapperElement=this.rootDocument.createElement("div"),this.rootGridElement=this.rootDocument.createElement("div"),this.rootPortalElement=this.rootDocument.createElement("div"),fe(this.rootElement,["ht-wrapper","handsontable"]),fe(this.rootWrapperElement,"ht-root-wrapper"),fe(this.rootGridElement,"ht-grid"),this.rootGridElement.appendChild(this.rootElement),this.rootWrapperElement.appendChild(this.rootGridElement),this.rootContainer.appendChild(this.rootWrapperElement),fe(this.rootPortalElement,"ht-portal"),this.rootDocument.body.appendChild(this.rootPortalElement)),this.isDestroyed=!1,this.renderSuspendedCounter=0,this.executionSuspendedCounter=0;const T=(n=C?.layoutDirection)!==null&&n!==void 0?n:"inherit",O=["rtl","ltr"].includes(T)?T:this.rootWindow.getComputedStyle(this.rootElement).direction;this.rootElement.setAttribute("dir",O),(i=this.rootWrapperElement)===null||i===void 0||i.setAttribute("dir",O),this.isRtl=function(){return O==="rtl"},this.isLtr=function(){return!a.isRtl()},this.getDirectionFactor=function(){return a.isLtr()?1:-1},this.stylesHandler=new vge({rootElement:a.rootElement,rootDocument:a.rootDocument,onThemeChange:S=>{Qh(this)&&(Ve(this.rootWrapperElement,/ht-theme-.*/g),Ve(this.rootPortalElement,/ht-theme-.*/g),S&&(fe(this.rootWrapperElement,S),fe(this.rootPortalElement,S),getComputedStyle(this.rootWrapperElement).getPropertyValue("--ht-line-height")||_t(`The "${S}" theme is enabled, but its stylesheets are missing or not imported correctly.               Import the correct CSS files in order to use that theme.`)))}}),C.language=Whe(C.language);const A=Object.fromEntries(Object.entries(C).filter(S=>{let[E]=S;return!(He.getSingleton().isRegistered(E)||He.getSingleton().isDeprecated(E))})),N=new k5(a,A,[qde,tfe]),x=N.getTableMeta(),$=N.getGlobalMeta(),L=CR();this.container=this.rootDocument.createElement("div"),this.rootElement.insertBefore(this.container,this.rootElement.firstChild),this.guid=`ht_${l4()}`,YA.set(this.guid,this),this.columnIndexMapper=new WH,this.rowIndexMapper=new WH,this.columnIndexMapper.addLocalHook("indexesSequenceChange",S=>{a.runHooks("afterColumnSequenceChange",S)}),this.rowIndexMapper.addLocalHook("indexesSequenceChange",S=>{a.runHooks("afterRowSequenceChange",S)}),u.addEventListener(this.rootDocument.documentElement,"compositionstart",S=>{a.runHooks("beforeCompositionStart",S)}),d=new she(a);const P=Ps(this.guid);P.register("cellRangeMapper",new Rge({rowIndexMapper:this.rowIndexMapper,columnIndexMapper:this.columnIndexMapper})),(!this.rootElement.id||this.rootElement.id.substring(0,3)==="ht_")&&(this.rootElement.id=this.guid);const Q=S=>{const{row:E,col:M}=S;return a._createCellCoords(E>=0?a.rowIndexMapper.getRenderableFromVisualIndex(E):E,M>=0?a.columnIndexMapper.getRenderableFromVisualIndex(M):M)},ue=S=>{const{row:E,col:M}=S;return a._createCellCoords(E>=0?a.rowIndexMapper.getVisualFromRenderableIndex(E):E,M>=0?a.columnIndexMapper.getVisualFromRenderableIndex(M):M)},X=(S,E)=>{const M=E>S?1:-1,F=Math.min(S,E),q=Math.max(S,E),J=a.rowIndexMapper.getNearestNotHiddenIndex(S,M);return J===null||M===1&&J>q||M===-1&&J<F?null:J>=0?a.rowIndexMapper.getRenderableFromVisualIndex(J):J},me=(S,E)=>{const M=E>S?1:-1,F=Math.min(S,E),q=Math.max(S,E),J=a.columnIndexMapper.getNearestNotHiddenIndex(S,M);return J===null||M===1&&J>q||M===-1&&J<F?null:J>=0?a.columnIndexMapper.getRenderableFromVisualIndex(J):J};let re=new N5(x,{rowIndexMapper:a.rowIndexMapper,columnIndexMapper:a.columnIndexMapper,countCols:()=>a.countCols(),countRows:()=>a.countRows(),propToCol:S=>h.propToCol(S),isEditorOpened:()=>a.getActiveEditor()?a.getActiveEditor().isOpened():!1,countRenderableColumns:()=>this.view.countRenderableColumns(),countRenderableRows:()=>this.view.countRenderableRows(),countRowHeaders:()=>this.countRowHeaders(),countColHeaders:()=>this.countColHeaders(),countRenderableRowsInRange:function(){return r.view.countRenderableRowsInRange(...arguments)},countRenderableColumnsInRange:function(){return r.view.countRenderableColumnsInRange(...arguments)},getShortcutManager:()=>a.getShortcutManager(),createCellCoords:(S,E)=>a._createCellCoords(S,E),createCellRange:(S,E,M)=>a._createCellRange(S,E,M),visualToRenderableCoords:Q,renderableToVisualCoords:ue,findFirstNonHiddenRenderableRow:X,findFirstNonHiddenRenderableColumn:me,isDisabledCellSelection:(S,E)=>S<0||E<0?a.getSettings().disableVisualSelection:a.getCellMeta(S,E).disableVisualSelection});this.selection=re;const Se=S=>{let{hiddenIndexesChanged:E}=S;this.forceFullRender=!0,E&&this.selection.commit()};this.columnIndexMapper.addLocalHook("cacheUpdated",Se),this.rowIndexMapper.addLocalHook("cacheUpdated",Se),this.selection.addLocalHook("afterSetRangeEnd",(S,E)=>{const M=Wo(!1),F=this.selection.getSelectedRange(),{from:q,to:J}=F.current(),_=F.size()-1;this.runHooks("afterSelection",q.row,q.col,J.row,J.col,M,_),this.runHooks("afterSelectionByProp",q.row,a.colToProp(q.col),J.row,a.colToProp(J.col),M,_),E&&(!M.isTouched()||M.isTouched()&&!M.value)&&y.scrollTo(S);const I=re.isSelectedByRowHeader(),k=re.isSelectedByColumnHeader();I&&k?fe(this.rootElement,["ht__selection--rows","ht__selection--columns"]):I?(Ve(this.rootElement,"ht__selection--columns"),fe(this.rootElement,"ht__selection--rows")):k?(Ve(this.rootElement,"ht__selection--rows"),fe(this.rootElement,"ht__selection--columns")):Ve(this.rootElement,["ht__selection--rows","ht__selection--columns"]),["shift","refresh"].includes(re.getSelectionSource())||m.closeEditor(null),re.getSelectionSource()!=="refresh"&&(a.view.render(),m.prepareEditor())}),this.selection.addLocalHook("beforeSetFocus",S=>{this.runHooks("beforeSelectionFocusSet",S.row,S.col)}),this.selection.addLocalHook("afterSetFocus",S=>{const E=Wo(!1);this.runHooks("afterSelectionFocusSet",S.row,S.col,E),(!E.isTouched()||E.isTouched()&&!E.value)&&y.scrollTo(S),m.closeEditor(),a.view.render(),m.prepareEditor()}),this.selection.addLocalHook("afterSelectionFinished",S=>{const E=S.length-1,{from:M,to:F}=S[E];this.runHooks("afterSelectionEnd",M.row,M.col,F.row,F.col,E),this.runHooks("afterSelectionEndByProp",M.row,a.colToProp(M.col),F.row,a.colToProp(F.col),E),re.getSelectionSource()==="refresh"&&(a.view.render(),m.prepareEditor())}),this.selection.addLocalHook("afterIsMultipleSelection",S=>{const E=this.runHooks("afterIsMultipleSelection",S.value);S.value&&(S.value=E)}),this.selection.addLocalHook("afterDeselect",()=>{m.closeEditor(),a.view.render(),Ve(this.rootElement,["ht__selection--rows","ht__selection--columns"]),this.runHooks("afterDeselect")}),this.selection.addLocalHook("beforeHighlightSet",()=>this.runHooks("beforeSelectionHighlightSet")).addLocalHook("beforeSetRangeStart",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("beforeSetRangeStart",...E)}).addLocalHook("beforeSetRangeStartOnly",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("beforeSetRangeStartOnly",...E)}).addLocalHook("beforeSetRangeEnd",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("beforeSetRangeEnd",...E)}).addLocalHook("beforeSelectColumns",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("beforeSelectColumns",...E)}).addLocalHook("afterSelectColumns",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("afterSelectColumns",...E)}).addLocalHook("beforeSelectRows",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("beforeSelectRows",...E)}).addLocalHook("afterSelectRows",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("afterSelectRows",...E)}).addLocalHook("beforeSelectAll",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("beforeSelectAll",...E)}).addLocalHook("afterSelectAll",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("afterSelectAll",...E)}).addLocalHook("beforeModifyTransformStart",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("modifyTransformStart",...E)}).addLocalHook("afterModifyTransformStart",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("afterModifyTransformStart",...E)}).addLocalHook("beforeModifyTransformFocus",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("modifyTransformFocus",...E)}).addLocalHook("afterModifyTransformFocus",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("afterModifyTransformFocus",...E)}).addLocalHook("beforeModifyTransformEnd",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("modifyTransformEnd",...E)}).addLocalHook("afterModifyTransformEnd",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("afterModifyTransformEnd",...E)}).addLocalHook("beforeRowWrap",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("beforeRowWrap",...E)}).addLocalHook("beforeColumnWrap",function(){for(var S=arguments.length,E=new Array(S),M=0;M<S;M++)E[M]=arguments[M];return r.runHooks("beforeColumnWrap",...E)}).addLocalHook("insertRowRequire",S=>this.alter("insert_row_above",S,1,"auto")).addLocalHook("insertColRequire",S=>this.alter("insert_col_start",S,1,"auto")),g={alter(S,E){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,F=arguments.length>3?arguments[3]:void 0,q=arguments.length>4?arguments[4]:void 0;const J=_=>{if(_.length===0)return[];const I=[..._];return I.sort((W,D)=>{let[z]=W,[Z]=D;return z===Z?0:z>Z?1:-1}),ho(I,(W,D)=>{let[z,Z]=D;const j=W[W.length-1],[K,ne]=j,ee=K+ne;if(z<=ee){const ce=Math.max(Z-(ee-z),0);j[1]+=ce}else W.push([z,Z]);return W},[I[0]])};switch(S){case"insert_row_below":case"insert_row_above":const _=a.countSourceRows();if(x.maxRows===_)return;const I=S==="insert_row_below"?"below":"above";E=E??(I==="below"?_:0);const{delta:k,startPhysicalIndex:W}=h.createRow(E,M,{source:F,mode:I});re.shiftRows(a.toVisualRow(W),k);break;case"insert_col_start":case"insert_col_end":const D=S==="insert_col_end"?"end":"start";E=E??(D==="end"?a.countSourceCols():0);const{delta:z,startPhysicalIndex:Z}=h.createCol(E,M,{source:F,mode:D});if(z){if(Array.isArray(x.colHeaders)){const ne=[a.toVisualColumn(Z),0];ne.length+=z,Array.prototype.splice.apply(x.colHeaders,ne)}re.shiftColumns(a.toVisualColumn(Z),z)}break;case"remove_row":const j=ne=>{let ee=0;U(ne,ce=>{let[Re,Ae]=ce;const Le=ni(Re)?a.countRows()-1:Math.max(Re-ee,0);if(Number.isInteger(Re)&&(Re=Math.max(Re-ee,0)),!h.removeRow(Re,Ae,F))return;if(re.isSelected()){const{row:Ct}=a.getSelectedRangeActive().highlight;Ct>=Re&&Ct<=Re+Ae-1&&m.closeEditor(!0)}const bt=a.countRows(),Ze=x.fixedRowsTop;Ze>=Le+1&&(x.fixedRowsTop-=Math.min(Ae,Ze-Le));const Je=x.fixedRowsBottom;if(Je&&Le>=bt-Je&&(x.fixedRowsBottom-=Math.min(Ae,Je)),bt===0)re.deselect();else if(F==="ContextMenu.removeRow"){const Ct=re.getSelectedRange(),Gn=Ct.pop();Ct.clear().set(Gn.from).current().setTo(Gn.to),re.refresh()}else re.shiftRows(Re,-Ae);ee+=Ae})};Array.isArray(E)?j(J(E)):j([[E,M]]);break;case"remove_col":const K=ne=>{let ee=0;U(ne,ce=>{let[Re,Ae]=ce;const Le=ni(Re)?a.countCols()-1:Math.max(Re-ee,0);let it=a.toPhysicalColumn(Le);if(Number.isInteger(Re)&&(Re=Math.max(Re-ee,0)),!h.removeCol(Re,Ae,F))return;if(re.isSelected()){const{col:Ct}=a.getSelectedRangeActive().highlight;Ct>=Re&&Ct<=Re+Ae-1&&m.closeEditor(!0)}if(a.countCols()===0)re.deselect();else if(F==="ContextMenu.removeColumn"){const Ct=re.getSelectedRange(),Gn=Ct.pop();Ct.clear().set(Gn.from).current().setTo(Gn.to),re.refresh()}else re.shiftColumns(Re,-Ae);const Je=x.fixedColumnsStart;Je>=Le+1&&(x.fixedColumnsStart-=Math.min(Ae,Je-Le)),Array.isArray(x.colHeaders)&&(typeof it>"u"&&(it=-1),x.colHeaders.splice(it,Ae)),ee+=Ae})};Array.isArray(E)?K(J(E)):K([[E,M]]);break;default:throw new Error(`There is no such action "${S}"`)}q||g.adjustRowsAndCols(),a.view.adjustElementsSize(),a.view.render()},adjustRowsAndCols(){const S=x.minRows,E=x.minSpareRows,M=x.minCols,F=x.minSpareCols;if(S){const q=a.countRows();q<S&&h.createRow(q,S-q,{source:"auto"})}if(E){const q=a.countEmptyRows(!0);if(q<E){const J=E-q,_=Math.min(J,x.maxRows-a.countSourceRows());h.createRow(a.countRows(),_,{source:"auto"})}}{let q;(M||F)&&(q=a.countEmptyCols(!0));let J=a.countCols();if(M&&!x.columns&&J<M){const _=M-J;q+=_,h.createCol(J,_,{source:"auto"})}if(F&&!x.columns&&a.dataType==="array"&&q<F){J=a.countCols();const _=F-q,I=Math.min(_,x.maxCols-J);h.createCol(J,I,{source:"auto"})}}},populateFromArray(S,E,M,F,q){let J,_,I,k;const W=[],D={},z=[],Z=S.row,j=S.col;if(_=E.length,_===0)return!1;let K=0,ne=0;switch(Qe(M)&&(K=M.col-j+1,ne=M.row-Z+1),q){case"shift_down":const ce=fC(E),Re=ce.length,Ae=Math.max(Re,K),Le=a.getData().slice(Z),it=fC(Le).slice(j,j+Ae);for(I=0;I<Ae;I+=1)if(I<Re){for(J=0,_=ce[I].length;J<ne-_;J+=1)ce[I].push(ce[I][J%_]);I<it.length?z.push(ce[I].concat(it[I])):z.push(ce[I].concat(new Array(Le.length).fill(null)))}else z.push(ce[I%Re].concat(it[I]));a.populateFromArray(Z,j,fC(z));break;case"shift_right":const bt=E.length,Ze=Math.max(bt,ne),Je=a.getData().slice(Z).map(nt=>nt.slice(j));for(J=0;J<Ze;J+=1)if(J<bt){for(I=0,k=E[J].length;I<K-k;I+=1)E[J].push(E[J][I%k]);if(J<Je.length)for(let nt=0;nt<Je[J].length;nt+=1)E[J].push(Je[J][nt]);else E[J].push(...new Array(Je[0].length).fill(null))}else E.push(E[J%_].slice(0,Ze).concat(Je[J]));a.populateFromArray(Z,j,E);break;case"overwrite":default:D.row=S.row,D.col=S.col;let Ct=0,Gn=0,Zi=!0,Qi;const Rn=function(Lt){let Lr=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;const Ds=E[Lt%E.length];return Lr!==null?Ds[Lr%Ds.length]:Ds},un=E.length,Mt=M?M.row-S.row+1:0;for(M?_=Mt:_=Math.max(un,Mt),J=0;J<_&&!(M&&D.row>M.row&&Mt>un||!x.allowInsertRow&&D.row>a.countRows()-1||D.row>=x.maxRows);J++){const nt=J-Ct,Lt=Rn(nt).length,Lr=M?M.col-S.col+1:0;if(M?k=Lr:k=Math.max(Lt,Lr),D.col=S.col,Qi=a.getCellMeta(D.row,D.col),(F==="CopyPaste.paste"||F==="Autofill.fill")&&Qi.skipRowOnPaste){Ct+=1,D.row+=1,_+=1;continue}for(Gn=0,I=0;I<k;I++){var ee;if(M&&D.col>M.col&&Lr>Lt||!x.allowInsertColumn&&D.col>a.countCols()-1||D.col>=x.maxCols)break;if(Qi=a.getCellMeta(D.row,D.col),(F==="CopyPaste.paste"||F==="Autofill.fill")&&Qi.skipColumnOnPaste){Gn+=1,D.col+=1,k+=1;continue}if(Qi.readOnly&&F!=="UndoRedo.undo"){D.col+=1;continue}const Ds=I-Gn,wr=!!Qi.valueSetter;let qn=Rn(nt,Ds),pi=(ee=a.getSourceDataAtCell(D.row,D.col))!==null&&ee!==void 0?ee:null;if(qn!==null&&typeof qn=="object"){if(Array.isArray(qn)&&pi===null&&(pi=[]),!wr&&(typeof pi!="object"||pi===null))Zi=!1;else if(pi!==null){const Wi=hw(Array.isArray(pi)?pi:pi[0]||pi),Ls=hw(Array.isArray(qn)?qn:qn[0]||qn);wr||pR(Wi,Ls)||Array.isArray(Wi)&&Array.isArray(Ls)?qn=Nr(qn):Zi=!1}}else!wr&&pi!==null&&typeof pi=="object"&&(Zi=!1);Zi&&W.push([D.row,D.col,qn]),Zi=!0,D.col+=1}D.row+=1}a.setDataAtCell(W,null,null,F||"populateFromArray");break}}};function we(S){const E=S5(S);HD(E)?(a.runHooks("beforeLanguageChange",E),$.language=E,a.runHooks("afterLanguageChange",E)):b5(S)}function _e(S,E){const M=S==="className"?a.rootElement:a.table;if(b)fe(M,E);else{let F=[],q=[];$[S]&&(F=Array.isArray($[S])?$[S]:qj($[S])),E&&(q=Array.isArray(E)?E:qj(E));const J=Gj(F,q),_=Gj(q,F);J.length&&Ve(M,J),_.length&&fe(M,_)}$[S]=E}this.init=function(){d.setData(x.data),a.runHooks("beforeInit"),(el()||S4())&&fe(a.rootElement,"mobile"),this.updateSettings(C,!0),this.view=new Kce(this),m=kH.getInstance(a,x,re),y=uge(a),v=new Tae(a),Qh(this)&&(tge(a),Ege(a.rootPortalElement),Goe(C.licenseKey,this.rootWrapperElement)),a.runHooks("init"),this.render(),b&&a.rootElement.offsetParent===null&&Use(a.rootElement,()=>{a.view._wt.wtOverlays.updateLastSpreaderSize(),a.view.adjustElementsSize(),a.render()}),typeof b=="object"&&(a.runHooks("afterChange",b[0],b[1]),b=!1),a.runHooks("afterInit")};function ie(){let S=!1;return{validatorsInQueue:0,valid:!0,addValidatorToQueue(){this.validatorsInQueue+=1,S=!1},removeValidatorFormQueue(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty(){},checkIfQueueIsEmpty(){this.validatorsInQueue===0&&S===!1&&(S=!0,this.onQueueEmpty(this.valid))}}}function de(S,E,M){if(!S.length){M();return}const F=a.getActiveEditor(),q=new ie;let J=!0;q.onQueueEmpty=()=>{F&&J&&F.cancelChanges(),M()};for(let _=S.length-1;_>=0;_--){const[I,k,,W]=S[_],D=h.propToCol(k);let z;Number.isInteger(D)?z=a.getCellMeta(I,D):z={...Object.getPrototypeOf(x),...x},a.getCellValidator(z)&&(q.addValidatorToQueue(),a.validateCell(W,z,(function(Z,j){return function(K){if(typeof K!="boolean")throw new Error("Validation error: result is not boolean");K===!1&&j.allowInvalid===!1&&(J=!1,S.splice(Z,1),j.valid=!0),q.removeValidatorFormQueue()}})(_,z),E))}q.checkIfQueueIsEmpty()}function Te(S,E){for(let F=S.length-1;F>=0;F--){let q=!1;if(S[F]===null){S.splice(F,1);continue}if(!((S[F][2]===null||S[F][2]===void 0)&&(S[F][3]===null||S[F][3]===void 0))){if(x.allowInsertRow)for(;S[F][0]>a.countRows()-1;){const{delta:J}=h.createRow(void 0,void 0,{source:"auto"});if(J===0){q=!0;break}}if(a.dataType==="array"&&(!x.columns||x.columns.length===0)&&x.allowInsertColumn)for(;h.propToCol(S[F][1])>a.countCols()-1;){const{delta:J}=h.createCol(void 0,void 0,{source:"auto"});if(J===0){q=!0;break}}q||h.set(S[F][0],S[F][1],S[F][3])}}if(S.length>0){g.adjustRowsAndCols(),a.runHooks("beforeChangeRender",S,E),m.closeEditor(),a.view.adjustElementsSize(),a.render(),m.prepareEditor(),a.runHooks("afterChange",S,E||"edit");const F=a.getActiveEditor();F&&Ne(F.refreshValue)&&F.refreshValue()}else a.render()}this._createCellCoords=function(S,E){return a.view._wt.createCellCoords(S,E)},this._createCellRange=function(S,E,M){return a.view._wt.createCellRange(S,E,M)},this.validateCell=function(S,E,M,F){let q=a.getCellValidator(E);function J(_){if(!(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0)||E.hidden===!0){M(_);return}const k=E.visualCol,W=E.visualRow,D=a.getCell(W,k,!0);if(D&&D.nodeName!=="TH"){const z=a.rowIndexMapper.getRenderableFromVisualIndex(W),Z=a.columnIndexMapper.getRenderableFromVisualIndex(k);a.view._wt.getSetting("cellRenderer",z,Z,D)}M(_)}zoe(q)&&(q=(function(_){return function(I,k){k(_.test(I))}})(q)),Yt(q)?(S=a.runHooks("beforeValidate",S,E.visualRow,E.prop,F),a._registerImmediate(()=>{q.call(E,S,_=>{a&&(_=a.runHooks("afterValidate",_,S,E.visualRow,E.prop,F),E.valid=_,J(_),a.runHooks("postAfterValidate",_,S,E.visualRow,E.prop,F))})})):a._registerImmediate(()=>{E.valid=!0,J(E.valid,!1)})};function Pe(S,E,M){return Array.isArray(S)?S:[[S,E,M]]}function De(S,E){const M=a.runHooks("beforeChange",S,E||"edit"),F=S.filter(J=>J!==null);if(M===!1||F.length===0){var q;return(q=a.getActiveEditor())===null||q===void 0||q.cancelChanges(),[]}for(let J=F.length-1;J>=0;J--){const[_,I,,k]=F[J],W=h.propToCol(I);let D;Number.isInteger(W)?D=a.getCellMeta(_,W):D={...Object.getPrototypeOf(x),...x},F[J][3]=FA(k,D)}return F}this.setDataAtCell=function(S,E,M,F){const q=Pe(S,E,M),J=[];let _=F,I,k,W;for(I=0,k=q.length;I<k;I++){const[z,Z,j]=q[I];if(typeof q[I]!="object")throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if(typeof Z!="number")throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");Z>=this.countCols()?W=Z:W=h.colToProp(Z),J.push([z,W,d.getAtCell(this.toPhysicalRow(z),Z),j])}!_&&typeof S=="object"&&(_=E);const D=De(J,_);a.runHooks("afterSetDataAtCell",D,_),de(D,_,()=>{Te(D,_)})},this.setDataAtRowProp=function(S,E,M,F){const q=Pe(S,E,M),J=[];let _=F,I,k;for(I=0,k=q.length;I<k;I++){const[D,z,Z]=q[I];J.push([D,z,d.getAtCell(this.toPhysicalRow(D),z),Z])}!_&&typeof S=="object"&&(_=E);const W=De(J,F);a.runHooks("afterSetDataAtRowProp",W,_),de(W,_,()=>{Te(W,_)})},this.listen=function(){a&&!a.isListening()&&(YA.forEach(S=>{a!==S&&S.unlisten()}),UA=a.guid,a.runHooks("afterListen"))},this.unlisten=function(){this.isListening()&&(UA=null,a.runHooks("afterUnlisten"))},this.isListening=function(){return UA===a.guid},this.destroyEditor=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;m.closeEditor(S),a.view.render(),E&&re.isSelected()&&m.prepareEditor()},this.populateFromArray=function(S,E,M,F,q,J,_){if(!(typeof M=="object"&&typeof M[0]=="object"))throw new Error("populateFromArray parameter `input` must be an array of arrays");const I=typeof F=="number"?a._createCellCoords(F,q):null;return g.populateFromArray(a._createCellCoords(S,E),M,I,J,_)},this.spliceCol=function(S,E,M){for(var F=arguments.length,q=new Array(F>3?F-3:0),J=3;J<F;J++)q[J-3]=arguments[J];return h.spliceCol(S,E,M,...q)},this.spliceRow=function(S,E,M){for(var F=arguments.length,q=new Array(F>3?F-3:0),J=3;J<F;J++)q[J-3]=arguments[J];return h.spliceRow(S,E,M,...q)},this.getSelected=function(){if(re.isSelected())return Vt(re.getSelectedRange(),S=>{let{from:E,to:M}=S;return[E.row,E.col,M.row,M.col]})},this.getSelectedLast=function(){const S=this.getSelected();let E;return S&&S.length>0&&(E=S[S.length-1]),E},this.getSelectedActive=function(){const S=this.getSelectedRangeActive();if(!S)return;const{from:E,to:M}=S;return[E.row,E.col,M.row,M.col]},this.getSelectedRange=function(){if(re.isSelected())return Array.from(re.getSelectedRange())},this.getSelectedRangeLast=function(){const S=this.getSelectedRange();let E;return S&&S.length>0&&(E=S[S.length-1]),E},this.getSelectedRangeActive=function(){return re.getActiveSelectedRange()},this.getActiveSelectionLayerIndex=function(){return re.getActiveSelectionLayerIndex()},this.emptySelectedCells=function(S){if(!re.isSelected()||this.countRows()===0||this.countCols()===0)return;const E=[];U(re.getSelectedRange(),M=>{if(M.isSingleHeader())return;const F=M.getTopStartCorner(),q=M.getBottomEndCorner();ze(F.row,q.row,J=>{ze(F.col,q.col,_=>{this.getCellMeta(J,_).readOnly||E.push([J,_,null])})})}),E.length>0&&this.setDataAtCell(E,S)},this.isRenderSuspended=function(){return this.renderSuspendedCounter>0},this.suspendRender=function(){this.renderSuspendedCounter+=1},this.resumeRender=function(){const S=this.renderSuspendedCounter-1;this.renderSuspendedCounter=Math.max(S,0),!this.isRenderSuspended()&&S===this.renderSuspendedCounter&&a.view.render()},this.render=function(){this.view&&(this.forceFullRender=!0,this.isRenderSuspended()||a.view.render())},this.batchRender=function(S){this.suspendRender();const E=S();return this.resumeRender(),E},this.isExecutionSuspended=function(){return this.executionSuspendedCounter>0},this.suspendExecution=function(){this.executionSuspendedCounter+=1,this.columnIndexMapper.suspendOperations(),this.rowIndexMapper.suspendOperations()},this.resumeExecution=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const E=this.executionSuspendedCounter-1;this.executionSuspendedCounter=Math.max(E,0),(!this.isExecutionSuspended()&&E===this.executionSuspendedCounter||S)&&(this.columnIndexMapper.resumeOperations(),this.rowIndexMapper.resumeOperations())},this.batchExecution=function(S){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;this.suspendExecution();const M=S();return this.resumeExecution(E),M},this.batch=function(S){this.suspendRender(),this.suspendExecution();const E=S();return this.resumeExecution(),this.resumeRender(),E},this.refreshDimensions=function(){if(!a.view)return;const S=a.view,{width:E,height:M}=S.getLastSize(),{width:F,height:q}=a.rootElement.getBoundingClientRect(),J=F!==E||q!==M;a.runHooks("beforeRefreshDimensions",{width:E,height:M},{width:F,height:q},J)!==!1&&((J||S._wt.wtOverlays.scrollableElement===a.rootWindow)&&(S.setLastSize(F,q),S.adjustElementsSize(),a.render()),a.runHooks("afterRefreshDimensions",{width:E,height:M},{width:F,height:q},J))},this.updateData=function(S,E){BU(S,M=>{h=M},M=>{h=M,a.columnIndexMapper.fitToLength(this.getInitialColumnCount()),a.rowIndexMapper.fitToLength(this.countSourceRows()),g.adjustRowsAndCols(),re.refresh()},{hotInstance:a,dataMap:h,dataSource:d,internalSource:"updateData",source:E,metaManager:N,firstRun:b})},this.loadData=function(S,E){BU(S,M=>{h=M},()=>{N.clearCellsCache(),a.initIndexMappers(),g.adjustRowsAndCols(),re.refresh(),b&&(b=[null,"loadData"])},{hotInstance:a,dataMap:h,dataSource:d,internalSource:"loadData",source:E,metaManager:N,firstRun:b})},this.getInitialColumnCount=function(){const S=x.columns;let E=0;if(Array.isArray(S))E=S.length;else if(Yt(S))if(a.dataType==="array"){const M=this.countSourceCols();for(let F=0;F<M;F+=1)S(F)&&(E+=1)}else(a.dataType==="object"||a.dataType==="function")&&(E=h.colToPropCache.length);else if(Ne(x.dataSchema)){const M=h.getSchema();E=Array.isArray(M)?M.length:EP(M)}else E=this.countSourceCols();return E},this.initIndexMappers=function(){this.columnIndexMapper.initToLength(this.getInitialColumnCount()),this.rowIndexMapper.initToLength(this.countSourceRows())},this.getData=function(S,E,M,F){return $n(S)?h.getAll():h.getRange(a._createCellCoords(S,E),a._createCellCoords(M,F),h.DESTINATION_RENDERER)},this.getCopyableText=function(S,E,M,F){return h.getCopyableText(a._createCellCoords(S,E),a._createCellCoords(M,F))},this.getCopyableData=function(S,E){return h.getCopyable(S,h.colToProp(E))},this.getCopyableSourceData=function(S,E){return d.getCopyable(S,h.colToProp(E))},this.getSchema=function(){return h.getSchema()},this.updateSettings=function(S){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const M=(b?a.loadData:a.updateData).bind(this);let F=!1,q,J;if(Ne(S.rows))throw new Error('The "rows" setting is no longer supported. Do you mean startRows, minRows or maxRows?');if(Ne(S.cols))throw new Error('The "cols" setting is no longer supported. Do you mean startCols, minCols or maxCols?');if(Ne(S.ganttChart))throw new Error('Since 8.0.0 the "ganttChart" setting is no longer supported.');for(q in S)if(!(q==="data"||q==="language"))if(q==="className")_e("className",S.className);else if(q==="tableClassName"&&a.table)_e("tableClassName",S.tableClassName),a.view._wt.wtOverlays.syncOverlayTableClassNames();else if(He.getSingleton().isRegistered(q)||He.getSingleton().isDeprecated(q)){const D=S[q];Yt(D)?(He.getSingleton().addAsFixed(q,D,a),x[q]=D):Array.isArray(D)&&(He.getSingleton().add(q,D,a),x[q]=D)}else!E&&ti(S,q)&&($[q]=S[q]);if(E)a.useTheme(x.themeName||YU(a.rootContainer));else{const D=a.getCurrentThemeName();ti(S,"themeName")&&D!==S.themeName&&a.useTheme(S.themeName)}QS.has(a)&&a.stylesHandler.getThemeName()!==void 0&&QS.delete(a),Qh(a)&&!QS.has(a)&&a.stylesHandler.isClassicTheme()&&(L4("Handsontable classic theme is a legacy theme and will be removed in version 17.0. Please update your theme settings to ensure compatibility with future versions."),QS.add(a)),S.data===void 0&&x.data===void 0?M(null,"updateSettings"):S.data!==void 0?M(S.data,"updateSettings"):S.columns!==void 0&&(h.createMap(),a.initIndexMappers()),!b&&S.language&&we(S.language);const _=a.countCols(),I=x.columns;if(I&&Yt(I)&&(F=!0),(S.cell!==void 0||S.cells!==void 0||S.columns!==void 0)&&N.clearCache(),_>0)for(q=0,J=0;q<_;q++){if(I){const D=F?I(q):I[J];D&&N.updateColumnMeta(J,D)}J+=1}Ne(S.cell)&&wt(S.cell,D=>{a.setCellMetaObject(D.row,D.col,D)}),a.runHooks("afterCellMetaReset");let k=a.rootElement.style.height;k!==""&&(k=parseInt(a.rootElement.style.height,10)),E&&a.rootElement.getAttribute("style")&&a.rootElement.setAttribute("data-initialstyle",a.rootElement.getAttribute("style"));let W=S.height;if(typeof S.height<"u")if(Yt(W)&&(W=W()),W=a.runHooks("beforeHeightChange",W),W===null){const D=a.rootElement.getAttribute("data-initialstyle");D&&(D.indexOf("height")>-1||D.indexOf("overflow")>-1)?a.rootElement.setAttribute("style",D):(a.rootElement.style.height="",a.rootElement.style.overflow="")}else W!==void 0&&(a.rootElement.style.height=isNaN(W)?`${W}`:`${W}px`,a.rootElement.style.overflow="hidden");if(typeof S.width<"u"){let D=S.width;Yt(D)&&(D=D()),D=a.runHooks("beforeWidthChange",D),a.rootElement.style.width=isNaN(D)?`${D}`:`${D}px`}E||(a.view&&(a.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked(),a.view._wt.exportSettingsAsClassNames()),a.runHooks("afterUpdateSettings",S)),g.adjustRowsAndCols(),a.view&&!b&&(a.render(),a.view._wt.wtOverlays.adjustElementsSize()),!E&&a.view&&(k===""||W===""||W===void 0)&&k!==W&&a.view._wt.wtOverlays.updateMainScrollableElements()},this.getValue=function(){const S=a.getSelectedRangeActive();if(x.getValue){if(Yt(x.getValue))return x.getValue.call(a);if(S)return a.getData()[S.highlight.row][x.getValue]}else if(S)return a.getDataAtCell(S.highlight.row,S.highlight.col);return null},this.getSettings=function(){return x},this.clear=function(){this.selectAll(),this.emptySelectedCells()},this.alter=function(S,E,M,F,q){g.alter(S,E,M,F,q)},this.getCell=function(S,E){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,F=E,q=S;if(E>=0){if(this.columnIndexMapper.isHidden(this.toPhysicalColumn(E)))return null;F=this.columnIndexMapper.getRenderableFromVisualIndex(E)}if(S>=0){if(this.rowIndexMapper.isHidden(this.toPhysicalRow(S)))return null;q=this.rowIndexMapper.getRenderableFromVisualIndex(S)}return q===null||F===null||q===void 0||F===void 0?null:a.view.getCellAtCoords(a._createCellCoords(q,F),M)},this.getCoords=function(S){const E=this.view._wt.wtTable.getCoords(S);if(E===null)return null;const{row:M,col:F}=E;let q=M,J=F;return M>=0&&(q=this.rowIndexMapper.getVisualFromRenderableIndex(M)),F>=0&&(J=this.columnIndexMapper.getVisualFromRenderableIndex(F)),a._createCellCoords(q,J)},this.colToProp=function(S){return h.colToProp(S)},this.propToCol=function(S){return h.propToCol(S)},this.toVisualRow=S=>this.rowIndexMapper.getVisualFromPhysicalIndex(S),this.toVisualColumn=S=>this.columnIndexMapper.getVisualFromPhysicalIndex(S),this.toPhysicalRow=S=>this.rowIndexMapper.getPhysicalFromVisualIndex(S),this.toPhysicalColumn=S=>this.columnIndexMapper.getPhysicalFromVisualIndex(S),this.getDataAtCell=function(S,E){return h.get(S,h.colToProp(E))},this.getDataAtRowProp=function(S,E){return h.get(S,E)},this.getDataAtCol=function(S){const E=[],M=h.getRange(a._createCellCoords(0,S),a._createCellCoords(x.data.length-1,S),h.DESTINATION_RENDERER);for(let F=0;F<M.length;F+=1)for(let q=0;q<M[F].length;q+=1)E.push(M[F][q]);return E},this.getDataAtProp=function(S){const E=[],M=h.getRange(a._createCellCoords(0,h.propToCol(S)),a._createCellCoords(x.data.length-1,h.propToCol(S)),h.DESTINATION_RENDERER);for(let F=0;F<M.length;F+=1)for(let q=0;q<M[F].length;q+=1)E.push(M[F][q]);return E},this.getSourceData=function(S,E,M,F){let q;return S===void 0?q=d.getData():q=d.getByRange(a._createCellCoords(S,E),a._createCellCoords(M,F)),q},this.getSourceDataArray=function(S,E,M,F){let q;return S===void 0?q=d.getData(!0):q=d.getByRange(a._createCellCoords(S,E),a._createCellCoords(M,F),!0),q},this.getSourceDataAtCol=function(S){return d.getAtColumn(S)},this.setSourceDataAtCell=function(S,E,M,F){const q=Pe(S,E,M),J=this.hasHook("afterSetSourceDataAtCell"),_=[],I=(W,D)=>{const z=this.toVisualRow(W),Z=this.toVisualColumn(D);return Number.isInteger(Z)?this.getCellMeta(z,Z):{...Object.getPrototypeOf(x),...x}};J&&U(q,W=>{let[D,z,Z]=W;const j=FA(Z,I(D,z));_.push([D,z,d.getAtCell(D,z),j])}),U(q,W=>{let[D,z,Z]=W;const j=FA(Z,I(D,z));d.setAtCell(D,z,j)}),J&&this.runHooks("afterSetSourceDataAtCell",_,F),this.render();const k=a.getActiveEditor();k&&Ne(k.refreshValue)&&k.refreshValue()},this.getSourceDataAtRow=function(S){return d.getAtRow(S)},this.getSourceDataAtCell=function(S,E){return d.getAtCell(S,E)},this.getDataAtRow=function(S){return h.getRange(a._createCellCoords(S,0),a._createCellCoords(S,this.countCols()-1),h.DESTINATION_RENDERER)[0]||[]},this.getDataType=function(S,E,M,F){const q=S===void 0?[0,0,this.countRows(),this.countCols()]:[S,E,M,F],[J,_]=q;let[,,I,k]=q,W=null,D=null;I===void 0&&(I=J),k===void 0&&(k=_);let z="mixed";return ze(Math.max(Math.min(J,I),0),Math.max(J,I),Z=>{let j=!0;return ze(Math.max(Math.min(_,k),0),Math.max(_,k),K=>(D=this.getCellMeta(Z,K).type,W?j=W===D:W=D,j)),z=j?D:"mixed",j}),z},this.removeCellMeta=function(S,E,M){const[F,q]=[this.toPhysicalRow(S),this.toPhysicalColumn(E)];let J=N.getCellMetaKeyValue(F,q,M);a.runHooks("beforeRemoveCellMeta",S,E,M,J)!==!1&&(N.removeCellMeta(F,q,M),a.runHooks("afterRemoveCellMeta",S,E,M,J)),J=null},this.spliceCellsMeta=function(S){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;for(var M=arguments.length,F=new Array(M>2?M-2:0),q=2;q<M;q++)F[q-2]=arguments[q];if(F.length>0&&!Array.isArray(F[0]))throw new Error("The 3rd argument (cellMetaRows) has to be passed as an array of cell meta objects array.");E>0&&N.removeRow(this.toPhysicalRow(S),E),F.length>0&&U(F.reverse(),J=>{N.createRow(this.toPhysicalRow(S)),U(J,(_,I)=>this.setCellMetaObject(S,I,_))}),a.render()},this.setCellMetaObject=function(S,E,M){typeof M=="object"&&wt(M,(F,q)=>{this.setCellMeta(S,E,q,F)})},this.setCellMeta=function(S,E,M,F){if(a.runHooks("beforeSetCellMeta",S,E,M,F)===!1)return;let J=S,_=E;S<this.countRows()&&(J=this.toPhysicalRow(S)),E<this.countCols()&&(_=this.toPhysicalColumn(E)),N.setCellMeta(J,_,M,F),a.runHooks("afterSetCellMeta",S,E,M,F)},this.getCellsMeta=function(){return N.getCellsMeta()},this.getCellMeta=function(S,E){let M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{skipMetaExtension:!1},F=this.toPhysicalRow(S),q=this.toPhysicalColumn(E);return F===null&&(F=S),q===null&&(q=E),N.getCellMeta(F,q,{visualRow:S,visualColumn:E,...M})},this.getColumnMeta=function(S){return N.getColumnMeta(this.toPhysicalColumn(S))},this.getCellMetaAtRow=function(S){return N.getCellsMetaAtRow(S)},this.isColumnModificationAllowed=function(){return!(a.dataType==="object"||x.columns)},this.getCellRenderer=function(S,E){const M=typeof S=="number"?a.getCellMeta(S,E).renderer:S.renderer;return typeof M=="string"?BH(M):$n(M)?BH("text"):M},this.getCellEditor=function(S,E){const M=typeof S=="number"?a.getCellMeta(S,E).editor:S.editor;return typeof M=="string"?LH(M):$n(M)?LH("text"):M},this.getCellValidator=function(S,E){const M=typeof S=="number"?a.getCellMeta(S,E).validator:S.validator;return typeof M=="string"?ele(M):M},this.validateCells=function(S){this._validateCells(S)},this.validateRows=function(S,E){if(!Array.isArray(S))throw new Error("validateRows parameter `rows` must be an array");this._validateCells(E,S)},this.validateColumns=function(S,E){if(!Array.isArray(S))throw new Error("validateColumns parameter `columns` must be an array");this._validateCells(E,void 0,S)},this._validateCells=function(S,E,M){const F=new ie;S&&(F.onQueueEmpty=S);let q=a.countRows()-1;for(;q>=0;){if(E!==void 0&&E.indexOf(q)===-1){q-=1;continue}let J=a.countCols()-1;for(;J>=0;){if(M!==void 0&&M.indexOf(J)===-1){J-=1;continue}F.addValidatorToQueue(),a.validateCell(a.getDataAtCell(q,J),a.getCellMeta(q,J),_=>{if(typeof _!="boolean")throw new Error("Validation error: result is not boolean");_===!1&&(F.valid=!1),F.removeValidatorFormQueue()},"validateCells"),J-=1}q-=1}F.checkIfQueueIsEmpty()},this.getRowHeader=function(S){let E=x.rowHeaders,M=S;return M!==void 0&&(M=a.runHooks("modifyRowHeader",M)),M===void 0?(E=[],ze(a.countRows()-1,F=>{E.push(a.getRowHeader(F))})):Array.isArray(E)&&E[M]!==void 0?E=E[M]:Yt(E)?E=E(M):E&&typeof E!="string"&&typeof E!="number"&&(E=M+1),E},this.hasRowHeaders=function(){return!!x.rowHeaders},this.hasColHeaders=function(){if(x.colHeaders!==void 0&&x.colHeaders!==null)return!!x.colHeaders;for(let S=0,E=a.countCols();S<E;S++)if(a.getColHeader(S))return!0;return!1},this.getColHeader=function(S){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:-1;const M=a.runHooks("modifyColHeader",S);if(M===void 0){const I=[],k=a.countCols();for(let W=0;W<k;W++)I.push(a.getColHeader(W));return I}let F=x.colHeaders;const q=function(I){const k=[],W=a.countCols();let D=0;for(;D<W;D++)Yt(x.columns)&&x.columns(D)&&k.push(D);return k[I]},J=a.toPhysicalColumn(M),_=q(J);return x.colHeaders===!1?F=null:x.columns&&Yt(x.columns)&&x.columns(_)&&x.columns(_).title?F=x.columns(_).title:x.columns&&x.columns[J]&&x.columns[J].title?F=x.columns[J].title:Array.isArray(x.colHeaders)&&x.colHeaders[J]!==void 0?F=x.colHeaders[J]:Yt(x.colHeaders)?F=x.colHeaders(J):x.colHeaders&&typeof x.colHeaders!="string"&&typeof x.colHeaders!="number"&&(F=the(M)),F=a.runHooks("modifyColumnHeaderValue",F,S,E),F},this._getColWidthFromSettings=function(S){let E;if(S>=0&&(E=a.getCellMeta(0,S).width),(E===void 0||E===x.width)&&(E=x.colWidths),E!=null){switch(typeof E){case"object":E=E[S];break;case"function":E=E(S);break}typeof E=="string"&&(E=parseInt(E,10))}return E},this.getColWidth=function(S,E){let M=a._getColWidthFromSettings(S);return M=a.runHooks("modifyColWidth",M,S,E),M===void 0&&(M=Jg),M},this._getRowHeightFromSettings=function(S){const E=a.stylesHandler.getDefaultRowHeight();let M=x.rowHeights;if(M!=null){switch(typeof M){case"object":M=M[S];break;case"function":M=M(S);break}typeof M=="string"&&(M=parseInt(M,10))}return M!=null&&M<E?E:M},this.getRowHeight=function(S,E){let M=a._getRowHeightFromSettings(S);return M=a.runHooks("modifyRowHeight",M,S,E),M},this.countSourceRows=function(){return d.countRows()},this.countSourceCols=function(){return d.countFirstRowKeys()},this.countRows=function(){return h.getLength()},this.countCols=function(){const S=x.maxCols,E=this.columnIndexMapper.getNotTrimmedIndexesLength();return Math.min(S,E)},this.countRenderedRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return a.view._wt.drawn?a.view._wt.wtTable.getVisibleColumnsCount():-1},this.countRowHeaders=function(){return this.view.getRowHeadersCount()},this.countColHeaders=function(){return this.view.getColumnHeadersCount()},this.countEmptyRows=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=0;return Hz(a.countRows()-1,M=>{if(a.isEmptyRow(M))E+=1;else if(S===!0)return!1}),E},this.countEmptyCols=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,E=0;return Hz(a.countCols()-1,M=>{if(a.isEmptyCol(M))E+=1;else if(S===!0)return!1}),E},this.isEmptyRow=function(S){return x.isEmptyRow.call(a,S)},this.isEmptyCol=function(S){return x.isEmptyCol.call(a,S)},this.selectCell=function(S,E,M,F){let q=arguments.length>4&&arguments[4]!==void 0?arguments[4]:!0,J=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;return $n(S)||$n(E)?!1:this.selectCells([[S,E,M,F]],q,J)},this.selectCells=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[[]],E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,M=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;E===!1&&y.suspend();const F=re.selectCells(S);return F&&M&&a.listen(),y.resume(),F},this.selectColumns=function(S){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S,M=arguments.length>2?arguments[2]:void 0;return re.selectColumns(S,E,M)},this.selectRows=function(S){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S,M=arguments.length>2?arguments[2]:void 0;return re.selectRows(S,E,M)},this.deselectCell=function(){re.deselect()},this.selectAll=function(){let S=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:S,M=arguments.length>2?arguments[2]:void 0;y.skipNextScrollCycle(),re.selectAll(S,E,M)};const V=(S,E)=>S.getNearestNotHiddenIndex(E,1,!0);this.scrollViewportTo=function(S,E){if(typeof S=="number"){var M;S={row:arguments[0],col:arguments[1],verticalSnap:arguments[2]?"bottom":"top",horizontalSnap:arguments[3]?"end":"start",considerHiddenIndexes:(M=arguments[4])!==null&&M!==void 0?M:!0}}const{row:F,col:q,considerHiddenIndexes:J}=S??{};let _=F,I=q;if(Yt(E)&&this.addHookOnce("afterScroll",E),J===void 0||J){const z=Number.isInteger(F)&&F>=0,Z=Number.isInteger(q)&&q>=0,j=z?V(this.rowIndexMapper,F):void 0,K=Z?V(this.columnIndexMapper,q):void 0;if(j===null||K===null)return!1;_=z?a.rowIndexMapper.getRenderableFromVisualIndex(j):F,I=Z?a.columnIndexMapper.getRenderableFromVisualIndex(K):q}const k=Number.isInteger(_),W=Number.isInteger(I);let D=!1;return k&&_>=0&&W&&I>=0?D=a.view.scrollViewport(a._createCellCoords(_,I),S.horizontalSnap,S.verticalSnap):k&&_>=0&&(W&&I<0||!W)?D=a.view.scrollViewportVertically(_,S.verticalSnap):W&&I>=0&&(k&&_<0||!k)&&(D=a.view.scrollViewportHorizontally(I,S.horizontalSnap)),Yt(E)&&(D?this.view.render():(this.removeHook("afterScroll",E),this._registerMicrotask(()=>E()))),D},this.scrollToFocusedCell=function(S){if(!this.selection.isSelected())return!1;Yt(S)&&this.addHookOnce("afterScroll",S);const{highlight:E}=this.getSelectedRangeActive(),M=this.scrollViewportTo(E.toObject());return M?this.view.render():Yt(S)&&(this.removeHook("afterScroll",S),this._registerMicrotask(()=>S())),M},this.destroy=function(){a._clearTimeouts(),a._clearImmediates(),a.view&&a.view.destroy(),d&&d.destroy(),d=null,Qh(this)&&Tge(),this.getShortcutManager().destroy(),P.clear(),N.clearCache(),YA.delete(this.guid),u.destroy(),m&&m.destroy(),a.rootContainer&&du(a.rootContainer),a.rootPortalElement&&a.rootPortalElement.remove(),a.batchExecution(()=>{a.rowIndexMapper.unregisterAll(),a.columnIndexMapper.unregisterAll(),L.getItems().forEach(S=>{let[,E]=S;E.destroy()}),L.clear(),a.runHooks("afterDestroy")},!0),He.getSingleton().destroy(a),wt(a,(S,E,M)=>{Yt(S)?M[E]=le(E):E!=="guid"&&(M[E]=null)}),a.isDestroyed=!0,h&&h.destroy(),h=null,g=null,re=null,m=null,a=null};function le(S){return()=>{throw new Error(`The "${S}" method cannot be called because this Handsontable instance has been destroyed`)}}this.getActiveEditor=function(){return m.getActiveEditor()},this.getFirstRenderedVisibleRow=function(){return a.view.getFirstRenderedVisibleRow()},this.getLastRenderedVisibleRow=function(){return a.view.getLastRenderedVisibleRow()},this.getFirstRenderedVisibleColumn=function(){return a.view.getFirstRenderedVisibleColumn()},this.getLastRenderedVisibleColumn=function(){return a.view.getLastRenderedVisibleColumn()},this.getFirstFullyVisibleRow=function(){return a.view.getFirstFullyVisibleRow()},this.getLastFullyVisibleRow=function(){return a.view.getLastFullyVisibleRow()},this.getFirstFullyVisibleColumn=function(){return a.view.getFirstFullyVisibleColumn()},this.getLastFullyVisibleColumn=function(){return a.view.getLastFullyVisibleColumn()},this.getFirstPartiallyVisibleRow=function(){return a.view.getFirstPartiallyVisibleRow()},this.getLastPartiallyVisibleRow=function(){return a.view.getLastPartiallyVisibleRow()},this.getFirstPartiallyVisibleColumn=function(){return a.view.getFirstPartiallyVisibleColumn()},this.getLastPartiallyVisibleColumn=function(){return a.view.getLastPartiallyVisibleColumn()},this.getPlugin=function(S){return L.getItem(ha(S))},this.getPluginName=function(S){return S===this.undoRedo?this.undoRedo.constructor.PLUGIN_KEY:L.getId(S)},this.getInstance=function(){return a},this.addHook=function(S,E,M){He.getSingleton().add(S,E,a,M)},this.hasHook=function(S){return He.getSingleton().has(S,a)||He.getSingleton().has(S)},this.addHookOnce=function(S,E,M){He.getSingleton().once(S,E,a,M)},this.removeHook=function(S,E){He.getSingleton().remove(S,E,a)},this.runHooks=function(S,E,M,F,q,J,_){return He.getSingleton().run(a,S,E,M,F,q,J,_)},this.getTranslatedPhrase=function(S,E){return x5(x.language,S,E)},this.toHTML=()=>Az(this),this.toTableElement=()=>{const S=this.rootDocument.createElement("div");return S.insertAdjacentHTML("afterbegin",Az(this)),S.firstElementChild},this.timeouts=[],this.useTheme=S=>{const E=!!b;this.stylesHandler.useTheme(S);const M=this.stylesHandler.getThemeName();E||(a.render(),a.scrollViewportTo(0,0),YU(this.rootContainer)&&(Ve(this.rootContainer,/ht-theme-.*/g),M&&fe(this.rootContainer,M))),this.runHooks("afterSetTheme",M,E)},this.getCurrentThemeName=()=>this.stylesHandler.getThemeName(),this.getTableHeight=()=>this.rootElement.offsetHeight,this.getTableWidth=()=>this.rootElement.offsetWidth,this._registerTimeout=function(S){let E=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,M=S;typeof M=="function"&&(M=setTimeout(M,E)),this.timeouts.push(M)},this._clearTimeouts=function(){U(this.timeouts,S=>{clearTimeout(S)})},this.immediates=[],this._registerImmediate=function(S){this.immediates.push(setImmediate(S))},this._clearImmediates=function(){U(this.immediates,S=>{clearImmediate(S)})},this._registerMicrotask=function(S){this.rootWindow.queueMicrotask(()=>{this.isDestroyed||S()})},this._getEditorManager=function(){return m};const ye=mge({handleEvent(){return a.isListening()},beforeKeyDown:S=>this.runHooks("beforeKeyDown",S),afterKeyDown:S=>{this.isDestroyed||a.runHooks("afterDocumentKeyDown",S)},ownerWindow:this.rootWindow});this.addHook("beforeOnCellMouseDown",S=>{S.ctrlKey===!1&&S.metaKey===!1&&ye.releasePressedKeys()}),this.getShortcutManager=function(){return ye},this.getFocusManager=function(){return v},Y4().forEach(S=>{const E=IP(S);L.addItem(S,new E(this))}),Jfe(a),ye.setActiveContextName("grid"),He.getSingleton().run(a,"construct")}function JU(t,e,n){t.addEventListener(e,n,!1)}function eY(t,e,n){t.removeEventListener(e,n,!1)}function JS(t){return t.ownerDocument.defaultView.getComputedStyle(t)}function Y5(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const n={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300,textContent:m=>m.value,...e},i=t.body,r=t.createTextNode(""),o=t.createElement("span");let a;function u(){var m,v;r.textContent=n.textContent(a),o.style.position="absolute",o.style.fontSize=JS(a).fontSize,o.style.fontFamily=JS(a).fontFamily,o.style.whiteSpace="pre",i.appendChild(o);const y=parseInt(((m=JS(a))===null||m===void 0?void 0:m.paddingInlineStart)||0,10),b=parseInt(((v=JS(a))===null||v===void 0?void 0:v.paddingInlineEnd)||0,10),C=o.clientWidth+y+b+1;i.removeChild(o);const T=a.style;T.height=`${n.minHeight}px`,n.minWidth>C?T.width=`${n.minWidth}px`:C>n.maxWidth?T.width=`${n.maxWidth}px`:T.width=`${C}px`;const O=a.scrollHeight?a.scrollHeight-1:0;n.minHeight>O?T.height=`${n.minHeight}px`:n.maxHeight<O?(T.height=`${n.maxHeight}px`,T.overflowY="visible"):T.height=`${O}px`}function h(){t.defaultView.setTimeout(u,0)}function d(m){if(m&&m.minHeight)if(m.minHeight==="inherit")n.minHeight=a.clientHeight;else{const v=parseInt(m.minHeight,10);isNaN(v)||(n.minHeight=v)}if(m&&m.maxHeight)if(m.maxHeight==="inherit")n.maxHeight=a.clientHeight;else{const v=parseInt(m.maxHeight,10);isNaN(v)||(n.maxHeight=v)}if(m&&m.minWidth)if(m.minWidth==="inherit")n.minWidth=a.clientWidth;else{const v=parseInt(m.minWidth,10);isNaN(v)||(n.minWidth=v)}if(m&&m.maxWidth)if(m.maxWidth==="inherit")n.maxWidth=a.clientWidth;else{const v=parseInt(m.maxWidth,10);isNaN(v)||(n.maxWidth=v)}o.firstChild||(o.className="autoResize",o.style.display="inline-block",o.appendChild(r))}function g(m,v){let y=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;a=m,d(v),a.nodeName==="TEXTAREA"&&(a.style.resize="none",a.style.height=`${n.minHeight}px`,a.style.minWidth=`${n.minWidth}px`,a.style.maxWidth=`${n.maxWidth}px`,a.style.overflowY="hidden"),y&&(JU(a,"input",u),JU(a,"keydown",h)),u()}return{init:g,resize:u,unObserve(){eY(a,"input",u),eY(a,"keydown",h)}}}function tY(t,e){const n=M4(e),i=e.value.split(`
`);let r=n,o=0;for(let a=0;a<i.length;a++){const u=i[a];a!==0&&(o+=i[a-1].length+1);const h=o+u.length;if(t==="home"?r=o:t==="end"&&(r=h),n<=h)break}wR(e,r)}function bh(t,e,n){return(e=Mge(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mge(t){var e=Age(t,"string");return typeof e=="symbol"?e:e+""}function Age(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Oge="ht_editor_visible",eb="ht_editor_hidden",nY="textEditor",xge="text";class jd extends Rm{static get EDITOR_TYPE(){return xge}constructor(e){super(e),bh(this,"eventManager",new da(this)),bh(this,"autoResize",Y5(this.hot.rootDocument)),bh(this,"TEXTAREA",void 0),bh(this,"textareaStyle",void 0),bh(this,"TEXTAREA_PARENT",void 0),bh(this,"textareaParentStyle",void 0),bh(this,"layerClass",void 0),this.eventManager=new da(this),this.createElements(),this.bindEvents(),this.hot.addHookOnce("afterDestroy",()=>this.destroy())}getValue(){return this.TEXTAREA.value}setValue(e){this.TEXTAREA.value=e}open(){this._opened=!0,this.refreshDimensions(),this.showEditableElement(),this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.autoResize.unObserve(),mC(this.hot.rootDocument.activeElement,this.hot.rootElement)&&this.hot.listen(),this.hideEditableElement(),this.unregisterShortcuts()}prepare(e,n,i,r,o,a){const u=this.state;if(super.prepare(e,n,i,r,o,a),!a.readOnly){this.refreshDimensions(!0);const{allowInvalid:h}=a;h&&!this.isOpened()&&(this.TEXTAREA.value=""),u!==Jn.FINISHED&&!this.isOpened()&&this.hideEditableElement()}}beginEditing(e,n){this.state===Jn.VIRGIN&&(this.TEXTAREA.value="",super.beginEditing(e,n))}focus(){this.TEXTAREA.select(),wR(this.TEXTAREA,this.TEXTAREA.value.length)}createElements(){const{rootDocument:e}=this.hot;this.TEXTAREA=e.createElement("TEXTAREA"),We(this.TEXTAREA,[["data-hot-input",""],lo(-1)]),fe(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.textareaStyle.overflowY="visible",this.TEXTAREA_PARENT=e.createElement("DIV"),fe(this.TEXTAREA_PARENT,"handsontableInputHolder"),Xe(this.TEXTAREA_PARENT,this.layerClass)&&Ve(this.TEXTAREA_PARENT,this.layerClass),fe(this.TEXTAREA_PARENT,eb),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.hot.rootElement.appendChild(this.TEXTAREA_PARENT)}hideEditableElement(){Pse()&&(this.textareaStyle.textIndent="-99999px"),this.textareaStyle.overflowY="visible",this.textareaParentStyle.opacity="0",this.textareaParentStyle.height="1px",Ve(this.TEXTAREA_PARENT,this.layerClass),fe(this.TEXTAREA_PARENT,eb)}showEditableElement(){this.textareaParentStyle.height="",this.textareaParentStyle.overflow="",this.textareaParentStyle.position="",this.textareaParentStyle[this.hot.isRtl()?"left":"right"]="auto",this.textareaParentStyle.opacity="1",this.textareaStyle.textIndent="";const e=this.TEXTAREA_PARENT.childNodes;let n=!1;ze(e.length-1,i=>{const r=e[i];if(Xe(r,"handsontableEditor"))return n=!0,!1}),Xe(this.TEXTAREA_PARENT,eb)&&Ve(this.TEXTAREA_PARENT,eb),n?(this.layerClass=Oge,fe(this.TEXTAREA_PARENT,this.layerClass)):(this.layerClass=this.getEditedCellsLayerClass(),fe(this.TEXTAREA_PARENT,this.layerClass))}refreshValue(){const e=this.hot.toPhysicalRow(this.row),n=this.hot.getSourceDataAtCell(e,this.col);this.originalValue=n,this.setValue(n),this.refreshDimensions()}refreshDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.state!==Jn.EDITING&&!e)return;if(this.TD=this.getEditedCell(),!this.TD){e||this.close();return}const{top:n,start:i,width:r,maxWidth:o,height:a,maxHeight:u}=this.getEditedCellRect();this.textareaParentStyle.top=`${n}px`,this.textareaParentStyle[this.hot.isRtl()?"right":"left"]=`${i}px`,this.showEditableElement();const h=this.hot.rootWindow.getComputedStyle(this.TD);this.TEXTAREA.style.fontSize=h.fontSize,this.TEXTAREA.style.fontFamily=h.fontFamily,this.TEXTAREA.style.backgroundColor=this.TD.style.backgroundColor,this.autoResize.init(this.TEXTAREA,{minWidth:Math.min(r,o),minHeight:Math.min(a,u),maxWidth:o,maxHeight:u},!0)}bindEvents(){y4()&&this.eventManager.addEventListener(this.TEXTAREA,"focusout",()=>this.finishEditing(!1)),this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>{this.refreshDimensions(),this.state===Jn.EDITING&&this.focus()}),this.addHook("afterRowResize",()=>{this.refreshDimensions(),this.state===Jn.EDITING&&this.focus()})}destroy(){this.eventManager.destroy(),this.clearHooks()}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={runOnlyIf:()=>Ne(this.hot.getSelected()),group:nY},r=()=>{this.hot.rootDocument.execCommand("insertText",!1,`
`)};n.addShortcuts([{keys:[["Control","Enter"]],callback:()=>(r(),!1),runOnlyIf:o=>!this.hot.selection.isMultiple()&&!o.altKey},{keys:[["Meta","Enter"]],callback:()=>(r(),!1),runOnlyIf:()=>!this.hot.selection.isMultiple()},{keys:[["Alt","Enter"]],callback:()=>(r(),!1)},{keys:[["Home"]],callback:(o,a)=>{let[u]=a;tY(u,this.TEXTAREA)}},{keys:[["End"]],callback:(o,a)=>{let[u]=a;tY(u,this.TEXTAREA)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(nY)}}const Hge="base",Ige="htTextEllipsis";function Yw(t,e,n,i,r,o,a){const u=a.ariaTags,h=[],d=[],g=[],m=[];a.className&&fe(e,a.className),a.readOnly?(h.push(a.readOnlyCellClassName),u&&m.push(Jj())):u&&g.push(Jj()[0]),a.valid===!1&&a.invalidCellClassName?(h.push(a.invalidCellClassName),u&&m.push(ez())):(d.push(a.invalidCellClassName),u&&g.push(ez()[0])),a.wordWrap===!1&&a.noWordWrapClassName&&h.push(a.noWordWrapClassName),!o&&a.placeholder&&h.push(a.placeholderCellClassName),a.textEllipsis&&h.push(Ige),Ve(e,d),fe(e,h),uu(e,g),We(e,m)}Yw.RENDERER_TYPE=Hge;const Pge="text";function bu(t,e,n,i,r,o,a){Yw.apply(this,[t,e,n,i,r,o,a]);let u=o;!u&&a.placeholder&&(u=a.placeholder),u=xn(u),a.trimWhitespace&&(u=u.trim()),Td(e,u)}bu.RENDERER_TYPE=Pge;const Nge="text",G5={CELL_TYPE:Nge,editor:jd,renderer:bu};qs(G5);Et.editors={BaseEditor:Rm};function Et(t,e){const n=new U5(t,e||{},qP);return n.init(),n}Et.Core=function(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return new U5(t,e,qP)};Et.DefaultSettings=L5();Et.hooks=He.getSingleton();Et.CellCoords=Md;Et.CellRange=bm;Et.packageName="handsontable";Et.buildDate="23/09/2025 14:16:56";Et.version="16.1.1";Et.languages={dictionaryKeys:Dhe,getLanguageDictionary:O5,getLanguagesDictionaries:Bhe,registerLanguageDictionary:A5,getTranslatedPhrase:x5};function KH(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function Dge(t){if(Array.isArray(t))return KH(t)}function Lge(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function pw(t,e,n){return e=s0(e),jge(t,q5()?Reflect.construct(e,n||[],s0(t).constructor):e.apply(t,n))}function nm(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function iY(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,K5(i.key),i)}}function im(t,e,n){return e&&iY(t.prototype,e),n&&iY(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function kge(t,e,n){return(e=K5(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function s0(t){return s0=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},s0(t)}function vw(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&XH(t,e)}function q5(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(q5=function(){return!!t})()}function $ge(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function Vge(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function rY(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Bge(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rY(Object(n),!0).forEach(function(i){kge(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rY(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function Fge(t,e){if(t==null)return{};var n,i,r=Wge(t,e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);for(i=0;i<o.length;i++)n=o[i],e.indexOf(n)===-1&&{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}function Wge(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.indexOf(i)!==-1)continue;n[i]=t[i]}return n}function jge(t,e){if(e&&(typeof e=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Lge(t)}function XH(t,e){return XH=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},XH(t,e)}function zge(t){return Dge(t)||$ge(t)||Yge(t)||Vge()}function Uge(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function K5(t){var e=Uge(t,"string");return typeof e=="symbol"?e:e+""}function Yge(t,e){if(t){if(typeof t=="string")return KH(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?KH(t,e):void 0}}var GA=null,Gge="Your `HotTable` configuration includes `autoRowSize`/`autoColumnSize` options, which are not compatible with  the component-based renderers`. Disable `autoRowSize` and `autoColumnSize` to prevent row and column misalignment.",qge="The Handsontable instance bound to this component was destroyed and cannot be used properly.",a0="global",Kge="hot-wrapper-editor-container";function Xge(){if(typeof console<"u"){var t;(t=console).warn.apply(t,arguments)}}function ZH(t,e){var n=bn.Children.toArray(t),i=bn.Children.count(t),r=null;return i!==0&&(i===1&&n[0].props[e]?r=n[0]:r=n.find(function(o){return o.props[e]!==void 0})),r||null}function X5(t){return t?t.type.WrappedComponent?t.type.WrappedComponent:t.type:null}function Z5(t,e){if(typeof t>"u"||e===null)return null;var n=J5(e.props,!1);return n.className="".concat(Kge," ").concat(n.className),kC.createPortal(bn.createElement("div",Object.assign({},n),e),t.body)}function Q5(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:a0,i=ZH(t,"hot-editor"),r=X5(i);return i?bn.cloneElement(i,{emitEditorInstance:function(a,u){e.get(r)||e.set(r,new Map);var h=e.get(r);h.set(u??a0,a)},editorColumnScope:n,isEditor:!0}):null}function Zge(t,e){var n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:document,i=arguments.length>3?arguments[3]:void 0,r=arguments.length>4?arguments[4]:void 0;n||(n=document),GA||(GA=n.createDocumentFragment());var o=r??n.createElement("DIV");GA.appendChild(o);var a=bn.cloneElement(t,Bge({key:"".concat(e.row,"-").concat(e.col)},e));return{portal:kC.createPortal(a,o,i),portalContainer:o}}function J5(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return{id:t.id||(e?"hot-"+Math.random().toString(36).substring(5):void 0),className:t.className||"",style:t.style||{}}}function Qge(){return typeof window<"u"}var eK=(function(){function t(){nm(this,t)}return im(t,null,[{key:"getSettings",value:(function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=i.prevProps,o=r===void 0?{}:r,a=i.isInit,u=a===void 0?!1:a,h=i.initOnlySettingKeys,d=h===void 0?[]:h,g=function(T){return!u&&d.includes(T)?o[T]===n[T]:!1},m={};if(n.settings){var v=n.settings;for(var y in v)v.hasOwnProperty(y)&&!g(y)&&(m[y]=v[y])}for(var b in n)b!=="settings"&&b!=="children"&&!g(b)&&n.hasOwnProperty(b)&&(m[b]=n[b]);return m})}])})(),Jge=(function(t){function e(){return nm(this,e),pw(this,e,arguments)}return vw(e,t),im(e,[{key:"getSettingsProps",value:(function(){var i=this;return this.internalProps=["_componentRendererColumns","_emitColumnSettings","_columnIndex","_getChildElementByType","_getRendererWrapper","_getEditorClass","_getEditorCache","_getOwnerDocument","hot-renderer","hot-editor","children"],Object.keys(this.props).filter(function(r){return!i.internalProps.includes(r)}).reduce(function(r,o){return r[o]=i.props[o],r},{})})},{key:"getLocalEditorElement",value:function(){return Q5(this.props.children,this.props._getEditorCache(),this.props._columnIndex)}},{key:"createColumnSettings",value:function(){var i=this.props._getChildElementByType(this.props.children,"hot-renderer"),r=this.getLocalEditorElement();this.columnSettings=eK.getSettings(this.getSettingsProps()),i!==null&&(this.columnSettings.renderer=this.props._getRendererWrapper(i),this.props._componentRendererColumns.set(this.props._columnIndex,!0)),r!==null&&(this.columnSettings.editor=this.props._getEditorClass(r,this.props._columnIndex))}},{key:"emitColumnSettings",value:function(){this.props._emitColumnSettings(this.columnSettings,this.props._columnIndex)}},{key:"componentDidMount",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"componentDidUpdate",value:function(){this.createColumnSettings(),this.emitColumnSettings()}},{key:"render",value:function(){var i=this.props._getOwnerDocument(),r=Z5(i,this.getLocalEditorElement());return bn.createElement(bn.Fragment,null,r)}}])})(bn.Component),eme=(function(t){function e(){var n;return nm(this,e),n=pw(this,e,arguments),n.state={portals:[]},n}return vw(e,t),im(e,[{key:"render",value:function(){return bn.createElement(bn.Fragment,null,this.state.portals)}}])})(bn.Component),tme="16.1.1";function nme(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var tK={exports:{}},qA,oY;function ime(){if(oY)return qA;oY=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return qA=t,qA}var KA,sY;function rme(){if(sY)return KA;sY=1;var t=ime();function e(){}function n(){}return n.resetWarningCache=e,KA=function(){function r(u,h,d,g,m,v){if(v!==t){var y=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw y.name="Invariant Violation",y}}r.isRequired=r;function o(){return r}var a={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:o,element:r,elementType:r,instanceOf:o,node:r,objectOf:o,oneOf:o,oneOfType:o,shape:o,exact:o,checkPropTypes:n,resetWarningCache:e};return a.PropTypes=a,a},KA}tK.exports=rme()();var ome=tK.exports,XA=nme(ome),kD=(function(t){function e(){var n;return nm(this,e),n=pw(this,e,arguments),n.id=null,n.__hotInstance=null,n.hotElementRef=null,n.columnSettings=[],n.renderersPortalManager=null,n.portalCache=new Map,n.portalContainerCache=new Map,n.renderedCellCache=new Map,n.editorCache=new Map,n.componentRendererColumns=new Map,n}return vw(e,t),im(e,[{key:"hotInstance",get:(function(){return!this.__hotInstance||this.__hotInstance&&!this.__hotInstance.isDestroyed?this.__hotInstance:(console.warn(qge),null)}),set:(function(i){this.__hotInstance=i})},{key:"_isHotInstanceDestroyed",value:function(){return this.__hotInstance&&this.__hotInstance.isDestroyed}},{key:"getPortalContainerCache",value:function(){return this.portalContainerCache}},{key:"getRenderedCellCache",value:function(){return this.renderedCellCache}},{key:"getEditorCache",value:function(){return this.editorCache}},{key:"clearCache",value:function(){this.getRenderedCellCache().clear(),this.componentRendererColumns.clear()}},{key:"getOwnerDocument",value:function(){return Qge()?this.hotElementRef?this.hotElementRef.ownerDocument:document:null}},{key:"setHotElementRef",value:function(i){this.hotElementRef=i}},{key:"getRendererWrapper",value:function(i){var r=this;return function(a,u,h,d,g,m,v){var y=r.getRenderedCellCache(),b=r.getPortalContainerCache(),C="".concat(h,"-").concat(d),T=a.guid,O="".concat(T,"-").concat(C),A="".concat(C,"-").concat(T);if(y.has(C)&&(u.innerHTML=y.get(C).innerHTML),u&&!u.getAttribute("ghost-table")){for(var N=r.portalCache.get(A),x=b.get(O);u.firstChild;)u.removeChild(u.firstChild);if(N&&x)u.appendChild(x);else{var $=Zge(i,{TD:u,row:h,col:d,prop:g,value:m,cellProperties:v,isRenderer:!0},u.ownerDocument,A,x),L=$.portal,P=$.portalContainer;b.set(O,P),u.appendChild(P),r.portalCache.set(A,L)}}return y.set(C,u),u}}},{key:"getEditorClass",value:function(i){var r,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:a0,a=X5(i),u=(r=this.getEditorCache().get(a))===null||r===void 0?void 0:r.get(o);return this.makeEditorClass(u)}},{key:"makeEditorClass",value:function(i){var r=(function(o){function a(u){var h;return nm(this,a),h=pw(this,a,[u]),i.hotCustomEditorInstance=h,h.editorComponent=i,h}return vw(a,o),im(a,[{key:"focus",value:function(){}},{key:"getValue",value:function(){}},{key:"setValue",value:function(){}},{key:"open",value:function(){}},{key:"close",value:function(){}}])})(Et.editors.BaseEditor);return Object.getOwnPropertyNames(Et.editors.BaseEditor.prototype).forEach(function(o){o!=="constructor"&&(r.prototype[o]=function(){for(var a,u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return(a=i[o]).call.apply(a,[i].concat(h))})}),r}},{key:"getGlobalRendererElement",value:function(){return ZH(this.props.children,"hot-renderer")}},{key:"getGlobalEditorElement",value:function(){return Q5(this.props.children,this.getEditorCache())}},{key:"createNewGlobalSettings",value:function(){var i,r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=this._isHotInstanceDestroyed()?[]:((i=this.hotInstance)===null||i===void 0||(i=i.getSettings())===null||i===void 0?void 0:i._initOnlySettings)||[],u=eK.getSettings(this.props,{prevProps:o,isInit:r,initOnlySettingKeys:a}),h=this.getGlobalRendererElement(),d=this.getGlobalEditorElement();if(u.columns=this.columnSettings.length?this.columnSettings:u.columns,d)u.editor=this.getEditorClass(d,a0);else{var g;this.props.editor||(g=this.props.settings)!==null&&g!==void 0&&g.editor?u.editor=this.props.editor||this.props.settings.editor:u.editor=LH("text")}if(h)u.renderer=this.getRendererWrapper(h),this.componentRendererColumns.set("global",!0);else{var m;this.props.renderer||(m=this.props.settings)!==null&&m!==void 0&&m.renderer?u.renderer=this.props.renderer||this.props.settings.renderer:u.renderer=BH("text")}return u}},{key:"displayAutoSizeWarning",value:function(i){var r,o;this.hotInstance&&((r=this.hotInstance.getPlugin("autoRowSize"))!==null&&r!==void 0&&r.enabled||(o=this.hotInstance.getPlugin("autoColumnSize"))!==null&&o!==void 0&&o.enabled)&&this.componentRendererColumns.size>0&&Xge(Gge)}},{key:"setHotColumnSettings",value:function(i,r){this.columnSettings[r]=i}},{key:"handsontableBeforeViewRender",value:function(){this.portalCache.clear(),this.getRenderedCellCache().clear()}},{key:"handsontableAfterViewRender",value:function(){this.renderersPortalManager.setState({portals:zge(this.portalCache.values())})}},{key:"updateHot",value:function(i){this.hotInstance&&this.hotInstance.updateSettings(i,!1)}},{key:"setRenderersPortalManagerRef",value:function(i){this.renderersPortalManager=i}},{key:"componentDidMount",value:function(){var i=this,r=this.createNewGlobalSettings(!0);this.hotInstance=new Et.Core(this.hotElementRef,r),this.hotInstance.addHook("beforeViewRender",function(){return i.handsontableBeforeViewRender()}),this.hotInstance.addHook("afterViewRender",function(){return i.handsontableAfterViewRender()}),this.hotInstance.init(),this.displayAutoSizeWarning(r)}},{key:"componentDidUpdate",value:function(i){this.clearCache();var r=this.createNewGlobalSettings(!1,i);this.updateHot(r),this.displayAutoSizeWarning(r)}},{key:"componentWillUnmount",value:function(){this.clearCache(),this.hotInstance&&this.hotInstance.destroy()}},{key:"render",value:function(){var i=this,r=function(g){return g.type===Jge},o=bn.Children.toArray(this.props.children),a=o.filter(function(d){return r(d)}).map(function(d,g){return bn.cloneElement(d,{_componentRendererColumns:i.componentRendererColumns,_emitColumnSettings:i.setHotColumnSettings.bind(i),_columnIndex:g,_getChildElementByType:ZH.bind(i),_getRendererWrapper:i.getRendererWrapper.bind(i),_getEditorClass:i.getEditorClass.bind(i),_getOwnerDocument:i.getOwnerDocument.bind(i),_getEditorCache:i.getEditorCache.bind(i),children:d.props.children})}),u=J5(this.props),h=Z5(this.getOwnerDocument(),this.getGlobalEditorElement());return bn.createElement(bn.Fragment,null,bn.createElement("div",Object.assign({ref:this.setHotElementRef.bind(this)},u),a),bn.createElement(eme,{ref:this.setRenderersPortalManagerRef.bind(this)}),h)}}],[{key:"version",get:function(){return tme}}])})(bn.Component);kD.propTypes={style:XA.object,id:XA.string,className:XA.string};var sme=["children"],nK=bn.forwardRef(function(t,e){var n,i=t.children,r=Fge(t,sme),o=typeof bn.useId=="function"?bn.useId():void 0,a=(n=r.id)!==null&&n!==void 0?n:o;return bn.createElement(kD,Object.assign({id:a},r,{ref:e}),i)});nK.version=kD.version;bn.Component;function aY(t,e,n){return(e=ame(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ame(t){var e=lme(t,"string");return typeof e=="symbol"?e:e+""}function lme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const lY="handsontableEditor",ume="handsontable";class $D extends jd{constructor(){super(...arguments),aY(this,"isFlippedVertically",!1),aY(this,"isFlippedHorizontally",!1)}static get EDITOR_TYPE(){return ume}open(){super.open();const e=this.htContainer.style;this.htEditor&&(this.htEditor.destroy(),e.width="",e.height="",e.overflow=""),e.display==="none"&&(e.display=""),this.htEditor=new this.hot.constructor(this.htContainer,this.htOptions),this.htEditor.init(),this.htEditor.rootElement.style.display="",this.cellProperties.strict?this.htEditor.selectCell(0,0):this.htEditor.deselectCell(),wR(this.TEXTAREA,0,this.TEXTAREA.value.length),this.htEditor.updateSettings({width:this.getTargetDropdownWidth(),height:this.getTargetDropdownHeight()}),this.refreshDimensions(),this.flipDropdownVerticallyIfNeeded(),this.flipDropdownHorizontallyIfNeeded()}close(){this.htEditor&&(this.htEditor.rootElement.style.display="none"),this.removeHooksByKey("beforeKeyDown"),super.close()}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a);const u=this,h={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,autoColumnSize:!1,autoRowSize:!1,readOnly:!0,fillHandle:!1,autoWrapCol:!1,autoWrapRow:!1,ariaTags:!1,themeName:this.hot.getCurrentThemeName(),afterOnCellMouseDown(d,g){const m=this.getSourceData(g.row,g.col);m!==void 0&&u.setValue(m),u.hot.destroyEditor()},preventWheel:!0,layoutDirection:this.hot.isRtl()?"rtl":"ltr"};this.cellProperties.handsontable&&Mi(h,a.handsontable),this.htOptions=h}beginEditing(e,n){const i=this.hot.getSettings().onBeginEditing;i&&i()===!1||super.beginEditing(e,n)}createElements(){super.createElements();const e=this.hot.rootDocument.createElement("DIV");e.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(e),this.htContainer=e,this.assignHooks()}finishEditing(e,n,i){if(this.htEditor&&this.htEditor.isListening()&&this.hot.listen(),this.htEditor&&this.htEditor.getSelectedActive()){const r=this.htEditor.getValue();r!==void 0&&this.setValue(r)}super.finishEditing(e,n,i)}flipDropdownVerticallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.top;if(e.isVerticallyScrollableByWindow()){const u=e.getTableOffset().top-this.hot.rootWindow.scrollY;i=Math.max(i+u,0)}const r=this.getDropdownHeight(),o=e.getWorkspaceHeight()-i-n.height,a=r>o&&i>o+n.height;return a?this.flipDropdownVertically():this.unflipDropdownVertically(),{isFlipped:a,spaceAbove:i,spaceBelow:o}}flipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top=`${-this.getDropdownHeight()}px`,this.isFlippedVertically=!0}unflipDropdownVertically(){const e=this.htEditor.rootElement.style;e.position="absolute",e.top="",this.isFlippedVertically=!1}flipDropdownHorizontallyIfNeeded(){const{view:e}=this.hot,n=this.getEditedCellRect();let i=n.start+n.width;if(e.isHorizontallyScrollableByWindow()){const u=e.getTableOffset().left-this.hot.rootWindow.scrollX;i=Math.max(i+u,0)}const r=this.getDropdownWidth(),o=e.getWorkspaceWidth()-i+n.width,a=r>o&&i>o;return a?this.flipDropdownHorizontally():this.unflipDropdownHorizontally(),{isFlipped:a,spaceInlineStart:i,spaceInlineEnd:o}}flipDropdownHorizontally(){const e=this.htEditor.rootElement.style,{width:n}=this.getEditedCellRect();e.position="absolute",e[this.hot.isRtl()?"right":"left"]=`${-(this.getDropdownWidth()-n)}px`,this.isFlippedHorizontally=!0}unflipDropdownHorizontally(){const e=this.htEditor.rootElement.style;e.position="absolute",e[this.hot.isRtl()?"right":"left"]="",this.isFlippedHorizontally=!1}getDropdownHeight(){return this.htEditor.getTableHeight()}getDropdownWidth(){return this.htEditor.getTableWidth()}getTargetDropdownWidth(){return this.htEditor.view.getTableWidth()}getTargetDropdownHeight(){return this.htEditor.view.getTableHeight()+1}assignHooks(){this.hot.addHook("afterDestroy",()=>{var e;(e=this.htEditor)===null||e===void 0||e.destroy()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor");super.registerShortcuts();const i={group:lY,relativeToGroup:Yc,position:"before"},r=(o,a)=>{const u=this.htEditor;if(o!==void 0&&(o<0||this.isFlippedVertically&&o>u.countRows()-1?u.deselectCell():u.selectCell(o,0),u.getData().length))return a.preventDefault(),ma(a),this.hot.listen(),this.TEXTAREA.focus(),!1};n.addShortcuts([{keys:[["ArrowUp"]],callback:o=>{const a=this.htEditor;let u,h;return!a.getSelectedActive()&&this.isFlippedVertically?u=a.countRows()-1:a.getSelectedActive()&&(this.isFlippedVertically?(h=a.getSelectedActive()[0],u=Math.max(0,h-1)):(h=a.getSelectedActive()[0],u=h-1)),r(u,o)},preventDefault:!1},{keys:[["ArrowDown"]],callback:o=>{const a=this.htEditor;let u,h;if(!a.getSelectedActive()&&!this.isFlippedVertically)u=0;else if(a.getSelectedActive()){if(this.isFlippedVertically)u=a.getSelectedActive()[0]+1;else if(!this.isFlippedVertically){const d=a.countRows()-1;h=a.getSelectedActive()[0],u=Math.min(d,h+1)}}return r(u,o)},preventDefault:!1}],i)}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(lY)}}function cme(t,e){iK(t,e),e.add(t)}function uY(t,e,n){iK(t,e),e.set(t,n)}function iK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ZA(t,e,n){return(e=hme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hme(t){var e=dme(t,"string");return typeof e=="symbol"?e:e+""}function dme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function QA(t,e){return t.get(wc(t,e))}function wc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const fme="autocomplete";var JA=new WeakMap,cY=new WeakMap,Ju=new WeakSet;class VD extends $D{constructor(){super(...arguments),cme(this,Ju),ZA(this,"query",null),ZA(this,"strippedChoices",[]),ZA(this,"rawChoices",[]),uY(this,JA,this.hot.guid.slice(0,9)),uY(this,cY,SR(()=>{this.focus()},100))}static get EDITOR_TYPE(){return fme}getValue(){const e=this.rawChoices.find(n=>{const i=this.stripValueIfNeeded(n);return(wc(Ju,this,Gp).call(this,i)?i.value:i)===this.TEXTAREA.value});return Ne(e)?e:this.TEXTAREA.value}createElements(){super.createElements(),fe(this.htContainer,"autocompleteEditor"),fe(this.htContainer,this.hot.rootWindow.navigator.platform.indexOf("Mac")===-1?"":"htMacScroll"),this.hot.getSettings().ariaTags&&We(this.TEXTAREA,[hse(),rse(),f4("listbox"),pse()])}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a),this.hot.getSettings().ariaTags&&We(this.TEXTAREA,[Ts("false"),vse(`${QA(JA,this)}-listbox-${e}-${n}`)]),this.htOptions={...this.htOptions,valueGetter:u=>wc(Ju,this,Gp).call(this,u)?u.value:u}}open(){super.open();const e=this.cellProperties.trimDropdown===void 0?!0:this.cellProperties.trimDropdown,n=this.hot.getSettings().ariaTags,i=Array.isArray(this.cellProperties.source)?this.cellProperties.source:null,r=i?.length,{row:o,col:a}=this;this.showEditableElement(),this.focus(),this.addHook("beforeKeyDown",u=>this.onBeforeKeyDown(u)),this.htEditor.addHook("afterScroll",QA(cY,this)),this.htEditor.updateSettings({colWidths:e?[hi(this.TEXTAREA)-2]:void 0,autoColumnSize:!0,renderer:(u,h,d,g,m,v,y)=>{bu(u,h,d,g,m,v,y);const{filteringCaseSensitive:b,allowHtml:C,locale:T}=this.cellProperties,O=this.query;let A=xn(v),N,x;A&&!C&&(N=b===!0?A.indexOf(O):A.toLocaleLowerCase(T).indexOf(O.toLocaleLowerCase(T)),N!==-1&&(x=A.substr(N,O.length),A=A.replace(x,`<strong>${x}</strong>`))),n&&We(h,[ose(),...i?[bse(r)]:[],...i?[Cse(i.indexOf(v)+1)]:[],["id",`${this.htEditor.rootElement.id}_${d}-${g}`]]),h.innerHTML=A},afterSelectionEnd:(u,h)=>{if(n){const d=m=>{We(m,[RP()]),We(this.TEXTAREA,...wse(m.id))},g=this.htEditor.getCell(u,h,!0);g!==null?d(g):this.htEditor.addHookOnce("afterScrollVertically",()=>{const m=this.htEditor.getCell(u,h,!0);d(m)})}}}),n&&(We(this.htEditor.view._wt.wtOverlays.wtTable.TABLE,...tu()),We(this.htEditor.rootElement,[d4(),yse("polite"),Sse("text"),["id",`${QA(JA,this)}-listbox-${o}-${a}`]]),We(this.TEXTAREA,...Ts("true"))),this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)})}close(){this.removeHooksByKey("beforeKeyDown"),super.close(),this.hot.getSettings().ariaTags&&We(this.TEXTAREA,[Ts("false")])}discardEditor(e){super.discardEditor(e),this.hot.view.render()}queryChoices(e){const n=this.cellProperties.source;this.query=e,typeof n=="function"?n.call(this.cellProperties,e,i=>{this.rawChoices=i,this.updateChoicesList(this.stripValuesIfNeeded(i))}):Array.isArray(n)?(this.rawChoices=n,this.updateChoicesList(this.stripValuesIfNeeded(n))):this.updateChoicesList([])}updateChoicesList(e){const n=M4(this.TEXTAREA),i=Wse(this.TEXTAREA),r=this.cellProperties.sortByRelevance,o=this.cellProperties.filter,a=this.stripValueIfNeeded(this.getValue()),u=wc(Ju,this,Gp).call(this,a)?a.value:a;let h=null,d=e;r||(d=d.toSorted());const g=[],m=this.cellProperties.locale,v=this.cellProperties.filteringCaseSensitive,y=v?u:u.toLocaleLowerCase(m);for(let b=0;b<d.length;b++){const C=wc(Ju,this,Gp).call(this,d[b])?iA(xn(d[b].value)):iA(xn(d[b]));if((v?C:C.toLocaleLowerCase(m)).indexOf(y)!==-1&&(g.push(b),o===!1))break}o===!1?h=g[0]:(d=g.map(b=>d[b]),h=d.indexOf(y)>-1?d.indexOf(y):0),this.strippedChoices=d,d.length===0?this.htEditor.rootElement.style.display="none":this.htEditor.rootElement.style.display="",this.htEditor.loadData(fC([d])),d.length>0&&(this.updateDropdownDimensions(),this.flipDropdownVerticallyIfNeeded(),this.cellProperties.strict===!0&&this.highlightBestMatchingChoice(h)),this.hot.listen(),wR(this.TEXTAREA,n,n===i?void 0:i)}flipDropdownVerticallyIfNeeded(){const e=super.flipDropdownVerticallyIfNeeded(),{isFlipped:n,spaceAbove:i,spaceBelow:r}=e;return this.limitDropdownIfNeeded(n?i:r),e}limitDropdownIfNeeded(e){const n=this.getDropdownHeight();if(n>e){let i=0,r=0,o=null;do r=this.htEditor.stylesHandler.getDefaultRowHeight(),i+=r;while(i<e);o=i-r,this.isFlippedVertically&&(this.htEditor.rootElement.style.top=`${parseInt(this.htEditor.rootElement.style.top,10)+n-o}px`),this.setDropdownHeight(i-r)}}updateDropdownDimensions(){const e=jse(),n=this.getTargetEditorWidth()+e,i=this.getTargetEditorHeight()+e;this.htEditor.updateSettings({width:n,height:i}),wc(Ju,this,hY).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}setDropdownHeight(e){this.htEditor.updateSettings({height:e}),wc(Ju,this,hY).call(this),this.htEditor.view._wt.wtTable.alignOverlaysWithTrimmingContainer()}highlightBestMatchingChoice(e){typeof e=="number"?this.htEditor.selectCell(e,0,void 0,void 0,void 0,!1):this.htEditor.deselectCell()}getTargetEditorHeight(){let e=0;if(!this.hot.getCurrentThemeName()){const r=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(r.borderTopWidth,10)+parseInt(r.borderBottomWidth,10)}const n=Math.min(this.cellProperties.visibleRows,this.strippedChoices.length);return Array.from({length:n},(r,o)=>o).reduce((r,o)=>{const a=this.hot.stylesHandler.getDefaultRowHeight()+(o===0?1:0);return r+a},0)+e}getTargetEditorWidth(){let e=0;if(!this.hot.getCurrentThemeName()){const n=this.hot.rootWindow.getComputedStyle(this.htContainer.querySelector(".htCore"));e=parseInt(n.borderInlineStartWidth,10)+parseInt(n.borderInlineEndWidth,10)}return this.htEditor.getColWidth(0)+e}stripValueIfNeeded(e){return this.stripValuesIfNeeded([e])[0]}stripValuesIfNeeded(e){const{allowHtml:n}=this.cellProperties,i=r=>xn(n?r:iA(r));return e.every(r=>wc(Ju,this,Gp).call(this,r))?e.map(r=>({key:i(r.key),value:i(r.value)})):e.map(r=>i(r))}onBeforeKeyDown(e){if(Kse(e.keyCode)||e.keyCode===Ge.BACKSPACE||e.keyCode===Ge.DELETE||e.keyCode===Ge.INSERT){let n=10;if(e.keyCode===Ge.C&&(e.ctrlKey||e.metaKey))return;this.isOpened()||(n+=10),this.htEditor&&this.hot._registerTimeout(()=>{this.queryChoices(this.TEXTAREA.value)},n)}}}function hY(){this.htEditor.view.hasVerticalScroll()&&this.htEditor.updateSettings({width:this.getTargetEditorWidth()+_i(this.hot.rootDocument)})}function Gp(t){return Qe(t)&&Ne(t.key)&&Ne(t.value)}const gme="checkbox";class rK extends Rm{static get EDITOR_TYPE(){return gme}beginEditing(e,n){if(n&&n.type==="mouseup"&&n.target.nodeName==="TD"){const i=this.TD.querySelector('input[type="checkbox"]');Xe(i,"htBadValue")||i.click()}}finishEditing(){}init(){}open(){}close(){}getValue(){}setValue(){}focus(){}}/*!
 * Pikaday
 *
 * Copyright © 2014 David Bushell | BSD & MIT license | https://github.com/Pikaday/Pikaday
 */const Hc=()=>window,bs=()=>window.document,QH=(t,e)=>window.setTimeout(t,e),Fa=function(t,e,n,i){t.addEventListener(e,n,!!i)},Ll=function(t,e,n,i){t.removeEventListener(e,n,!!i)},mme=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")},Ao=function(t,e){return(" "+t.className+" ").indexOf(" "+e+" ")!==-1},eO=function(t,e){Ao(t,e)||(t.className=t.className===""?e:t.className+" "+e)},tO=function(t,e){t.className=mme((" "+t.className+" ").replace(" "+e+" "," "))},BD=function(t){return/Array/.test(Object.prototype.toString.call(t))},No=function(t){return/Date/.test(Object.prototype.toString.call(t))&&!isNaN(t.getTime())},pme=function(t){let e=t.getDay();return e===0||e===6},vme=function(t){return t%4===0&&t%100!==0||t%400===0},dY=function(t,e){return[31,vme(t)?29:28,31,30,31,30,31,31,30,31,30,31][e]},tb=function(t){No(t)&&t.setHours(0,0,0,0)},nb=function(t,e){return t.getTime()===e.getTime()},l0=function(t,e,n){let i,r;for(i in e)r=t[i]!==void 0,r&&typeof e[i]=="object"&&e[i]!==null&&e[i].nodeName===void 0?No(e[i])?n&&(t[i]=new Date(e[i].getTime())):BD(e[i])?n&&(t[i]=e[i].slice(0)):t[i]=l0({},e[i],n):(n||!r)&&(t[i]=e[i]);return t},fY=function(t,e,n){let i=bs().createEvent("HTMLEvents");i.initEvent(e,!0,!1),i=l0(i,n),t.dispatchEvent(i)},gY=function(t){return t.month<0&&(t.year-=Math.ceil(Math.abs(t.month)/12),t.month+=12),t.month>11&&(t.year+=Math.floor(Math.abs(t.month)/12),t.month-=12),t},Ma={field:null,bound:void 0,ariaLabel:"Use the arrow keys to pick a date",position:"bottom left",reposition:!0,format:"YYYY-MM-DD",toString:null,parse:null,defaultDate:null,setDefaultDate:!1,firstDay:0,firstWeekOfYearMinDays:4,formatStrict:!1,minDate:null,maxDate:null,yearRange:10,showWeekNumber:!1,pickWholeWeek:!1,minYear:0,maxYear:9999,minMonth:void 0,maxMonth:void 0,startRange:null,endRange:null,isRTL:!1,yearSuffix:"",showMonthAfterYear:!1,showDaysInNextAndPreviousMonths:!1,enableSelectionDaysInNextAndPreviousMonths:!1,numberOfMonths:1,mainCalendar:"left",container:void 0,blurFieldOnSelect:!0,i18n:{previousMonth:"Previous Month",nextMonth:"Next Month",months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],weekdaysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},theme:null,events:[],onSelect:null,onOpen:null,onClose:null,onDraw:null,keyboardInput:!0},mY=function(t,e,n){for(e+=t.firstDay;e>=7;)e-=7;return n?t.i18n.weekdaysShort[e]:t.i18n.weekdays[e]},wme=function(t){let e=[],n="false";if(t.isEmpty)if(t.showDaysInNextAndPreviousMonths)e.push("is-outside-current-month"),t.enableSelectionDaysInNextAndPreviousMonths||e.push("is-selection-disabled");else return'<td class="is-empty"></td>';return t.isDisabled&&e.push("is-disabled"),t.isToday&&e.push("is-today"),t.isSelected&&(e.push("is-selected"),n="true"),t.hasEvent&&e.push("has-event"),t.isInRange&&e.push("is-inrange"),t.isStartRange&&e.push("is-startrange"),t.isEndRange&&e.push("is-endrange"),'<td data-day="'+t.day+'" class="'+e.join(" ")+'" aria-selected="'+n+'"><button class="pika-button pika-day" type="button" data-pika-year="'+t.year+'" data-pika-month="'+t.month+'" data-pika-day="'+t.day+'">'+t.day+"</button></td>"},yme=function(t,e){t.setHours(0,0,0,0);let n=t.getDate(),i=t.getDay(),r=e,o=r-1,a=7,u=function(v){return(v+a-1)%a};t.setDate(n+o-u(i));let h=new Date(t.getFullYear(),0,r),d=1440*60*1e3,g=(t.getTime()-h.getTime())/d;return 1+Math.round((g-o+u(h.getDay()))/a)},Sme=function(t,e,n,i,r){let o=new Date(i,n,e);return'<td class="pika-week">'+(t.hasMoment?t.moment(o).isoWeek():yme(o,r))+"</td>"},bme=function(t,e,n,i){return'<tr class="pika-row'+(n?" pick-whole-week":"")+(i?" is-selected":"")+'">'+(e?t.reverse():t).join("")+"</tr>"},Cme=function(t){return"<tbody>"+t.join("")+"</tbody>"},Rme=function(t){let e,n=[];for(t.showWeekNumber&&n.push("<th></th>"),e=0;e<7;e++)n.push('<th scope="col"><abbr title="'+mY(t,e)+'">'+mY(t,e,!0)+"</abbr></th>");return"<thead><tr>"+(t.isRTL?n.reverse():n).join("")+"</tr></thead>"},Eme=function(t,e,n,i,r,o){let a,u,h,d=t._o,g=n===d.minYear,m=n===d.maxYear,v='<div id="'+o+'" class="pika-title" role="heading" aria-live="polite">',y,b,C=!0,T=!0;for(h=[],a=0;a<12;a++)h.push('<option value="'+(n===r?a-e:12+a-e)+'"'+(a===i?' selected="selected"':"")+(g&&a<d.minMonth||m&&a>d.maxMonth?' disabled="disabled"':"")+">"+d.i18n.months[a]+"</option>");for(y='<div class="pika-label">'+d.i18n.months[i]+'<select class="pika-select pika-select-month" tabindex="-1">'+h.join("")+"</select></div>",BD(d.yearRange)?(a=d.yearRange[0],u=d.yearRange[1]+1):(a=n-d.yearRange,u=1+n+d.yearRange),h=[];a<u&&a<=d.maxYear;a++)a>=d.minYear&&h.push('<option value="'+a+'"'+(a===n?' selected="selected"':"")+">"+a+"</option>");return b='<div class="pika-label">'+n+d.yearSuffix+'<select class="pika-select pika-select-year" tabindex="-1">'+h.join("")+"</select></div>",d.showMonthAfterYear?v+=b+y:v+=y+b,g&&(i===0||d.minMonth>=i)&&(C=!1),m&&(i===11||d.maxMonth<=i)&&(T=!1),e===0&&(v+='<button class="pika-prev'+(C?"":" is-disabled")+'" type="button">'+d.i18n.previousMonth+"</button>"),e===t._o.numberOfMonths-1&&(v+='<button class="pika-next'+(T?"":" is-disabled")+'" type="button">'+d.i18n.nextMonth+"</button>"),v+="</div>"},Tme=function(t,e,n){return'<table cellpadding="0" cellspacing="0" class="pika-table" role="grid" aria-labelledby="'+n+'">'+Rme(t)+Cme(e)+"</table>"};function JH(t){let e=this,n=e.config(t);e._onMouseDown=function(r){if(!e._v)return;r=r||Hc().event;let o=r.target||r.srcElement;if(o)if(Ao(o,"is-disabled")||(Ao(o,"pika-button")&&!Ao(o,"is-empty")&&!Ao(o.parentNode,"is-disabled")?(e.setDate(new Date(o.getAttribute("data-pika-year"),o.getAttribute("data-pika-month"),o.getAttribute("data-pika-day"))),n.bound&&QH(function(){e.hide(),n.blurFieldOnSelect&&n.field&&n.field.blur()},100)):Ao(o,"pika-prev")?e.prevMonth():Ao(o,"pika-next")&&e.nextMonth()),Ao(o,"pika-select"))e._c=!0;else if(r.preventDefault)r.preventDefault();else return r.returnValue=!1,!1},e._onChange=function(r){r=r||Hc().event;let o=r.target||r.srcElement;o&&(Ao(o,"pika-select-month")?e.gotoMonth(o.value):Ao(o,"pika-select-year")&&e.gotoYear(o.value))},e._onKeyChange=function(r){if(r=r||Hc().event,e.isVisible())switch(r.keyCode){case 13:case 27:n.field&&n.field.blur();break;case 37:e.adjustDate("subtract",1);break;case 38:e.adjustDate("subtract",7);break;case 39:e.adjustDate("add",1);break;case 40:e.adjustDate("add",7);break;case 8:case 46:e.setDate(null);break}},e._parseFieldValue=function(){if(n.parse)return n.parse(n.field.value,n.format);if(this.hasMoment){let r=this.moment(n.field.value,n.format,n.formatStrict);return r&&r.isValid()?r.toDate():null}else return new Date(Date.parse(n.field.value))},e._onInputChange=function(r){let o;r.firedBy!==e&&(o=e._parseFieldValue(),No(o)&&e.setDate(o),e._v||e.show())},e._onInputFocus=function(){e.show()},e._onInputClick=function(){e.show()},e._onInputBlur=function(){let r=bs().activeElement;do if(Ao(r,"pika-single"))return;while(r=r.parentNode);e._c||(e._b=QH(function(){e.hide()},50)),e._c=!1},e._onClick=function(r){r=r||Hc().event;let o=r.target||r.srcElement,a=o;if(o){!hasEventListeners&&Ao(o,"pika-select")&&(o.onchange||(o.setAttribute("onchange","return;"),Fa(o,"change",e._onChange)));do if(Ao(a,"pika-single")||a===n.trigger)return;while(a=a.parentNode);e._v&&o!==n.trigger&&a!==n.trigger&&e.hide()}},e.el=bs().createElement("div"),e.el.className="pika-single"+(n.isRTL?" is-rtl":"")+(n.theme?" "+n.theme:""),Fa(e.el,"mousedown",e._onMouseDown,!0),Fa(e.el,"touchend",e._onMouseDown,!0),Fa(e.el,"change",e._onChange),n.keyboardInput&&Fa(bs(),"keydown",e._onKeyChange),n.field&&(n.container?n.container.appendChild(e.el):n.bound?bs().body.appendChild(e.el):n.field.parentNode.insertBefore(e.el,n.field.nextSibling),Fa(n.field,"change",e._onInputChange),n.defaultDate||(n.defaultDate=e._parseFieldValue(),n.setDefaultDate=!0));let i=n.defaultDate;No(i)?n.setDefaultDate?e.setDate(i,!0):e.gotoDate(i):e.gotoDate(new Date),n.bound?(this.hide(),e.el.className+=" is-bound",Fa(n.trigger,"click",e._onInputClick),Fa(n.trigger,"focus",e._onInputFocus),Fa(n.trigger,"blur",e._onInputBlur)):this.show()}JH.prototype={config:function(t){this._o||(this._o=l0({},Ma,!0));let e=l0(this._o,t,!0);e.isRTL=!!e.isRTL,e.field=e.field&&e.field.nodeName?e.field:null,e.theme=typeof e.theme=="string"&&e.theme?e.theme:null,e.bound=!!(e.bound!==void 0?e.field&&e.bound:e.field),e.trigger=e.trigger&&e.trigger.nodeName?e.trigger:e.field,e.disableWeekends=!!e.disableWeekends,e.disableDayFn=typeof e.disableDayFn=="function"?e.disableDayFn:null;let n=parseInt(e.numberOfMonths,10)||1;if(e.numberOfMonths=n>4?4:n,No(e.minDate)||(e.minDate=!1),No(e.maxDate)||(e.maxDate=!1),e.minDate&&e.maxDate&&e.maxDate<e.minDate&&(e.maxDate=e.minDate=!1),e.minDate&&this.setMinDate(e.minDate),e.maxDate&&this.setMaxDate(e.maxDate),BD(e.yearRange)){let i=new Date().getFullYear()-10;e.yearRange[0]=parseInt(e.yearRange[0],10)||i,e.yearRange[1]=parseInt(e.yearRange[1],10)||i}else e.yearRange=Math.abs(parseInt(e.yearRange,10))||Ma.yearRange,e.yearRange>100&&(e.yearRange=100);return e},toString:function(t){return t=t||this._o.format,No(this._d)?this._o.toString?this._o.toString(this._d,t):this.hasMoment?this.moment(this._d).format(t):this._d.toDateString():""},getMoment:function(){return this.hasMoment?this.moment(this._d):null},setMoment:function(t,e){this.hasMoment&&this.moment.isMoment(t)&&this.setDate(t.toDate(),e)},useMoment:function(t){this.hasMoment=!0,this.moment=t},getDate:function(){return No(this._d)?new Date(this._d.getTime()):null},setDate:function(t,e){if(!t)return this._d=null,this._o.field&&(this._o.field.value="",fY(this._o.field,"change",{firedBy:this})),this.draw();if(typeof t=="string"&&(t=new Date(Date.parse(t))),!No(t))return;let n=this._o.minDate,i=this._o.maxDate;No(n)&&t<n?t=n:No(i)&&t>i&&(t=i),this._d=new Date(t.getTime()),tb(this._d),this.gotoDate(this._d),this._o.field&&(this._o.field.value=this.toString(),fY(this._o.field,"change",{firedBy:this})),!e&&typeof this._o.onSelect=="function"&&this._o.onSelect.call(this,this.getDate())},clear:function(){this.setDate(null)},gotoDate:function(t){let e=!0;if(No(t)){if(this.calendars){let n=new Date(this.calendars[0].year,this.calendars[0].month,1),i=new Date(this.calendars[this.calendars.length-1].year,this.calendars[this.calendars.length-1].month,1),r=t.getTime();i.setMonth(i.getMonth()+1),i.setDate(i.getDate()-1),e=r<n.getTime()||i.getTime()<r}e&&(this.calendars=[{month:t.getMonth(),year:t.getFullYear()}],this._o.mainCalendar==="right"&&(this.calendars[0].month+=1-this._o.numberOfMonths)),this.adjustCalendars()}},adjustDate:function(t,e){let n=this.getDate()||new Date,i=parseInt(e)*24*60*60*1e3,r;t==="add"?r=new Date(n.valueOf()+i):t==="subtract"&&(r=new Date(n.valueOf()-i)),this.setDate(r)},adjustCalendars:function(){this.calendars[0]=gY(this.calendars[0]);for(let t=1;t<this._o.numberOfMonths;t++)this.calendars[t]=gY({month:this.calendars[0].month+t,year:this.calendars[0].year});this.draw()},gotoToday:function(){this.gotoDate(new Date)},gotoMonth:function(t){isNaN(t)||(this.calendars[0].month=parseInt(t,10),this.adjustCalendars())},nextMonth:function(){this.calendars[0].month++,this.adjustCalendars()},prevMonth:function(){this.calendars[0].month--,this.adjustCalendars()},gotoYear:function(t){isNaN(t)||(this.calendars[0].year=parseInt(t,10),this.adjustCalendars())},setMinDate:function(t){t instanceof Date?(tb(t),this._o.minDate=t,this._o.minYear=t.getFullYear(),this._o.minMonth=t.getMonth()):(this._o.minDate=Ma.minDate,this._o.minYear=Ma.minYear,this._o.minMonth=Ma.minMonth,this._o.startRange=Ma.startRange),this.draw()},setMaxDate:function(t){t instanceof Date?(tb(t),this._o.maxDate=t,this._o.maxYear=t.getFullYear(),this._o.maxMonth=t.getMonth()):(this._o.maxDate=Ma.maxDate,this._o.maxYear=Ma.maxYear,this._o.maxMonth=Ma.maxMonth,this._o.endRange=Ma.endRange),this.draw()},setStartRange:function(t){this._o.startRange=t},setEndRange:function(t){this._o.endRange=t},draw:function(t){if(!this._v&&!t)return;let e=this._o,n=e.minYear,i=e.maxYear,r=e.minMonth,o=e.maxMonth,a="",u;this._y<=n&&(this._y=n,!isNaN(r)&&this._m<r&&(this._m=r)),this._y>=i&&(this._y=i,!isNaN(o)&&this._m>o&&(this._m=o));for(let h=0;h<e.numberOfMonths;h++)u="pika-title-"+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(0,2),a+='<div class="pika-lendar">'+Eme(this,h,this.calendars[h].year,this.calendars[h].month,this.calendars[0].year,u)+this.render(this.calendars[h].year,this.calendars[h].month,u)+"</div>";this.el.innerHTML=a,e.bound&&e.field.type!=="hidden"&&QH(function(){e.trigger.focus()},1),typeof this._o.onDraw=="function"&&this._o.onDraw(this),e.bound&&e.field.setAttribute("aria-label",e.ariaLabel)},adjustPosition:function(){let t,e,n,i,r,o,a,u,h,d,g;this._o.container||(this.el.style.position="absolute",t=this._o.trigger,e=this.el.offsetWidth,n=this.el.offsetHeight,i=Hc().innerWidth||bs().documentElement.clientWidth,r=Hc().innerHeight||bs().documentElement.clientHeight,o=bs().body.scrollTop||bs().documentElement.scrollTop,d=!0,g=!0,h=t.getBoundingClientRect(),a=h.left+Hc().pageXOffset,u=h.bottom+Hc().pageYOffset,(this._o.reposition&&a+e>i||this._o.position.indexOf("right")>-1&&a-e+t.offsetWidth>0)&&(a=a-e+t.offsetWidth,d=!1),(this._o.reposition&&u+n>r+o||this._o.position.indexOf("top")>-1&&u-n-t.offsetHeight>0)&&(u=u-n-t.offsetHeight,g=!1),a<0&&(a=0),u<0&&(u=0),this.el.style.left=a+"px",this.el.style.top=u+"px",eO(this.el,d?"left-aligned":"right-aligned"),eO(this.el,g?"bottom-aligned":"top-aligned"),tO(this.el,d?"right-aligned":"left-aligned"),tO(this.el,g?"top-aligned":"bottom-aligned"))},render:function(t,e,n){let i=this._o,r=new Date,o=dY(t,e),a=new Date(t,e,1).getDay(),u=[],h=[];tb(r),i.firstDay>0&&(a-=i.firstDay,a<0&&(a+=7));let d=e===0?11:e-1,g=e===11?0:e+1,m=e===0?t-1:t,v=e===11?t+1:t,y=dY(m,d),b=o+a,C=b;for(;C>7;)C-=7;b+=7-C;let T=!1;for(let O=0,A=0;O<b;O++){let N=new Date(t,e,1+(O-a)),x=No(this._d)?nb(N,this._d):!1,$=nb(N,r),L=i.events.indexOf(N.toDateString())!==-1,P=O<a||O>=o+a,Q=1+(O-a),ue=e,X=t,me=i.startRange&&nb(i.startRange,N),re=i.endRange&&nb(i.endRange,N),Se=i.startRange&&i.endRange&&i.startRange<N&&N<i.endRange,we=i.minDate&&N<i.minDate||i.maxDate&&N>i.maxDate||i.disableWeekends&&pme(N)||i.disableDayFn&&i.disableDayFn(N);P&&(O<a?(Q=y+Q,ue=d,X=m):(Q=Q-o,ue=g,X=v));let _e={day:Q,month:ue,year:X,hasEvent:L,isSelected:x,isToday:$,isDisabled:we,isEmpty:P,isStartRange:me,isEndRange:re,isInRange:Se,showDaysInNextAndPreviousMonths:i.showDaysInNextAndPreviousMonths,enableSelectionDaysInNextAndPreviousMonths:i.enableSelectionDaysInNextAndPreviousMonths};i.pickWholeWeek&&x&&(T=!0),h.push(wme(_e)),++A===7&&(i.showWeekNumber&&h.unshift(Sme(this,O-a,e,t,i.firstWeekOfYearMinDays)),u.push(bme(h,i.isRTL,i.pickWholeWeek,T)),h=[],A=0,T=!1)}return Tme(i,u,n)},isVisible:function(){return this._v},show:function(){this.isVisible()||(this._v=!0,this.draw(),tO(this.el,"is-hidden"),this._o.bound&&(Fa(bs(),"click",this._onClick),this.adjustPosition()),typeof this._o.onOpen=="function"&&this._o.onOpen.call(this))},hide:function(){let t=this._v;t!==!1&&(this._o.bound&&Ll(bs(),"click",this._onClick),this._o.container||(this.el.style.position="static",this.el.style.left="auto",this.el.style.top="auto"),eO(this.el,"is-hidden"),this._v=!1,t!==void 0&&typeof this._o.onClose=="function"&&this._o.onClose.call(this))},destroy:function(){let t=this._o;this.hide(),Ll(this.el,"mousedown",this._onMouseDown,!0),Ll(this.el,"touchend",this._onMouseDown,!0),Ll(this.el,"change",this._onChange),t.keyboardInput&&Ll(bs(),"keydown",this._onKeyChange),t.field&&(Ll(t.field,"change",this._onInputChange),t.bound&&(Ll(t.trigger,"click",this._onInputClick),Ll(t.trigger,"focus",this._onInputFocus),Ll(t.trigger,"blur",this._onInputBlur))),this.el.parentNode&&this.el.parentNode.removeChild(this.el)}};function _me(t,e){Mme(t,e),e.add(t)}function Mme(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pY(t,e,n){return(e=Ame(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ame(t){var e=Ome(t,"string");return typeof e=="symbol"?e:e+""}function Ome(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function nO(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const oK="date",vY="dateEditor",xme="DD/MM/YYYY";var ib=new WeakSet;class sK extends jd{constructor(){super(...arguments),_me(this,ib),pY(this,"parentDestroyed",!1),pY(this,"$datePicker",null)}static get EDITOR_TYPE(){return oK}init(){if(typeof Ce!="function")throw new Error("You need to include moment.js to your project.");if(typeof JH!="function")throw new Error("You need to include Pikaday to your project.");super.init(),this.hot.addHook("afterDestroy",()=>{this.parentDestroyed=!0,this.destroyElements()}),this.hot.addHook("afterSetTheme",(e,n)=>{n||this.close()})}createElements(){super.createElements(),this.datePicker=this.hot.rootDocument.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,this.datePicker.setAttribute("dir",this.hot.isRtl()?"rtl":"ltr"),fe(this.datePicker,"htDatepickerHolder"),this.hot.rootPortalElement.appendChild(this.datePicker),this.eventManager.addEventListener(this.datePicker,"mousedown",e=>{Xe(e.target,"pika-day")&&this.hideDatepicker(),e.stopPropagation()})}destroyElements(){const e=this.datePicker.parentNode;this.$datePicker&&this.$datePicker.destroy(),e&&e.removeChild(this.datePicker)}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a)}open(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const i=this.hot.getShortcutManager().getContext("editor");this.showDatepicker(e),super.open(),i.addShortcuts([{keys:[["ArrowLeft"]],callback:()=>{this.$datePicker.adjustDate("subtract",1)}},{keys:[["ArrowRight"]],callback:()=>{this.$datePicker.adjustDate("add",1)}},{keys:[["ArrowUp"]],callback:()=>{this.$datePicker.adjustDate("subtract",7)}},{keys:[["ArrowDown"]],callback:()=>{this.$datePicker.adjustDate("add",7)}}],{group:vY})}close(){var e;(e=this.$datePicker)!==null&&e!==void 0&&e.destroy&&this.$datePicker.destroy(),this.hot._registerTimeout(()=>{const r=this.hot._getEditorManager();r.closeEditor(),this.hot.view.render(),r.prepareEditor()}),this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(vY),super.close()}finishEditing(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;super.finishEditing(e,n)}showDatepicker(e){const n=nO(ib,this,iO).call(this),i=this.hot.view.isMouseDown(),r=e?D4(e.keyCode):!1;let o;this.datePicker.style.display="block",this.$datePicker=new JH(this.getDatePickerConfig()),typeof this.$datePicker.useMoment=="function"&&this.$datePicker.useMoment(Ce),this.$datePicker._onInputFocus=function(){},this.originalValue?(o=this.originalValue,Ce(o,n,!0).isValid()&&this.$datePicker.setMoment(Ce(o,n),!0),this.getValue()!==this.originalValue&&this.setValue(this.originalValue),!r&&!i&&this.setValue("")):this.cellProperties.defaultDate?(o=this.cellProperties.defaultDate,Ce(o,n,!0).isValid()&&this.$datePicker.setMoment(Ce(o,n),!0),!r&&!i&&this.setValue("")):this.$datePicker.gotoToday()}hideDatepicker(){this.datePickerStyle.display="none",this.$datePicker.hide()}getDatePickerConfig(){var e;const n=this.TEXTAREA,i={};this.cellProperties&&this.cellProperties.datePickerConfig&&mR(i,this.cellProperties.datePickerConfig);const r=i.onSelect,o=i.onClose;return i.field=n,i.trigger=n,i.container=this.datePicker,i.bound=!1,i.keyboardInput=!1,i.format=(e=i.format)!==null&&e!==void 0?e:nO(ib,this,iO).call(this),i.reposition=i.reposition||!1,i.isRTL=!1,i.onSelect=a=>{let u=a;isNaN(u.getTime())||(u=Ce(u).format(nO(ib,this,iO).call(this))),this.setValue(u),r&&r(),el()&&this.hideDatepicker()},i.onClose=()=>{this.parentDestroyed||this.finishEditing(!1),o&&o()},i}refreshDimensions(e){var n;if(super.refreshDimensions(e),this.state!==Jn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.hideDatepicker();return}const{rowIndexMapper:i,columnIndexMapper:r}=this.hot,{wtOverlays:o}=this.hot.view._wt,{wtTable:a}=(n=o.getParentOverlay(this.TD))!==null&&n!==void 0?n:this.hot.view._wt,u=i.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleRow()),h=i.getVisualFromRenderableIndex(a.getLastPartiallyVisibleRow()),d=r.getVisualFromRenderableIndex(a.getFirstPartiallyVisibleColumn()),g=r.getVisualFromRenderableIndex(a.getLastPartiallyVisibleColumn());if(this.row>=u&&this.row<=h&&this.col>=d&&this.col<=g){const m=this.TD.getBoundingClientRect();this.datePickerStyle.top=`${this.hot.rootWindow.pageYOffset+m.top+Ti(this.TD)}px`;let v=this.hot.rootWindow.pageXOffset;this.hot.isRtl()?v+=m.right-hi(this.datePicker):v+=m.left,this.datePickerStyle.left=`${v}px`}else this.hideDatepicker()}}function iO(){var t;return(t=this.cellProperties.dateFormat)!==null&&t!==void 0?t:xme}const Hme="dropdown";class aK extends VD{static get EDITOR_TYPE(){return Hme}prepare(e,n,i,r,o,a){a.filter=!1,a.strict=!0,super.prepare(e,n,i,r,o,a)}}const Ime="numeric";class lK extends jd{static get EDITOR_TYPE(){return Ime}}function Pme(t,e,n){return(e=Nme(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Nme(t){var e=Dme(t,"string");return typeof e=="symbol"?e:e+""}function Dme(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const Lme="password";class uK extends jd{constructor(){super(...arguments),Pme(this,"autoResize",Y5(this.hot.rootDocument,{textContent:e=>"•".repeat(e.value.length)}))}static get EDITOR_TYPE(){return Lme}createElements(){super.createElements(),this.TEXTAREA=this.hot.rootDocument.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.setAttribute("data-hot-input",""),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,du(this.TEXTAREA_PARENT),this.TEXTAREA.setAttribute(...lo(-1)),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)}}const rO="ht_editor_visible",wY="selectEditor",kme="select";class cK extends Rm{static get EDITOR_TYPE(){return kme}init(){this.selectWrapper=this.hot.rootDocument.createElement("div"),this.select=this.hot.rootDocument.createElement("select"),this.select.setAttribute("data-hot-input","true"),this.selectWrapper.style.display="none";const e=this.hot.rootDocument.createElement("DIV"),n=this.hot.getSettings().ariaTags;e.className="htAutocompleteArrow",n&&e.setAttribute(...Bd()),e.appendChild(this.hot.rootDocument.createTextNode("▼")),fe(this.selectWrapper,"htSelectEditor"),this.selectWrapper.appendChild(this.select),this.selectWrapper.insertBefore(e,this.selectWrapper.firstChild),this.hot.rootElement.appendChild(this.selectWrapper),this.registerHooks()}getValue(){return this.select.value}setValue(e){this.select.value=e}open(){this._opened=!0,this.refreshDimensions(),this.selectWrapper.style.display="",this.hot.getShortcutManager().setActiveContextName("editor"),this.registerShortcuts()}close(){this._opened=!1,this.selectWrapper.style.display="none",Xe(this.selectWrapper,rO)&&Ve(this.selectWrapper,rO),this.unregisterShortcuts(),this.clearHooks()}focus(){this.select.focus()}registerHooks(){this.addHook("afterScrollHorizontally",()=>this.refreshDimensions()),this.addHook("afterScrollVertically",()=>this.refreshDimensions()),this.addHook("afterColumnResize",()=>this.refreshDimensions()),this.addHook("afterRowResize",()=>this.refreshDimensions())}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a);const u=this.cellProperties.selectOptions;let h;typeof u=="function"?h=this.prepareOptions(u(this.row,this.col,this.prop)):h=this.prepareOptions(u),du(this.select),wt(h,(d,g)=>{const m=this.hot.rootDocument.createElement("OPTION");m.value=g,Fd(m,d),this.select.appendChild(m)})}prepareOptions(e){let n={};if(Array.isArray(e))for(let i=0,r=e.length;i<r;i++)n[e[i]]=e[i];else typeof e=="object"&&(n=e);return n}refreshValue(){const e=this.hot.getSourceDataAtCell(this.row,this.prop);this.originalValue=e,this.setValue(e),this.refreshDimensions()}refreshDimensions(){if(this.state!==Jn.EDITING)return;if(this.TD=this.getEditedCell(),!this.TD){this.close();return}const{top:e,start:n,width:i,height:r}=this.getEditedCellRect(),o=this.selectWrapper.style;o.height=`${r}px`,o.width=`${i}px`,o.top=`${e}px`,o[this.hot.isRtl()?"right":"left"]=`${n}px`,o.margin="0px",fe(this.selectWrapper,rO)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("editor"),i={group:wY};this.isInFullEditMode()&&n.addShortcuts([{keys:[["ArrowUp"]],callback:()=>{const r=this.select.selectedIndex-1;r>=0&&(this.select[r].selected=!0)}},{keys:[["ArrowDown"]],callback:()=>{const r=this.select.selectedIndex+1;r<=this.select.length-1&&(this.select[r].selected=!0)}}],i)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("editor").removeShortcutsByGroup(wY)}}const $me="time";class hK extends jd{static get EDITOR_TYPE(){return $me}prepare(e,n,i,r,o,a){super.prepare(e,n,i,r,o,a),this.TEXTAREA.dir="ltr"}}function Vme(){xo(Rm),xo(VD),xo(rK),xo(sK),xo(aK),xo($D),xo(lK),xo(uK),xo(cK),xo(jd),xo(hK)}const Bme="html";function FD(t,e,n,i,r,o,a){Yw.apply(this,[t,e,n,i,r,o,a]),Fd(e,o??"",!1)}FD.RENDERER_TYPE=Bme;const Fme="autocomplete";function Tm(t,e,n,i,r,o,a){const{rootDocument:u}=t,h=a.allowHtml?FD:bu,d=u.createElement("DIV"),g=t.getSettings().ariaTags;if(d.className="htAutocompleteArrow",g&&d.setAttribute(...Bd()),d.appendChild(u.createTextNode("▼")),h.apply(this,[t,e,n,i,r,o,a]),e.firstChild||e.appendChild(u.createTextNode(" ")),e.insertBefore(d,e.firstChild),fe(e,"htAutocomplete"),!t.acArrowListener){const m=new da(t);t.acArrowListener=function(v){Xe(v.target,"htAutocompleteArrow")&&t.view._wt.getSetting("onCellDblClick",null,t._createCellCoords(n,i),e)},m.addEventListener(t.rootElement,"mousedown",t.acArrowListener),t.addHookOnce("afterDestroy",()=>{m.destroy()})}}Tm.RENDERER_TYPE=Fme;const Wme="dropdown";function WD(t,e,n,i,r,o,a){Tm.apply(this,[t,e,n,i,r,o,a])}WD.RENDERER_TYPE=Wme;const yY=new WeakMap,SY=new WeakMap,jme="htBadValue",rm="data-row",om="data-col",zme="checkboxRenderer",dK="checkbox";He.getSingleton().add("modifyAutoColumnSizeSeed",function(t,e,n){const{label:i,type:r,row:o,column:a,prop:u}=e;if(r===dK){if(i){const{value:h,property:d}=i;let g=n;if(h)g=typeof h=="function"?h(o,a,u,n):h;else if(d){const m=this.getDataAtRowProp(o,d);g=m!==null?m:n}t=g}return t}});function jD(t,e,n,i,r,o,a){const{rootDocument:u}=t,h=t.getSettings().ariaTags;Yw.apply(this,[t,e,n,i,r,o,a]),Ume(t);let d=Yme(u);const g=a.label;let m=!1;if(typeof a.checkedTemplate>"u"&&(a.checkedTemplate=!0),typeof a.uncheckedTemplate>"u"&&(a.uncheckedTemplate=!1),du(e),o===a.checkedTemplate||xn(o).toLocaleLowerCase(a.locale)===xn(a.checkedTemplate).toLocaleLowerCase(a.locale)?d.checked=!0:o===a.uncheckedTemplate||xn(o).toLocaleLowerCase(a.locale)===xn(a.uncheckedTemplate).toLocaleLowerCase(a.locale)?d.checked=!1:ni(o)?fe(d,"noValue"):(d.style.display="none",fe(d,jme),m=!0),We(d,[[rm,n],[om,i]]),h&&We(d,[Bo(d.checked?t.getTranslatedPhrase(AD):t.getTranslatedPhrase(OD)),p4(d.checked),sse()]),!m&&g){let C="";if(g.value)C=typeof g.value=="function"?g.value.call(this,n,i,r,o):g.value;else if(g.property){const O=t.getDataAtRowProp(n,g.property);C=O!==null?O:""}const T=Gme(u,C,g.separated!==!0);g.position==="before"?g.separated?(e.appendChild(T),e.appendChild(d)):(T.appendChild(d),d=T):(!g.position||g.position==="after")&&(g.separated?(e.appendChild(d),e.appendChild(T)):(T.insertBefore(d,T.firstChild),d=T))}(!g||g&&!g.separated)&&e.appendChild(d),m&&e.appendChild(u.createTextNode("#bad-value#")),yY.has(t)||(yY.set(t,!0),v());function v(){const T=t.getShortcutManager().getContext("grid"),O={group:zme,relativeToGroup:Yc,position:"before"};T.addShortcuts([{keys:[["space"]],callback:()=>(y(),!b()),runOnlyIf:()=>{var A;return(A=t.getSelectedRangeActive())===null||A===void 0?void 0:A.highlight.isCell()}},{keys:[["enter"]],callback:()=>(y(),!b()),runOnlyIf:()=>{const A=t.getSelectedRangeActive();return t.getSettings().enterBeginsEditing&&A?.highlight.isCell()&&!t.selection.isMultiple()}},{keys:[["delete"],["backspace"]],callback:()=>(y(!0),!b()),runOnlyIf:()=>{var A;return(A=t.getSelectedRangeActive())===null||A===void 0?void 0:A.highlight.isCell()}}],O)}function y(){let C=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const T=t.getSelectedRange(),O=[],A=new Map;let N=[],x=0;if(T){for(let $=0;$<T.length;$++){const{row:L,col:P}=T[$].getTopStartCorner(),{row:Q,col:ue}=T[$].getBottomEndCorner();for(let X=L;X<=Q;X+=1)for(let me=P;me<=ue;me+=1){const re=t.getCellMeta(X,me);if(re.hidden)continue;const Se={checkedTemplate:re.checkedTemplate,uncheckedTemplate:re.uncheckedTemplate};if(re.type!=="checkbox"){C===!0&&!re.readOnly&&(A.has(O.length)?A.set(O.length,[...A.get(O.length),[X,me,null]]):A.set(O.length,[[X,me,null]]));continue}if(re.readOnly===!0)continue;typeof re.checkedTemplate>"u"&&(re.checkedTemplate=!0),typeof re.uncheckedTemplate>"u"&&(re.uncheckedTemplate=!1);const we=t.getDataAtCell(X,me);C===!1?[re.checkedTemplate,re.checkedTemplate.toString()].includes(we)?N.push([X,me,re.uncheckedTemplate,Se]):[re.uncheckedTemplate,re.uncheckedTemplate.toString(),null,void 0].includes(we)&&N.push([X,me,re.checkedTemplate,Se]):N.push([X,me,re.uncheckedTemplate,Se]),x+=1}O.push(x),x=0}N.every($=>{let[,,L]=$;return L===N[0][2]})?N=N.map($=>{let[L,P,Q]=$;return[L,P,Q]}):N=N.map($=>{let[L,P,,Q]=$;return[L,P,Q.checkedTemplate]}),N.length>0&&O.forEach(($,L)=>{let P=N.splice(0,$);A.size&&A.has(L)&&(P=[...P,...A.get(L)]),t.setDataAtCell(P)})}}function b(){const C=t.getSelectedRange();if(C){for(let T=0;T<C.length;T++){const O=C[T].getTopStartCorner(),A=C[T].getBottomEndCorner();for(let N=O.row;N<=A.row;N++)for(let x=O.col;x<=A.col;x++){if(t.getCellMeta(N,x).readOnly)continue;const L=t.getCell(N,x);if(cu(L)&&L.querySelectorAll("input[type=checkbox]").length>0)return!0}}return!1}}}jD.RENDERER_TYPE=dK;function Ume(t){let e=SY.get(t);if(!e){const{rootElement:n}=t;e=new da(t),e.addEventListener(n,"click",i=>Kme(i,t)),e.addEventListener(n,"mouseup",i=>qme(i,t)),e.addEventListener(n,"change",i=>Xme(i,t)),SY.set(t,e)}return e}function Yme(t){const e=t.createElement("input");return e.className="htCheckboxRendererInput",e.type="checkbox",e.setAttribute("tabindex","-1"),e.cloneNode(!1)}function Gme(t,e,n){const i=t.createElement("label");i.className=`htCheckboxRendererLabel ${n?"fullWidth":""}`;const r=t.createTextNode(e);if(n){const o=t.createElement("span");o.appendChild(r),i.appendChild(o)}else i.appendChild(r);return i.cloneNode(!0)}function qme(t,e){const{target:n}=t;zD(n)&&(!n.hasAttribute(rm)||!n.hasAttribute(om)||setTimeout(e.listen,10))}function Kme(t,e){const{target:n}=t;if(!zD(n)||!n.hasAttribute(rm)||!n.hasAttribute(om))return;const i=parseInt(n.getAttribute(rm),10),r=parseInt(n.getAttribute(om),10);e.getCellMeta(i,r).readOnly&&t.preventDefault()}function Xme(t,e){const{target:n}=t;if(!zD(n)||!n.hasAttribute(rm)||!n.hasAttribute(om))return;const i=parseInt(n.getAttribute(rm),10),r=parseInt(n.getAttribute(om),10),o=e.getCellMeta(i,r);if(!o.readOnly){let a=null;t.target.checked?a=o.uncheckedTemplate===void 0?!0:o.checkedTemplate:a=o.uncheckedTemplate===void 0?!1:o.uncheckedTemplate,e.setDataAtCell(i,r,a)}}function zD(t){return t.tagName==="INPUT"&&t.getAttribute("type")==="checkbox"}const Zme="handsontable";function UD(t,e,n,i,r,o,a){Tm.apply(this,[t,e,n,i,r,o,a])}UD.RENDERER_TYPE=Zme;var Qme=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Jme(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var oO,bY;function epe(){return bY||(bY=1,oO={languageTag:"en-US",delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},spaceSeparated:!1,ordinal:function(t){let e=t%10;return~~(t%100/10)===1?"th":e===1?"st":e===2?"nd":e===3?"rd":"th"},bytes:{binarySuffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"],decimalSuffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},currency:{symbol:"$",position:"prefix",code:"USD"},currencyFormat:{thousandSeparated:!0,totalLength:4,spaceSeparated:!0,spaceSeparatedCurrency:!0},formats:{fourDigits:{totalLength:4,spaceSeparated:!0},fullWithTwoDecimals:{output:"currency",thousandSeparated:!0,mantissa:2},fullWithTwoDecimalsNoCurrency:{thousandSeparated:!0,mantissa:2},fullWithNoDecimals:{output:"currency",thousandSeparated:!0,mantissa:0}}}),oO}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var sO,CY;function fK(){if(CY)return sO;CY=1;const t=[{key:"ZiB",factor:Math.pow(1024,7)},{key:"ZB",factor:Math.pow(1e3,7)},{key:"YiB",factor:Math.pow(1024,8)},{key:"YB",factor:Math.pow(1e3,8)},{key:"TiB",factor:Math.pow(1024,4)},{key:"TB",factor:Math.pow(1e3,4)},{key:"PiB",factor:Math.pow(1024,5)},{key:"PB",factor:Math.pow(1e3,5)},{key:"MiB",factor:Math.pow(1024,2)},{key:"MB",factor:Math.pow(1e3,2)},{key:"KiB",factor:Math.pow(1024,1)},{key:"KB",factor:Math.pow(1e3,1)},{key:"GiB",factor:Math.pow(1024,3)},{key:"GB",factor:Math.pow(1e3,3)},{key:"EiB",factor:Math.pow(1024,6)},{key:"EB",factor:Math.pow(1e3,6)},{key:"B",factor:1}];function e(h){return h.replace(/[-/\\^$*+?.()|[\]{}]/g,"\\$&")}function n(h,d,g,m,v,y,b){if(!isNaN(+h))return+h;let C="",T=h.replace(/(^[^(]*)\((.*)\)([^)]*$)/,"$1$2$3");if(T!==h)return-1*n(T,d,g,m,v,y);for(let L=0;L<t.length;L++){let P=t[L];if(C=h.replace(RegExp(`([0-9 ])(${P.key})$`),"$1"),C!==h)return n(C,d,g,m,v,y)*P.factor}if(C=h.replace("%",""),C!==h)return n(C,d,g,m,v,y)/100;let O=parseFloat(h);if(isNaN(O))return;let A=m(O);if(A&&A!=="."&&(C=h.replace(new RegExp(`${e(A)}$`),""),C!==h))return n(C,d,g,m,v,y);let N={};Object.keys(y).forEach(L=>{N[y[L]]=L});let x=Object.keys(N).sort().reverse(),$=x.length;for(let L=0;L<$;L++){let P=x[L],Q=N[P];if(C=h.replace(P,""),C!==h){let ue;switch(Q){case"thousand":ue=Math.pow(10,3);break;case"million":ue=Math.pow(10,6);break;case"billion":ue=Math.pow(10,9);break;case"trillion":ue=Math.pow(10,12);break}return n(C,d,g,m,v,y)*ue}}}function i(h,d,g){let m=h.replace(g,"");return m=m.replace(new RegExp(`([0-9])${e(d.thousands)}([0-9])`,"g"),"$1$2"),m=m.replace(d.decimal,"."),m}function r(h,d,g="",m,v,y,b){if(h==="")return;if(h===v)return 0;let C=i(h,d,g);return n(C,d,g,m,v,y)}function o(h,d){if(!(h.indexOf(":")&&d.thousands!==":"))return!1;let m=h.split(":");if(m.length!==3)return!1;let v=+m[0],y=+m[1],b=+m[2];return!isNaN(v)&&!isNaN(y)&&!isNaN(b)}function a(h){let d=h.split(":"),g=+d[0],m=+d[1];return+d[2]+60*m+3600*g}function u(h,d){const g=qD();let m=g.currentDelimiters(),v=g.currentCurrency().symbol,y=g.currentOrdinal(),b=g.getZeroFormat(),C=g.currentAbbreviations(),T;if(typeof h=="string")o(h,m)?T=a(h):T=r(h,m,v,y,b,C);else if(typeof h=="number")T=h;else return;if(T!==void 0)return T}return sO={unformat:u},sO}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var aO,RY;function YD(){if(RY)return aO;RY=1;let t=fK();const e=/^[a-z]{2,3}(-[a-zA-Z]{4})?(-([A-Z]{2}|[0-9]{3}))?$/,n=["currency","percent","byte","time","ordinal","number"],i=["trillion","billion","million","thousand"],r=["prefix","infix","postfix"],o=["sign","parenthesis"],a={type:"object",children:{thousand:{type:"string",mandatory:!0},million:{type:"string",mandatory:!0},billion:{type:"string",mandatory:!0},trillion:{type:"string",mandatory:!0}},mandatory:!0},d={output:{type:"string",validValues:n},base:{type:"string",validValues:["decimal","binary","general"],restriction:(T,O)=>O.output==="byte",message:"`base` must be provided only when the output is `byte`",mandatory:T=>T.output==="byte"},characteristic:{type:"number",restriction:T=>T>=0,message:"value must be positive"},prefix:"string",postfix:"string",forceAverage:{type:"string",validValues:i},average:"boolean",lowPrecision:{type:"boolean",restriction:(T,O)=>O.average===!0,message:"`lowPrecision` must be provided only when the option `average` is set"},currencyPosition:{type:"string",validValues:r},currencySymbol:"string",totalLength:{type:"number",restrictions:[{restriction:T=>T>=0,message:"value must be positive"},{restriction:(T,O)=>!O.exponential,message:"`totalLength` is incompatible with `exponential`"}]},mantissa:{type:"number",restriction:T=>T>=0,message:"value must be positive"},optionalMantissa:"boolean",trimMantissa:"boolean",roundingFunction:"function",optionalCharacteristic:"boolean",thousandSeparated:"boolean",spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",spaceSeparatedAbbreviation:"boolean",abbreviations:{type:"object",children:{thousand:"string",million:"string",billion:"string",trillion:"string"}},negative:{type:"string",validValues:o},forceSign:"boolean",exponential:{type:"boolean"},prefixSymbol:{type:"boolean",restriction:(T,O)=>O.output==="percent",message:"`prefixSymbol` can be provided only when the output is `percent`"}},g={languageTag:{type:"string",mandatory:!0,restriction:T=>T.match(e),message:"the language tag must follow the BCP 47 specification (see https://tools.ieft.org/html/bcp47)"},delimiters:{type:"object",children:{thousands:"string",decimal:"string",thousandsSize:"number"},mandatory:!0},abbreviations:a,spaceSeparated:"boolean",spaceSeparatedCurrency:"boolean",ordinal:{type:"function",mandatory:!0},bytes:{type:"object",children:{binarySuffixes:"object",decimalSuffixes:"object"}},currency:{type:"object",children:{symbol:"string",position:"string",code:"string"},mandatory:!0},defaults:"format",ordinalFormat:"format",byteFormat:"format",percentageFormat:"format",currencyFormat:"format",timeDefaults:"format",formats:{type:"object",children:{fourDigits:{type:"format",mandatory:!0},fullWithTwoDecimals:{type:"format",mandatory:!0},fullWithTwoDecimalsNoCurrency:{type:"format",mandatory:!0},fullWithNoDecimals:{type:"format",mandatory:!0}}}};function m(T,O){let A=v(T),N=b(O);return A&&N}function v(T){return t.unformat(T)!==void 0}function y(T,O,A,N=!1){let x=Object.keys(T).map($=>{if(!O[$])return console.error(`${A} Invalid key: ${$}`),!1;let L=T[$],P=O[$];if(typeof P=="string"&&(P={type:P}),P.type==="format"){if(!y(L,d,`[Validate ${$}]`,!0))return!1}else if(typeof L!==P.type)return console.error(`${A} ${$} type mismatched: "${P.type}" expected, "${typeof L}" provided`),!1;if(P.restrictions&&P.restrictions.length){let Q=P.restrictions.length;for(let ue=0;ue<Q;ue++){let{restriction:X,message:me}=P.restrictions[ue];if(!X(L,T))return console.error(`${A} ${$} invalid value: ${me}`),!1}}return P.restriction&&!P.restriction(L,T)?(console.error(`${A} ${$} invalid value: ${P.message}`),!1):P.validValues&&P.validValues.indexOf(L)===-1?(console.error(`${A} ${$} invalid value: must be among ${JSON.stringify(P.validValues)}, "${L}" provided`),!1):!(P.children&&!y(L,P.children,`[Validate ${$}]`))});return N||x.push(...Object.keys(O).map($=>{let L=O[$];if(typeof L=="string"&&(L={type:L}),L.mandatory){let P=L.mandatory;if(typeof P=="function"&&(P=P(T)),P&&T[$]===void 0)return console.error(`${A} Missing mandatory key "${$}"`),!1}return!0})),x.reduce(($,L)=>$&&L,!0)}function b(T){return y(T,d,"[Validate format]")}function C(T){return y(T,g,"[Validate language]")}return aO={validate:m,validateFormat:b,validateInput:v,validateLanguage:C},aO}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function tpe(t,e){let n=t.match(/^{([^}]*)}/);return n?(e.prefix=n[1],t.slice(n[0].length)):t}function npe(t,e){let n=t.match(/{([^}]*)}$/);return n?(e.postfix=n[1],t.slice(0,-n[0].length)):t}function ipe(t,e){if(t.indexOf("$")!==-1){e.output="currency";return}if(t.indexOf("%")!==-1){e.output="percent";return}if(t.indexOf("bd")!==-1){e.output="byte",e.base="general";return}if(t.indexOf("b")!==-1){e.output="byte",e.base="binary";return}if(t.indexOf("d")!==-1){e.output="byte",e.base="decimal";return}if(t.indexOf(":")!==-1){e.output="time";return}t.indexOf("o")!==-1&&(e.output="ordinal")}function rpe(t,e){t.indexOf(",")!==-1&&(e.thousandSeparated=!0)}function ope(t,e){t.indexOf(" ")!==-1&&(e.spaceSeparated=!0,e.spaceSeparatedCurrency=!0,(e.average||e.forceAverage)&&(e.spaceSeparatedAbbreviation=!0))}function spe(t,e){let n=t.match(/[1-9]+[0-9]*/);n&&(e.totalLength=+n[0])}function ape(t,e){let i=t.split(".")[0].match(/0+/);i&&(e.characteristic=i[0].length)}function lpe(t,e){let n=t.split(".")[1];if(n){let i=n.match(/0+/);i&&(e.mantissa=i[0].length)}}function upe(t,e){const n=t.split(".")[1];n&&(e.trimMantissa=n.indexOf("[")!==-1)}function cpe(t,e){t.indexOf("a")!==-1&&(e.average=!0)}function hpe(t,e){t.indexOf("K")!==-1?e.forceAverage="thousand":t.indexOf("M")!==-1?e.forceAverage="million":t.indexOf("B")!==-1?e.forceAverage="billion":t.indexOf("T")!==-1&&(e.forceAverage="trillion")}function dpe(t,e){t.match(/\[\.]/)?e.optionalMantissa=!0:t.match(/\./)&&(e.optionalMantissa=!1)}function fpe(t,e){if(t.indexOf(".")!==-1){let n=t.split(".")[0];e.optionalCharacteristic=n.indexOf("0")===-1}}function gpe(t,e){t.match(/^\+?\([^)]*\)$/)&&(e.negative="parenthesis"),t.match(/^\+?-/)&&(e.negative="sign")}function mpe(t,e){t.match(/^\+/)&&(e.forceSign=!0)}function ppe(t,e={}){return typeof t!="string"?t:(t=tpe(t,e),t=npe(t,e),ipe(t,e),spe(t,e),ape(t,e),fpe(t,e),cpe(t,e),hpe(t,e),lpe(t,e),dpe(t,e),upe(t,e),rpe(t,e),ope(t,e),gpe(t,e),mpe(t,e),e)}var GD={parseFormat:ppe};/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */var lO,EY;function qD(){if(EY)return lO;EY=1;const t=epe(),e=YD(),n=GD;let i={},r,o={},a=null,u={};function h(g){r=g}function d(){return o[r]}return i.languages=()=>Object.assign({},o),i.currentLanguage=()=>r,i.currentBytes=()=>d().bytes||{},i.currentCurrency=()=>d().currency,i.currentAbbreviations=()=>d().abbreviations,i.currentDelimiters=()=>d().delimiters,i.currentOrdinal=()=>d().ordinal,i.currentDefaults=()=>Object.assign({},d().defaults,u),i.currentOrdinalDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().ordinalFormat),i.currentByteDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().byteFormat),i.currentPercentageDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().percentageFormat),i.currentCurrencyDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().currencyFormat),i.currentTimeDefaultFormat=()=>Object.assign({},i.currentDefaults(),d().timeFormat),i.setDefaults=g=>{g=n.parseFormat(g),e.validateFormat(g)&&(u=g)},i.getZeroFormat=()=>a,i.setZeroFormat=g=>a=typeof g=="string"?g:null,i.hasZeroFormat=()=>a!==null,i.languageData=g=>{if(g){if(o[g])return o[g];throw new Error(`Unknown tag "${g}"`)}return d()},i.registerLanguage=(g,m=!1)=>{if(!e.validateLanguage(g))throw new Error("Invalid language data");o[g.languageTag]=g,m&&h(g.languageTag)},i.setLanguage=(g,m=t.languageTag)=>{if(!o[g]){let v=g.split("-")[0],y=Object.keys(o).find(b=>b.split("-")[0]===v);if(!o[y]){h(m);return}h(y);return}h(g)},i.registerLanguage(t),r=t.languageTag,lO=i,lO}function vpe(t){throw new Error('Could not dynamically require "'+t+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */function wpe(t,e){t.forEach(n=>{let i;try{i=vpe(`../languages/${n}`)}catch{console.error(`Unable to load "${n}". No matching language file found.`)}i&&e.registerLanguage(i)})}var ype=t=>({loadLanguagesInNode:e=>wpe(e,t)}),gK={exports:{}};(function(t){(function(e){var n,i=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,r=Math.ceil,o=Math.floor,a="[BigNumber Error] ",u=a+"Number primitive has more than 15 significant digits: ",h=1e14,d=14,g=9007199254740991,m=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],v=1e7,y=1e9;function b(L){var P,Q,ue,X=S.prototype={constructor:S,toString:null,valueOf:null},me=new S(1),re=20,Se=4,we=-7,_e=21,ie=-1e7,de=1e7,Te=!1,Pe=1,De=0,V={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:" ",suffix:""},le="0123456789abcdefghijklmnopqrstuvwxyz",ye=!0;function S(_,I){var k,W,D,z,Z,j,K,ne,ee=this;if(!(ee instanceof S))return new S(_,I);if(I==null){if(_&&_._isBigNumber===!0){ee.s=_.s,!_.c||_.e>de?ee.c=ee.e=null:_.e<ie?ee.c=[ee.e=0]:(ee.e=_.e,ee.c=_.c.slice());return}if((j=typeof _=="number")&&_*0==0){if(ee.s=1/_<0?(_=-_,-1):1,_===~~_){for(z=0,Z=_;Z>=10;Z/=10,z++);z>de?ee.c=ee.e=null:(ee.e=z,ee.c=[_]);return}ne=String(_)}else{if(!i.test(ne=String(_)))return ue(ee,ne,j);ee.s=ne.charCodeAt(0)==45?(ne=ne.slice(1),-1):1}(z=ne.indexOf("."))>-1&&(ne=ne.replace(".","")),(Z=ne.search(/e/i))>0?(z<0&&(z=Z),z+=+ne.slice(Z+1),ne=ne.substring(0,Z)):z<0&&(z=ne.length)}else{if(A(I,2,le.length,"Base"),I==10&&ye)return ee=new S(_),q(ee,re+ee.e+1,Se);if(ne=String(_),j=typeof _=="number"){if(_*0!=0)return ue(ee,ne,j,I);if(ee.s=1/_<0?(ne=ne.slice(1),-1):1,S.DEBUG&&ne.replace(/^0\.0*|\./,"").length>15)throw Error(u+_)}else ee.s=ne.charCodeAt(0)===45?(ne=ne.slice(1),-1):1;for(k=le.slice(0,I),z=Z=0,K=ne.length;Z<K;Z++)if(k.indexOf(W=ne.charAt(Z))<0){if(W=="."){if(Z>z){z=K;continue}}else if(!D&&(ne==ne.toUpperCase()&&(ne=ne.toLowerCase())||ne==ne.toLowerCase()&&(ne=ne.toUpperCase()))){D=!0,Z=-1,z=0;continue}return ue(ee,String(_),j,I)}j=!1,ne=Q(ne,I,10,ee.s),(z=ne.indexOf("."))>-1?ne=ne.replace(".",""):z=ne.length}for(Z=0;ne.charCodeAt(Z)===48;Z++);for(K=ne.length;ne.charCodeAt(--K)===48;);if(ne=ne.slice(Z,++K)){if(K-=Z,j&&S.DEBUG&&K>15&&(_>g||_!==o(_)))throw Error(u+ee.s*_);if((z=z-Z-1)>de)ee.c=ee.e=null;else if(z<ie)ee.c=[ee.e=0];else{if(ee.e=z,ee.c=[],Z=(z+1)%d,z<0&&(Z+=d),Z<K){for(Z&&ee.c.push(+ne.slice(0,Z)),K-=d;Z<K;)ee.c.push(+ne.slice(Z,Z+=d));Z=d-(ne=ne.slice(Z)).length}else Z-=K;for(;Z--;ne+="0");ee.c.push(+ne)}}else ee.c=[ee.e=0]}S.clone=b,S.ROUND_UP=0,S.ROUND_DOWN=1,S.ROUND_CEIL=2,S.ROUND_FLOOR=3,S.ROUND_HALF_UP=4,S.ROUND_HALF_DOWN=5,S.ROUND_HALF_EVEN=6,S.ROUND_HALF_CEIL=7,S.ROUND_HALF_FLOOR=8,S.EUCLID=9,S.config=S.set=function(_){var I,k;if(_!=null)if(typeof _=="object"){if(_.hasOwnProperty(I="DECIMAL_PLACES")&&(k=_[I],A(k,0,y,I),re=k),_.hasOwnProperty(I="ROUNDING_MODE")&&(k=_[I],A(k,0,8,I),Se=k),_.hasOwnProperty(I="EXPONENTIAL_AT")&&(k=_[I],k&&k.pop?(A(k[0],-y,0,I),A(k[1],0,y,I),we=k[0],_e=k[1]):(A(k,-y,y,I),we=-(_e=k<0?-k:k))),_.hasOwnProperty(I="RANGE"))if(k=_[I],k&&k.pop)A(k[0],-y,-1,I),A(k[1],1,y,I),ie=k[0],de=k[1];else if(A(k,-y,y,I),k)ie=-(de=k<0?-k:k);else throw Error(a+I+" cannot be zero: "+k);if(_.hasOwnProperty(I="CRYPTO"))if(k=_[I],k===!!k)if(k)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))Te=k;else throw Te=!k,Error(a+"crypto unavailable");else Te=k;else throw Error(a+I+" not true or false: "+k);if(_.hasOwnProperty(I="MODULO_MODE")&&(k=_[I],A(k,0,9,I),Pe=k),_.hasOwnProperty(I="POW_PRECISION")&&(k=_[I],A(k,0,y,I),De=k),_.hasOwnProperty(I="FORMAT"))if(k=_[I],typeof k=="object")V=k;else throw Error(a+I+" not an object: "+k);if(_.hasOwnProperty(I="ALPHABET"))if(k=_[I],typeof k=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(k))ye=k.slice(0,10)=="0123456789",le=k;else throw Error(a+I+" invalid: "+k)}else throw Error(a+"Object expected: "+_);return{DECIMAL_PLACES:re,ROUNDING_MODE:Se,EXPONENTIAL_AT:[we,_e],RANGE:[ie,de],CRYPTO:Te,MODULO_MODE:Pe,POW_PRECISION:De,FORMAT:V,ALPHABET:le}},S.isBigNumber=function(_){if(!_||_._isBigNumber!==!0)return!1;if(!S.DEBUG)return!0;var I,k,W=_.c,D=_.e,z=_.s;e:if({}.toString.call(W)=="[object Array]"){if((z===1||z===-1)&&D>=-y&&D<=y&&D===o(D)){if(W[0]===0){if(D===0&&W.length===1)return!0;break e}if(I=(D+1)%d,I<1&&(I+=d),String(W[0]).length==I){for(I=0;I<W.length;I++)if(k=W[I],k<0||k>=h||k!==o(k))break e;if(k!==0)return!0}}}else if(W===null&&D===null&&(z===null||z===1||z===-1))return!0;throw Error(a+"Invalid BigNumber: "+_)},S.maximum=S.max=function(){return M(arguments,-1)},S.minimum=S.min=function(){return M(arguments,1)},S.random=(function(){var _=9007199254740992,I=Math.random()*_&2097151?function(){return o(Math.random()*_)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(k){var W,D,z,Z,j,K=0,ne=[],ee=new S(me);if(k==null?k=re:A(k,0,y),Z=r(k/d),Te)if(crypto.getRandomValues){for(W=crypto.getRandomValues(new Uint32Array(Z*=2));K<Z;)j=W[K]*131072+(W[K+1]>>>11),j>=9e15?(D=crypto.getRandomValues(new Uint32Array(2)),W[K]=D[0],W[K+1]=D[1]):(ne.push(j%1e14),K+=2);K=Z/2}else if(crypto.randomBytes){for(W=crypto.randomBytes(Z*=7);K<Z;)j=(W[K]&31)*281474976710656+W[K+1]*1099511627776+W[K+2]*4294967296+W[K+3]*16777216+(W[K+4]<<16)+(W[K+5]<<8)+W[K+6],j>=9e15?crypto.randomBytes(7).copy(W,K):(ne.push(j%1e14),K+=7);K=Z/7}else throw Te=!1,Error(a+"crypto unavailable");if(!Te)for(;K<Z;)j=I(),j<9e15&&(ne[K++]=j%1e14);for(Z=ne[--K],k%=d,Z&&k&&(j=m[d-k],ne[K]=o(Z/j)*j);ne[K]===0;ne.pop(),K--);if(K<0)ne=[z=0];else{for(z=-1;ne[0]===0;ne.splice(0,1),z-=d);for(K=1,j=ne[0];j>=10;j/=10,K++);K<d&&(z-=d-K)}return ee.e=z,ee.c=ne,ee}})(),S.sum=function(){for(var _=1,I=arguments,k=new S(I[0]);_<I.length;)k=k.plus(I[_++]);return k},Q=(function(){var _="0123456789";function I(k,W,D,z){for(var Z,j=[0],K,ne=0,ee=k.length;ne<ee;){for(K=j.length;K--;j[K]*=W);for(j[0]+=z.indexOf(k.charAt(ne++)),Z=0;Z<j.length;Z++)j[Z]>D-1&&(j[Z+1]==null&&(j[Z+1]=0),j[Z+1]+=j[Z]/D|0,j[Z]%=D)}return j.reverse()}return function(k,W,D,z,Z){var j,K,ne,ee,ce,Re,Ae,Le,it=k.indexOf("."),bt=re,Ze=Se;for(it>=0&&(ee=De,De=0,k=k.replace(".",""),Le=new S(W),Re=Le.pow(k.length-it),De=ee,Le.c=I($(T(Re.c),Re.e,"0"),10,D,_),Le.e=Le.c.length),Ae=I(k,W,D,Z?(j=le,_):(j=_,le)),ne=ee=Ae.length;Ae[--ee]==0;Ae.pop());if(!Ae[0])return j.charAt(0);if(it<0?--ne:(Re.c=Ae,Re.e=ne,Re.s=z,Re=P(Re,Le,bt,Ze,D),Ae=Re.c,ce=Re.r,ne=Re.e),K=ne+bt+1,it=Ae[K],ee=D/2,ce=ce||K<0||Ae[K+1]!=null,ce=Ze<4?(it!=null||ce)&&(Ze==0||Ze==(Re.s<0?3:2)):it>ee||it==ee&&(Ze==4||ce||Ze==6&&Ae[K-1]&1||Ze==(Re.s<0?8:7)),K<1||!Ae[0])k=ce?$(j.charAt(1),-bt,j.charAt(0)):j.charAt(0);else{if(Ae.length=K,ce)for(--D;++Ae[--K]>D;)Ae[K]=0,K||(++ne,Ae=[1].concat(Ae));for(ee=Ae.length;!Ae[--ee];);for(it=0,k="";it<=ee;k+=j.charAt(Ae[it++]));k=$(k,ne,j.charAt(0))}return k}})(),P=(function(){function _(W,D,z){var Z,j,K,ne,ee=0,ce=W.length,Re=D%v,Ae=D/v|0;for(W=W.slice();ce--;)K=W[ce]%v,ne=W[ce]/v|0,Z=Ae*K+ne*Re,j=Re*K+Z%v*v+ee,ee=(j/z|0)+(Z/v|0)+Ae*ne,W[ce]=j%z;return ee&&(W=[ee].concat(W)),W}function I(W,D,z,Z){var j,K;if(z!=Z)K=z>Z?1:-1;else for(j=K=0;j<z;j++)if(W[j]!=D[j]){K=W[j]>D[j]?1:-1;break}return K}function k(W,D,z,Z){for(var j=0;z--;)W[z]-=j,j=W[z]<D[z]?1:0,W[z]=j*Z+W[z]-D[z];for(;!W[0]&&W.length>1;W.splice(0,1));}return function(W,D,z,Z,j){var K,ne,ee,ce,Re,Ae,Le,it,bt,Ze,Je,Ct,Gn,Zi,Qi,Rn,un,Mt=W.s==D.s?1:-1,nt=W.c,Lt=D.c;if(!nt||!nt[0]||!Lt||!Lt[0])return new S(!W.s||!D.s||(nt?Lt&&nt[0]==Lt[0]:!Lt)?NaN:nt&&nt[0]==0||!Lt?Mt*0:Mt/0);for(it=new S(Mt),bt=it.c=[],ne=W.e-D.e,Mt=z+ne+1,j||(j=h,ne=C(W.e/d)-C(D.e/d),Mt=Mt/d|0),ee=0;Lt[ee]==(nt[ee]||0);ee++);if(Lt[ee]>(nt[ee]||0)&&ne--,Mt<0)bt.push(1),ce=!0;else{for(Zi=nt.length,Rn=Lt.length,ee=0,Mt+=2,Re=o(j/(Lt[0]+1)),Re>1&&(Lt=_(Lt,Re,j),nt=_(nt,Re,j),Rn=Lt.length,Zi=nt.length),Gn=Rn,Ze=nt.slice(0,Rn),Je=Ze.length;Je<Rn;Ze[Je++]=0);un=Lt.slice(),un=[0].concat(un),Qi=Lt[0],Lt[1]>=j/2&&Qi++;do{if(Re=0,K=I(Lt,Ze,Rn,Je),K<0){if(Ct=Ze[0],Rn!=Je&&(Ct=Ct*j+(Ze[1]||0)),Re=o(Ct/Qi),Re>1)for(Re>=j&&(Re=j-1),Ae=_(Lt,Re,j),Le=Ae.length,Je=Ze.length;I(Ae,Ze,Le,Je)==1;)Re--,k(Ae,Rn<Le?un:Lt,Le,j),Le=Ae.length,K=1;else Re==0&&(K=Re=1),Ae=Lt.slice(),Le=Ae.length;if(Le<Je&&(Ae=[0].concat(Ae)),k(Ze,Ae,Je,j),Je=Ze.length,K==-1)for(;I(Lt,Ze,Rn,Je)<1;)Re++,k(Ze,Rn<Je?un:Lt,Je,j),Je=Ze.length}else K===0&&(Re++,Ze=[0]);bt[ee++]=Re,Ze[0]?Ze[Je++]=nt[Gn]||0:(Ze=[nt[Gn]],Je=1)}while((Gn++<Zi||Ze[0]!=null)&&Mt--);ce=Ze[0]!=null,bt[0]||bt.splice(0,1)}if(j==h){for(ee=1,Mt=bt[0];Mt>=10;Mt/=10,ee++);q(it,z+(it.e=ee+ne*d-1)+1,Z,ce)}else it.e=ne,it.r=+ce;return it}})();function E(_,I,k,W){var D,z,Z,j,K;if(k==null?k=Se:A(k,0,8),!_.c)return _.toString();if(D=_.c[0],Z=_.e,I==null)K=T(_.c),K=W==1||W==2&&(Z<=we||Z>=_e)?x(K,Z):$(K,Z,"0");else if(_=q(new S(_),I,k),z=_.e,K=T(_.c),j=K.length,W==1||W==2&&(I<=z||z<=we)){for(;j<I;K+="0",j++);K=x(K,z)}else if(I-=Z,K=$(K,z,"0"),z+1>j){if(--I>0)for(K+=".";I--;K+="0");}else if(I+=z-j,I>0)for(z+1==j&&(K+=".");I--;K+="0");return _.s<0&&D?"-"+K:K}function M(_,I){for(var k,W,D=1,z=new S(_[0]);D<_.length;D++)W=new S(_[D]),(!W.s||(k=O(z,W))===I||k===0&&z.s===I)&&(z=W);return z}function F(_,I,k){for(var W=1,D=I.length;!I[--D];I.pop());for(D=I[0];D>=10;D/=10,W++);return(k=W+k*d-1)>de?_.c=_.e=null:k<ie?_.c=[_.e=0]:(_.e=k,_.c=I),_}ue=(function(){var _=/^(-?)0([xbo])(?=\w[\w.]*$)/i,I=/^([^.]+)\.$/,k=/^\.([^.]+)$/,W=/^-?(Infinity|NaN)$/,D=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(z,Z,j,K){var ne,ee=j?Z:Z.replace(D,"");if(W.test(ee))z.s=isNaN(ee)?null:ee<0?-1:1;else{if(!j&&(ee=ee.replace(_,function(ce,Re,Ae){return ne=(Ae=Ae.toLowerCase())=="x"?16:Ae=="b"?2:8,!K||K==ne?Re:ce}),K&&(ne=K,ee=ee.replace(I,"$1").replace(k,"0.$1")),Z!=ee))return new S(ee,ne);if(S.DEBUG)throw Error(a+"Not a"+(K?" base "+K:"")+" number: "+Z);z.s=null}z.c=z.e=null}})();function q(_,I,k,W){var D,z,Z,j,K,ne,ee,ce=_.c,Re=m;if(ce){e:{for(D=1,j=ce[0];j>=10;j/=10,D++);if(z=I-D,z<0)z+=d,Z=I,K=ce[ne=0],ee=o(K/Re[D-Z-1]%10);else if(ne=r((z+1)/d),ne>=ce.length)if(W){for(;ce.length<=ne;ce.push(0));K=ee=0,D=1,z%=d,Z=z-d+1}else break e;else{for(K=j=ce[ne],D=1;j>=10;j/=10,D++);z%=d,Z=z-d+D,ee=Z<0?0:o(K/Re[D-Z-1]%10)}if(W=W||I<0||ce[ne+1]!=null||(Z<0?K:K%Re[D-Z-1]),W=k<4?(ee||W)&&(k==0||k==(_.s<0?3:2)):ee>5||ee==5&&(k==4||W||k==6&&(z>0?Z>0?K/Re[D-Z]:0:ce[ne-1])%10&1||k==(_.s<0?8:7)),I<1||!ce[0])return ce.length=0,W?(I-=_.e+1,ce[0]=Re[(d-I%d)%d],_.e=-I||0):ce[0]=_.e=0,_;if(z==0?(ce.length=ne,j=1,ne--):(ce.length=ne+1,j=Re[d-z],ce[ne]=Z>0?o(K/Re[D-Z]%Re[Z])*j:0),W)for(;;)if(ne==0){for(z=1,Z=ce[0];Z>=10;Z/=10,z++);for(Z=ce[0]+=j,j=1;Z>=10;Z/=10,j++);z!=j&&(_.e++,ce[0]==h&&(ce[0]=1));break}else{if(ce[ne]+=j,ce[ne]!=h)break;ce[ne--]=0,j=1}for(z=ce.length;ce[--z]===0;ce.pop());}_.e>de?_.c=_.e=null:_.e<ie&&(_.c=[_.e=0])}return _}function J(_){var I,k=_.e;return k===null?_.toString():(I=T(_.c),I=k<=we||k>=_e?x(I,k):$(I,k,"0"),_.s<0?"-"+I:I)}return X.absoluteValue=X.abs=function(){var _=new S(this);return _.s<0&&(_.s=1),_},X.comparedTo=function(_,I){return O(this,new S(_,I))},X.decimalPlaces=X.dp=function(_,I){var k,W,D,z=this;if(_!=null)return A(_,0,y),I==null?I=Se:A(I,0,8),q(new S(z),_+z.e+1,I);if(!(k=z.c))return null;if(W=((D=k.length-1)-C(this.e/d))*d,D=k[D])for(;D%10==0;D/=10,W--);return W<0&&(W=0),W},X.dividedBy=X.div=function(_,I){return P(this,new S(_,I),re,Se)},X.dividedToIntegerBy=X.idiv=function(_,I){return P(this,new S(_,I),0,1)},X.exponentiatedBy=X.pow=function(_,I){var k,W,D,z,Z,j,K,ne,ee,ce=this;if(_=new S(_),_.c&&!_.isInteger())throw Error(a+"Exponent not an integer: "+J(_));if(I!=null&&(I=new S(I)),j=_.e>14,!ce.c||!ce.c[0]||ce.c[0]==1&&!ce.e&&ce.c.length==1||!_.c||!_.c[0])return ee=new S(Math.pow(+J(ce),j?_.s*(2-N(_)):+J(_))),I?ee.mod(I):ee;if(K=_.s<0,I){if(I.c?!I.c[0]:!I.s)return new S(NaN);W=!K&&ce.isInteger()&&I.isInteger(),W&&(ce=ce.mod(I))}else{if(_.e>9&&(ce.e>0||ce.e<-1||(ce.e==0?ce.c[0]>1||j&&ce.c[1]>=24e7:ce.c[0]<8e13||j&&ce.c[0]<=9999975e7)))return z=ce.s<0&&N(_)?-0:0,ce.e>-1&&(z=1/z),new S(K?1/z:z);De&&(z=r(De/d+2))}for(j?(k=new S(.5),K&&(_.s=1),ne=N(_)):(D=Math.abs(+J(_)),ne=D%2),ee=new S(me);;){if(ne){if(ee=ee.times(ce),!ee.c)break;z?ee.c.length>z&&(ee.c.length=z):W&&(ee=ee.mod(I))}if(D){if(D=o(D/2),D===0)break;ne=D%2}else if(_=_.times(k),q(_,_.e+1,1),_.e>14)ne=N(_);else{if(D=+J(_),D===0)break;ne=D%2}ce=ce.times(ce),z?ce.c&&ce.c.length>z&&(ce.c.length=z):W&&(ce=ce.mod(I))}return W?ee:(K&&(ee=me.div(ee)),I?ee.mod(I):z?q(ee,De,Se,Z):ee)},X.integerValue=function(_){var I=new S(this);return _==null?_=Se:A(_,0,8),q(I,I.e+1,_)},X.isEqualTo=X.eq=function(_,I){return O(this,new S(_,I))===0},X.isFinite=function(){return!!this.c},X.isGreaterThan=X.gt=function(_,I){return O(this,new S(_,I))>0},X.isGreaterThanOrEqualTo=X.gte=function(_,I){return(I=O(this,new S(_,I)))===1||I===0},X.isInteger=function(){return!!this.c&&C(this.e/d)>this.c.length-2},X.isLessThan=X.lt=function(_,I){return O(this,new S(_,I))<0},X.isLessThanOrEqualTo=X.lte=function(_,I){return(I=O(this,new S(_,I)))===-1||I===0},X.isNaN=function(){return!this.s},X.isNegative=function(){return this.s<0},X.isPositive=function(){return this.s>0},X.isZero=function(){return!!this.c&&this.c[0]==0},X.minus=function(_,I){var k,W,D,z,Z=this,j=Z.s;if(_=new S(_,I),I=_.s,!j||!I)return new S(NaN);if(j!=I)return _.s=-I,Z.plus(_);var K=Z.e/d,ne=_.e/d,ee=Z.c,ce=_.c;if(!K||!ne){if(!ee||!ce)return ee?(_.s=-I,_):new S(ce?Z:NaN);if(!ee[0]||!ce[0])return ce[0]?(_.s=-I,_):new S(ee[0]?Z:Se==3?-0:0)}if(K=C(K),ne=C(ne),ee=ee.slice(),j=K-ne){for((z=j<0)?(j=-j,D=ee):(ne=K,D=ce),D.reverse(),I=j;I--;D.push(0));D.reverse()}else for(W=(z=(j=ee.length)<(I=ce.length))?j:I,j=I=0;I<W;I++)if(ee[I]!=ce[I]){z=ee[I]<ce[I];break}if(z&&(D=ee,ee=ce,ce=D,_.s=-_.s),I=(W=ce.length)-(k=ee.length),I>0)for(;I--;ee[k++]=0);for(I=h-1;W>j;){if(ee[--W]<ce[W]){for(k=W;k&&!ee[--k];ee[k]=I);--ee[k],ee[W]+=h}ee[W]-=ce[W]}for(;ee[0]==0;ee.splice(0,1),--ne);return ee[0]?F(_,ee,ne):(_.s=Se==3?-1:1,_.c=[_.e=0],_)},X.modulo=X.mod=function(_,I){var k,W,D=this;return _=new S(_,I),!D.c||!_.s||_.c&&!_.c[0]?new S(NaN):!_.c||D.c&&!D.c[0]?new S(D):(Pe==9?(W=_.s,_.s=1,k=P(D,_,0,3),_.s=W,k.s*=W):k=P(D,_,0,Pe),_=D.minus(k.times(_)),!_.c[0]&&Pe==1&&(_.s=D.s),_)},X.multipliedBy=X.times=function(_,I){var k,W,D,z,Z,j,K,ne,ee,ce,Re,Ae,Le,it,bt,Ze=this,Je=Ze.c,Ct=(_=new S(_,I)).c;if(!Je||!Ct||!Je[0]||!Ct[0])return!Ze.s||!_.s||Je&&!Je[0]&&!Ct||Ct&&!Ct[0]&&!Je?_.c=_.e=_.s=null:(_.s*=Ze.s,!Je||!Ct?_.c=_.e=null:(_.c=[0],_.e=0)),_;for(W=C(Ze.e/d)+C(_.e/d),_.s*=Ze.s,K=Je.length,ce=Ct.length,K<ce&&(Le=Je,Je=Ct,Ct=Le,D=K,K=ce,ce=D),D=K+ce,Le=[];D--;Le.push(0));for(it=h,bt=v,D=ce;--D>=0;){for(k=0,Re=Ct[D]%bt,Ae=Ct[D]/bt|0,Z=K,z=D+Z;z>D;)ne=Je[--Z]%bt,ee=Je[Z]/bt|0,j=Ae*ne+ee*Re,ne=Re*ne+j%bt*bt+Le[z]+k,k=(ne/it|0)+(j/bt|0)+Ae*ee,Le[z--]=ne%it;Le[z]=k}return k?++W:Le.splice(0,1),F(_,Le,W)},X.negated=function(){var _=new S(this);return _.s=-_.s||null,_},X.plus=function(_,I){var k,W=this,D=W.s;if(_=new S(_,I),I=_.s,!D||!I)return new S(NaN);if(D!=I)return _.s=-I,W.minus(_);var z=W.e/d,Z=_.e/d,j=W.c,K=_.c;if(!z||!Z){if(!j||!K)return new S(D/0);if(!j[0]||!K[0])return K[0]?_:new S(j[0]?W:D*0)}if(z=C(z),Z=C(Z),j=j.slice(),D=z-Z){for(D>0?(Z=z,k=K):(D=-D,k=j),k.reverse();D--;k.push(0));k.reverse()}for(D=j.length,I=K.length,D-I<0&&(k=K,K=j,j=k,I=D),D=0;I;)D=(j[--I]=j[I]+K[I]+D)/h|0,j[I]=h===j[I]?0:j[I]%h;return D&&(j=[D].concat(j),++Z),F(_,j,Z)},X.precision=X.sd=function(_,I){var k,W,D,z=this;if(_!=null&&_!==!!_)return A(_,1,y),I==null?I=Se:A(I,0,8),q(new S(z),_,I);if(!(k=z.c))return null;if(D=k.length-1,W=D*d+1,D=k[D]){for(;D%10==0;D/=10,W--);for(D=k[0];D>=10;D/=10,W++);}return _&&z.e+1>W&&(W=z.e+1),W},X.shiftedBy=function(_){return A(_,-g,g),this.times("1e"+_)},X.squareRoot=X.sqrt=function(){var _,I,k,W,D,z=this,Z=z.c,j=z.s,K=z.e,ne=re+4,ee=new S("0.5");if(j!==1||!Z||!Z[0])return new S(!j||j<0&&(!Z||Z[0])?NaN:Z?z:1/0);if(j=Math.sqrt(+J(z)),j==0||j==1/0?(I=T(Z),(I.length+K)%2==0&&(I+="0"),j=Math.sqrt(+I),K=C((K+1)/2)-(K<0||K%2),j==1/0?I="5e"+K:(I=j.toExponential(),I=I.slice(0,I.indexOf("e")+1)+K),k=new S(I)):k=new S(j+""),k.c[0]){for(K=k.e,j=K+ne,j<3&&(j=0);;)if(D=k,k=ee.times(D.plus(P(z,D,ne,1))),T(D.c).slice(0,j)===(I=T(k.c)).slice(0,j))if(k.e<K&&--j,I=I.slice(j-3,j+1),I=="9999"||!W&&I=="4999"){if(!W&&(q(D,D.e+re+2,0),D.times(D).eq(z))){k=D;break}ne+=4,j+=4,W=1}else{(!+I||!+I.slice(1)&&I.charAt(0)=="5")&&(q(k,k.e+re+2,1),_=!k.times(k).eq(z));break}}return q(k,k.e+re+1,Se,_)},X.toExponential=function(_,I){return _!=null&&(A(_,0,y),_++),E(this,_,I,1)},X.toFixed=function(_,I){return _!=null&&(A(_,0,y),_=_+this.e+1),E(this,_,I)},X.toFormat=function(_,I,k){var W,D=this;if(k==null)_!=null&&I&&typeof I=="object"?(k=I,I=null):_&&typeof _=="object"?(k=_,_=I=null):k=V;else if(typeof k!="object")throw Error(a+"Argument not an object: "+k);if(W=D.toFixed(_,I),D.c){var z,Z=W.split("."),j=+k.groupSize,K=+k.secondaryGroupSize,ne=k.groupSeparator||"",ee=Z[0],ce=Z[1],Re=D.s<0,Ae=Re?ee.slice(1):ee,Le=Ae.length;if(K&&(z=j,j=K,K=z,Le-=z),j>0&&Le>0){for(z=Le%j||j,ee=Ae.substr(0,z);z<Le;z+=j)ee+=ne+Ae.substr(z,j);K>0&&(ee+=ne+Ae.slice(z)),Re&&(ee="-"+ee)}W=ce?ee+(k.decimalSeparator||"")+((K=+k.fractionGroupSize)?ce.replace(new RegExp("\\d{"+K+"}\\B","g"),"$&"+(k.fractionGroupSeparator||"")):ce):ee}return(k.prefix||"")+W+(k.suffix||"")},X.toFraction=function(_){var I,k,W,D,z,Z,j,K,ne,ee,ce,Re,Ae=this,Le=Ae.c;if(_!=null&&(j=new S(_),!j.isInteger()&&(j.c||j.s!==1)||j.lt(me)))throw Error(a+"Argument "+(j.isInteger()?"out of range: ":"not an integer: ")+J(j));if(!Le)return new S(Ae);for(I=new S(me),ne=k=new S(me),W=K=new S(me),Re=T(Le),z=I.e=Re.length-Ae.e-1,I.c[0]=m[(Z=z%d)<0?d+Z:Z],_=!_||j.comparedTo(I)>0?z>0?I:ne:j,Z=de,de=1/0,j=new S(Re),K.c[0]=0;ee=P(j,I,0,1),D=k.plus(ee.times(W)),D.comparedTo(_)!=1;)k=W,W=D,ne=K.plus(ee.times(D=ne)),K=D,I=j.minus(ee.times(D=I)),j=D;return D=P(_.minus(k),W,0,1),K=K.plus(D.times(ne)),k=k.plus(D.times(W)),K.s=ne.s=Ae.s,z=z*2,ce=P(ne,W,z,Se).minus(Ae).abs().comparedTo(P(K,k,z,Se).minus(Ae).abs())<1?[ne,W]:[K,k],de=Z,ce},X.toNumber=function(){return+J(this)},X.toPrecision=function(_,I){return _!=null&&A(_,1,y),E(this,_,I,2)},X.toString=function(_){var I,k=this,W=k.s,D=k.e;return D===null?W?(I="Infinity",W<0&&(I="-"+I)):I="NaN":(_==null?I=D<=we||D>=_e?x(T(k.c),D):$(T(k.c),D,"0"):_===10&&ye?(k=q(new S(k),re+D+1,Se),I=$(T(k.c),k.e,"0")):(A(_,2,le.length,"Base"),I=Q($(T(k.c),D,"0"),10,_,W,!0)),W<0&&k.c[0]&&(I="-"+I)),I},X.valueOf=X.toJSON=function(){return J(this)},X._isBigNumber=!0,L!=null&&S.set(L),S}function C(L){var P=L|0;return L>0||L===P?P:P-1}function T(L){for(var P,Q,ue=1,X=L.length,me=L[0]+"";ue<X;){for(P=L[ue++]+"",Q=d-P.length;Q--;P="0"+P);me+=P}for(X=me.length;me.charCodeAt(--X)===48;);return me.slice(0,X+1||1)}function O(L,P){var Q,ue,X=L.c,me=P.c,re=L.s,Se=P.s,we=L.e,_e=P.e;if(!re||!Se)return null;if(Q=X&&!X[0],ue=me&&!me[0],Q||ue)return Q?ue?0:-Se:re;if(re!=Se)return re;if(Q=re<0,ue=we==_e,!X||!me)return ue?0:!X^Q?1:-1;if(!ue)return we>_e^Q?1:-1;for(Se=(we=X.length)<(_e=me.length)?we:_e,re=0;re<Se;re++)if(X[re]!=me[re])return X[re]>me[re]^Q?1:-1;return we==_e?0:we>_e^Q?1:-1}function A(L,P,Q,ue){if(L<P||L>Q||L!==o(L))throw Error(a+(ue||"Argument")+(typeof L=="number"?L<P||L>Q?" out of range: ":" not an integer: ":" not a primitive number: ")+String(L))}function N(L){var P=L.c.length-1;return C(L.e/d)==P&&L.c[P]%2!=0}function x(L,P){return(L.length>1?L.charAt(0)+"."+L.slice(1):L)+(P<0?"e":"e+")+P}function $(L,P,Q){var ue,X;if(P<0){for(X=Q+".";++P;X+=Q);L=X+L}else if(ue=L.length,++P>ue){for(X=Q,P-=ue;--P;X+=Q);L+=X}else P<ue&&(L=L.slice(0,P)+"."+L.slice(P));return L}n=b(),n.default=n.BigNumber=n,t.exports?t.exports=n:(e||(e=typeof self<"u"&&self?self:window),e.BigNumber=n)})(Qme)})(gK);var mK=gK.exports;/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Zs=qD(),Spe=YD(),bpe=GD,Cpe=mK,rr={trillion:Math.pow(10,12),billion:Math.pow(10,9),million:Math.pow(10,6),thousand:Math.pow(10,3)},Gw={totalLength:0,characteristic:0,forceAverage:!1,average:!1,mantissa:-1,optionalMantissa:!0,thousandSeparated:!1,spaceSeparated:!1,negative:"sign",forceSign:!1,roundingFunction:Math.round,spaceSeparatedAbbreviation:!1},{binarySuffixes:pK,decimalSuffixes:u0}=Zs.currentBytes(),KD={general:{scale:1024,suffixes:u0},binary:{scale:1024,suffixes:pK},decimal:{scale:1e3,suffixes:u0}};function Rpe(t,e={},n){if(typeof e=="string"&&(e=bpe.parseFormat(e)),!Spe.validateFormat(e))return"ERROR: invalid format";let r=e.prefix||"",o=e.postfix||"",a=Epe(t,e,n);return a=jpe(a,r),a=zpe(a,o),a}function Epe(t,e,n){switch(e.output){case"currency":return e=vg(e,Zs.currentCurrencyDefaultFormat()),Ipe(t,e,Zs);case"percent":return e=vg(e,Zs.currentPercentageDefaultFormat()),Hpe(t,e,Zs,n);case"byte":return e=vg(e,Zs.currentByteDefaultFormat()),Ape(t,e,Zs,n);case"time":return e=vg(e,Zs.currentTimeDefaultFormat()),xpe(t);case"ordinal":return e=vg(e,Zs.currentOrdinalDefaultFormat()),Ope(t,e,Zs);case"number":default:return qw({instance:t,providedFormat:e})}}function Tpe(t){let e=KD.decimal;return PR(t._value,e.suffixes,e.scale).suffix}function _pe(t){let e=KD.binary;return PR(t._value,e.suffixes,e.scale).suffix}function Mpe(t){let e=KD.general;return PR(t._value,e.suffixes,e.scale).suffix}function PR(t,e,n){let i=e[0],r=Math.abs(t);if(r>=n){for(let o=1;o<e.length;++o){let a=Math.pow(n,o),u=Math.pow(n,o+1);if(r>=a&&r<u){i=e[o],t=t/a;break}}i===e[0]&&(t=t/Math.pow(n,e.length-1),i=e[e.length-1])}return{value:t,suffix:i}}function Ape(t,e,n,i){let r=e.base||"binary",o=Object.assign({},Gw,e);const{binarySuffixes:a,decimalSuffixes:u}=n.currentBytes();let d={general:{scale:1024,suffixes:u||u0,marker:"bd"},binary:{scale:1024,suffixes:a||pK,marker:"b"},decimal:{scale:1e3,suffixes:u||u0,marker:"d"}}[r],{value:g,suffix:m}=PR(t._value,d.suffixes,d.scale);return`${qw({instance:i(g),providedFormat:e,state:n,defaults:n.currentByteDefaultFormat()})}${o.spaceSeparated?" ":""}${m}`}function Ope(t,e,n){let i=n.currentOrdinal(),r=Object.assign({},Gw,e),o=qw({instance:t,providedFormat:e,state:n}),a=i(t._value);return`${o}${r.spaceSeparated?" ":""}${a}`}function xpe(t){let e=Math.floor(t._value/60/60),n=Math.floor((t._value-e*60*60)/60),i=Math.round(t._value-e*60*60-n*60);return`${e}:${n<10?"0":""}${n}:${i<10?"0":""}${i}`}function Hpe(t,e,n,i){let r=e.prefixSymbol,o=qw({instance:i(t._value*100),providedFormat:e,state:n}),a=Object.assign({},Gw,e);return r?`%${a.spaceSeparated?" ":""}${o}`:`${o}${a.spaceSeparated?" ":""}%`}function Ipe(t,e,n){const i=n.currentCurrency();let r=Object.assign({},e),o=Object.assign({},Gw,r),a,u="",h=!!o.totalLength||!!o.forceAverage||o.average,d=r.currencyPosition||i.position,g=r.currencySymbol||i.symbol;const m=o.spaceSeparatedCurrency!==void 0?o.spaceSeparatedCurrency:o.spaceSeparated;r.lowPrecision===void 0&&(r.lowPrecision=!1),m&&(u=" "),d==="infix"&&(a=u+g+u);let v=qw({instance:t,providedFormat:r,state:n,decimalSeparator:a});return d==="prefix"&&(t._value<0&&o.negative==="sign"?v=`-${u}${g}${v.slice(1)}`:t._value>0&&o.forceSign?v=`+${u}${g}${v.slice(1)}`:v=g+u+v),(!d||d==="postfix")&&(u=!o.spaceSeparatedAbbreviation&&h?"":u,v=v+u+g),v}function Ppe({value:t,forceAverage:e,lowPrecision:n=!0,abbreviations:i,spaceSeparated:r=!1,totalLength:o=0,roundingFunction:a=Math.round}){let u="",h=Math.abs(t),d=-1;if(e&&i[e]&&rr[e]?(u=i[e],t=t/rr[e]):h>=rr.trillion||n&&a(h/rr.trillion)===1?(u=i.trillion,t=t/rr.trillion):h<rr.trillion&&h>=rr.billion||n&&a(h/rr.billion)===1?(u=i.billion,t=t/rr.billion):h<rr.billion&&h>=rr.million||n&&a(h/rr.million)===1?(u=i.million,t=t/rr.million):(h<rr.million&&h>=rr.thousand||n&&a(h/rr.thousand)===1)&&(u=i.thousand,t=t/rr.thousand),u&&(u=(r?" ":"")+u),o){let m=t<0,v=t.toString().split(".")[0],y=m?v.length-1:v.length;d=Math.max(o-y,0)}return{value:t,abbreviation:u,mantissaPrecision:d}}function Npe({value:t,characteristicPrecision:e}){let[n,i]=t.toExponential().split("e"),r=+n;if(!e)return{value:r,abbreviation:`e${i}`};let o=1;return o<e&&(r=r*Math.pow(10,e-o),i=+i-(e-o),i=i>=0?`+${i}`:i),{value:r,abbreviation:`e${i}`}}function rb(t){let e="";for(let n=0;n<t;n++)e+="0";return e}function Dpe(t,e){let n=t.toString(),[i,r]=n.split("e"),[o,a=""]=i.split(".");if(+r>0)n=o+a+rb(r-a.length);else{let u=".";+o<0?u=`-0${u}`:u=`0${u}`;let h=(rb(-r-1)+Math.abs(o)+a).substr(0,e);h.length<e&&(h+=rb(e-h.length)),n=u+h}return+r>0&&e>0&&(n+=`.${rb(e)}`),n}function Lpe(t,e,n=Math.round){return t.toString().indexOf("e")!==-1?Dpe(t,e):new Cpe(n(+`${t}e+${e}`)/Math.pow(10,e)).toFixed(e)}function kpe(t,e,n,i,r,o){if(i===-1)return t;let a=Lpe(e,i,o),[u,h=""]=a.toString().split(".");if(h.match(/^0+$/)&&(n||r))return u;let d=h.match(/0+$/);return r&&d?`${u}.${h.toString().slice(0,d.index)}`:a.toString()}function $pe(t,e,n,i){let r=t,[o,a]=r.toString().split(".");if(o.match(/^-?0$/)&&n)return a?`${o.replace("0","")}.${a}`:o.replace("0","");const u=e<0&&o.indexOf("-")===0;if(u&&(o=o.slice(1),r=r.slice(1)),o.length<i){let h=i-o.length;for(let d=0;d<h;d++)r=`0${r}`}return u&&(r=`-${r}`),r.toString()}function Vpe(t,e){let n=[],i=0;for(let r=t;r>0;r--)i===e&&(n.unshift(r),i=0),i++;return n}function Bpe(t,e,n,i,r){let o=i.currentDelimiters(),a=o.thousands;r=r||o.decimal;let u=o.thousandsSize||3,h=t.toString(),d=h.split(".")[0],g=h.split(".")[1];const m=e<0&&d.indexOf("-")===0;return n&&(m&&(d=d.slice(1)),Vpe(d.length,u).forEach((y,b)=>{d=d.slice(0,y+b)+a+d.slice(y+b)}),m&&(d=`-${d}`)),g?h=d+r+g:h=d,h}function Fpe(t,e){return t+e}function Wpe(t,e,n){return e===0?t:+t==0?t.replace("-",""):e>0?`+${t}`:n==="sign"?t:`(${t.replace("-","")})`}function jpe(t,e){return e+t}function zpe(t,e){return t+e}function qw({instance:t,providedFormat:e,state:n=Zs,decimalSeparator:i,defaults:r=n.currentDefaults()}){let o=t._value;if(o===0&&n.hasZeroFormat())return n.getZeroFormat();if(!isFinite(o))return o.toString();let a=Object.assign({},Gw,r,e),u=a.totalLength,h=u?0:a.characteristic,d=a.optionalCharacteristic,g=a.forceAverage,m=a.lowPrecision,v=!!u||!!g||a.average,y=u?-1:v&&e.mantissa===void 0?0:a.mantissa,b=u?!1:e.optionalMantissa===void 0?y===-1:a.optionalMantissa,C=a.trimMantissa,T=a.thousandSeparated,O=a.spaceSeparated,A=a.negative,N=a.forceSign,x=a.exponential,$=a.roundingFunction,L="";if(v){let Q=Ppe({value:o,forceAverage:g,lowPrecision:m,abbreviations:n.currentAbbreviations(),spaceSeparated:O,roundingFunction:$,totalLength:u});o=Q.value,L+=Q.abbreviation,u&&(y=Q.mantissaPrecision)}if(x){let Q=Npe({value:o,characteristicPrecision:h});o=Q.value,L=Q.abbreviation+L}let P=kpe(o.toString(),o,b,y,C,$);return P=$pe(P,o,d,h),P=Bpe(P,o,T,n,i),(v||x)&&(P=Fpe(P,L)),(N||o<0)&&(P=Wpe(P,o,A)),P}function vg(t,e){if(!t)return e;let n=Object.keys(t);return n.length===1&&n[0]==="output"?e:t}var Upe=t=>({format:(...e)=>Rpe(...e,t),getByteUnit:(...e)=>Mpe(...e,t),getBinaryByteUnit:(...e)=>_pe(...e,t),getDecimalByteUnit:(...e)=>Tpe(...e,t),formatOrDefault:vg});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const fu=mK;function Ype(t,e,n){let i=new fu(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new fu(r),t._value=i.plus(r).toNumber(),t}function vK(t,e,n){let i=new fu(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new fu(r),t._value=i.minus(r).toNumber(),t}function Gpe(t,e,n){let i=new fu(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new fu(r),t._value=i.times(r).toNumber(),t}function qpe(t,e,n){let i=new fu(t._value),r=e;return n.isNumbro(e)&&(r=e._value),r=new fu(r),t._value=i.dividedBy(r).toNumber(),t}function Kpe(t,e,n){let i=e;return n.isNumbro(e)&&(i=e._value),t._value=i,t}function Xpe(t,e,n){let i=n(t._value);return vK(i,e,n),Math.abs(i._value)}var Zpe=t=>({add:(e,n)=>Ype(e,n,t),subtract:(e,n)=>vK(e,n,t),multiply:(e,n)=>Gpe(e,n,t),divide:(e,n)=>qpe(e,n,t),set:(e,n)=>Kpe(e,n,t),difference:(e,n)=>Xpe(e,n,t),BigNumber:fu});/*!
 * Copyright (c) 2017 Benjamin Van Ryseghem<benjamin@vanryseghem.com>
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in
 * all copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 */const Qpe="2.5.0",ul=qD(),Jpe=YD(),eve=ype(ri),tve=fK();let Ch=Upe(ri),Jh=Zpe(ri);const nve=GD;class wK{constructor(e){this._value=e}clone(){return ri(this._value)}format(e={}){return Ch.format(this,e)}formatCurrency(e){return typeof e=="string"&&(e=nve.parseFormat(e)),e=Ch.formatOrDefault(e,ul.currentCurrencyDefaultFormat()),e.output="currency",Ch.format(this,e)}formatTime(e={}){return e.output="time",Ch.format(this,e)}binaryByteUnits(){return Ch.getBinaryByteUnit(this)}decimalByteUnits(){return Ch.getDecimalByteUnit(this)}byteUnits(){return Ch.getByteUnit(this)}difference(e){return Jh.difference(this,e)}add(e){return Jh.add(this,e)}subtract(e){return Jh.subtract(this,e)}multiply(e){return Jh.multiply(this,e)}divide(e){return Jh.divide(this,e)}set(e){return Jh.set(this,yK(e))}value(){return this._value}valueOf(){return this._value}}function yK(t){let e=t;return ri.isNumbro(t)?e=t._value:typeof t=="string"?e=ri.unformat(t):isNaN(t)&&(e=NaN),e}function ri(t){return new wK(yK(t))}ri.version=Qpe;ri.isNumbro=function(t){return t instanceof wK};ri.language=ul.currentLanguage;ri.registerLanguage=ul.registerLanguage;ri.setLanguage=ul.setLanguage;ri.languages=ul.languages;ri.languageData=ul.languageData;ri.zeroFormat=ul.setZeroFormat;ri.defaultFormat=ul.currentDefaults;ri.setDefaults=ul.setDefaults;ri.defaultCurrencyFormat=ul.currentCurrencyDefaultFormat;ri.validate=Jpe.validate;ri.loadLanguagesInNode=eve.loadLanguagesInNode;ri.unformat=tve.unformat;ri.BigNumber=Jh.BigNumber;var ive=ri,Rh=Jme(ive);const rve="numeric";function SK(t,e){if(Hr(t)){const n=e.numericFormat,i=n&&n.culture||"-",r=n&&n.pattern;if(typeof i<"u"&&!Rh.languages()[i]){const o=i.replace("-",""),a=Rh.allLanguages?Rh.allLanguages[i]:Rh[o];a&&Rh.registerLanguage(a)}Rh.setLanguage(i),t=Rh(t).format(r||"0")}return t}function XD(t,e,n,i,r,o,a){let u=o;if(Hr(u)){let d=[];if(Array.isArray(a.className))d=a.className;else{var h;const g=(h=a.className)!==null&&h!==void 0?h:"";g.length&&(d=g.split(" "))}u=SK(u,a),d.indexOf("htLeft")<0&&d.indexOf("htCenter")<0&&d.indexOf("htRight")<0&&d.indexOf("htJustify")<0&&d.push("htRight"),d.indexOf("htNumeric")<0&&d.push("htNumeric"),a.className=d.join(" "),e.dir="ltr"}bu(t,e,n,i,r,u,a)}XD.RENDERER_TYPE=rve;const ove="password";function ZD(t,e,n,i,r,o,a){bu.apply(this,[t,e,n,i,r,o,a]);const u=a.hashLength||e.innerHTML.length,h=a.hashSymbol||"*";let d="";ze(u-1,()=>{d+=h}),Fd(e,d)}ZD.RENDERER_TYPE=ove;const sve="select";function QD(t,e,n,i,r,o,a){bu.apply(this,[t,e,n,i,r,o,a])}QD.RENDERER_TYPE=sve;const ave="time";function JD(t,e,n,i,r,o,a){bu.apply(this,[t,e,n,i,r,o,a]),e.dir="ltr"}JD.RENDERER_TYPE=ave;function lve(){ds(Tm),ds(Yw),ds(jD),ds(WD),ds(UD),ds(FD),ds(XD),ds(ZD),ds(QD),ds(bu),ds(JD)}const uve="autocomplete";function NR(t,e){let n=t;if(n==null&&(n=""),this.allowEmpty&&n===""){e(!0);return}this.strict&&this.source?typeof this.source=="function"?this.source(n,TY(n,e)):TY(n,e)(this.source):e(!0)}NR.VALIDATOR_TYPE=uve;function TY(t,e){const n=t;return function(i){let r=!1;for(let o=0,a=i.length;o<a;o++)if(pR(n,i[o])){r=!0;break}e(r)}}function cve(t){const e=new Date(t);return isNaN(new Date(`${t}T00:00`).getDate())?e:new Date(e.getTime()+e.getTimezoneOffset()*6e4)}const hve="date";function eL(t,e){const n=B4(oK,this.instance);let i=t,r=!0;i==null&&(i="");let o=Ce(i,this.dateFormat||n.defaultDateFormat,!0).isValid(),a=Ce(new Date(i)).isValid()||o;if(this.allowEmpty&&i===""&&(a=!0,o=!0),a||(r=!1),!a&&o&&(r=!0),a&&!o)if(this.correctFormat===!0){const u=dve(i,this.dateFormat);this.instance.setDataAtCell(this.visualRow,this.visualCol,u,"dateValidator"),r=!0}else r=!1;e(r)}eL.VALIDATOR_TYPE=hve;function dve(t,e){const n=Ce(cve(t)),i=Ce(t,e),r=t.search(/[A-Za-z]/g)>-1;let o;return n.isValid()&&n.format("x")===i.format("x")||!i.isValid()||r?o=n:o=i,o.format(e)}const fve="dropdown";function tL(t,e){NR.apply(this,[t,e])}tL.VALIDATOR_TYPE=fve;const gve="numeric";function nL(t,e){let n=t;n==null&&(n=""),this.allowEmpty&&n===""?e(!0):e(n===""?!1:Hr(t))}nL.VALIDATOR_TYPE=gve;const mve=["YYYY-MM-DDTHH:mm:ss.SSSZ","X","x"],pve="time";function iL(t,e){const n=this.timeFormat||"h:mm:ss a";let i=!0,r=t;r===null&&(r=""),r=/^\d{3,}$/.test(r)?parseInt(r,10):r;const o=/^\d{1,2}$/.test(r);o&&(r+=":00");const a=Ce(r,mve,!0).isValid()?Ce(r):Ce(r,n);let u=a.isValid(),h=Ce(r,n,!0).isValid()&&!o;if(this.allowEmpty&&r===""&&(u=!0,h=!0),u||(i=!1),!u&&h&&(i=!0),u&&!h)if(this.correctFormat===!0){const d=a.format(n);this.instance.setDataAtCell(this.visualRow,this.visualCol,d,"timeValidator"),i=!0}else i=!1;e(i)}iL.VALIDATOR_TYPE=pve;function vve(){pg(NR),pg(tL),pg(eL),pg(nL),pg(iL)}function bK(t){return Qe(t)&&t.value!==void 0?t.value:t}function CK(t,e,n){const i=this.getSourceDataAtCell(this.toPhysicalRow(e),this.toPhysicalColumn(n)),r=o=>Qe(o)&&Ne(o.key)&&Ne(o.value);return r(i)?r(t)?t:{key:t,value:t}:t}const wve="autocomplete",yve={CELL_TYPE:wve,editor:VD,renderer:Tm,validator:NR,valueGetter:bK,valueSetter:CK};function Sve(t,e,n){const{checkedTemplate:i,uncheckedTemplate:r}=this.getCellMeta(e,n),o=xn(t),a=o===xn(i),u=o===xn(r);return a||u?a?i:r:t}const bve="checkbox",Cve={CELL_TYPE:bve,editor:rK,renderer:jD,valueSetter:Sve},Rve="date";function RK(t,e,n,i,r,o,a){Tm.apply(this,[t,e,n,i,r,o,a])}RK.RENDERER_TYPE=Rve;const Eve="date",Tve={CELL_TYPE:Eve,editor:sK,renderer:RK,validator:eL};function _ve(t){return bK.call(this,t)}function Mve(t,e,n,i){return CK.call(this,t,e,n,i)}const Ave="dropdown",Ove={CELL_TYPE:Ave,editor:aK,renderer:WD,validator:tL,filter:!1,strict:!0,valueGetter:_ve,valueSetter:Mve},xve="handsontable",Hve={CELL_TYPE:xve,editor:$D,renderer:UD};function Ive(t){if(typeof t=="string"&&Lae(t)){const e=kae(t);return Mv(e)?t:e}return t}const Pve="numeric",Nve={CELL_TYPE:Pve,editor:lK,renderer:XD,validator:nL,dataType:"number",valueSetter:Ive},Dve="password",Lve={CELL_TYPE:Dve,editor:uK,renderer:ZD,copyable:!1},kve="select",$ve={CELL_TYPE:kve,editor:cK,renderer:QD},Vve="time",Bve={CELL_TYPE:Vve,editor:hK,renderer:JD,validator:iL};function Fve(){qs(yve),qs(Cve),qs(Tve),qs(Ove),qs(Hve),qs(Nve),qs(Lve),qs($ve),qs(G5),qs(Bve)}function Wve(t,e){EK(t,e),e.add(t)}function $f(t,e,n){return(e=jve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jve(t){var e=zve(t,"string");return typeof e=="symbol"?e:e+""}function zve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function _Y(t,e,n){EK(t,e),e.set(t,n)}function EK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ob(t,e,n){return t.set(rL(t,e),n),n}function Zn(t,e){return t.get(rL(t,e))}function rL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const MY=new Map([["plugin",Gae],["cell-type",D5],["editor",V4],["renderer",G4],["validator",q4]]),TK=Symbol("mainSetting"),Uve="base",sb=[];let Eh=null;var li=new WeakMap,Th=new WeakMap,AY=new WeakSet;class Dt{static get PLUGIN_KEY(){return Uve}static get SETTING_KEYS(){return[this.PLUGIN_KEY]}static get DEFAULT_SETTINGS(){return{}}static get SETTINGS_VALIDATORS(){return null}constructor(e){Wve(this,AY),_Y(this,li,null),$f(this,"eventManager",new da(this)),$f(this,"pluginName",null),$f(this,"pluginsInitializedCallbacks",[]),$f(this,"isPluginsReady",!1),$f(this,"enabled",!1),$f(this,"initialized",!1),_Y(this,Th,{}),yu(this,"hot",e,{writable:!1}),Eh=null,this.hot.addHook("afterPluginsInitialized",()=>this.onAfterPluginsInitialized()),this.hot.addHook("afterUpdateSettings",n=>this.onUpdateSettings(n)),this.hot.addHook("beforeInit",()=>this.init())}init(){this.pluginName=this.hot.getPluginName(this),this.updatePluginSettings(this.hot.getSettings()[this.constructor.PLUGIN_KEY]);const e=this.constructor.PLUGIN_DEPS,n=Array.isArray(e)?e:[];if(n.length>0){const r=[];if(n.forEach(o=>{const[a,u]=o.split(":");if(!MY.has(a))throw new Error(`Unknown plugin dependency type "${a}" was found.`);MY.get(a)(u)||r.push(` - ${u} (${a})`)}),r.length>0){const o=[`The ${this.pluginName} plugin requires the following modules:
`,`${r.join(`
`)}
`].join("");sb.push(o)}}if(Eh||(Eh=Y4()),Eh.indexOf(this.pluginName)>=0&&Eh.splice(Eh.indexOf(this.pluginName),1),this.hot.addHookOnce("afterPluginsInitialized",()=>{this.isEnabled&&this.isEnabled()&&this.enablePlugin()}),Eh.length===0){if(sb.length>0){const r=[`${sb.join(`
`)}
`,"You have to import and register them manually."].join("");throw sb.length=0,new Error(r)}this.hot.runHooks("afterPluginsInitialized")}this.initialized=!0}enablePlugin(){this.enabled=!0}disablePlugin(){var e;(e=this.eventManager)===null||e===void 0||e.clear(),this.clearHooks(),this.enabled=!1}getSetting(e){const n=this.constructor.DEFAULT_SETTINGS;if(e===void 0)return Qe(Zn(li,this))?gC(Zn(li,this),n):Zn(li,this);if((Array.isArray(Zn(li,this))||Qe(Zn(li,this)))&&n[TK]===e){var i;return Array.isArray(Zn(li,this))?Zn(li,this):(i=Zn(li,this)[e])!==null&&i!==void 0?i:n[e]}if(e.includes(".")){const r=IH(Zn(li,this),e),o=IH(n,e);return Qe(r)?gC(r,o):r!==void 0?r:o}return Qe(Zn(li,this))?gC(Zn(li,this),n)[e]:n[e]}updatePluginSettings(e){const n=this.constructor.SETTINGS_VALIDATORS;if(n&&typeof n=="function"&&typeof e!="object"){if(n(e)===!1){_t(`${this.pluginName} Plugin: option is not valid and it will be ignored.`);return}return ob(li,this,e),Zn(li,this)}return n&&typeof n=="object"&&typeof e=="object"?((Zn(li,this)===null||typeof Zn(li,this)!="object")&&ob(li,this,{...this.constructor.DEFAULT_SETTINGS}),Object.keys(n).forEach(i=>{if(!(i in e))return;const r=n[i];if((r?r(e[i]):!0)===!1){_t(`${this.pluginName} Plugin: "${i}" option is not valid and it will be ignored.`);return}Zn(li,this)[i]=e[i]}),Zn(li,this)):(ob(li,this,e),e)}addHook(e,n,i){Zn(Th,this)[e]=Zn(Th,this)[e]||[];const r=Zn(Th,this)[e];this.hot.addHook(e,n,i),r.push(n),Zn(Th,this)[e]=r}removeHooks(e){U(Zn(Th,this)[e]||[],n=>{this.hot.removeHook(e,n)})}clearHooks(){const e=Zn(Th,this);wt(e,(n,i)=>this.removeHooks(i)),e.length=0}callOnPluginsReady(e){this.isPluginsReady?e():this.pluginsInitializedCallbacks.push(e)}onAfterPluginsInitialized(){U(this.pluginsInitializedCallbacks,e=>e()),this.pluginsInitializedCallbacks.length=0,this.isPluginsReady=!0}onUpdateSettings(e){const n=rL(AY,this,Yve).call(this,e);this.isEnabled&&(this.enabled&&!this.isEnabled()&&this.disablePlugin(),!this.enabled&&this.isEnabled()&&this.enablePlugin(),this.enabled&&this.isEnabled()&&n&&(this.updatePluginSettings(e[this.constructor.PLUGIN_KEY]),this.updatePlugin(e)))}updatePlugin(){}destroy(){var e;ob(li,this,null),(e=this.eventManager)===null||e===void 0||e.destroy(),this.clearHooks(),wt(this,(n,i)=>{i!=="hot"&&(this[i]=null)}),delete this.t,delete this.hot}}function Yve(t){if(!t)return!1;const e=this.constructor.SETTING_KEYS;if(typeof e=="boolean")return e;for(let n=0;n<e.length;n++)if(t[e[n]]!==void 0)return!0;return!1}function _h(t,e,n){return(e=Gve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Gve(t){var e=qve(t,"string");return typeof e=="symbol"?e:e+""}function qve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}let _K=class{constructor(e){_h(this,"hot",null),_h(this,"container",null),_h(this,"injected",!1),_h(this,"rows",[]),_h(this,"columns",[]),_h(this,"samples",null),_h(this,"settings",{useHeaders:!0}),this.hot=e}addRow(e,n){if(this.columns.length)throw new Error("Doesn't support multi-dimensional table");this.rows.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={row:e};this.rows.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol(e)),this.table.tr.appendChild(this.createRow(e)),e===0&&fe(this.table.table,"htGhostTableFirstRow"),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}addColumnHeadersRow(e){const n=this.hot.getColHeader(0);if(n!=null){const i={row:-1};this.rows.push(i),this.container=this.createContainer(this.hot.rootElement.className),this.samples=e,this.table=this.createTable(this.hot.table.className),this.table.colGroup.appendChild(this.createColGroupsCol()),this.appendColumnHeadersRow(),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}}addColumn(e,n){if(this.rows.length)throw new Error("Doesn't support multi-dimensional table");this.columns.length||(this.container=this.createContainer(this.hot.rootElement.className));const i={col:e};this.columns.push(i),this.samples=n,this.table=this.createTable(this.hot.table.className),this.getSetting("useHeaders")&&this.hot.getColHeader(e)!==null&&this.hot.view.appendColHeader(e,this.table.th,void 0,-1),this.table.tBody.appendChild(this.createCol(e)),this.container.container.appendChild(this.table.fragment),i.table=this.table.table}getHeights(e){this.injected||this.injectTable(),U(this.rows,n=>{const{height:i}=n.table.getBoundingClientRect();e(n.row,Math.ceil(i))})}getWidths(e){this.injected||this.injectTable(),U(this.columns,n=>{const{width:i}=n.table.getBoundingClientRect();e(n.col,Math.ceil(i))})}setSettings(e){this.settings=e}setSetting(e,n){this.settings||(this.settings={}),this.settings[e]=n}getSettings(){return this.settings}getSetting(e){return this.settings?this.settings[e]:null}createColGroupsCol(e){const n=this.hot.rootDocument.createDocumentFragment();return this.hot.hasRowHeaders()&&n.appendChild(this.createColElement(-1,-1)),this.samples.forEach(i=>{U(i.strings,r=>{n.appendChild(this.createColElement(r.col,e))})}),n}createRow(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("th");return this.hot.hasRowHeaders()&&(this.hot.view.appendRowHeader(e,r),i.appendChild(r)),this.samples.forEach(o=>{U(o.strings,a=>{const u=a.col,h=this.hot.getCellMeta(e,u),d=this.hot.getCellRenderer(h),g=n.createElement("td");g.setAttribute("ghost-table",1),d(this.hot,g,e,u,this.hot.colToProp(u),a.value,h),i.appendChild(g)})}),i}appendColumnHeadersRow(){const{rootDocument:e}=this.hot,n=e.createDocumentFragment(),i=[];if(this.hot.hasRowHeaders()){const r=e.createElement("th");i.push([-1,r]),n.appendChild(r)}this.samples.forEach(r=>{U(r.strings,o=>{const a=o.col,u=e.createElement("th");i.push([a,u]),n.appendChild(u)})}),this.table.tHead.appendChild(n),U(i,r=>{const[o,a]=r;this.hot.view.appendColHeader(o,a)})}createCol(e){const{rootDocument:n}=this.hot,i=n.createDocumentFragment();return this.samples.forEach(r=>{U(r.strings,o=>{const a=o.row,u=this.hot.getCellMeta(a,e),h=this.hot.getCellRenderer(u),d=n.createElement("td"),g=n.createElement("tr");d.setAttribute("ghost-table",1),h(this.hot,d,a,e,this.hot.colToProp(e),o.value,u),g.appendChild(d),i.appendChild(g)})}),i}clean(){this.rows.length=0,this.rows[-1]=void 0,this.columns.length=0,this.samples&&this.samples.clear(),this.samples=null,this.removeTable()}injectTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;this.injected||((e||this.hot.rootElement).appendChild(this.container.fragment),this.injected=!0)}removeTable(){this.injected&&this.container.container.parentNode&&(this.container.container.parentNode.removeChild(this.container.container),this.container=null,this.injected=!1)}createColElement(e,n){const i=this.hot.rootDocument.createElement("col");let r=0;n>=0&&e>=0&&(r=this.hot.getCellMeta(n,e).colspan);let o=this.hot.getColWidth(e);if(r>1)for(let a=e+1;a<e+r;a++)o+=this.hot.getColWidth(a);return i.style.width=`${o}px`,i}createTable(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("table"),o=n.createElement("thead"),a=n.createElement("tbody"),u=n.createElement("colgroup"),h=n.createElement("tr"),d=n.createElement("th");return this.isVertical()&&r.appendChild(u),this.isHorizontal()&&(h.appendChild(d),o.appendChild(h),r.style.tableLayout="auto",r.style.width="auto"),r.appendChild(o),this.isVertical()&&a.appendChild(h),r.appendChild(a),fe(r,e),i.appendChild(r),{fragment:i,table:r,tHead:o,tBody:a,colGroup:u,tr:h,th:d}}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"";const{rootDocument:n}=this.hot,i=n.createDocumentFragment(),r=n.createElement("div"),o=`htGhostTable htAutoSize ${e.trim()}`;return fe(r,o),i.appendChild(r),{fragment:i,container:r}}isVertical(){return!!(this.rows.length&&!this.columns.length)}isHorizontal(){return!!(this.columns.length&&!this.rows.length)}};function qp(t,e,n){return(e=Kve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Kve(t){var e=Xve(t,"string");return typeof e=="symbol"?e:e+""}function Xve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DR{static get SAMPLE_COUNT(){return 3}constructor(e){qp(this,"samples",null),qp(this,"dataFactory",null),qp(this,"customSampleCount",null),qp(this,"allowDuplicates",!1),qp(this,"includeHidden",!1),this.dataFactory=e}getSampleCount(){return this.customSampleCount?this.customSampleCount:DR.SAMPLE_COUNT}setSampleCount(e){this.customSampleCount=e}setAllowDuplicates(e){this.allowDuplicates=e}setIncludeHidden(e){this.includeHidden=e}generateRowSamples(e,n){return this.generateSamples("row",n,e)}generateColumnSamples(e,n){return this.generateSamples("col",n,e)}generateSamples(e,n,i){const r=new Map,{from:o,to:a}=typeof i=="number"?{from:i,to:i}:i;return ze(o,a,u=>{const h=this.generateSample(e,n,u);r.set(u,h)}),r}generateSample(e,n,i){if(e!=="row"&&e!=="col")throw new Error("Unsupported sample type");const r=new Map,o=e==="row"?"col":"row",a=[];return ze(n.from,n.to,u=>{const h=e==="row"?this.dataFactory(i,u,this):this.dataFactory(u,i,this);if(h===!1)return;const{value:d,bundleSeed:g}=h,m=typeof g=="string"&&g.length>0;let v;m?v=g:Qe(d)?v=`${Object.keys(d).length}`:Array.isArray(d)?v=`${d.length}`:v=`${xn(d).length}`,r.has(v)||r.set(v,{needed:this.getSampleCount(),strings:[]});const y=r.get(v);y.needed&&(!(a.indexOf(d)>-1)||this.allowDuplicates||m)&&(y.strings.push({value:d,[o]:u}),a.push(d),y.needed-=1)}),r}}function Zve(t,e){MK(t,e),e.add(t)}function uO(t,e,n){MK(t,e),e.set(t,n)}function MK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Kp(t,e,n){return(e=Qve(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qve(t){var e=Jve(t,"string");return typeof e=="symbol"?e:e+""}function Jve(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Ic(t,e){return t.get(oo(t,e))}function c0(t,e,n){return t.set(oo(t,e),n),n}function oo(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("modifyAutoColumnSizeSeed");const cO="autoColumnSize",ewe=10,twe="autoColumnSize";var oL=new WeakMap,wg=new WeakMap,sm=new WeakMap,Ho=new WeakSet;class Bv extends Dt{static get PLUGIN_KEY(){return cO}static get PLUGIN_PRIORITY(){return ewe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 50}constructor(e){super(e),Zve(this,Ho),Kp(this,"ghostTable",new _K(this.hot)),Kp(this,"samplesGenerator",new DR((n,i)=>{const r=this.hot.toPhysicalRow(n),o=this.hot.toPhysicalColumn(i);if(this.hot.rowIndexMapper.isHidden(r)||this.hot.columnIndexMapper.isHidden(o))return!1;const a=this.hot.getCellMeta(n,i);let u="";a.spanned||(u=this.hot.getDataAtCell(n,i));let h="";return this.hot.hasHook("modifyAutoColumnSizeSeed")&&(h=this.hot.runHooks("modifyAutoColumnSizeSeed",h,a,u)),{value:u,bundleSeed:h}})),Kp(this,"inProgress",!1),Kp(this,"measuredColumns",0),Kp(this,"columnWidthsMap",new Uc),uO(this,oL,!1),uO(this,wg,[]),uO(this,sm,[]),this.hot.columnIndexMapper.registerMap(twe,this.columnWidthsMap),this.addHook("beforeColumnResize",(n,i,r)=>oo(Ho,this,OY).call(this,n,i,r))}isEnabled(){return this.hot.getSettings()[cO]!==!1&&!this.hot.getSettings().colWidths}enablePlugin(){var e=this;if(this.enabled)return;this.ghostTable.setSetting("useHeaders",this.getSetting("useHeaders")),this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return oo(Ho,e,rwe).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return oo(Ho,e,owe).call(e,...r)}),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return oo(Ho,e,awe).call(e,...r)}),this.addHook("beforeRender",()=>oo(Ho,this,iwe).call(this)),this.addHook("modifyColWidth",(i,r)=>this.getColumnWidth(r,i)),this.addHook("init",()=>oo(Ho,this,swe).call(this)),super.enablePlugin()}updatePlugin(){c0(sm,this,this.findColumnsWhereHeaderWasChanged()),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.addHook("beforeColumnResize",(e,n,i)=>oo(Ho,this,OY).call(this,e,n,i))}calculateVisibleColumnsWidth(){if(!this.hot.countRows())return;const e=this.getFirstVisibleColumn(),n=this.getLastVisibleColumn();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateColumnsWidth({from:e,to:n},void 0,i)}calculateColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countRows()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;ze(r.from,r.to,a=>{let u=this.hot.toPhysicalColumn(a);u===null&&(u=a),(i||this.columnWidthsMap.getValueAtIndex(u)===null&&!this.hot._getColWidthFromSettings(u))&&oo(Ho,this,AK).call(this,a,o)}),this.ghostTable.columns.length&&(oo(Ho,this,OK).call(this),this.measuredColumns=r.to+1,this.ghostTable.clean())}calculateAllColumnsWidth(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countCols()-1;let o=null;this.inProgress=!0;const a=()=>{if(!this.hot){KC(o),this.inProgress=!1;return}this.calculateColumnsWidth({from:i,to:Math.min(i+Bv.CALCULATION_STEP,r)},e,n),i=i+Bv.CALCULATION_STEP+1,i<r?o=qC(a):(KC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateColumnsWidth({from:0,to:u},e,n),i=u+1),i<r?a():this.inProgress=!1}recalculateAllColumnsWidth(){this.hot.view.isVisible()&&this.calculateAllColumnsWidth({from:0,to:this.hot.countRows()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[cO];let n=Bv.SYNC_CALCULATION_LIMIT;const i=this.hot.countCols()-1;return Qe(e)&&(n=e.syncLimit,u4(n)?n=j4(i,n):n>>=0),Math.min(n,i)}getColumnWidth(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=n;return r===void 0&&(r=this.columnWidthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e)),i&&typeof r=="number"&&(r=Math.max(r,Jg))),r}getFirstVisibleColumn(){var e;return(e=this.hot.getFirstRenderedVisibleColumn())!==null&&e!==void 0?e:-1}getLastVisibleColumn(){var e;return(e=this.hot.getLastRenderedVisibleColumn())!==null&&e!==void 0?e:-1}findColumnsWhereHeaderWasChanged(){return this.hot.getColHeader().reduce((i,r,o)=>{const a=Ic(wg,this).length;return(a-1<o||Ic(wg,this)[o]!==r)&&i.push(this.hot.toVisualColumn(o)),a-1<o?Ic(wg,this).push(r):Ic(wg,this)[o]=r,i},[])}clearCache(e){Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.columnWidthsMap.setValueAtIndex(n,null)})},!0):this.columnWidthsMap.clear()}isNeedRecalculate(){return!!this.columnWidthsMap.getValues().slice(0,this.measuredColumns).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function nwe(t){const e={from:0,to:this.hot.countRows()-1};t.forEach(n=>{const i=this.hot.toPhysicalColumn(n);i!==null&&(this.hot._getColWidthFromSettings(i)||oo(Ho,this,AK).call(this,n,e))}),this.ghostTable.columns.length&&(oo(Ho,this,OK).call(this),this.ghostTable.clean())}function AK(t,e){this.samplesGenerator.generateColumnSamples(t,e).forEach((i,r)=>this.ghostTable.addColumn(r,i))}function OK(){this.hot.batchExecution(()=>{this.ghostTable.getWidths((t,e)=>{const n=this.hot.toPhysicalColumn(t);this.columnWidthsMap.setValueAtIndex(n,e)})},!0)}function iwe(){this.calculateVisibleColumnsWidth(),this.inProgress||(oo(Ho,this,nwe).call(this,Ic(sm,this)),c0(sm,this,[]))}function rwe(t,e){e||this.recalculateAllColumnsWidth()}function owe(t){const e=t.reduce((n,i)=>{let[,r]=i;const o=this.hot.propToCol(r);return Number.isInteger(o)&&n.indexOf(o)===-1&&n.push(o),n},[]);Ic(sm,this).push(...e)}function OY(t,e,n){let i=t;return n&&(this.calculateColumnsWidth(e,void 0,!0),i=this.getColumnWidth(e,void 0,!1)),i}function swe(){c0(wg,this,this.hot.getColHeader()),this.recalculateAllColumnsWidth(),c0(oL,this,!0)}function awe(t){if(!Ic(oL,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.col;if(Number.isInteger(o)){const a=this.hot.toVisualColumn(o);n.indexOf(a)===-1&&n.push(a)}return n},[]);Ic(sm,this).push(...e)}const dd={horizontal:"horizontal",vertical:"vertical"};function lwe(t,e,n){let i,r,o;return e[0]===t[0]&&e[1]<t[1]?(o="left",i=n(e[0],e[1]),r=n(e[2],t[1]-1)):e[2]===t[2]&&e[0]===t[0]&&e[3]>t[3]?(o="right",i=n(e[0],t[3]+1),r=n(e[2],e[3])):e[0]<t[0]&&e[1]===t[1]?(o="up",i=n(e[0],e[1]),r=n(t[0]-1,e[3])):e[2]>t[2]&&e[1]===t[1]&&(o="down",i=n(t[2]+1,e[1]),r=n(e[2],e[3])),i&&i.normalize(),r&&r.normalize(),{directionOfDrag:o,startOfDragCoords:i,endOfDragCoords:r}}function uwe(t){const e={};return t===!0?(e.directions=Object.keys(dd),e.autoInsertRow=!0):Qe(t)?(Ne(t.autoInsertRow)?t.direction===dd.horizontal?e.autoInsertRow=!1:e.autoInsertRow=t.autoInsertRow:e.autoInsertRow=!1,Ne(t.direction)?e.directions=[t.direction]:e.directions=Object.keys(dd)):typeof t=="string"?(e.directions=[t],e.autoInsertRow=!0):(e.directions=[],e.autoInsertRow=!1),e}function cwe(t,e){hwe(t,e),e.add(t)}function hwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vf(t,e,n){return(e=dwe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dwe(t){var e=fwe(t,"string");return typeof e=="symbol"?e:e+""}function fwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Bf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("modifyAutofillRange");He.getSingleton().register("beforeAutofill");He.getSingleton().register("afterAutofill");const xY="autofill",gwe=20,mwe=["fillHandle"],pwe="insert_row_below",vwe=200;var Mh=new WeakSet;class wwe extends Dt{constructor(){super(...arguments),cwe(this,Mh),Vf(this,"addingStarted",!1),Vf(this,"mouseDownOnCellCorner",!1),Vf(this,"mouseDragOutside",!1),Vf(this,"handleDraggedCells",0),Vf(this,"directions",[]),Vf(this,"autoInsertRow",!1)}static get PLUGIN_KEY(){return xY}static get PLUGIN_PRIORITY(){return gwe}static get SETTING_KEYS(){return[xY,...mwe]}isEnabled(){return this.hot.getSettings().fillHandle}enablePlugin(){this.enabled||(this.mapSettings(),this.registerEvents(),this.addHook("afterOnCellCornerMouseDown",e=>Bf(Mh,this,bwe).call(this,e)),this.addHook("afterOnCellCornerDblClick",e=>Bf(Mh,this,Swe).call(this,e)),this.addHook("beforeOnCellMouseOver",(e,n)=>Bf(Mh,this,Cwe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.clearMappedSettings(),super.disablePlugin()}getSelectionData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;const n=this.hot.getSelectedRangeLast(),{row:i,col:r}=n.getTopStartCorner(),{row:o,col:a}=n.getBottomEndCorner(),u=this.hot.runHooks("modifyCopyableRange",[{startRow:i,startCol:r,endRow:o,endCol:a}]),h=[],d=[],g=[];return U(u,m=>{for(let v=m.startRow;v<=m.endRow;v+=1)h.indexOf(v)===-1&&h.push(v);for(let v=m.startCol;v<=m.endCol;v+=1)d.indexOf(v)===-1&&d.push(v)}),U(h,m=>{const v=[];U(d,y=>{const b=e?this.hot.getSourceDataAtCell(m,y):null;e&&Qe(b)?v.push(this.hot.getCopyableSourceData(m,y)):v.push(this.hot.getCopyableData(m,y))}),g.push(v)}),g}fillIn(){if(this.hot.selection.highlight.getFill().isEmpty())return!1;const[e,n,i,r]=this.hot.selection.highlight.getFill().getVisualCorners(),o=this.hot.getSelectedRangeLast(),a=o.getTopStartCorner(),u=o.getBottomEndCorner();this.resetSelectionOfDraggedArea();const h=[a.row,a.col,u.row,u.col],d=this.hot.runHooks("modifyAutofillRange",[Math.min(a.row,e),Math.min(a.col,n),Math.max(u.row,i),Math.max(u.col,r)],h),{directionOfDrag:g,startOfDragCoords:m,endOfDragCoords:v}=lwe(h,d,(y,b)=>this.hot._createCellCoords(y,b));if(m&&m.row>-1&&m.col>-1){const y=this.getSelectionData(),b=this.getSelectionData(!0),C=o.clone(),T=this.hot._createCellRange(m,m,v),O=this.hot.runHooks("beforeAutofill",y,C,T,g);if(O===!1)return this.hot.selection.highlight.getFill().clear(),this.hot.render(),!1;let A=O;const N=O;if(["up","left"].indexOf(g)>-1&&!(N.length===1&&N[0].length===0))if(A=[],g==="up"){const x=v.row-m.row+1,$=x%N.length;for(let L=0;L<x;L++)A.push(N[(L+(N.length-$))%N.length])}else{const x=v.col-m.col+1,$=x%N[0].length;for(let L=0;L<N.length;L++){A.push([]);for(let P=0;P<x;P++)A[L].push(N[L][(P+(N[L].length-$))%N[L].length])}}if(b.some(x=>x.some($=>Qe($)))){const x=Bf(Mh,this,ywe).call(this,A,b,m,v,g);x.length&&(A=x)}this.hot.populateFromArray(m.row,m.col,A,v.row,v.col,`${this.pluginName}.fill`,null),this.setSelection(d),this.hot.runHooks("afterAutofill",A,C,T,g),this.hot.render()}else this.hot.view.render();return!0}reduceSelectionAreaIfNeeded(e){return e.row<0&&(e.row=0),e.col<0&&(e.col=0),e}getCoordsOfDragAndDropBorders(e){const n=this.hot.getSelectedRangeLast(),i=n.getBottomEndCorner();let r=e;if(this.directions.includes(dd.vertical)&&this.directions.includes(dd.horizontal)){const o=n.getTopStartCorner();(i.col<=e.col||o.col>=e.col)&&(r=this.hot._createCellCoords(i.row,e.col)),(i.row<e.row||o.row>e.row)&&(r=this.hot._createCellCoords(e.row,i.col))}else if(this.directions.includes(dd.vertical))r=this.hot._createCellCoords(e.row,i.col);else if(this.directions.includes(dd.horizontal))r=this.hot._createCellCoords(i.row,e.col);else return;return this.reduceSelectionAreaIfNeeded(r)}showBorder(e){const n=this.getCoordsOfDragAndDropBorders(e);n&&this.redrawBorders(n)}addRow(){this.hot._registerTimeout(()=>{this.hot.alter(pwe,void 0,1,`${this.pluginName}.fill`),this.addingStarted=!1},vwe)}addNewRowIfNeeded(){if(!this.hot.selection.highlight.getFill().isEmpty()&&this.addingStarted===!1&&this.autoInsertRow){const e=this.hot.getSelectedLast(),n=this.hot.selection.highlight.getFill().getVisualCorners(),i=this.hot.countRows();e[2]<i-1&&n[2]===i-1&&(this.addingStarted=!0,this.addRow())}}getIndexOfLastAdjacentFilledInRow(e){const n=this.hot.getData(),i=this.hot.countRows();let r;for(let o=e[2]+1;o<i;o++){for(let h=e[1];h<=e[3];h++){const d=n[o][h];if(!ni(d))return-1}const a=n[o][e[1]-1],u=n[o][e[3]+1];(!ni(a)||!ni(u))&&(r=o)}return r}addSelectionFromStartAreaToSpecificRowIndex(e,n){this.hot.selection.highlight.getFill().clear().add(this.hot._createCellCoords(e[0],e[1])).add(this.hot._createCellCoords(n,e[3])).commit()}setSelection(e){this.hot.selectCell(...Vt(e,n=>Math.max(n,0)),!1,!1)}selectAdjacent(){const e=this.hot.getSelectedLast(),n=this.getIndexOfLastAdjacentFilledInRow(e);return n===-1||n===void 0?!1:(this.addSelectionFromStartAreaToSpecificRowIndex(e,n),!0)}resetSelectionOfDraggedArea(){this.handleDraggedCells=0,this.hot.selection.highlight.getFill().clear()}redrawBorders(e){this.hot.selection.highlight.getFill().clear().add(this.hot.getSelectedRangeLast().from).add(this.hot.getSelectedRangeLast().to).add(e).commit(),this.hot.view.render()}getIfMouseWasDraggedOutside(e){const{documentElement:n}=this.hot.rootDocument,i=pr(this.hot.table).top-(this.hot.rootWindow.pageYOffset||n.scrollTop)+Ti(this.hot.table),r=pr(this.hot.table).left-(this.hot.rootWindow.pageXOffset||n.scrollLeft)+hi(this.hot.table);return e.clientY>i&&e.clientX<=r}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mouseup",()=>Bf(Mh,this,Rwe).call(this)),this.eventManager.addEventListener(e,"mousemove",n=>Bf(Mh,this,Ewe).call(this,n))}clearMappedSettings(){this.directions.length=0,this.autoInsertRow=!1}mapSettings(){const e=uwe(this.hot.getSettings().fillHandle);this.directions=e.directions,this.autoInsertRow=e.autoInsertRow}destroy(){super.destroy()}}function ywe(t,e,n,i){const r=[];for(let o=Math.min(n.row,i.row);o<=Math.max(n.row,i.row);o+=1){r.push([]);for(let a=Math.min(n.col,i.col);a<=Math.max(n.col,i.col);a+=1){const u=this.hot.getSourceDataAtCell(o,a),h=o-Math.min(n.row,i.row),d=a-Math.min(n.col,i.col),g=h%e.length,m=d%e[0].length;Qe(u)?r[h][d]=e[g][m]:r[h][d]=t[g][m]}}return r}function Swe(){this.selectAdjacent()&&this.fillIn()}function bwe(){this.handleDraggedCells=1,this.mouseDownOnCellCorner=!0}function Cwe(t){this.mouseDownOnCellCorner&&!this.hot.view.isMouseDown()&&this.handleDraggedCells&&(this.handleDraggedCells+=1,this.showBorder(t),this.addNewRowIfNeeded())}function Rwe(){this.handleDraggedCells&&(this.handleDraggedCells>1&&this.fillIn(),this.handleDraggedCells=0,this.mouseDownOnCellCorner=!1)}function Ewe(t){const e=this.getIfMouseWasDraggedOutside(t);this.addingStarted===!1&&this.handleDraggedCells>0&&e?(this.mouseDragOutside=!0,this.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&this.autoInsertRow&&this.addRow()}function Twe(t,e){xK(t,e),e.add(t)}function HY(t,e,n){xK(t,e),e.set(t,n)}function xK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ff(t,e,n){return(e=_we(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _we(t){var e=Mwe(t,"string");return typeof e=="symbol"?e:e+""}function Mwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function HK(t,e,n){return t.set(Do(t,e),n),n}function h0(t,e){return t.get(Do(t,e))}function Do(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const hO="autoRowSize",Awe=40,Owe="autoRowSize",IY="htFirstDatasetColumnNotRendered";var ww=new WeakMap,sL=new WeakMap,fs=new WeakSet;class Fv extends Dt{static get PLUGIN_KEY(){return hO}static get PLUGIN_PRIORITY(){return Awe}static get SETTING_KEYS(){return!0}static get DEFAULT_SETTINGS(){return{useHeaders:!0,samplingRatio:null,allowSampleDuplicates:!1}}static get CALCULATION_STEP(){return 50}static get SYNC_CALCULATION_LIMIT(){return 500}constructor(e){super(e),Twe(this,fs),Ff(this,"headerHeight",null),Ff(this,"ghostTable",new _K(this.hot)),Ff(this,"samplesGenerator",new DR((n,i)=>{const r=this.hot.toPhysicalColumn(i);if(this.hot.columnIndexMapper.isHidden(r)||n>=0&&i>=0&&this.hot.getCellMeta(n,i).hidden)return!1;let o;return n>=0?o=this.hot.getDataAtCell(n,i):n===-1&&(o=this.hot.getColHeader(i)),{value:o}})),Ff(this,"inProgress",!1),Ff(this,"measuredRows",0),Ff(this,"rowHeightsMap",new Uc),HY(this,ww,[]),HY(this,sL,!1),this.hot.rowIndexMapper.registerMap(Owe,this.rowHeightsMap),this.addHook("beforeRowResize",(n,i,r)=>Do(fs,this,PY).call(this,n,i,r))}isEnabled(){const e=this.hot.getSettings()[hO];return e===!0||Qe(e)}enablePlugin(){var e=this;if(this.enabled)return;this.samplesGenerator.setAllowDuplicates(this.getSetting("allowSampleDuplicates"));const n=this.getSetting("samplingRatio");n&&!isNaN(n)&&this.samplesGenerator.setSampleCount(parseInt(n,10)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Do(fs,e,Pwe).call(e,...r)}),this.addHook("beforeChangeRender",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Do(fs,e,Nwe).call(e,...r)}),this.addHook("beforeColumnResize",()=>this.recalculateAllRowsHeight()),this.addHook("afterFormulasValuesUpdate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Do(fs,e,Lwe).call(e,...r)}),this.addHook("beforeViewRender",()=>Do(fs,this,Hwe).call(this)),this.addHook("beforeRender",()=>Do(fs,this,Iwe).call(this)),this.addHook("modifyRowHeight",(i,r)=>this.getRowHeight(r,i)),this.addHook("init",()=>Do(fs,this,Dwe).call(this)),this.addHook("modifyColumnHeaderHeight",()=>this.getColumnHeaderHeight()),super.enablePlugin()}disablePlugin(){this.headerHeight=null,super.disablePlugin(),Do(fs,this,IK).call(this,!1),this.addHook("beforeRowResize",(e,n,i)=>Do(fs,this,PY).call(this,e,n,i))}calculateVisibleRowsHeight(){if(!this.hot.countCols())return;const e=this.getFirstVisibleRow(),n=this.getLastVisibleRow();if(e===-1||n===-1)return;const i=this.hot.forceFullRender;this.calculateRowsHeight({from:e,to:n},void 0,i)}calculateRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countRows()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{from:0,to:this.hot.countCols()-1},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=typeof e=="number"?{from:e,to:e}:e,o=typeof n=="number"?{from:n,to:n}:n;if(this.hot.getColHeader(0)!==null){const a=this.samplesGenerator.generateRowSamples(-1,o);this.ghostTable.addColumnHeadersRow(a.get(-1))}ze(r.from,r.to,a=>{let u=this.hot.toPhysicalRow(a);u===null&&(u=a),(i||this.rowHeightsMap.getValueAtIndex(u)===null)&&this.samplesGenerator.generateRowSamples(a,o).forEach((d,g)=>this.ghostTable.addRow(g,d))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((a,u)=>{a<0?this.headerHeight=u:this.rowHeightsMap.setValueAtIndex(this.hot.toPhysicalRow(a),u)})},!0),this.measuredRows=r.to+1,this.ghostTable.clean())}calculateAllRowsHeight(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{from:0,to:this.hot.countCols()-1},n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=0;const r=this.hot.countRows()-1;let o=null;this.inProgress=!0;const a=()=>{if(!this.hot){KC(o),this.inProgress=!1;return}this.calculateRowsHeight({from:i,to:Math.min(i+Fv.CALCULATION_STEP,r)},e,n),i=i+Fv.CALCULATION_STEP+1,i<r?o=qC(a):(KC(o),this.inProgress=!1,this.hot.view.adjustElementsSize())},u=this.getSyncCalculationLimit();u>=0&&(this.calculateRowsHeight({from:0,to:u},e,n),i=u+1),i<r?a():(this.inProgress=!1,this.hot.view.adjustElementsSize())}recalculateAllRowsHeight(){this.hot.view.isVisible()&&this.calculateAllRowsHeight({from:0,to:this.hot.countCols()-1},!0)}getSyncCalculationLimit(){const e=this.hot.getSettings()[hO];let n=Fv.SYNC_CALCULATION_LIMIT;const i=this.hot.countRows()-1;return Qe(e)&&(n=e.syncLimit,u4(n)?n=j4(i,n):n>>=0),Math.min(n,i)}getRowHeight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.hot.stylesHandler.getDefaultRowHeight();if(e<0){var i;return(i=this.headerHeight)!==null&&i!==void 0?i:n}const r=this.hot.toPhysicalRow(e);if(this.hot.rowIndexMapper.isHidden(r))return n;const o=this.rowHeightsMap.getValueAtIndex(r);let a=n;return o!==null&&o>n&&(a=o),a}getColumnHeaderHeight(){return this.headerHeight}getFirstVisibleRow(){var e;return(e=this.hot.getFirstRenderedVisibleRow())!==null&&e!==void 0?e:-1}getLastVisibleRow(){var e;return(e=this.hot.getLastRenderedVisibleRow())!==null&&e!==void 0?e:-1}clearCache(e){this.headerHeight=null,Array.isArray(e)?this.hot.batchExecution(()=>{e.forEach(n=>{this.rowHeightsMap.setValueAtIndex(n,null)})},!0):this.rowHeightsMap.clear()}clearCacheByRange(e){const{from:n,to:i}=typeof e=="number"?{from:e,to:e}:e;this.hot.batchExecution(()=>{ze(Math.min(n,i),Math.max(n,i),r=>{this.rowHeightsMap.setValueAtIndex(r,null)})},!0)}isNeedRecalculate(){return!!this.rowHeightsMap.getValues().slice(0,this.measuredRows).filter(e=>e===null).length}destroy(){this.ghostTable.clean(),super.destroy()}}function xwe(t){const e={from:0,to:this.hot.countCols()-1};t.forEach(n=>{this.samplesGenerator.generateRowSamples(n,e).forEach((r,o)=>this.ghostTable.addRow(o,r))}),this.ghostTable.rows.length&&(this.hot.batchExecution(()=>{this.ghostTable.getHeights((n,i)=>{const r=this.hot.toPhysicalRow(n);this.rowHeightsMap.setValueAtIndex(r,i)})},!0),this.ghostTable.clean())}function IK(t){const e=this.hot.getFirstRenderedVisibleColumn(),n=this.hot.columnIndexMapper.getPhysicalFromVisualIndex(e);t===!1||n===this.hot.columnIndexMapper.getPhysicalFromRenderableIndex(0)?Ve(this.hot.rootElement,IY):fe(this.hot.rootElement,IY)}function Hwe(){Do(fs,this,IK).call(this)}function Iwe(){this.calculateVisibleRowsHeight(),this.inProgress||(Do(fs,this,xwe).call(this,h0(ww,this)),HK(ww,this,[]))}function PY(t,e,n){let i=t;return n&&(this.calculateRowsHeight(e,void 0,!0),i=this.getRowHeight(e)),i}function Pwe(t,e){e||this.recalculateAllRowsHeight()}function Nwe(t){const e=t.reduce((n,i)=>{let[r]=i;return n.indexOf(r)===-1&&n.push(r),n},[]);h0(ww,this).push(...e)}function Dwe(){this.recalculateAllRowsHeight(),HK(sL,this,!0)}function Lwe(t){if(!h0(sL,this))return;const e=t.reduce((n,i)=>{var r;const o=(r=i.address)===null||r===void 0?void 0:r.row;if(Number.isInteger(o)){const a=this.hot.toVisualRow(o);n.indexOf(a)===-1&&n.push(a)}return n},[]);h0(ww,this).push(...e)}const{getListWithInsertedItems:kwe,getListWithRemovedItems:$we}=m5("physicallyIndexed");class Vwe extends Wd{constructor(){super(e=>e)}insert(e,n){const i=JP(this.indexedValues,n);this.indexedValues=kwe(i,e,n,this.initValueOrFn),super.insert(e,n)}remove(e){const n=$we(this.indexedValues,e);this.indexedValues=QP(n,e),super.remove(e)}}const{getListWithInsertedItems:Bwe,getListWithRemovedItems:Fwe}=m5("physicallyIndexed");class Wwe extends Wd{constructor(){super(e=>e)}insert(e,n){this.indexedValues=Bwe(this.indexedValues,e,n,(i,r)=>this.getNextValue(r)),super.insert(e,n)}remove(e){this.indexedValues=Fwe(this.indexedValues,e),super.remove(e)}getNextValue(e){return Math.max(...this.getValues())+1+e}}function jwe(t,e){zwe(t,e),e.add(t)}function zwe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Uwe(t,e,n){return(e=Ywe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ywe(t){var e=Gwe(t,"string");return typeof e=="symbol"?e:e+""}function Gwe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function qwe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const NY="bindRowsWithHeaders",Kwe=210,Xwe="loose",DY=new Map([["loose",Vwe],["strict",Wwe]]);var LY=new WeakSet;class Zwe extends Dt{constructor(){super(...arguments),jwe(this,LY),Uwe(this,"headerIndexes",null)}static get PLUGIN_KEY(){return NY}static get PLUGIN_PRIORITY(){return Kwe}isEnabled(){return!!this.hot.getSettings()[NY]}enablePlugin(){var e;if(this.enabled)return;const n=(e=DY.get(this.getSetting()))!==null&&e!==void 0?e:DY.get(Xwe);this.headerIndexes=this.hot.rowIndexMapper.registerMap("bindRowsWithHeaders",new n),this.addHook("modifyRowHeader",i=>qwe(LY,this,Qwe).call(this,i)),super.enablePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("bindRowsWithHeaders"),super.disablePlugin()}destroy(){super.destroy()}}function Qwe(t){return this.headerIndexes.getValueAtIndex(this.hot.toPhysicalRow(t))}function Jwe(t,e){PK(t,e),e.add(t)}function eye(t,e,n){PK(t,e),e.set(t,n)}function PK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kY(t,e,n){return(e=tye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function tye(t){var e=nye(t,"string");return typeof e=="symbol"?e:e+""}function nye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function $Y(t,e){return t.get(xg(t,e))}function dO(t,e,n){return t.set(xg(t,e),n),n}function xg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const bC="collapsibleColumns",iye=290,rye=["nestedHeaders"],Ug="collapsibleIndicator",VY=bC,BY=new Map([["collapse",{hideColumn:!0,beforeHook:"beforeColumnCollapse",afterHook:"afterColumnCollapse"}],["expand",{hideColumn:!1,beforeHook:"beforeColumnExpand",afterHook:"afterColumnExpand"}]]);var Wf=new WeakMap,Xp=new WeakSet;class oye extends Dt{constructor(){super(...arguments),Jwe(this,Xp),kY(this,"nestedHeadersPlugin",null),kY(this,"headerStateManager",null),eye(this,Wf,null)}static get PLUGIN_KEY(){return bC}static get PLUGIN_PRIORITY(){return iye}static get PLUGIN_DEPS(){return["plugin:NestedHeaders"]}static get SETTING_KEYS(){return[bC,...rye]}isEnabled(){return!!this.hot.getSettings()[bC]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();n||_t("You need to configure the Nested Headers plugin in order to use collapsible headers."),dO(Wf,this,this.hot.columnIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding")),this.nestedHeadersPlugin=this.hot.getPlugin("nestedHeaders"),this.headerStateManager=this.nestedHeadersPlugin.getStateManager(),this.addHook("init",()=>xg(Xp,this,lye).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return xg(Xp,e,uye).call(e,...r)}),this.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return xg(Xp,e,sye).call(e,...r)}),this.addHook("beforeOnCellMouseDown",(i,r,o)=>xg(Xp,this,aye).call(this,i,r,o)),this.registerShortcuts(),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(this.hot.view){if(!this.nestedHeadersPlugin.detectedOverlappedHeaders){const{collapsibleColumns:e}=this.hot.getSettings();typeof e=="boolean"?this.headerStateManager.mapState(n=>({collapsible:n.origColspan>1})):Array.isArray(e)&&(this.headerStateManager.mapState(()=>({collapsible:!1})),this.headerStateManager.mergeStateWith(e))}super.updatePlugin()}}disablePlugin(){this.hot.columnIndexMapper.unregisterMap(this.pluginName),dO(Wf,this,null),this.nestedHeadersPlugin=null,this.unregisterShortcuts(),this.clearButtons(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{var e;const{row:n,col:i}=this.hot.getSelectedRangeActive().highlight,{collapsible:r,isCollapsed:o,columnIndex:a}=(e=this.headerStateManager.getHeaderTreeNodeData(n,i))!==null&&e!==void 0?e:{};if(r)return o?this.expandSection({row:n,col:a}):this.collapseSection({row:n,col:a}),!1},runOnlyIf:()=>{var e,n;return((e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.isSingle())&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.highlight.isHeader())},group:VY,relativeToGroup:Yc,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(VY)}clearButtons(){if(!this.hot.view)return;const e=this.hot.view._wt.getSetting("columnHeaders").length,n=this.hot.view._wt.wtTable.THEAD,i=this.hot.view._wt.wtOverlays.topOverlay.clone.wtTable.THEAD,r=this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay?this.hot.view._wt.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null,o=function(a){a&&a.parentNode.removeChild(a)};ze(0,e-1,a=>{const u=n.childNodes[a],h=i.childNodes[a],d=r?r.childNodes[a]:null;ze(0,u.childNodes.length-1,g=>{let m=u.childNodes[g].querySelector(`.${Ug}`);o(m),h&&h.childNodes[g]&&(m=h.childNodes[g].querySelector(`.${Ug}`),o(m)),r&&d&&d.childNodes[g]&&(m=d.childNodes[g].querySelector(`.${Ug}`),o(m))})})}expandSection(e){this.toggleCollapsibleSection([e],"expand")}collapseSection(e){this.toggleCollapsibleSection([e],"collapse")}toggleAllCollapsibleSections(e){const n=this.headerStateManager.mapNodes(i=>{const{collapsible:r,origColspan:o,headerLevel:a,columnIndex:u,isCollapsed:h}=i;if(r===!0&&o>1&&(h&&e==="expand"||!h&&e==="collapse"))return{row:this.headerStateManager.levelToRowCoords(a),col:u}});this.toggleCollapsibleSection(n,e)}collapseAll(){this.toggleAllCollapsibleSections("collapse")}expandAll(){this.toggleAllCollapsibleSections("expand")}toggleCollapsibleSection(e,n){if(!BY.has(n))throw new Error(`Unsupported action is passed (${n}).`);if(!Array.isArray(e))return;const i=Rd(e,y=>{let{row:b}=y;return b<0});let r=i.length>0;U(i,y=>{var b;let{row:C,col:T}=y;const{collapsible:O,isCollapsed:A}=(b=this.headerStateManager.getHeaderSettings(C,T))!==null&&b!==void 0?b:{};if(!O||A&&n==="collapse"||!A&&n==="expand")return r=!1,!1});const o=[],a=[];r&&U(i,y=>{let{row:b,col:C}=y;const{colspanCompensation:T,affectedColumns:O,rollbackModification:A}=this.headerStateManager.triggerNodeModification(n,b,C);T>0&&(a.push(...O),o.push(A))});const u=this.getCollapsedColumns();let h=[];n==="collapse"?h=joe([...u,...a]):n==="expand"&&(h=Rd(u,y=>!a.includes(y)));const d=BY.get(n);if(this.hot.runHooks(d.beforeHook,u,h,r)===!1){U(o,y=>{y()});return}this.hot.batchExecution(()=>{U(a,y=>{$Y(Wf,this).setValueAtIndex(this.hot.toPhysicalColumn(y),d.hideColumn)})},!0);const m=this.getCollapsedColumns().length!==u.length,v=this.hot.getSelectedRangeActive();if(n==="collapse"&&m&&v){const{row:y,col:b}=v.highlight;if((this.hot.rowIndexMapper.isHidden(y)||this.hot.columnIndexMapper.isHidden(b))&&a.includes(b)){const T=y>=0?this.hot.rowIndexMapper.getNearestNotHiddenIndex(y,1,!0):y,O=b>=0?this.hot.columnIndexMapper.getNearestNotHiddenIndex(b,1,!0):b;T!==null&&O!==null&&this.hot.selectCell(T,O)}}this.hot.runHooks(d.afterHook,u,h,r,m),this.hot.view.adjustElementsSize(),this.hot.render()}getCollapsedColumns(){return $Y(Wf,this).getHiddenIndexes()}destroy(){dO(Wf,this,null),super.destroy()}}function sye(t,e,n){var i;const{collapsible:r,origColspan:o,isCollapsed:a}=(i=this.headerStateManager.getHeaderSettings(n,t))!==null&&i!==void 0?i:{},u=r&&o>1&&t>=this.hot.getSettings().fixedColumnsStart,h=this.hot.getSettings().ariaTags;let d=e.querySelector(`.${Ug}`);if(uu(e,[Ts("")[0]]),u)d||(d=this.hot.rootDocument.createElement("div"),fe(d,Ug),e.querySelector("div:first-child").appendChild(d)),Ve(d,["collapsed","expanded"]),a?(fe(d,"collapsed"),Td(d,"+"),h&&We(e,...Ts(!1))):(fe(d,"expanded"),Td(d,"-"),h&&We(e,...Ts(!0))),h&&We(d,...Bd());else{var g;(g=d)===null||g===void 0||g.remove()}}function aye(t,e){Xe(t.target,Ug)&&(Xe(t.target,"expanded")?(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"collapse")):Xe(t.target,"collapsed")&&(this.eventManager.fireEvent(t.target,"mouseup"),this.toggleCollapsibleSection([e],"expand")),ma(t))}function lye(){this.updatePlugin()}function uye(t,e){e||this.updatePlugin()}function Ah(t,e,n){return(e=cye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function cye(t){var e=hye(t,"string");return typeof e=="symbol"?e:e+""}function hye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const dye=["sortEmptyCells","indicator","headerAction","compareFunctionFactory"],fye=!1,gye=!0,mye=!0;class pye{constructor(e,n){Ah(this,"hot",void 0),Ah(this,"sortingStates",new _R),Ah(this,"sortEmptyCells",fye),Ah(this,"indicator",gye),Ah(this,"headerAction",mye),Ah(this,"compareFunctionFactory",void 0),Ah(this,"mapName",void 0),this.hot=e,this.mapName=n,this.hot.columnIndexMapper.registerMap(n,this.sortingStates)}updateAllColumnsProperties(e){Qe(e)&&wt(e,(n,i)=>{dye.includes(i)&&(this[i]=n)})}getAllColumnsProperties(){const e={sortEmptyCells:this.sortEmptyCells,indicator:this.indicator,headerAction:this.headerAction};return typeof this.compareFunctionFactory=="function"&&(e.compareFunctionFactory=this.compareFunctionFactory),e}getSortOrderOfColumn(e){var n;return(n=this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))===null||n===void 0?void 0:n.sortOrder}getIndexOfColumnInSortQueue(e){return e=this.hot.toPhysicalColumn(e),this.sortingStates.getEntries().findIndex(n=>{let[i]=n;return i===e})}getNumberOfSortedColumns(){return this.sortingStates.getLength()}isListOfSortedColumnsEmpty(){return this.getNumberOfSortedColumns()===0}isColumnSorted(e){return Qe(this.sortingStates.getValueAtIndex(this.hot.toPhysicalColumn(e)))}getSortStates(){return this.sortingStates===null?[]:this.sortingStates.getEntries().map(n=>{let[i,r]=n;return{column:this.hot.toVisualColumn(i),...r}})}getColumnSortState(e){const n=this.getSortOrderOfColumn(e);if(Ne(n))return{column:e,sortOrder:n}}setSortStates(e){this.sortingStates.clear();for(let n=0;n<e.length;n+=1)this.sortingStates.setValueAtIndex(this.hot.toPhysicalColumn(e[n].column),{sortOrder:e[n].sortOrder})}destroy(){this.hot.columnIndexMapper.unregisterMap(this.mapName),this.sortingStates=null}}function NK(t,e,n){const i=e.locale;return function(r,o){const{sortEmptyCells:a}=n;return typeof r=="string"&&(r=r.toLocaleLowerCase(i)),typeof o=="string"&&(o=o.toLocaleLowerCase(i)),r===o?tl:ni(r)?ni(o)?tl:a&&t==="asc"?zn:Un:ni(o)?a&&t==="asc"?Un:zn:isNaN(r)&&!isNaN(o)?t==="asc"?Un:zn:!isNaN(r)&&isNaN(o)||(isNaN(r)||isNaN(o)||(r=parseFloat(r),o=parseFloat(o)),r<o)?t==="asc"?zn:Un:r>o?t==="asc"?Un:zn:tl}}const DK="default";function vye(t,e,n){return function(i,r){const o=parseFloat(i),a=parseFloat(r),{sortEmptyCells:u}=n;if(o===a||isNaN(o)&&isNaN(a))return tl;if(u){if(ni(i))return t==="asc"?zn:Un;if(ni(r))return t==="asc"?Un:zn}return isNaN(o)?Un:isNaN(a)?zn:o<a?t==="asc"?zn:Un:o>a?t==="asc"?Un:zn:tl}}const wye="numeric";function yye(t,e,n){const i=e.checkedTemplate,r=e.uncheckedTemplate,{sortEmptyCells:o}=n;return function(a,u){const h=ni(a),d=ni(u),g=h?r:a,m=d?r:u,v=g===r||g===i,y=m===r||m===i;if(o===!1){if(h&&d===!1)return Un;if(h===!1&&d)return zn}return v===!1&&y?t==="asc"?zn:Un:v&&y===!1?t==="asc"?Un:zn:v===!1&&y===!1?NK(t,e,n)(a,u):g===r&&m===i?t==="asc"?zn:Un:g===i&&m===r?t==="asc"?Un:zn:tl}}const Sye="checkbox";function bye(t,e,n){return FK(t,e.dateFormat,n)}const Cye="date";function Rye(t,e,n){return FK(t,e.timeFormat,n)}const Eye="time",{register:Kw,getItem:FY,hasItem:Tye}=Ps("sorting.compareFunctionFactory"),{register:LK,getItem:_ye}=Ps("sorting.mainSortComparator");function kK(t){return Tye(t)?FY(t):FY(DK)}Kw(Sye,yye);Kw(Cye,bye);Kw(DK,NK);Kw(wye,vye);Kw(Eye,Rye);const tl=0,zn=-1,Un=1;function Mye(t,e){const n=_ye(e);for(var i=arguments.length,r=new Array(i>2?i-2:0),o=2;o<i;o++)r[o-2]=arguments[o];t.sort(n(...r))}const d0="asc",f0="desc",$K="colHeader";function Aye(t){if(Qe(t)===!1)return!1;const{column:e,sortOrder:n}=t;return Number.isInteger(e)&&[d0,f0].includes(n)}function Oye(t){if(t.some(n=>Aye(n)===!1))return!1;const e=t.map(n=>{let{column:i}=n;return i});return new Set(e).size===e.length}function WY(t){if(t!==f0)return t===d0?f0:d0}function VK(t){return t.querySelector(`.${$K}`)}function BK(t,e){if(t<0||!e.parentNode)return!1;const n=e.parentNode.parentNode.childNodes;return Array.from(n).indexOf(e.parentNode)-n.length===-1}function aL(t,e,n){return t===-1&&e>=0&&_d(n)===!1}function FK(t,e,n){return function(i,r){const{sortEmptyCells:o}=n;if(i===r)return tl;if(ni(i))return ni(r)?tl:o&&t==="asc"?zn:Un;if(ni(r))return o&&t==="asc"?Un:zn;const a=Ce(i,e),u=Ce(r,e);return a.isValid()?u.isValid()?u.isAfter(a)?t==="asc"?zn:Un:u.isBefore(a)?t==="asc"?Un:zn:tl:zn:Un}}function xye(t,e){_t(Ft`Plugins \`columnSorting\` and \`multiColumnSorting\` should not be enabled simultaneously.\x20
    Only \`${t}\` will work. The \`${e}\` plugin will remain disabled.`)}const Hye="ascending",Iye="descending",WK="indicatorDisabled",jK="columnSorting",zK="sortAction",UK=new Map([[d0,Hye],[f0,Iye]]);function Pye(t,e,n,i){const r=[jK];if(i&&r.push(zK),n===!1)return r.push(WK),r;const o=t.getSortOrderOfColumn(e);return Ne(o)&&r.push(UK.get(o)),r}function Nye(){return Array.from(UK.values()).concat(zK,WK,jK)}function Dye(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return(function(u){const h=t[u],d=e[u],g=r[u],m=o[u],v=d.columnSorting;return(v.compareFunctionFactory?v.compareFunctionFactory:kK(d.type))(h,d,v)(g,m)})(0)}}function Lye(t,e){kye(t,e),e.add(t)}function kye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ab(t,e,n){return(e=$ye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $ye(t){var e=Vye(t,"string");return typeof e=="symbol"?e:e+""}function Vye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function yg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const g0="columnSorting",Bye=50,m0="append",Fye="replace",jY=g0;LK(g0,Dye);He.getSingleton().register("beforeColumnSort");He.getSingleton().register("afterColumnSort");const Zp=new WeakMap;var ed=new WeakSet;class YK extends Dt{constructor(){super(...arguments),Lye(this,ed),ab(this,"columnStatesManager",null),ab(this,"columnMetaCache",null),ab(this,"pluginKey",g0),ab(this,"indexesSequenceCache",null)}static get PLUGIN_KEY(){return g0}static get PLUGIN_PRIORITY(){return Bye}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){var e=this;if(Zp.has(this.hot)&&Zp.get(this.hot)!==this.pluginKey){this.hot.updateSettings({[this.pluginKey]:!1}),xye(Zp.get(this.hot),this.pluginKey);return}this.enabled||(Zp.set(this.hot,this.pluginKey),this.columnStatesManager=new pye(this.hot,`${this.pluginKey}.sortingStates`),this.columnMetaCache=new Uc(n=>{let i=this.hot.toVisualColumn(n);return i===null&&(i=n),this.getMergedPluginSettings(i)}),this.hot.columnIndexMapper.registerMap(`${this.pluginKey}.columnMeta`,this.columnMetaCache),this.addHook("afterGetColHeader",(n,i)=>yg(ed,this,Wye).call(this,n,i)),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yg(ed,e,zye).call(e,...i)}),this.addHook("afterOnCellMouseDown",(n,i)=>this.onAfterOnCellMouseDown(n,i)),this.addHook("afterInit",()=>yg(ed,this,eI).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return yg(ed,e,jye).call(e,...i)}),this.hot.view&&yg(ed,this,eI).call(this),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){const e=(n,i)=>{const r=VK(i);BK(n,i)===!1||r===null||this.updateHeaderClasses(r)};Zp.delete(this.hot),this.hot.addHook("afterGetColHeader",e),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("afterGetColHeader",e)}),this.hot.batchExecution(()=>{this.indexesSequenceCache!==null&&(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginKey),this.indexesSequenceCache=null)},!0),this.hot.columnIndexMapper.unregisterMap(`${this.pluginKey}.columnMeta`),this.columnStatesManager.destroy(),this.columnMetaCache=null,this.columnStatesManager=null,this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return this.sort(this.getColumnNextConfig(e.col)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.row===-1&&i.col>=0},relativeToGroup:Yc,position:"before",group:jY})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(jY)}sort(e){const n=this.getSortConfig(),i=this.getNormalizedSortConfigs(e),r=this.areValidSortConfigs(i);this.hot.runHooks("beforeColumnSort",n,i,r)!==!1&&(n.length===0&&this.indexesSequenceCache===null&&(this.indexesSequenceCache=this.hot.rowIndexMapper.registerMap(this.pluginKey,new p5),this.indexesSequenceCache.setValues(this.hot.rowIndexMapper.getIndexesSequence())),r&&(this.columnStatesManager.setSortStates(i),this.sortByPresetSortStates(i),this.saveAllSortSettings(i)),this.hot.runHooks("afterColumnSort",n,r?i:n,r),r&&this.hot.render())}clearSort(){this.sort([])}isSorted(){return this.enabled&&!this.columnStatesManager.isListOfSortedColumnsEmpty()}getSortConfig(e){return Ne(e)?this.columnStatesManager.getColumnSortState(e):this.columnStatesManager.getSortStates()}setSortConfig(e){const n=this.getNormalizedSortConfigs(e);this.areValidSortConfigs(n)&&this.columnStatesManager.setSortStates(n)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e.slice(0,1):[e]}areValidSortConfigs(e){const n=this.hot.countCols();return Oye(e)&&e.every(i=>{let{column:r}=i;return r<=n&&r>=0})}saveAllSortSettings(e){const n=this.columnStatesManager.getAllColumnsProperties(),i=r=>{let{column:o,...a}=r;return{column:this.hot.toPhysicalColumn(o),...a}};n.initialConfig=Vt(e,i),this.hot.runHooks("persistentStateSave","columnSorting",n)}getAllSavedSortSettings(){const e={};this.hot.runHooks("persistentStateLoad","columnSorting",e);const n=e.value,i=r=>{let{column:o,...a}=r;return{column:this.hot.toVisualColumn(o),...a}};return Ne(n)&&Array.isArray(n.initialConfig)&&(n.initialConfig=Vt(n.initialConfig,i)),n}getColumnNextConfig(e){const n=this.columnStatesManager.getSortOrderOfColumn(e);if(Ne(n)){const r=WY(n);return Ne(r)?{column:e,sortOrder:r}:void 0}const i=this.hot.countCols();if(Number.isInteger(e)&&e>=0&&e<i)return{column:e,sortOrder:WY()}}getNextSortConfig(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:m0;const i=this.columnStatesManager.getIndexOfColumnInSortQueue(e),r=i!==-1,o=this.getSortConfig(),a=this.getColumnNextConfig(e);if(r){if($n(a))return[...o.slice(0,i),...o.slice(i+1)];if(n===m0)return[...o.slice(0,i),...o.slice(i+1),a];if(n===Fye)return[...o.slice(0,i),a,...o.slice(i+1)]}return Ne(a)?o.concat(a):o}getPluginColumnConfig(e){if(Qe(e)){const n=e[this.pluginKey];if(Qe(n))return n}return{}}getMergedPluginSettings(e){const n=this.hot.getSettings()[this.pluginKey],i=this.columnStatesManager.getAllColumnsProperties(),r=this.hot.getCellMeta(0,e),o=Object.getPrototypeOf(r);return Array.isArray(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns[e])):Yt(o.columns)?Object.assign(i,n,this.getPluginColumnConfig(o.columns(e))):Object.assign(i,n)}getFirstCellSettings(e){const n=this.hot.getCellMeta(0,e),i=Object.create(n);return i[this.pluginKey]=this.columnMetaCache.getValueAtIndex(this.hot.toPhysicalColumn(e)),i}getNumberOfRowsToSort(e){const n=this.hot.getSettings();return n.maxRows<=e?n.maxRows:e-n.minSpareRows}sortByPresetSortStates(e){if(this.hot.rowIndexMapper.setIndexesSequence(this.indexesSequenceCache.getValues()),e.length===0)return;const n=[],i=this.hot.countRows(),r=d=>Vt(e,g=>this.hot.getDataAtCell(d,g.column));for(let d=0;d<this.getNumberOfRowsToSort(i);d+=1)n.push([this.hot.toPhysicalRow(d)].concat(r(d)));const o=Vt(n,d=>d[0]);Mye(n,this.pluginKey,Vt(e,d=>d.sortOrder),Vt(e,d=>this.getFirstCellSettings(d.column)));for(let d=n.length;d<i;d+=1)n.push([d].concat(r(d)));const a=Vt(n,d=>d[0]),u=new Map(Vt(o,(d,g)=>[d,a[g]])),h=Vt(this.hot.rowIndexMapper.getIndexesSequence(),d=>u.has(d)?u.get(d):d);this.hot.rowIndexMapper.setIndexesSequence(h)}sortBySettings(e){if(Qe(e)){this.columnStatesManager.updateAllColumnsProperties(e);const n=e.initialConfig;(Array.isArray(n)||Qe(n))&&this.sort(n)}else this.hot.render()}updateHeaderClasses(e){if(Ve(e,Nye()),this.enabled!==!1){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];fe(e,Pye(...i))}}onUpdateSettings(e){super.onUpdateSettings(e),this.columnMetaCache!==null&&this.columnMetaCache.init(this.hot.columnIndexMapper.getNumberOfIndexes()),Ne(e[this.pluginKey])&&this.sortBySettings(e[this.pluginKey])}wasClickableHeaderClicked(e,n){return this.getFirstCellSettings(n)[this.pluginKey].headerAction&&Xe(e.target,$K)}onAfterOnCellMouseDown(e,n){if(aL(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)){this.hot.getShortcutManager().isCtrlPressed()&&(this.hot.deselectCell(),this.hot.selectColumns(n.col));const i=this.hot.getActiveEditor(),r=this.getColumnNextConfig(n.col);i!=null&&i.isOpened()&&this.hot.getCellValidator(i.row,i.col)?this.hot.addHookOnce("postAfterValidate",()=>{this.sort(r)}):this.sort(r)}}destroy(){var e;(e=this.columnStatesManager)===null||e===void 0||e.destroy(),super.destroy()}}function eI(){const t=this.getAllSavedSortSettings();if(Qe(t))this.sortBySettings(t);else{const e=this.hot.getSettings()[this.pluginKey];this.sortBySettings(e)}}function Wye(t,e){const n=VK(e);if(BK(t,e)===!1||n===null)return;const i=this.getFirstCellSettings(t)[this.pluginKey],r=i.indicator,o=i.headerAction;if(this.updateHeaderClasses(n,this.columnStatesManager,t,r,o),this.hot.getSettings().ariaTags){const a=this.columnStatesManager.getSortOrderOfColumn(t);We(e,...mse(a?`${a}ending`:"none"))}}function jye(t){t===!0&&this.hot.view&&yg(ed,this,eI).call(this)}function zye(t,e,n,i){aL(e.row,e.col,t)!==!1&&this.wasClickableHeaderClicked(t,e.col)&&this.hot.getShortcutManager().isCtrlPressed()&&(i.column=!0)}function fO(t){return t==null||isNaN(t)}function Uye(t,e){if(typeof t!="number")return t;const n=i=>i.toString();switch(typeof e){case"number":return n(t.toFixed(Math.min(Math.max(0,e),100)));case"boolean":return e?n(Math.round(t)):t;case"string":if(e==="auto"){const i=Math.round(t).toString().length;return n(t.toFixed(8-i))}return t;default:return t}}function Oh(t,e,n){return(e=Yye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Yye(t){var e=Gye(t,"string");return typeof e=="symbol"?e:e+""}function Gye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class qye{constructor(e,n){Oh(this,"plugin",void 0),Oh(this,"hot",void 0),Oh(this,"endpoints",[]),Oh(this,"settings",void 0),Oh(this,"settingsType","array"),Oh(this,"currentEndpoint",null),Oh(this,"cellsToSetCache",[]),this.plugin=e,this.hot=this.plugin.hot,this.settings=n}initEndpoints(){this.endpoints=this.parseSettings(),this.refreshAllEndpoints()}getEndpoint(e){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings)[e]:this.endpoints[e]}getAllEndpoints(){return this.settingsType==="function"?this.fillMissingEndpointData(this.settings):this.endpoints}fillMissingEndpointData(e){return this.parseSettings(e.call(this))}parseSettings(e){const n=[];let i=e;if(!i&&typeof this.settings=="function"){this.settingsType="function";return}return i||(i=this.settings),U(i,r=>{const o={};this.assignSetting(r,o,"ranges",[[0,this.hot.countRows()-1]]),this.assignSetting(r,o,"reversedRowCoords",!1),this.assignSetting(r,o,"destinationRow",new Error(`
        You must provide a destination row for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"destinationColumn",new Error(`
        You must provide a destination column for the Column Summary plugin in order to work properly!
      `)),this.assignSetting(r,o,"sourceColumn",r.destinationColumn),this.assignSetting(r,o,"type","sum"),this.assignSetting(r,o,"forceNumeric",!1),this.assignSetting(r,o,"suppressDataTypeErrors",!0),this.assignSetting(r,o,"customFunction",null),this.assignSetting(r,o,"readOnly",!0),this.assignSetting(r,o,"roundFloat",!1),n.push(o)}),n}assignSetting(e,n,i,r){if(i==="ranges"&&e[i]===void 0){n[i]=r;return}else if(i==="ranges"&&e[i].length===0)return;if(e[i]===void 0){if(r instanceof Error)throw r;n[i]=r}else i==="destinationRow"&&n.reversedRowCoords?n[i]=this.hot.countRows()-e[i]-1:n[i]=e[i]}resetSetupBeforeStructureAlteration(e,n,i){if(this.settingsType!=="function")return;const r=e.indexOf("row")>-1?"row":"col",o=this.getAllEndpoints();U(o,a=>{r==="row"&&a.destinationRow>=n&&(e==="insert_row"?a.alterRowOffset=i:e==="remove_row"&&(a.alterRowOffset=-1*i)),r==="col"&&a.destinationColumn>=n&&(e==="insert_col"?a.alterColumnOffset=i:e==="remove_col"&&(a.alterColumnOffset=-1*i))}),this.resetAllEndpoints(o,!1)}resetSetupAfterStructureAlteration(e,n,i,r,o){let a=arguments.length>5&&arguments[5]!==void 0?arguments[5]:!0;if(this.settingsType==="function"){const v=()=>(this.hot.removeHook("beforeViewRender",v),this.refreshAllEndpoints());this.hot.addHookOnce("beforeViewRender",v);return}const u=e.indexOf("row")>-1?"row":"col",h=e.indexOf("remove")>-1?-1:1,d=this.getAllEndpoints(),g=e.indexOf("move_row")===0,m=n;U(d,v=>{u==="row"&&v.destinationRow>=m&&(v.alterRowOffset=h*i),u==="col"&&v.destinationColumn>=m&&(v.alterColumnOffset=h*i)}),this.resetAllEndpoints(d,!g),g?U(d,v=>{this.extendEndpointRanges(v,m,r[0],r.length),this.recreatePhysicalRanges(v),this.clearOffsetInformation(v)}):U(d,v=>{this.shiftEndpointCoordinates(v,m)}),a&&this.refreshAllEndpoints()}clearOffsetInformation(e){e.alterRowOffset=void 0,e.alterColumnOffset=void 0}extendEndpointRanges(e,n,i,r){U(e.ranges,o=>{o[1]&&(n>=o[0]&&n<=o[1]?i>o[1]?o[1]+=r:i<o[0]&&(o[0]-=r):i>=o[0]&&i<=o[1]&&(o[1]-=r,n<=o[0]&&(o[0]+=1,o[1]+=1)))})}recreatePhysicalRanges(e){const n=e.ranges,i=[],r=[];U(n,o=>{const a=[];if(o[1])for(let u=o[0];u<=o[1];u++)a.push(this.hot.toPhysicalRow(u));else a.push(this.hot.toPhysicalRow(o[0]));r.push(a)}),U(r,o=>{let a=[];U(o,(u,h)=>{h===0?a.push(u):o[h]!==o[h-1]+1&&(a.push(o[h-1]),i.push(a),a=[],a.push(u)),h===o.length-1&&(a.push(u),i.push(a))})}),e.ranges=i}shiftEndpointCoordinates(e,n){e.alterRowOffset&&e.alterRowOffset!==0?(e.destinationRow+=e.alterRowOffset||0,U(e.ranges,i=>{U(i,(r,o)=>{r>=n&&(i[o]+=e.alterRowOffset||0)})})):e.alterColumnOffset&&e.alterColumnOffset!==0&&(e.destinationColumn+=e.alterColumnOffset||0,e.sourceColumn+=e.alterColumnOffset||0)}resetAllEndpoints(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.getAllEndpoints(),n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;e.some(r=>{const o=r.alterRowOffset||0,a=r.alterColumnOffset||0;return r.destinationRow+o>=this.hot.countRows()||r.destinationColumn+a>=this.hot.countCols()})||(this.cellsToSetCache=[],U(e,r=>{this.resetEndpointValue(r,n)}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[])}refreshAllEndpoints(){this.cellsToSetCache=[],U(this.getAllEndpoints(),e=>{this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e,"init")}),this.currentEndpoint=null,this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshChangedEndpoints(e){const n=[];this.cellsToSetCache=[],U(e,(i,r,o)=>{`${i[2]||""}`!=`${i[3]}`&&U(this.getAllEndpoints(),(a,u)=>{this.hot.propToCol(o[r][1])===a.sourceColumn&&n.indexOf(u)===-1&&n.push(u)})}),U(n,i=>{this.refreshEndpoint(this.getEndpoint(i))}),this.hot.setDataAtCell(this.cellsToSetCache,"ColumnSummary.reset"),this.cellsToSetCache=[]}refreshCellMetas(){this.endpoints.forEach(e=>{const n=this.hot.toVisualRow(e.destinationRow);if(n!==null){const i=this.hot.getCellMeta(n,e.destinationColumn);i.readOnly=e.readOnly,i.className="columnSummaryResult"}})}refreshEndpoint(e){this.currentEndpoint=e,this.plugin.calculate(e),this.setEndpointValue(e),this.currentEndpoint=null}resetEndpointValue(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=e.alterRowOffset||0,r=e.alterColumnOffset||0;this.cellsToSetCache.push([this.hot.toVisualRow(e.destinationRow+(n?i:0)),this.hot.toVisualColumn(e.destinationColumn+(n?r:0)),""])}setEndpointValue(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=this.hot.toVisualRow(e.destinationRow);if(e.destinationRow>=this.hot.countRows()||e.destinationColumn>=this.hot.countCols()){this.throwOutOfBoundsWarning();return}const o=this.hot.toVisualRow(e.destinationRow);if(o!==null){const a=this.hot.getCellMeta(o,e.destinationColumn);(n==="init"||a.readOnly!==e.readOnly)&&(a.readOnly=e.readOnly,a.className="columnSummaryResult")}e.result=Uye(e.result,e.roundFloat),i?this.hot.setDataAtCell(r,e.destinationColumn,e.result,"ColumnSummary.set"):this.cellsToSetCache.push([r,e.destinationColumn,e.result]),e.alterRowOffset=void 0,e.alterColumnOffset=void 0}throwOutOfBoundsWarning(){_t("One of the Column Summary plugins' destination points you provided is beyond the table boundaries!")}}function Kye(t,e){Xye(t,e),e.add(t)}function Xye(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zye(t,e,n){return(e=Qye(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Qye(t){var e=Jye(t,"string");return typeof e=="symbol"?e:e+""}function Jye(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function jf(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gO="columnSummary",eSe=220;var xh=new WeakSet;class tSe extends Dt{constructor(){super(...arguments),Kye(this,xh),Zye(this,"endpoints",null)}static get PLUGIN_KEY(){return gO}static get PLUGIN_PRIORITY(){return eSe}isEnabled(){return!!this.hot.getSettings()[gO]}enablePlugin(){var e=this;this.enabled||(this.settings=this.hot.getSettings()[gO],this.endpoints=new qye(this,this.settings),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(xh,e,nSe).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(xh,e,rSe).call(e,...i)}),this.addHook("afterUpdateSettings",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(xh,e,iSe).call(e,...i)}),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(xh,e,oSe).call(e,...i)}),this.addHook("afterUpdateData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(xh,e,sSe).call(e,...i)}),this.addHook("beforeCreateRow",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_row",n,i,null,r)),this.addHook("beforeCreateCol",(n,i,r)=>this.endpoints.resetSetupBeforeStructureAlteration("insert_col",n,i,null,r)),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_row",...i)}),this.addHook("beforeRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupBeforeStructureAlteration("remove_col",...i)}),this.addHook("afterCreateRow",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_row",n,i,null,r)),this.addHook("afterCreateCol",(n,i,r)=>this.endpoints.resetSetupAfterStructureAlteration("insert_col",n,i,null,r)),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_row",...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return e.endpoints.resetSetupAfterStructureAlteration("remove_col",...i)}),this.addHook("afterRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return jf(xh,e,aSe).call(e,...i)}),super.enablePlugin())}disablePlugin(){this.endpoints=null,this.settings=null,this.currentEndpoint=null,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.endpoints.initEndpoints(),super.updatePlugin()}calculate(e){switch(e.type.toLowerCase()){case"sum":e.result=this.calculateSum(e);break;case"min":e.result=this.calculateMinMax(e,e.type);break;case"max":e.result=this.calculateMinMax(e,e.type);break;case"count":e.result=this.countEntries(e);break;case"average":e.result=this.calculateAverage(e);break;case"custom":e.result=e.customFunction.call(this,e);break}}calculateSum(e){let n=0;return wt(e.ranges,i=>{n+=this.getPartialSum(i,e.sourceColumn)}),n}getPartialSum(e,n){let i=0,r=e[1]||e[0],o=null,a=0;do{if(o=this.getCellValue(r,n),o=fO(o)?null:o,o!==null){const u=(`${o}`.split(".")[1]||[]).length||1;u>a&&(a=u)}i+=o||0,r-=1}while(r>=e[0]);return Math.round(i*10**a)/10**a}calculateMinMax(e,n){let i=null;return wt(e.ranges,r=>{const o=this.getPartialMinMax(r,e.sourceColumn,n);if(i===null&&o!==null&&(i=o),o!==null)switch(n){case"min":i=Math.min(i,o);break;case"max":i=Math.max(i,o);break}}),i===null?"Not enough data":i}getPartialMinMax(e,n,i){let r=null,o=e[1]||e[0],a;do{if(a=this.getCellValue(o,n),a=fO(a)?null:a,r===null)r=a;else if(a!==null)switch(i){case"min":r=Math.min(r,a);break;case"max":r=Math.max(r,a);break}o-=1}while(o>=e[0]);return r}countEmpty(e,n){let i,r=0,o=e[1]||e[0];do i=this.getCellValue(o,n),i=fO(i)?null:i,i===null&&(r+=1),o-=1;while(o>=e[0]);return r}countEntries(e){let n=0;const i=e.ranges;return wt(i,r=>{const o=r[1]===void 0?1:r[1]-r[0]+1,a=this.countEmpty(r,e.sourceColumn);n+=o,n-=a}),n}calculateAverage(e){const n=this.calculateSum(e),i=this.countEntries(e);return n/i}getCellValue(e,n){const i=this.hot.toVisualRow(e),r=this.hot.toVisualColumn(n);let o=this.hot.getSourceDataAtCell(e,n),a="";if(i!==null&&r!==null&&(a=this.hot.getCellMeta(i,r).className||""),a.indexOf("columnSummaryResult")>-1)return null;if(this.endpoints.currentEndpoint.forceNumeric&&(typeof o=="string"&&(o=o.replace(/,/,".")),o=parseFloat(o)),isNaN(o)&&!this.endpoints.currentEndpoint.suppressDataTypeErrors)throw new Error(Ft`ColumnSummary plugin: cell at (${e}, ${n}) is not in a\x20
          numeric format. Cannot do the calculation.`);return o}}function nSe(){this.endpoints.initEndpoints()}function iSe(t){t.columns!==void 0&&this.endpoints.refreshCellMetas()}function rSe(t,e){t&&e!=="ColumnSummary.reset"&&e!=="ColumnSummary.set"&&e!=="loadData"&&this.endpoints.refreshChangedEndpoints(t)}function oSe(t,e){e||this.endpoints.refreshAllEndpoints()}function sSe(t,e){e||this.endpoints.refreshAllEndpoints()}function aSe(t,e){this.endpoints.resetSetupBeforeStructureAlteration("move_row",t[0],t.length,t,this.pluginName),this.endpoints.resetSetupAfterStructureAlteration("move_row",e,t.length,t,this.pluginName)}function lSe(t,e){GK(t,e),e.add(t)}function mO(t,e,n){GK(t,e),e.set(t,n)}function GK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Sg(t,e){return t.get(lL(t,e))}function tI(t,e,n){return t.set(lL(t,e),n),n}function lL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var p0=new WeakMap,lb=new WeakMap,ub=new WeakMap,zY=new WeakSet;class qK{constructor(){lSe(this,zY),mO(this,p0,!0),mO(this,lb,null),mO(this,ub,new ResizeObserver(e=>lL(zY,this,uSe).call(this,e)))}setObservedElement(e){tI(lb,this,e)}unobserve(){Sg(ub,this).unobserve(Sg(lb,this))}observe(){tI(p0,this,!0),Sg(ub,this).observe(Sg(lb,this))}destroy(){Sg(ub,this).disconnect()}}function uSe(t){if(Sg(p0,this)||!Array.isArray(t)||!t.length){tI(p0,this,!1);return}t.forEach(e=>{let{borderBoxSize:n}=e;const{inlineSize:i,blockSize:r}=n[0];this.runLocalHooks("resize",i,r)})}en(qK,Fi);function ec(t,e,n){cSe(t,e),e.set(t,n)}function cSe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dn(t,e){return t.get(KK(t,e))}function Aa(t,e,n){return t.set(KK(t,e),n),n}function KK(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var zf=new WeakMap,pO=new WeakMap,vO=new WeakMap,kl=new WeakMap,tc=new WeakMap,nc=new WeakMap,cb=new WeakMap,Uf=new WeakMap;class fd{static get CLASS_EDITOR_CONTAINER(){return"htCommentsContainer"}static get CLASS_EDITOR(){return"htComments"}static get CLASS_INPUT(){return"htCommentTextArea"}static get CLASS_CELL(){return"htCommentCell"}constructor(e,n,i){var r=this;ec(this,zf,void 0),ec(this,pO,void 0),ec(this,vO,!1),ec(this,kl,null),ec(this,tc,void 0),ec(this,nc,void 0),ec(this,cb,!0),ec(this,Uf,new qK),Aa(zf,this,e),Aa(pO,this,i),Aa(vO,this,n),Aa(tc,this,this.createEditor()),Aa(nc,this,dn(tc,this).style),dn(Uf,this).setObservedElement(this.getInputElement()),dn(Uf,this).addLocalHook("resize",function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return r.runLocalHooks("resize",...a)}),this.hide()}setPosition(e,n){dn(nc,this).left=`${e}px`,dn(nc,this).top=`${n}px`}setSize(e,n){if(e&&n){const i=this.getInputElement();i.style.width=`${e}px`,i.style.height=`${n}px`}}getSize(){return{width:hi(this.getInputElement()),height:Ti(this.getInputElement())}}observeSize(){dn(Uf,this).observe()}resetSize(){const e=this.getInputElement();e.style.width="",e.style.height=""}setReadOnlyState(e){const n=this.getInputElement();n.readOnly=e}show(){dn(nc,this).display="block",Aa(cb,this,!1)}hide(){dn(Uf,this).unobserve(),dn(cb,this)||(dn(nc,this).display="none"),Aa(cb,this,!0)}isVisible(){return dn(nc,this).display==="block"}setValue(){const n=(arguments.length>0&&arguments[0]!==void 0?arguments[0]:"")||"";this.getInputElement().value=n}getValue(){return this.getInputElement().value}isFocused(){return dn(zf,this).activeElement===this.getInputElement()}focus(){this.getInputElement().focus()}createEditor(){const e=dn(zf,this).createElement("div"),n=dn(zf,this).createElement("textarea");return e.style.display="none",Aa(kl,this,dn(zf,this).createElement("div")),dn(kl,this).setAttribute("dir",dn(vO,this)?"rtl":"ltr"),fe(dn(kl,this),fd.CLASS_EDITOR_CONTAINER),dn(pO,this).appendChild(dn(kl,this)),fe(e,fd.CLASS_EDITOR),fe(n,fd.CLASS_INPUT),n.setAttribute("data-hot-input",!0),e.appendChild(n),dn(kl,this).appendChild(e),e}getInputElement(){return dn(tc,this).querySelector(`.${fd.CLASS_INPUT}`)}getEditorElement(){return dn(tc,this)}destroy(){const e=dn(kl,this)?dn(kl,this).parentNode:null;dn(tc,this).parentNode.removeChild(dn(tc,this)),Aa(tc,this,null),Aa(nc,this,null),dn(Uf,this).destroy(),e&&e.removeChild(dn(kl,this))}}en(fd,Fi);function wO(t,e,n){return(e=hSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hSe(t){var e=dSe(t,"string");return typeof e=="symbol"?e:e+""}function dSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const fSe=250,gSe=250;class XK{constructor(e){wO(this,"wasLastActionShow",!0),wO(this,"showDebounced",null),wO(this,"hidingTimer",null),this.updateDelay(e)}hide(){this.wasLastActionShow=!1,this.hidingTimer=setTimeout(()=>{this.wasLastActionShow===!1&&this.runLocalHooks("hide")},gSe)}show(e){this.wasLastActionShow=!0,this.showDebounced(e)}cancelHiding(){this.wasLastActionShow=!0,clearTimeout(this.hidingTimer),this.hidingTimer=null}updateDelay(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:fSe;this.showDebounced=SR(n=>{this.wasLastActionShow&&this.runLocalHooks("show",n.from.row,n.from.col)},e)}destroy(){this.clearLocalHooks()}}en(XK,Fi);function mSe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ","")} ${e}`}function pSe(t,e){return t.indexOf(e)!==-1?t:`${t.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ","")} ${e}`}function Hh(t,e){const n={};return U(t,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&(n[r]||(n[r]=[]),n[r][o]=e(r,o))})}),n}function yc(t,e,n,i,r){U(t,o=>{o.forAll((a,u)=>{a>=0&&u>=0&&vSe(a,u,e,n,i,r)})})}function vSe(t,e,n,i,r,o){const a=r(t,e);let u=i;a.className&&(n==="vertical"?u=mSe(a.className,i):u=pSe(a.className,i)),o(t,e,"className",u)}function ZK(t){return`<span class="selected">✓</span>${t}`}function CC(t,e){let n=!1;return Array.isArray(t)&&U(t,i=>(i.forAll((r,o)=>{if(r>=0&&o>=0&&e(r,o))return n=!0,!1}),n)),n}function LR(t,e){const n={top:0,left:0};if(e!==t.ownerDocument){const{frameElement:i}=e.defaultView,{top:r,left:o}=i.getBoundingClientRect();n.top=r,n.left=o}return n}const vt="---------";function wSe(){return{name:vt}}const vs="alignment";function ySe(){return{key:vs,name(){return this.getTranslatedPhrase(EN)},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const t=this.getSelectedRangeActive();return!t||t.isSingleHeader()?!0:!(this.getSelectedRange()&&!this.selection.isSelectedByCorner())},submenu:{items:[{key:`${vs}:left`,name(){return this.getTranslatedPhrase(TN)},callback(){const t=this.getSelectedRange(),e=Hh(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htLeft";this.runHooks("beforeCellAlignment",e,t,n,i),yc(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${vs}:center`,name(){return this.getTranslatedPhrase(_N)},callback(){const t=this.getSelectedRange(),e=Hh(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htCenter";this.runHooks("beforeCellAlignment",e,t,n,i),yc(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${vs}:right`,name(){return this.getTranslatedPhrase(MN)},callback(){const t=this.getSelectedRange(),e=Hh(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htRight";this.runHooks("beforeCellAlignment",e,t,n,i),yc(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${vs}:justify`,name(){return this.getTranslatedPhrase(AN)},callback(){const t=this.getSelectedRange(),e=Hh(t,(r,o)=>this.getCellMeta(r,o).className),n="horizontal",i="htJustify";this.runHooks("beforeCellAlignment",e,t,n,i),yc(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{name:vt},{key:`${vs}:top`,name(){return this.getTranslatedPhrase(ON)},callback(){const t=this.getSelectedRange(),e=Hh(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htTop";this.runHooks("beforeCellAlignment",e,t,n,i),yc(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${vs}:middle`,name(){return this.getTranslatedPhrase(xN)},callback(){const t=this.getSelectedRange(),e=Hh(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htMiddle";this.runHooks("beforeCellAlignment",e,t,n,i),yc(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1},{key:`${vs}:bottom`,name(){return this.getTranslatedPhrase(HN)},callback(){const t=this.getSelectedRange(),e=Hh(t,(r,o)=>this.getCellMeta(r,o).className),n="vertical",i="htBottom";this.runHooks("beforeCellAlignment",e,t,n,i),yc(t,n,i,(r,o)=>this.getCellMeta(r,o),(r,o,a,u)=>this.setCellMeta(r,o,a,u)),this.render()},disabled:!1}]}}}const kR="clear_column";function SSe(){return{key:kR,name(){return this.getTranslatedPhrase(cN)},callback(t,e){const n=e[0].start.col,i=e[0].end.col;this.countRows()&&this.populateFromArray(0,n,[[null]],Math.max(e[0].start.row,e[0].end.row),i,"ContextMenu.clearColumn")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0||!this.selection.isSelectedByColumnHeader())return!0;let e=!1;return t.forAll((n,i)=>{if(n<0||i<0)return!0;const{readOnly:r}=this.getCellMeta(n,i);return r?!0:(e=!0,!1)}),!e}}}const Xw="col_left";function bSe(){return{key:Xw,name(){return this.getTranslatedPhrase(rN)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner(),e=this.isRtl()?"insert_col_end":"insert_col_start";this.alter(e,t.col,1,"ContextMenu.columnLeft")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols?!0:this.selection.isSelectedByCorner()?this.countCols()===0:!1},hidden(){return!this.getSettings().allowInsertColumn}}}const Zw="col_right";function CSe(){return{key:Zw,name(){return this.getTranslatedPhrase(oN)},callback(){const t=this.getSelectedRangeActive().getTopRightCorner(),e=this.isRtl()?"insert_col_start":"insert_col_end";this.alter(e,t.col,1,"ContextMenu.columnRight")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByRowHeader()||t.isSingleHeader()&&t.highlight.col<0||this.countSourceCols()>=this.getSettings().maxCols)},hidden(){return!this.getSettings().allowInsertColumn}}}const Qw="make_read_only";function RSe(){return{key:Qw,checkable:!0,ariaChecked(){return CC(this.getSelectedRange(),(e,n)=>this.getCellMeta(e,n).readOnly)},ariaLabel(){return this.getTranslatedPhrase(e0)},name(){let t=this.getTranslatedPhrase(e0);return CC(this.getSelectedRange(),(n,i)=>this.getCellMeta(n,i).readOnly)&&(t=ZK(t)),t},callback(){const t=this.getSelectedRange(),e=CC(t,(n,i)=>this.getCellMeta(n,i).readOnly);U(t,n=>{n.forAll((i,r)=>{i>=0&&r>=0&&this.setCellMeta(i,r,"readOnly",!e)})}),this.render()},disabled(){const t=this.getSelectedRangeActive();return!!(!t||t.isSingleHeader()||this.selection.isSelectedByCorner()||this.countRows()===0||this.countCols()===0||!this.getSelectedRange()||this.getSelectedRange().length===0)}}}const $R="redo";function ESe(){return{key:$R,name(){return this.getTranslatedPhrase(uN)},callback(){this.getPlugin("undoRedo").redo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isRedoAvailable()}}}const Jw="remove_col";function TSe(){return{key:Jw,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[,n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(aN,e)},callback(){this.alter("remove_col",gde(this),null,"ContextMenu.removeColumn")},disabled(){if(!this.isColumnModificationAllowed())return!0;const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.col<0)return!0;const e=this.countCols();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByRowHeader()||e===0},hidden(){return!this.getSettings().allowRemoveColumn}}}const VR="remove_row";function _Se(){return{key:VR,name(){const t=this.getSelected();let e=0;if(t)if(t.length>1)e=1;else{const[n,,i]=t[0];n-i!==0&&(e=1)}return this.getTranslatedPhrase(sN,e)},callback(){this.alter("remove_row",mde(this),1,"ContextMenu.removeRow")},disabled(){const t=this.getSelectedRangeActive();if(!t||t.isSingleHeader()&&t.highlight.row<0)return!0;const e=this.countRows();return this.selection.isSelectedByCorner()?e===0:this.selection.isSelectedByColumnHeader()||e===0},hidden(){return!this.getSettings().allowRemoveRow}}}const BR="row_above";function MSe(){return{key:BR,name(){return this.getTranslatedPhrase(nN)},callback(){const t=this.getSelectedRangeActive().getTopLeftCorner();this.alter("insert_row_above",t.row,1,"ContextMenu.rowAbove")},disabled(){const t=this.getSelectedRangeActive();return!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows?!0:this.selection.isSelectedByCorner()?this.countRows()===0:!1},hidden(){return!this.getSettings().allowInsertRow}}}const FR="row_below";function ASe(){return{key:FR,name(){return this.getTranslatedPhrase(iN)},callback(){const t=this.getSelectedRangeActive().getBottomRightCorner();this.alter("insert_row_below",t.row,1,"ContextMenu.rowBelow")},disabled(){const t=this.getSelectedRangeActive();return!!(!t||this.selection.isSelectedByColumnHeader()||t.isSingleHeader()&&t.highlight.row<0||this.countSourceRows()>=this.getSettings().maxRows)},hidden(){return!this.getSettings().allowInsertRow}}}const yw="no_items";function OSe(){return{key:yw,name(){return this.getTranslatedPhrase(tN)},disabled:!0,isCommand:!1}}const WR="undo";function xSe(){return{key:WR,name(){return this.getTranslatedPhrase(lN)},callback(){this.getPlugin("undoRedo").undo()},hidden(){const t=this.getPlugin("undoRedo");return!t||!t.isEnabled()},disabled(){return!this.getPlugin("undoRedo").isUndoAvailable()}}}const HSe=[BR,FR,Xw,Zw,kR,VR,Jw,WR,$R,Qw,vs,vt,yw],ISe={[vt]:wSe,[yw]:OSe,[BR]:MSe,[FR]:ASe,[Xw]:bSe,[Zw]:CSe,[kR]:SSe,[VR]:_Se,[Jw]:TSe,[WR]:xSe,[$R]:ESe,[Qw]:RSe,[vs]:ySe};function QK(){const t={};return wt(ISe,(e,n)=>{t[n]=e()}),t}function PSe(t){return{key:"commentsAddEdit",name(){var e;const n=(e=this.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n!=null&&n.isCell()&&t.getCommentAtCell(n.row,n.col)?this.getTranslatedPhrase(bN):this.getTranslatedPhrase(SN)},callback(){const e=this.getSelectedRangeActive();t.setRange(e),t.show(),t.focusEditor()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function NSe(t){return{key:"commentsRemove",name(){return this.getTranslatedPhrase(CN)},callback(){this.getSelectedRangeActive().forAll((n,i)=>{n>=0&&i>=0&&t.removeCommentAtCell(n,i,!1)}),this.render()},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function DSe(t){return{key:"commentsReadOnly",name(){const e=this.getTranslatedPhrase(RN);return CC(this.getSelectedRange(),(i,r)=>t.getCommentMeta(i,r,RC))?ZK(e):e},callback(){this.getSelectedRangeActive().forAll((n,i)=>{if(n>=0&&i>=0){const r=!!t.getCommentMeta(n,i,RC);t.updateCommentMeta(n,i,{[RC]:!r})}})},disabled(){const e=this.getSelectedRangeActive();return!!(!e||e.highlight.isHeader()||!t.getCommentAtCell(e.highlight.row,e.highlight.col)||this.selection.isEntireRowSelected()&&this.selection.isEntireColumnSelected()||this.countRenderedRows()===0||this.countRenderedCols()===0)}}}function LSe(t,e){JK(t,e),e.add(t)}function Ih(t,e,n){JK(t,e),e.set(t,n)}function JK(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kSe(t,e,n){return(e=$Se(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $Se(t){var e=VSe(t,"string");return typeof e=="symbol"?e:e+""}function VSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Za(t,e,n){return t.set(ki(t,e),n),n}function ft(t,e){return t.get(ki(t,e))}function ki(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const v0="comments",BSe=60,ql="comment",Ov="value",e8="style",RC="readOnly",Qp=v0,nI=`plugin:${v0}`;var gn=new WeakMap,za=new WeakMap,jR=new WeakMap,EC=new WeakMap,w0=new WeakMap,iI=new WeakMap,y0=new WeakMap,qi=new WeakSet;class FSe extends Dt{constructor(){super(...arguments),LSe(this,qi),kSe(this,"range",{}),Ih(this,gn,null),Ih(this,za,null),Ih(this,jR,!1),Ih(this,EC,!1),Ih(this,w0,!1),Ih(this,iI,null),Ih(this,y0,"")}static get PLUGIN_KEY(){return v0}static get PLUGIN_PRIORITY(){return BSe}static get DEFAULT_SETTINGS(){return{displayDelay:250}}isEnabled(){return!!this.hot.getSettings()[v0]}enablePlugin(){var e=this;this.enabled||(ft(gn,this)||(Za(gn,this,new fd(this.hot.rootDocument,this.hot.isRtl(),this.hot.rootPortalElement)),ft(gn,this).addLocalHook("resize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ki(qi,e,KSe).call(e,...i)}),this.hot.addHook("afterSetTheme",(n,i)=>{i||this.hide()})),ft(za,this)||Za(za,this,new XK(this.getSetting("displayDelay"))),this.addHook("afterContextMenuDefaultOptions",n=>this.addToContextMenu(n)),this.addHook("afterRenderer",(n,i,r,o,a,u)=>ki(qi,this,YSe).call(this,n,u)),this.addHook("afterScroll",()=>ki(qi,this,XSe).call(this)),this.addHook("afterBeginEditing",()=>this.hide()),this.addHook("afterDocumentKeyDown",n=>ki(qi,this,UY).call(this,n)),this.addHook("beforeCompositionStart",n=>ki(qi,this,UY).call(this,n)),ft(za,this).addLocalHook("hide",()=>this.hide()),ft(za,this).addLocalHook("show",(n,i)=>this.showAtCell(n,i)),this.registerShortcuts(),this.registerListeners(),super.enablePlugin())}updatePlugin(){ft(za,this).updateDelay(this.getSetting("displayDelay")),super.updatePlugin()}disablePlugin(){this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager(),n=e.getContext("grid"),i=e.addContext(nI);n.addShortcut({keys:[["Control","Alt","M"]],callback:()=>{const r=this.hot.getSelectedRangeActive();Za(EC,this,!0),this.hot.scrollToFocusedCell(()=>{this.setRange(r),this.show(),this.focusEditor(),e.setActiveContextName(nI),this.hot._registerTimeout(()=>{Za(EC,this,!1)})})},stopPropagation:!0,runOnlyIf:()=>{var r;return(r=this.hot.getSelectedRangeActive())===null||r===void 0?void 0:r.highlight.isCell()},group:Qp}),i.addShortcut({keys:[["Escape"]],callback:()=>{ft(gn,this).setValue(ft(y0,this)),this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>ft(gn,this).isVisible()&&ft(gn,this).isFocused(),group:Qp}),i.addShortcut({keys:[["Control/Meta","Enter"]],callback:()=>{this.hide(),e.setActiveContextName("grid")},runOnlyIf:()=>ft(gn,this).isVisible()&&ft(gn,this).isFocused(),group:Qp}),i.addShortcut({keys:[["Shift","Tab"],["Tab"]],forwardToContext:e.getContext("grid"),callback:()=>{Za(w0,this,!0),ft(gn,this).setValue(ft(gn,this).getValue()),this.setComment(),this.hide(),e.setActiveContextName("grid")},group:Qp})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(Qp)}registerListeners(){const{rootDocument:e}=this.hot,n=this.getEditorInputElement();this.eventManager.addEventListener(e,"mouseover",i=>ki(qi,this,zSe).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>ki(qi,this,WSe).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>ki(qi,this,USe).call(this)),this.eventManager.addEventListener(n,"focus",()=>ki(qi,this,qSe).call(this)),this.eventManager.addEventListener(n,"blur",()=>ki(qi,this,GSe).call(this)),this.eventManager.addEventListener(this.getEditorInputElement(),"mousedown",i=>ki(qi,this,jSe).call(this,i))}setRange(e){this.range=e}clearRange(){this.range={}}targetIsCellWithComment(e){const n=Ed(e.target,"TD","TBODY");return!!(n&&Xe(n,"htCommentCell")&&Ed(n,[this.hot.rootElement]))}targetIsCommentTextArea(e){return this.getEditorInputElement()===e.target}setComment(e){if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const n=ft(gn,this).getValue();let i="";e!=null?i=e:n!=null&&(i=n);const{row:r,col:o}=ki(qi,this,bg).call(this);this.updateCommentMeta(r,o,{[Ov]:i}),this.hot.render()}setCommentAtCell(e,n,i){this.setRange({from:this.hot._createCellCoords(e,n)}),this.setComment(i)}removeComment(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:i}=ki(qi,this,bg).call(this);this.hot.setCellMeta(n,i,ql),e&&this.hot.render(),this.hide()}removeCommentAtCell(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;this.setRange({from:this.hot._createCellCoords(e,n)}),this.removeComment(i)}getComment(){const{row:e,col:n}=ki(qi,this,bg).call(this);return this.getCommentMeta(e,n,Ov)}getCommentAtCell(e,n){return this.getCommentMeta(e,n,Ov)}show(){var e;if(!this.range.from)throw new Error('Before using this method, first set cell range (hot.getPlugin("comment").setRange())');const{row:n,col:i}=ki(qi,this,bg).call(this);if(n<0||n>this.hot.countSourceRows()-1||i<0||i>this.hot.countSourceCols()-1)return!1;const r=this.hot.getCellMeta(n,i);return ft(za,this).cancelHiding(),ft(gn,this).setValue((e=r[ql]?r[ql][Ov]:null)!==null&&e!==void 0?e:""),ft(gn,this).show(),this.refreshEditor(!0),!0}showAtCell(e,n){return this.setRange({from:this.hot._createCellCoords(e,n)}),this.show()}hide(){ft(gn,this).hide()}refreshEditor(){if(!(arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1)&&(!this.range.from||!ft(gn,this).isVisible()))return;const{rowIndexMapper:n,columnIndexMapper:i}=this.hot,{row:r,col:o}=ki(qi,this,bg).call(this);let a=n.getRenderableFromVisualIndex(r),u=i.getRenderableFromVisualIndex(o);const h=a===null;ft(gn,this).setPosition(0,0),a===null&&(a=n.getRenderableFromVisualIndex(n.getNearestNotHiddenIndex(r,-1))),u===null&&(u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(o,-1)));const d=a===null,g=u===null;a=a??0,u=u??0;const{rootWindow:m,view:{_wt:v}}=this.hot,{wtTable:y}=v,b=v.getCell({row:a,col:u},!0),C=this.getCommentMeta(r,o,e8);C?ft(gn,this).setSize(C.width,C.height):ft(gn,this).resetSize();const T=g?0:y.getColumnWidth(u),O=h&&!d?Ti(b):0,{left:A,top:N,width:x,height:$}=b.getBoundingClientRect(),{width:L,height:P}=ft(gn,this).getSize(),{innerWidth:Q,innerHeight:ue}=this.hot.rootWindow,X=this.hot.rootDocument.documentElement,me=_i(this.hot.rootDocument),re=A4(this.hot.rootWindow)?me:0,Se=O4(this.hot.rootWindow)?me:0;let we=A+m.scrollX+T,_e=N+m.scrollY+O;this.hot.isRtl()&&(we-=L+T),this.hot.isLtr()&&A+x+L>Q-re?we=A+m.scrollX-L-1:this.hot.isRtl()&&we<-(X.scrollWidth-X.clientWidth)&&(we=A+m.scrollX+T+1),N+P>ue-Se&&(_e-=P-$+1),ft(gn,this).setPosition(we,_e),ft(gn,this).setReadOnlyState(this.getCommentMeta(r,o,RC)),ft(gn,this).observeSize()}focusEditor(){ft(gn,this).focus()}updateCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n)[ql];let o;r?(o=Nr(r),mR(o,i)):o=i,this.hot.setCellMeta(e,n,ql,o)}getCommentMeta(e,n,i){const r=this.hot.getCellMeta(e,n);if(r[ql])return r[ql][i]}addToContextMenu(e){e.items.push({name:vt},PSe(this),NSe(this),DSe(this))}getEditorInputElement(){return ft(gn,this).getInputElement()}destroy(){var e,n;(e=ft(gn,this))===null||e===void 0||e.destroy(),(n=ft(za,this))===null||n===void 0||n.destroy(),super.destroy()}}function WSe(t){if(!(!this.hot.view||!this.hot.view._wt)&&!ft(jR,this)&&!this.targetIsCommentTextArea(t)){const e=Ed(t.target,"TD","TBODY");let n=null;e&&(n=this.hot.getCoords(e)),(!e||this.range.from&&n&&(this.range.from.row!==n.row||this.range.from.col!==n.col))&&this.hide()}}function jSe(t){t.stopPropagation()}function zSe(t){const{rootDocument:e}=this.hot;if(!(ft(jR,this)||ft(gn,this).isFocused()||Xe(t.target,"wtBorder")||ft(iI,this)===t.target||!ft(gn,this)))if(Za(iI,this,e.elementFromPoint(t.clientX,t.clientY)),this.targetIsCellWithComment(t)){const n=this.hot._createCellRange(this.hot.getCoords(t.target));ft(za,this).show(n)}else bd(t.target,e)&&!this.targetIsCommentTextArea(t)&&ft(za,this).hide()}function USe(){Za(jR,this,!1)}function YSe(t,e){e[ql]&&e[ql][Ov]&&fe(t,e.commentedCellClassName)}function GSe(){if(ft(w0,this)){Za(w0,this,!1);return}Za(y0,this,""),this.hot.getShortcutManager().setActiveContextName("grid"),this.setComment()}function qSe(){Za(y0,this,this.getComment()),this.hot.listen(),this.hot.getShortcutManager().setActiveContextName(nI)}function KSe(t,e){const{row:n,col:i}=ki(qi,this,bg).call(this);this.updateCommentMeta(n,i,{[e8]:{width:t,height:e}})}function UY(t){ft(gn,this).isFocused()&&ma(t)}function XSe(){ft(EC,this)||this.hide()}function bg(){return this.range instanceof bm?this.range.highlight:this.hot._createCellCoords(this.range.from.row,this.range.from.col)}function yO(t,e,n){return(e=ZSe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ZSe(t){var e=QSe(t,"string");return typeof e=="symbol"?e:e+""}function QSe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class t8{constructor(e){yO(this,"hot",void 0),yO(this,"commands",{}),yO(this,"commonCallback",null),this.hot=e}registerCommand(e,n){this.commands[e]=n}setCommonCallback(e){this.commonCallback=e}execute(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];const o=e.split(":"),a=o[0],u=o.length===2?o[1]:null;let h=this.commands[a];if(!h)throw new Error(`Menu command '${a}' not exists.`);if(u&&h.submenu&&(h=JSe(u,h.submenu.items)),h.disabled===!0||typeof h.disabled=="function"&&h.disabled.call(this.hot)===!0||ti(h,"submenu"))return;const d=[];typeof h.callback=="function"&&d.push(h.callback),typeof this.commonCallback=="function"&&d.push(this.commonCallback),i.unshift(o.join(":")),U(d,g=>g.apply(this.hot,i))}}function JSe(t,e){let n;return U(e,i=>{const r=i.key?i.key.split(":"):null;if(Array.isArray(r)&&r[1]===t)return n=i,!1}),n}function SO(t,e,n){return(e=ebe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ebe(t){var e=tbe(t,"string");return typeof e=="symbol"?e:e+""}function tbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n8{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:null;SO(this,"hot",void 0),SO(this,"predefinedItems",QK()),SO(this,"defaultOrderPattern",void 0),this.hot=e,this.defaultOrderPattern=n}setPredefinedItems(e){const n={};this.defaultOrderPattern.length=0,wt(e,(i,r)=>{let o="";i.name===vt?(n[vt]=i,o=vt):isNaN(parseInt(r,10))?(i.key=i.key===void 0?r:i.key,n[r]=i,o=i.key):(n[i.key]=i,o=i.key),this.defaultOrderPattern.push(o)}),this.predefinedItems=n}getItems(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;return nbe(e,this.defaultOrderPattern,this.predefinedItems)}}function nbe(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};const i=[];let r=t;return r&&r.items?r=r.items:Array.isArray(r)||(r=e),Qe(r)?wt(r,(o,a)=>{let u=n[typeof o=="string"?o:a];u||(u=o),Qe(o)?Mi(u,o):typeof u=="string"&&(u={name:u}),u.key===void 0&&(u.key=a),i.push(u)}):U(r,(o,a)=>{let u=n[o];!u&&HSe.indexOf(o)>=0||(u||(u={name:o,key:`${a}`}),Qe(o)&&Mi(u,o),u.key===void 0&&(u.key=a),i.push(u))}),i}function ic(t,e,n){return(e=ibe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ibe(t){var e=rbe(t,"string");return typeof e=="symbol"?e:e+""}function rbe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class obe{constructor(e,n){ic(this,"top",void 0),ic(this,"topRelative",void 0),ic(this,"left",void 0),ic(this,"leftRelative",void 0),ic(this,"scrollTop",void 0),ic(this,"scrollLeft",void 0),ic(this,"cellHeight",void 0),ic(this,"cellWidth",void 0);const i=n.scrollY,r=n.scrollX;let o,a,u,h,d,g;this.rootWindow=n,this.type=this.getSourceType(e),this.type==="literal"?(o=parseInt(e.top,10),u=parseInt(e.left,10),d=e.height||0,g=e.width||0,a=o,h=u,o+=i,u+=r):this.type==="event"&&(o=parseInt(e.pageY,10),u=parseInt(e.pageX,10),d=e.target.clientHeight,g=e.target.clientWidth,a=o-i,h=u-r),this.top=o,this.topRelative=a,this.left=u,this.leftRelative=h,this.scrollTop=i,this.scrollLeft=r,this.cellHeight=d,this.cellWidth=g}getSourceType(e){let n="literal";return e instanceof Event&&(n="event"),n}fitsAbove(e){return this.topRelative>=e.offsetHeight}fitsBelow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.innerHeight;return this.topRelative+e.offsetHeight<=n}fitsOnRight(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.rootWindow.document.documentElement.clientWidth;return this.leftRelative+this.cellWidth+e.offsetWidth<=n}fitsOnLeft(e){return this.leftRelative>=e.offsetWidth}}function Jp(t,e,n){sbe(t,e),e.set(t,n)}function sbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function at(t,e){return t.get(i8(t,e))}function hb(t,e,n){return t.set(i8(t,e),n),n}function i8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Cr=new WeakMap,Xr=new WeakMap,Zr=new WeakMap,bO=new WeakMap,Yf=new WeakMap;class abe{constructor(e){Jp(this,Cr,void 0),Jp(this,Xr,void 0),Jp(this,Zr,void 0),Jp(this,bO,!1),Jp(this,Yf,{above:0,below:0,left:0,right:0}),hb(bO,this,e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return at(Yf,this)[e]=n,this}setElement(e){return hb(Cr,this,e),this}setParentElement(e){return hb(Xr,this,e),this}updatePosition(e){hb(Zr,this,new obe(e,at(Cr,this).ownerDocument.defaultView)),at(bO,this)?(at(Zr,this).fitsBelow(at(Cr,this))?this.setPositionBelowCursor():at(Zr,this).fitsAbove(at(Cr,this))?this.setPositionAboveCursor():this.setPositionBelowCursor(),this.updateHorizontalPosition()):(this.setPositionBelowCursor(),this.setPositionOnRightOfCursor())}updateHorizontalPosition(){at(Cr,this).dir==="rtl"?at(Zr,this).fitsOnLeft(at(Cr,this))?this.setPositionOnLeftOfCursor():this.setPositionOnRightOfCursor():at(Zr,this).fitsOnRight(at(Cr,this))?this.setPositionOnRightOfCursor():this.setPositionOnLeftOfCursor()}setPositionAboveCursor(){let e=at(Yf,this).above+at(Zr,this).top-at(Cr,this).offsetHeight;if(at(Xr,this)){const i=at(Xr,this).ownerDocument.defaultView.getComputedStyle(at(Xr,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=at(Zr,this).top+at(Zr,this).cellHeight-at(Cr,this).scrollHeight+r+o}at(Cr,this).style.top=`${e}px`}setPositionBelowCursor(){let e=at(Yf,this).below+at(Zr,this).top+1;if(at(Xr,this)){const i=at(Xr,this).ownerDocument.defaultView.getComputedStyle(at(Xr,this).querySelector(".ht_master")),r=Number.parseInt(i.paddingTop,10),o=Number.parseInt(i.borderTop,10);e=at(Zr,this).top-r-o}at(Cr,this).style.top=`${e}px`}setPositionOnRightOfCursor(){let e=at(Zr,this).left;if(at(Xr,this)){const n=at(Xr,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(at(Xr,this).querySelector(".htCore")).borderRightWidth,10);e+=at(Zr,this).cellWidth+i}else e+=at(Yf,this).right;at(Cr,this).style.left=`${e}px`}setPositionOnLeftOfCursor(){let e=at(Yf,this).left+at(Zr,this).left-at(Cr,this).offsetWidth;if(at(Xr,this)){const n=at(Xr,this).ownerDocument.defaultView,i=Number.parseInt(n.getComputedStyle(at(Xr,this).querySelector(".htCore")).borderLeftWidth,10);e-=i}at(Cr,this).style.left=`${e}px`}}function uL(t){let{initialPage:e=-1,size:n=()=>0,onItemSelect:i=()=>{},onClear:r=()=>{}}=t;const o=new Set;let a=St(e,-1,C()-1);function u(O,A){const N=C()-1;return O<0&&(O=N),O>N&&(O=0),o.has(O)?-1:(o.add(O),i(O,!1)===!1&&(O=u(A===1?++O:--O,A)),O)}function h(O){O>-1&&O<C()&&i(O,!0)!==!1&&(a=O)}function d(O){O>-1&&O<C()&&(a=O)}function g(){return a}function m(){C()>0&&(o.clear(),a=u(0,1))}function v(){C()>0&&(o.clear(),a=u(C()-1,-1))}function y(){C()>0&&(o.clear(),a=u(++a,1))}function b(){C()>0&&(o.clear(),a=u(--a,-1))}function C(){return Math.max(n(),0)}function T(){o.clear(),a=e,r()}return{setCurrentPage:h,setPageCursorAt:d,getCurrentPage:g,toFirstItem:m,toLastItem:v,toNextItem:y,toPreviousItem:b,getSize:C,clear:T}}function lbe(t){return Vt(t,e=>({start:e.getTopStartCorner(),end:e.getBottomEndCorner()}))}function rI(t){return ti(t,"submenu")}function oI(t){return new RegExp(vt,"i").test(t.name)}function TC(t,e){return t.disabled===!0||typeof t.disabled=="function"&&t.disabled.call(e)===!0}function YY(t){return ti(t,"disableSelection")}function ube(t){return Xe(t,"htSeparator")}function cbe(t){return Xe(t,"htSubmenu")}function hbe(t){return Xe(t,"htDisabled")}function dbe(t){return Xe(t,"htSelectionDisabled")}function fbe(t,e){return!t.hidden||!(typeof t.hidden=="function"&&t.hidden.call(e))}function r8(t,e){const n=t.slice(0);for(let i=0;i<n.length&&n[i].name===e;)n.shift();return n}function gbe(t,e){let n=t.slice(0);return n.reverse(),n=r8(n,e),n.reverse(),n}function mbe(t){const e=[];return U(t,(n,i)=>{i>0?e[e.length-1].name!==n.name&&e.push(n):e.push(n)}),e}function pbe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:vt,n=t.slice(0);return n=r8(n,e),n=gbe(n,e),n=mbe(n),n}function vbe(t){return t.checkable===!0}function wbe(t){return uL({size:()=>t.countRows(),onItemSelect(e,n){const i=t.getCell(e,0);if(!i||ube(i)||hbe(i)||dbe(i))return!1;t.selectCell(e,0,...n?[e,0,!1,!1]:[])},onClear(){t.deselectCell()}})}function ybe(t){const{hot:e,hotMenu:n}=t;return[{keys:[["Control/Meta","A"]],forwardToContext:e.getShortcutManager().getContext("grid"),callback:()=>t.close(!0)},{keys:[["Tab"],["Shift","Tab"]],callback:(i,r)=>{const o=e.getSettings(),a=typeof o.tabMoves=="function"?o.tabMoves(i):o.tabMoves;r.includes("shift")?e.selection.transformStart(-a.row,-a.col):e.selection.transformStart(a.row,a.col),t.close(!0)}},{keys:[["Escape"]],callback:()=>t.close()},{keys:[["ArrowDown"]],callback:()=>t.getNavigator().toNextItem()},{keys:[["ArrowUp"]],callback:()=>t.getNavigator().toPreviousItem()},{keys:[[e.isRtl()?"ArrowLeft":"ArrowRight"]],callback:()=>{const i=n.getSelectedActive();if(i){const r=t.openSubMenu(i[0]);r&&r.getNavigator().toFirstItem()}}},{keys:[[e.isRtl()?"ArrowRight":"ArrowLeft"]],callback:()=>{n.getSelectedActive()&&t.isSubMenu()&&(t.close(),t.isSubMenu()&&t.parentMenu.hotMenu.listen())}},{keys:[["Control/Meta","ArrowUp"],["Home"]],callback:()=>t.getNavigator().toFirstItem()},{keys:[["Control/Meta","ArrowDown"],["End"]],callback:()=>t.getNavigator().toLastItem()},{keys:[["Enter"],["Space"]],callback:i=>{const r=n.getSelectedActive();r&&(n.getSourceDataAtRow(r[0]).submenu?t.openSubMenu(r[0]).getNavigator().toFirstItem():(t.executeCommand(i),t.close(!0)))}},{keys:[["PageUp"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(-n.countVisibleRows(),0):t.getNavigator().toFirstItem()}},{keys:[["PageDown"]],callback:()=>{n.getSelectedActive()?n.selection.transformStart(n.countVisibleRows(),0):t.getNavigator().toLastItem()}}]}const o8="menu",GY=o8;function Sbe(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const n=[];i(ybe(t)),e.forEach(d=>{let{shortcuts:g,contextName:m}=d;r(g,m)});function i(d,g){u(g).addShortcuts(d,{group:o8})}function r(d,g){const m=u(g);d.forEach(v=>{let{keys:y}=v;y.forEach(b=>m.removeShortcutsByKeys(b))}),n.push({shortcuts:d,contextName:g}),i(d,g)}function o(){return[...n]}function a(d){return d?`${GY}:${d}`:GY}function u(d){var g;const m=t.hotMenu.getShortcutManager(),v=a(d);return(g=m.getContext(v))!==null&&g!==void 0?g:m.addContext(v)}function h(d){t.hotMenu.getShortcutManager().setActiveContextName(a(d))}return{addCustomShortcuts:r,getCustomShortcuts:o,getContext:u,listen:h}}function bbe(t){return(e,n,i,r,o,a)=>{const u=e.getSourceDataAtRow(i),h=t.rootDocument.createElement("div"),d=typeof a=="function"?a.call(t):a,g=typeof u.ariaLabel=="function"?u.ariaLabel.call(t):u.ariaLabel,m=typeof u.ariaChecked=="function"?u.ariaChecked.call(t):u.ariaChecked;if(du(n),fe(h,"htItemWrapper"),t.getSettings().ariaTags){const v=!TC(u,t)&&!YY(u)&&!oI(u);We(n,[...vbe(u)?[ise(),Bo(g),p4(m)]:[nse(),Bo(d)],...v?[lo(-1)]:[],...TC(u,t)?[Ev()]:[],...rI(u)?[Ts(!1)]:[]])}n.className="",n.appendChild(h),oI(u)?fe(n,"htSeparator"):typeof u.renderer=="function"?(fe(n,"htCustomMenuRenderer"),n.appendChild(u.renderer(e,h,i,r,o,d))):Fd(h,d),TC(u,t)?fe(n,"htDisabled"):YY(u)?fe(n,"htSelectionDisabled"):rI(u)&&fe(n,"htSubmenu")}}function CO(t,e,n){Cbe(t,e),e.set(t,n)}function Cbe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Oa(t,e,n){return(e=Rbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Rbe(t){var e=Ebe(t,"string");return typeof e=="symbol"?e:e+""}function Ebe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function RO(t,e,n){return t.set(s8(t,e),n),n}function rc(t,e){return t.get(s8(t,e))}function s8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const qY=215;var Gf=new WeakMap,db=new WeakMap,fb=new WeakMap;class _m{get tableBorderWidth(){return rc(fb,this)===void 0&&this.hotMenu&&RO(fb,this,parseInt(this.hotMenu.rootWindow.getComputedStyle(this.hotMenu.view._wt.wtTable.TABLE).borderWidth,10)),rc(fb,this)}constructor(e,n){var i=this;Oa(this,"hot",void 0),Oa(this,"options",void 0),Oa(this,"eventManager",new da(this)),Oa(this,"container",void 0),Oa(this,"positioner",void 0),Oa(this,"hotMenu",null),Oa(this,"hotSubMenus",{}),Oa(this,"parentMenu",void 0),Oa(this,"menuItems",null),Oa(this,"origOutsideClickDeselects",null),CO(this,Gf,void 0),CO(this,db,void 0),CO(this,fb,void 0),this.hot=e,this.options=n||{parent:null,name:null,className:"",keepInViewport:!0,standalone:!1,minWidth:qY,container:this.hot.rootPortalElement},this.container=this.createContainer(this.options.name),this.positioner=new abe(this.options.keepInViewport),this.parentMenu=this.options.parent||null,this.registerEvents(),this.isSubMenu()&&this.addLocalHook("afterSelectionChange",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return i.parentMenu.runLocalHooks("afterSelectionChange",...o)}),this.hot.addHook("afterSetTheme",(r,o)=>{this.options.container!==this.hot.rootPortalElement&&(Ve(this.options.container,/ht-theme-.*/g),fe(this.options.container,r)),o||this.close()})}registerEvents(){let e=this.hot.rootWindow;for(;e;)this.eventManager.addEventListener(e.document,"mousedown",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"touchstart",n=>this.onDocumentMouseDown(n)),this.eventManager.addEventListener(e.document,"contextmenu",n=>this.onDocumentContextMenu(n)),e=Zg(e)}setMenuItems(e){this.menuItems=e}getNavigator(){return rc(Gf,this)}getKeyboardShortcutsCtrl(){return rc(db,this)}getSelectedItem(){return this.hasSelectedItem()?this.hotMenu.getSourceDataAtRow(this.hotMenu.getSelectedActive()[0]):null}hasSelectedItem(){return Array.isArray(this.hotMenu.getSelectedActive())}isSubMenu(){return this.parentMenu!==null}open(){this.runLocalHooks("beforeOpen"),this.container.removeAttribute("style"),this.container.style.display="block";const e=SR(u=>this.openSubMenu(u),300),n=this.options.minWidth||qY;let i=!1,r=Rd(this.menuItems,u=>(u.key===yw&&(i=!0),fbe(u,this.hot)));if(r.length<1&&!i)r.push(QK()[yw]);else if(r.length===0)return;r=pbe(r,vt);let o=!1;const a={data:r,colHeaders:!1,autoColumnSize:!0,autoWrapRow:!1,modifyColWidth(u){return Ne(u)&&u<n?n:u},autoRowSize:!1,readOnly:!0,editor:!1,copyPaste:!1,hiddenRows:!0,maxCols:1,columns:[{data:"name",renderer:bbe(this.hot)}],renderAllRows:!0,fragmentSelection:!1,outsideClickDeselects:!1,disableVisualSelection:"area",layoutDirection:this.hot.isRtl()?"rtl":"ltr",ariaTags:!1,themeName:this.hot.getCurrentThemeName(),beforeRefreshDimensions:()=>!1,beforeOnCellMouseOver:(u,h)=>{this.hotMenu.stylesHandler.isClassicTheme()?rc(Gf,this).setCurrentPage(h.row):rc(Gf,this).setPageCursorAt(h.row)},afterOnCellMouseOver:(u,h)=>{this.isAllSubMenusClosed()?e(h.row):this.openSubMenu(h.row)},afterOnCellContextMenu:u=>{u.preventDefault(),PH()&&o&&this.hasSelectedItem()&&this.close(!0)},afterSelection:(u,h,d,g,m)=>{this.hotMenu.view.isMouseDown()&&(m.value=!0),this.runLocalHooks("afterSelectionChange",this.getSelectedItem())},beforeOnCellMouseUp:u=>{this.hasSelectedItem()&&(o=!this.isCommandPassive(this.getSelectedItem()),this.executeCommand(u))},afterOnCellMouseUp:u=>{(!PH()||!_d(u))&&o&&this.hasSelectedItem()&&(el()||S4()?this.hot._registerTimeout(()=>this.close(!0),325):this.close(!0))},afterUnlisten:()=>{!this.hasSelectedItem()&&this.isOpened()&&this.hotMenu.listen()}};this.origOutsideClickDeselects=this.hot.getSettings().outsideClickDeselects,this.hot.getSettings().outsideClickDeselects=!1,this.hotMenu=new this.hot.constructor(this.container,a),this.hotMenu.addHook("afterInit",()=>this.onAfterInit()),this.hotMenu.init(),RO(Gf,this,wbe(this.hotMenu)),RO(db,this,Sbe(this)),rc(db,this).listen(),this.focus(),this.isSubMenu()&&this.addLocalHook("afterOpen",()=>this.parentMenu.runLocalHooks("afterSubmenuOpen",this)),this.runLocalHooks("afterOpen",this)}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;if(this.isOpened()){if(e&&this.isSubMenu())this.parentMenu.close();else if(rc(Gf,this).clear(),this.closeAllSubMenus(),this.container.style.display="none",this.hotMenu.destroy(),this.hotMenu=null,this.hot.getSettings().outsideClickDeselects=this.origOutsideClickDeselects,this.runLocalHooks("afterClose"),this.isSubMenu()){if(this.hot.getSettings().ariaTags){const n=this.parentMenu.hotMenu.getSelectedActive();if(n){const i=this.parentMenu.hotMenu.getCell(n[0],0);We(i,[Ts(!1)])}}this.parentMenu.hotMenu.listen()}}}openSubMenu(e){if(!this.hotMenu)return!1;const n=this.hotMenu.getCell(e,0);if(this.closeAllSubMenus(),!n||!cbe(n))return!1;const i=this.hotMenu.getSourceDataAtRow(e),r=new _m(this.hot,{parent:this,name:i.name,className:this.options.className,keepInViewport:!0,container:this.options.container});return r.setMenuItems(i.submenu.items),r.open(),r.setPosition(n.getBoundingClientRect()),this.hotSubMenus[i.key]=r,this.hot.getSettings().ariaTags&&We(n,[Ts(!0)]),r}closeSubMenu(e){const n=this.hotMenu.getSourceDataAtRow(e),i=this.hotSubMenus[n.key];if(i){i.destroy(),delete this.hotSubMenus[n.key];const r=this.hotMenu.getCell(e,0);this.hot.getSettings().ariaTags&&We(r,[Ts(!1)])}}closeAllSubMenus(){U(this.hotMenu.getData(),(e,n)=>this.closeSubMenu(n))}isAllSubMenusClosed(){return Object.keys(this.hotSubMenus).length===0}focus(){this.isOpened()&&(this.hotMenu.rootElement.focus({preventScroll:!0}),this.getKeyboardShortcutsCtrl().listen(),this.hotMenu.listen())}destroy(){const e=this.container.parentNode;this.clearLocalHooks(),this.close(),this.parentMenu=null,this.eventManager.destroy(),e&&e.removeChild(this.container)}isOpened(){return this.hotMenu!==null}executeCommand(e){if(!this.isOpened()||!this.hasSelectedItem())return;const n=this.getSelectedItem();if(this.runLocalHooks("select",n,e),this.isCommandPassive(n))return;const i=this.hot.getSelectedRange(),r=i?lbe(i):[];this.runLocalHooks("executeCommand",n.key,r,e),this.isSubMenu()&&this.parentMenu.runLocalHooks("executeCommand",n.key,r,e)}isCommandPassive(e){return e.isCommand===!1||oI(e)||TC(e,this.hot)||rI(e)}setOffset(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;this.positioner.setOffset(e,n)}setPosition(e){this.isSubMenu()&&this.positioner.setParentElement(this.parentMenu.container),this.positioner.setElement(this.container).updatePosition(e)}updateMenuDimensions(){const{wtTable:e}=this.hotMenu.view._wt,n=this.hotMenu.getSettings().data,i=e.hider.style,r=e.holder.style,o=parseInt(i.width,10),a=ho(n,(u,h,d)=>{const m=this.hotMenu.getCell(d,0)?Ti(this.hotMenu.getCell(d,0)):0;return u+(h.name===vt?1:m)},0);this.hotMenu.stylesHandler.isClassicTheme()?(r.width=`${o+3}px`,r.height=`${a+3}px`):(r.width=`${o}px`,r.height=`${a}px`),i.height=r.height}createContainer(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:null;const n=this.options.container.ownerDocument;let i=e,r;return i&&(Yt(i)&&(i=i.call(this.hot),i===null||$n(i)?i="":i=i.toString()),i=i.replace(/[^A-Za-z0-9]/g,"_"),i=`${this.options.className}Sub_${i}`,r=n.querySelector(`.${this.options.className}.${i}`)),r||(r=n.createElement("div"),fe(r,`htMenu handsontable ${this.options.className}`),i&&fe(r,i),this.options.container.appendChild(r)),r}onAfterInit(){this.updateMenuDimensions(),this.hot.getSettings().ariaTags&&We(this.hotMenu.rootElement,[tse(),lo(-1)])}onDocumentMouseDown(e){this.isOpened()&&(this.options.standalone&&this.hotMenu&&!bd(e.target,this.hotMenu.rootElement)?this.close(!0):(this.isAllSubMenusClosed()||this.isSubMenu())&&!bd(e.target,".htMenu")&&this.close(!0))}onDocumentContextMenu(e){this.isOpened()&&Xe(e.target,"htCore")&&bd(e.target,this.hotMenu.rootElement)&&e.preventDefault()}}en(_m,Fi);function Tbe(t,e){_be(t,e),e.add(t)}function _be(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function EO(t,e,n){return(e=Mbe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mbe(t){var e=Abe(t,"string");return typeof e=="symbol"?e:e+""}function Abe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function gb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xv="contextMenu",Obe=70,KY=xv;He.getSingleton().register("afterContextMenuDefaultOptions");He.getSingleton().register("beforeContextMenuShow");He.getSingleton().register("afterContextMenuShow");He.getSingleton().register("afterContextMenuHide");He.getSingleton().register("afterContextMenuExecute");var ev=new WeakSet;class zR extends Dt{constructor(){super(...arguments),Tbe(this,ev),EO(this,"commandExecutor",new t8(this.hot)),EO(this,"itemsFactory",null),EO(this,"menu",null)}static get PLUGIN_KEY(){return xv}static get PLUGIN_PRIORITY(){return Obe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[BR,FR,vt,Xw,Zw,vt,VR,Jw,vt,WR,$R,vt,Qw,vt,vs]}isEnabled(){return!!this.hot.getSettings()[xv]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[xv];typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.menu=new _m(this.hot,{className:"htContextMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.menu.addLocalHook("beforeOpen",()=>gb(ev,this,Hbe).call(this)),this.menu.addLocalHook("afterOpen",()=>gb(ev,this,Ibe).call(this)),this.menu.addLocalHook("afterClose",()=>gb(ev,this,Pbe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return e.executeCommand.call(e,...r)}),this.addHook("afterOnCellContextMenu",i=>gb(ev,this,xbe).call(this,i)),this.addHook("beforeDialogShow",()=>this.close()),this.registerShortcuts(),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&(this.menu.destroy(),this.menu=null),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control/Meta","Shift","Backslash"],["Shift","F10"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();this.hot.scrollToFocusedCell();const n=this.hot.getCell(e.row,e.col,!0).getBoundingClientRect(),i=LR(this.menu.container,this.hot.rootDocument);this.open({left:n.left+i.left,top:n.top+i.top-1+n.height},{left:n.width,above:-n.height}),this.menu.getNavigator().toFirstItem()},runOnlyIf:()=>{var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n&&this.hot.selection.isCellVisible(n)&&!this.menu.isOpened()},group:KY})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(KY)}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.prepareMenuItems(),this.menu.open(),wt(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close(),this.itemsFactory=null}executeCommand(e){this.itemsFactory===null&&this.prepareMenuItems();for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}prepareMenuItems(){this.itemsFactory=new n8(this.hot,zR.DEFAULT_ITEMS);const e=this.hot.getSettings()[xv],n={items:this.itemsFactory.getItems(e)};this.hot.runHooks("afterContextMenuDefaultOptions",n),this.itemsFactory.setPredefinedItems(n.items);const i=this.itemsFactory.getItems(e);this.hot.runHooks("beforeContextMenuSetItems",i),this.menu.setMenuItems(i),U(i,r=>this.commandExecutor.registerCommand(r.key,r))}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function xbe(t){const e=this.hot.getSettings(),n=e.rowHeaders,i=e.colHeaders;function r(u){return u.nodeName==="TD"||u.parentNode.nodeName==="TD"}const o=t.target;if(this.close(),Xe(o,"handsontableInput")||(t.preventDefault(),t.stopPropagation(),!(n||i)&&!r(o)&&!(Xe(o,"current")&&Xe(o,"wtBorder"))))return;const a=LR(this.menu.container,this.hot.rootDocument);this.open({top:t.clientY+a.top,left:t.clientX+a.left})}function Hbe(){this.hot.runHooks("beforeContextMenuShow",this)}function Ibe(){this.hot.runHooks("afterContextMenuShow",this)}function Pbe(){this.hot.listen(),this.hot.runHooks("afterContextMenuHide",this)}zR.SEPARATOR={name:vt};function Nbe(t){return{key:"copy",name(){return this.getTranslatedPhrase(hN)},callback(){t.copyCellsOnly()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Dbe(t){return{key:"copy_column_headers_only",name(){const e=this.getSelectedRangeActive(),n=e?St(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(gN,n)},callback(){t.copyColumnHeadersOnly()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function Lbe(t){return{key:"copy_with_column_group_headers",name(){const e=this.getSelectedRangeActive(),n=e?St(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(fN,n)},callback(){t.copyWithAllColumnHeaders()},disabled(){if(!this.hasColHeaders()||!this.getSettings().nestedHeaders)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function kbe(t){return{key:"copy_with_column_headers",name(){const e=this.getSelectedRangeActive(),n=e?St(e.getWidth()-1,0,1):0;return this.getTranslatedPhrase(dN,n)},callback(){t.copyWithColumnHeaders()},disabled(){if(!this.hasColHeaders())return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}function $be(t){return{key:"cut",name(){return this.getTranslatedPhrase(mN)},callback(){t.cut()},disabled(){if(this.countRows()===0||this.countCols()===0)return!0;const e=this.getSelectedRangeActive();if(!e||e.isSingleHeader())return!0;const n=this.getSelected();return!n||n.length>1},hidden:!1}}class Vbe{constructor(){this.data={}}setData(e,n){this.data[e]=n}getData(e){return this.data[e]||void 0}}class Bbe{constructor(){this.clipboardData=new Vbe}preventDefault(){}composedPath(){return[]}}function Fbe(t,e){a8(t,e),e.add(t)}function qf(t,e,n){a8(t,e),e.set(t,n)}function a8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tr(t,e){return t.get(Hg(t,e))}function Kf(t,e,n){return t.set(Hg(t,e),n),n}function Hg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var oc=new WeakMap,TO=new WeakMap,tv=new WeakMap,sI=new WeakMap,aI=new WeakMap,nv=new WeakMap,iv=new WeakSet;class Wbe{constructor(e){let{countRows:n,countColumns:i,rowsLimit:r,columnsLimit:o,countColumnHeaders:a}=e;Fbe(this,iv),qf(this,oc,void 0),qf(this,TO,void 0),qf(this,tv,void 0),qf(this,sI,void 0),qf(this,aI,void 0),qf(this,nv,void 0),Kf(TO,this,n),Kf(tv,this,i),Kf(sI,this,r),Kf(aI,this,o),Kf(nv,this,a)}setSelectedRange(e){Kf(oc,this,e)}getCellsRange(){if(Tr(TO,this).call(this)===0||Tr(tv,this).call(this)===0)return null;const{row:e,col:n}=Tr(oc,this).getTopStartCorner(),{row:i,col:r}=Tr(oc,this).getBottomEndCorner(),o=Hg(iv,this,jbe).call(this,e,i),a=Hg(iv,this,_O).call(this,n,r);return{isRangeTrimmed:i!==o||r!==a,startRow:e,startCol:n,endRow:o,endCol:a}}getMostBottomColumnHeadersRange(){if(Tr(tv,this).call(this)===0||Tr(nv,this).call(this)===0)return null;const{col:e}=Tr(oc,this).getTopStartCorner(),{col:n}=Tr(oc,this).getBottomEndCorner(),i=Hg(iv,this,_O).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-1,startCol:e,endRow:-1,endCol:i}}getAllColumnHeadersRange(){if(Tr(tv,this).call(this)===0||Tr(nv,this).call(this)===0)return null;const{col:e}=Tr(oc,this).getTopStartCorner(),{col:n}=Tr(oc,this).getBottomEndCorner(),i=Hg(iv,this,_O).call(this,e,n);return{isRangeTrimmed:n!==i,startRow:-Tr(nv,this).call(this),startCol:e,endRow:-1,endCol:i}}}function _O(t,e){return Math.min(e,Math.max(t+Tr(aI,this).call(this)-1,t))}function jbe(t,e){return Math.min(e,Math.max(t+Tr(sI,this).call(this)-1,t))}function l8(t){const e=[],n=[];return U(t,i=>{const r=Math.min(i.startRow,i.endRow),o=Math.max(i.startRow,i.endRow);ze(r,o,h=>{e.indexOf(h)===-1&&e.push(h)});const a=Math.min(i.startCol,i.endCol),u=Math.max(i.startCol,i.endCol);ze(a,u,h=>{n.indexOf(h)===-1&&n.push(h)})}),{rows:e,columns:n}}function zbe(t,e){u8(t,e),e.add(t)}function sc(t,e,n){u8(t,e),e.set(t,n)}function u8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function rv(t,e,n){return(e=Ube(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ube(t){var e=Ybe(t,"string");return typeof e=="symbol"?e:e+""}function Ybe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ro(t,e){return t.get(fr(t,e))}function Ks(t,e,n){return t.set(fr(t,e),n),n}function fr(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("afterCopyLimit");He.getSingleton().register("modifyCopyableRange");He.getSingleton().register("beforeCut");He.getSingleton().register("afterCut");He.getSingleton().register("beforePaste");He.getSingleton().register("afterPaste");He.getSingleton().register("beforeCopy");He.getSingleton().register("afterCopy");const MO="copyPaste",Gbe=80,qbe=["fragmentSelection"],c8="application/ht-source-data-json-html",XY=['<meta name="generator" content="Handsontable"/>','<style type="text/css">td{white-space:normal}br{mso-data-placement:same-cell}</style>'].join("");var lI=new WeakMap,uI=new WeakMap,cI=new WeakMap,Xf=new WeakMap,mb=new WeakMap,pb=new WeakMap,Zf=new WeakMap,S0=new WeakMap,_r=new WeakSet;class Kbe extends Dt{constructor(){super(...arguments),zbe(this,_r),rv(this,"columnsLimit",1/0),rv(this,"rowsLimit",1/0),rv(this,"pasteMode","overwrite"),rv(this,"uiContainer",this.hot.rootDocument.body),sc(this,lI,!1),sc(this,uI,!1),sc(this,cI,!1),sc(this,Xf,"cells-only"),sc(this,mb,!1),sc(this,pb,!1),sc(this,Zf,new Wbe({countRows:()=>this.hot.countRows(),countColumns:()=>this.hot.countCols(),rowsLimit:()=>this.rowsLimit,columnsLimit:()=>this.columnsLimit,countColumnHeaders:()=>this.hot.view.getColumnHeadersCount()})),sc(this,S0,!1),rv(this,"copyableRanges",[])}static get PLUGIN_KEY(){return MO}static get SETTING_KEYS(){return[MO,...qbe]}static get PLUGIN_PRIORITY(){return Gbe}static get DEFAULT_SETTINGS(){return{pasteMode:"overwrite",rowsLimit:1/0,columnsLimit:1/0,copyColumnHeaders:!1,copyColumnGroupHeaders:!1,copyColumnHeadersOnly:!1}}isEnabled(){return!!this.hot.getSettings()[MO]}enablePlugin(){var e,n,i=this;this.enabled||(this.pasteMode=(e=this.getSetting("pasteMode"))!==null&&e!==void 0?e:this.pasteMode,this.rowsLimit=isNaN(this.getSetting("rowsLimit"))?this.rowsLimit:this.getSetting("rowsLimit"),this.columnsLimit=isNaN(this.getSetting("columnsLimit"))?this.columnsLimit:this.getSetting("columnsLimit"),Ks(lI,this,this.getSetting("copyColumnHeaders")),Ks(uI,this,this.getSetting("copyColumnGroupHeaders")),Ks(cI,this,this.getSetting("copyColumnHeadersOnly")),this.uiContainer=(n=this.getSetting("uiContainer"))!==null&&n!==void 0?n:this.uiContainer,this.addHook("afterContextMenuDefaultOptions",r=>fr(_r,this,Qbe).call(this,r)),this.addHook("afterSelection",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return fr(_r,i,Jbe).call(i,...o)}),this.addHook("afterSelectionEnd",()=>fr(_r,this,eCe).call(this)),this.eventManager.addEventListener(this.hot.rootDocument,"copy",function(){return i.onCopy(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"cut",function(){return i.onCut(...arguments)}),this.eventManager.addEventListener(this.hot.rootDocument,"paste",function(){return i.onPaste(...arguments)}),vR()&&(this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseenter",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return fr(_r,i,tCe).call(i,...o)}),this.eventManager.addEventListener(this.hot.rootDocument.body,"mouseleave",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return fr(_r,i,nCe).call(i,...o)}),this.addHook("afterSelection",()=>fr(_r,this,iCe).call(this))),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin()}copy(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"cells-only";Ks(Xf,this,e),Ks(mb,this,!0),fr(_r,this,ZY).call(this,"copy")}copyCellsOnly(){this.copy("cells-only")}copyColumnHeadersOnly(){this.copy("column-headers-only")}copyWithAllColumnHeaders(){this.copy("with-column-group-headers")}copyWithColumnHeaders(){this.copy("with-column-headers")}cut(){Ks(pb,this,!0),fr(_r,this,ZY).call(this,"cut")}getRangedCopyableData(e){return i0(this.getRangedData(e))}getRangedData(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=[],{rows:r,columns:o}=l8(e);return U(r,a=>{const u=[];U(o,h=>{if(a<0)u.push(this.hot.getColHeader(h,a));else{let d=n?this.hot.getCopyableSourceData(a,h):this.hot.getCopyableData(a,h);n&&Qe(d)&&(d=JSON.stringify(d)),u.push(d)}}),i.push(u)}),i}paste(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"",n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;if(!e&&!n)return;const i=new Bbe;e&&i.clipboardData.setData("text/plain",e),n&&i.clipboardData.setData("text/html",n),this.onPaste(i)}setCopyableText(){const e=this.hot.getSelectedRangeActive();if(!e)return;if(e.isSingleHeader()){this.copyableRanges=[];return}ro(Zf,this).setSelectedRange(e);const n=new Map([["headers",null],["cells",null]]);ro(Xf,this)==="column-headers-only"?n.set("headers",ro(Zf,this).getMostBottomColumnHeadersRange()):(ro(Xf,this)==="with-column-headers"?n.set("headers",ro(Zf,this).getMostBottomColumnHeadersRange()):ro(Xf,this)==="with-column-group-headers"&&n.set("headers",ro(Zf,this).getAllColumnHeadersRange()),n.set("cells",ro(Zf,this).getCellsRange())),this.copyableRanges=Array.from(n.values()).filter(r=>r!==null).map(r=>{let{startRow:o,startCol:a,endRow:u,endCol:h}=r;return{startRow:o,startCol:a,endRow:u,endCol:h}}),this.copyableRanges=this.hot.runHooks("modifyCopyableRange",this.copyableRanges);const i=n.get("cells");if(i!==null&&i.isRangeTrimmed){const{startRow:r,startCol:o,endRow:a,endCol:u}=i;this.hot.runHooks("afterCopyLimit",a-r+1,u-o+1,this.rowsLimit,this.columnsLimit)}}isEditorOpened(){var e;return(e=this.hot.getActiveEditor())===null||e===void 0?void 0:e.isOpened()}populateValues(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.hot.getSelectedRangeActive();if(!e.length)return[null,null,null,null];const r=e.length,o=e[0].length,a=[],{row:u,col:h}=i.getTopStartCorner(),{row:d,col:g}=i.getBottomEndCorner();let m=u,v=h,y=u,b=h;for(;a.length<r||m<=d;){const{skipRowOnPaste:T,visualRow:O}=this.hot.getCellMeta(m,h);if(m=O+1,T===!0)continue;y=O,v=h;const A=[],N=a.length%r;for(;A.length<o||v<=g;){var C;const{skipColumnOnPaste:x,visualCol:$}=this.hot.getCellMeta(O,v),L=this.hot.getSourceDataAtCell(O,v),P=A.length%o;if(v=$+1,x===!0)continue;b=$;const Q=n==null||(C=n[N])===null||C===void 0?void 0:C[P];let ue=e[N][P];if(n&&Koe(Q)){const X=JSON.parse(Q);(Qe(L)||L===null)&&(ue=X)}A.push(ue)}a.push(A)}return Ks(S0,this,!0),this.hot.populateFromArray(u,h,a,void 0,void 0,"CopyPaste.paste",this.pasteMode),[u,h,y,b]}onCopy(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ro(mb,this)||this.isEditorOpened()||cu(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!mC(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ks(mb,this,!1);const o=this.getRangedData(this.copyableRanges),a=this.getRangedData(this.copyableRanges,!0),u=fr(_r,this,Xbe).call(this,this.copyableRanges);!!this.hot.runHooks("beforeCopy",o,this.copyableRanges,u)&&(fr(_r,this,QY).call(this,e,o,a),this.hot.runHooks("afterCopy",o,this.copyableRanges,u)),Ks(Xf,this,"cells-only")}onCut(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()&&!ro(pb,this)||this.isEditorOpened()||cu(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!mC(n,this.hot.rootElement)))return;e.preventDefault(),this.setCopyableText(),Ks(pb,this,!1);const o=this.getRangedData(this.copyableRanges),a=this.getRangedData(this.copyableRanges,!0);!!this.hot.runHooks("beforeCut",o,this.copyableRanges)&&(fr(_r,this,QY).call(this,e,o,a),this.hot.emptySelectedCells("CopyPaste.cut"),this.hot.runHooks("afterCut",o,this.copyableRanges))}onPaste(e){const n=e.composedPath()[0],i=this.hot.getFocusManager().getRefocusElement(),r=n?.hasAttribute("data-hot-input");if(!this.hot.isListening()||this.isEditorOpened()||!this.hot.getSelected()||cu(n)&&(r&&n!==i||!r&&n!==this.hot.rootDocument.body&&!mC(n,this.hot.rootElement)))return;e.preventDefault();let o,a;if(e&&typeof e.clipboardData<"u"){const m=e.clipboardData.getData(c8);m&&(a=xz(m,this.hot.rootDocument).data);const v=bP(e.clipboardData.getData("text/html"),{ADD_TAGS:["meta"],ADD_ATTR:["content"],FORCE_BODY:!0});v&&/(<table)|(<TABLE)/g.test(v)?o=xz(v,this.hot.rootDocument).data:o=e.clipboardData.getData("text/plain")}else typeof ClipboardEvent>"u"&&typeof this.hot.rootWindow.clipboardData<"u"&&(o=this.hot.rootWindow.clipboardData.getData("Text"));if(typeof o=="string"&&(o=Sde(o)),o===void 0||o&&o.length===0||this.hot.runHooks("beforePaste",o,this.copyableRanges)===!1)return;const[u,h,d,g]=this.populateValues(o,a);u!==null&&h!==null&&this.hot.selectCell(u,h,Math.min(this.hot.countRows()-1,d),Math.min(this.hot.countCols()-1,g)),this.hot.runHooks("afterPaste",o,this.copyableRanges)}destroy(){super.destroy()}}function ZY(t){if(vR()){const e=this.hot.getSelectedRangeActive();if(e){const{row:n,col:i}=e.highlight,r=this.hot.getCell(n,i,!0);r&&Yse(r,()=>{this.hot.rootDocument.execCommand(t)})}}else this.hot.rootDocument.execCommand(t)}function Xbe(t){const{rows:e}=l8(t);let n=0;for(let i=0;i<e.length&&!(e[i]>=0);i++)n+=1;return{columnHeadersCount:n}}function Zbe(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i&&I4(i)}}}function h8(){if(this.hot.isListening()){const t=this.hot.getSelectedRangeActive();if(t){const{row:e,col:n}=t.highlight,i=this.hot.getCell(e,n,!0);i!=null&&i.hasAttribute("contenteditable")&&P4(i)}}}function QY(t,e,n){const i=i0(e);if(t&&t.clipboardData){const r=Oz(e),o=Oz(n);t.clipboardData.setData("text/plain",i),t.clipboardData.setData("text/html",[XY,r].join("")),t.clipboardData.setData(c8,[XY,o].join(""))}else typeof ClipboardEvent>"u"&&this.hot.rootWindow.clipboardData.setData("Text",i)}function Qbe(t){t.items.push({name:"---------"},Nbe(this)),ro(lI,this)&&t.items.push(kbe(this)),ro(uI,this)&&t.items.push(Lbe(this)),ro(cI,this)&&t.items.push(Dbe(this)),t.items.push($be(this))}function Jbe(t,e,n,i,r){ro(S0,this)&&(r.value=!0),Ks(S0,this,!1)}function eCe(){this.isEditorOpened()||this.hot.getSettings().fragmentSelection||this.setCopyableText()}function tCe(){fr(_r,this,h8).call(this)}function nCe(){fr(_r,this,Zbe).call(this)}function iCe(){fr(_r,this,h8).call(this)}function d8(t,e){return`border_row${t}col${e}`}function Hv(){return{width:1,color:"#000"}}function nu(){return{hide:!0}}function rCe(){return{width:1,color:"#000",cornerVisible:!1}}function AO(t){if(Ne(t.start)||Ne(t.left)){var e;t.start=(e=t.start)!==null&&e!==void 0?e:t.left}if(Ne(t.end)||Ne(t.right)){var n;t.end=(n=t.end)!==null&&n!==void 0?n:t.right}return delete t.left,delete t.right,t}function ov(t){return Ne(t.start)&&(t.left=t.start),Ne(t.end)&&(t.right=t.end),t}function OO(t,e){return{id:d8(t,e),border:rCe(),row:t,col:e,top:nu(),bottom:nu(),start:nu(),end:nu()}}function oCe(t,e){return ti(e,"border")&&e.border&&(t.border=e.border),ti(e,"top")&&Ne(e.top)&&(e.top?(Qe(e.top)||(e.top=Hv()),t.top=e.top):(e.top=nu(),t.top=e.top)),ti(e,"bottom")&&Ne(e.bottom)&&(e.bottom?(Qe(e.bottom)||(e.bottom=Hv()),t.bottom=e.bottom):(e.bottom=nu(),t.bottom=e.bottom)),ti(e,"start")&&Ne(e.start)&&(e.start?(Qe(e.start)||(e.start=Hv()),t.start=e.start):(e.start=nu(),t.start=e.start)),ti(e,"end")&&Ne(e.end)&&(e.end?(Qe(e.end)||(e.end=Hv()),t.end=e.end):(e.end=nu(),t.end=e.end)),t}function gu(t,e){let n=!1;return U(t.getSelectedRange(),i=>{i.forAll((r,o)=>{if(r<0||o<0)return;const a=t.getCellMeta(r,o).borders;if(a)if(e){if(!ti(a[e],"hide")||a[e].hide===!1)return n=!0,!1}else return n=!0,!1})}),n}function UR(t){return`<span class="selected">✓</span>${t}`}function sCe(t){return t.some(e=>Ne(e.left)||Ne(e.right))}function aCe(t){return t.some(e=>Ne(e.start)||Ne(e.end))}const lCe=new Map([["left","start"],["right","end"]]);function uCe(t){var e;return(e=lCe.get(t))!==null&&e!==void 0?e:t}function cCe(t){return{key:"borders:bottom",name(){let e=this.getTranslatedPhrase(DN);return gu(this,"bottom")&&(e=UR(e)),e},callback(e,n){const i=gu(this,"bottom");t.prepareBorder(n,"bottom",i)}}}function hCe(t){const e=t.hot.isRtl()?"end":"start";return{key:"borders:left",name(){let n=this.getTranslatedPhrase(LN);return gu(this,e)&&(n=UR(n)),n},callback(n,i){const r=gu(this,e);t.prepareBorder(i,e,r)}}}function dCe(t){return{key:"borders:no_borders",name(){return this.getTranslatedPhrase(kN)},callback(e,n){t.prepareBorder(n,"noBorders")},disabled(){return!gu(this)}}}function fCe(t){const e=t.hot.isRtl()?"start":"end";return{key:"borders:right",name(){let n=this.getTranslatedPhrase(NN);return gu(this,e)&&(n=UR(n)),n},callback(n,i){const r=gu(this,e);t.prepareBorder(i,e,r)}}}function gCe(t){return{key:"borders:top",name(){let e=this.getTranslatedPhrase(PN);return gu(this,"top")&&(e=UR(e)),e},callback(e,n){const i=gu(this,"top");t.prepareBorder(n,"top",i)}}}function mCe(t,e){pCe(t,e),e.add(t)}function pCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vCe(t,e,n){return(e=wCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wCe(t){var e=yCe(t,"string");return typeof e=="symbol"?e:e+""}function yCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JY(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _C="customBorders",SCe=90;var xO=new WeakSet;class bCe extends Dt{constructor(){super(...arguments),mCe(this,xO),vCe(this,"savedBorders",[])}static get PLUGIN_KEY(){return _C}static get PLUGIN_PRIORITY(){return SCe}isEnabled(){return!!this.hot.getSettings()[_C]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>JY(xO,this,CCe).call(this,e)),this.addHook("init",()=>JY(xO,this,RCe).call(this)),super.enablePlugin())}disablePlugin(){this.hideBorders(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.changeBorderSettings(),super.updatePlugin()}setBorders(e,n){let i=["top","bottom","start","end"],r=null;n&&(this.checkSettingsCohesion([n]),i=Object.keys(n),r=AO(n));const o=em(e),a=gw(o,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)});U(e,u=>{a(u).forAll((h,d)=>{U(i,g=>{this.prepareBorderFromCustomAdded(h,d,r,uCe(g))})})}),this.hot.view.render()}getBorders(e){if(!Array.isArray(e))return this.savedBorders;const n=em(e),i=gw(n,{createCellCoords:this.hot._createCellCoords.bind(this.hot),createCellRange:this.hot._createCellRange.bind(this.hot)}),r=[];return U(e,o=>{i(o).forAll((a,u)=>{U(this.savedBorders,h=>{h.row===a&&h.col===u&&r.push(ov(h))})})}),r}clearBorders(e){e?this.setBorders(e):(U(this.savedBorders,n=>{this.clearBordersFromSelectionSettings(n.id),this.clearNullCellRange(),this.hot.removeCellMeta(n.row,n.col,"borders")}),this.savedBorders.length=0)}insertBorderIntoSettings(e,n){this.checkSavedBorders(e)||this.savedBorders.push(e);const r=this.hot._createCellRange(this.hot._createCellCoords(e.row,e.col));this.checkCustomSelections(e,r,n)||this.hot.selection.highlight.addCustomSelection({border:e,visualCellRange:r})}prepareBorderFromCustomAdded(e,n,i,r){const o=this.hot.countRows(),a=this.hot.countCols();if(e>=o||n>=a)return;let u=OO(e,n);i&&(u=oCe(u,i),U(this.hot.selection.highlight.customSelections,h=>{if(u.id===h.settings.id)return Object.assign(h.settings,i),u.id=h.settings.id,u.top=h.settings.top,u.bottom=h.settings.bottom,u.start=h.settings.start,u.end=h.settings.end,!1})),this.hot.setCellMeta(e,n,"borders",ov(u)),this.insertBorderIntoSettings(u,r)}prepareBorderFromCustomAddedRange(e,n){const i=Math.min(e.to.row,this.hot.countRows()-1),r=Math.min(e.to.col,this.hot.countCols()-1);ze(e.from.row,i,o=>{ze(e.from.col,r,a=>{const u=OO(o,a);let h=0;o===e.from.row&&ti(n,"top")&&(h+=1,u.top=n.top),o===e.to.row&&ti(n,"bottom")&&(h+=1,u.bottom=n.bottom),a===e.from.col&&ti(n,"start")&&(h+=1,u.start=n.start),a===e.to.col&&ti(n,"end")&&(h+=1,u.end=n.end),h>0&&(this.hot.setCellMeta(o,a,"borders",ov(u)),this.insertBorderIntoSettings(u))})})}removeAllBorders(e,n){const i=d8(e,n);this.spliceBorder(i),this.clearBordersFromSelectionSettings(i),this.clearNullCellRange(),this.hot.removeCellMeta(e,n,"borders")}setBorder(e,n,i,r){let o=this.hot.getCellMeta(e,n).borders;!o||o.border===void 0?o=OO(e,n):o=AO(o),r?(o[i]=nu(),this.countHide(o)===4?this.removeAllBorders(e,n):(this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",ov(o)))):(o[i]=Hv(),this.checkCustomSelectionsFromContextMenu(o,i,r)||this.insertBorderIntoSettings(o),this.hot.setCellMeta(e,n,"borders",ov(o)))}prepareBorder(e,n,i){U(e,r=>{let{start:o,end:a}=r;if(o.row===a.row&&o.col===a.col)n==="noBorders"?this.removeAllBorders(o.row,o.col):this.setBorder(o.row,o.col,n,i);else switch(n){case"noBorders":ze(o.col,a.col,u=>{ze(o.row,a.row,h=>{this.removeAllBorders(h,u)})});break;case"top":ze(o.col,a.col,u=>{this.setBorder(o.row,u,n,i)});break;case"bottom":ze(o.col,a.col,u=>{this.setBorder(a.row,u,n,i)});break;case"start":ze(o.row,a.row,u=>{this.setBorder(u,o.col,n,i)});break;case"end":ze(o.row,a.row,u=>{this.setBorder(u,a.col,n,i)});break}})}createCustomBorders(e){U(e,n=>{const i=AO(n);n.range?this.prepareBorderFromCustomAddedRange(n.range,i):this.prepareBorderFromCustomAdded(n.row,n.col,i)})}countHide(e){const{top:n,bottom:i,start:r,end:o}=e;return ho([n,i,r,o],(u,h)=>{let d=u;return h&&h.hide&&(d+=1),d},0)}clearBordersFromSelectionSettings(e){const n=Vt(this.hot.selection.highlight.customSelections,i=>i.settings.id).indexOf(e);n>-1&&this.hot.selection.highlight.customSelections[n].clear()}clearNullCellRange(){U(this.hot.selection.highlight.customSelections,(e,n)=>{if(e.cellRange===null)return this.hot.selection.highlight.customSelections[n].destroy(),this.hot.selection.highlight.customSelections.splice(n,1),!1})}hideBorders(){U(this.savedBorders,e=>{this.clearBordersFromSelectionSettings(e.id),this.clearNullCellRange()})}spliceBorder(e){const n=Vt(this.savedBorders,i=>i.id).indexOf(e);n>-1&&this.savedBorders.splice(n,1)}checkSavedBorders(e){let n=!1;return this.countHide(e)===4?(this.spliceBorder(e.id),n=!0):U(this.savedBorders,(r,o)=>{if(e.id===r.id)return this.savedBorders[o]=e,n=!0,!1}),n}checkCustomSelectionsFromContextMenu(e,n,i){let r=!1;return U(this.hot.selection.highlight.customSelections,o=>{if(e.id===o.settings.id){const a=this.hot.view._wt.selectionManager.getBorderInstances(o);return U(a,u=>{u.toggleHiddenClass(n,i)}),r=!0,!1}}),r}checkCustomSelections(e,n,i){const r=this.countHide(e);let o=!1;return r===4?(this.removeAllBorders(e.row,e.col),o=!0):U(this.hot.selection.highlight.customSelections,a=>{if(e.id===a.settings.id){if(a.visualCellRange=n,a.commit(),i){const u=this.hot.view._wt.selectionManager.getBorderInstances(a);U(u,h=>{h.changeBorderStyle(i,e)})}return o=!0,!1}}),o}changeBorderSettings(){const e=this.hot.getSettings()[_C];if(Array.isArray(e)){const n=Nr(e);this.checkSettingsCohesion(n),n.length||(this.savedBorders=n),this.createCustomBorders(n)}else e!==void 0&&this.createCustomBorders(this.savedBorders)}checkSettingsCohesion(e){const n=sCe(e),i=aCe(e);if(n&&i)throw new Error('The "left"/"right" and "start"/"end" options should not be used together. Please use only the option "start"/"end".');if(this.hot.isRtl()&&n)throw new Error('The "left"/"right" properties are not supported for RTL. Please use option "start"/"end".')}destroy(){super.destroy()}}function CCe(t){this.hot.getSettings()[_C]&&t.items.push({name:"---------"},{key:"borders",name(){return this.getTranslatedPhrase(IN)},disabled(){const e=this.getSelectedRangeActive();return!e||e.isSingleHeader()?!0:this.selection.isSelectedByCorner()},submenu:{items:[gCe(this),fCe(this),cCe(this),hCe(this),dCe(this)]}})}function RCe(){this.changeBorderSettings()}function ECe(t,e){TCe(t,e),e.add(t)}function TCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function HO(t,e,n){return(e=_Ce(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _Ce(t){var e=MCe(t,"string");return typeof e=="symbol"?e:e+""}function MCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function eG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const tG="dragToScroll",ACe=100;var IO=new WeakSet;class OCe extends Dt{constructor(){super(...arguments),ECe(this,IO),HO(this,"boundaries",null),HO(this,"callback",null),HO(this,"listening",!1)}static get PLUGIN_KEY(){return tG}static get PLUGIN_PRIORITY(){return ACe}isEnabled(){return!!this.hot.getSettings()[tG]}enablePlugin(){this.enabled||(this.addHook("afterOnCellMouseDown",e=>eG(IO,this,nG).call(this,e)),this.addHook("afterOnCellCornerMouseDown",e=>eG(IO,this,nG).call(this,e)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.unregisterEvents(),super.disablePlugin()}setBoundaries(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{left:0,right:this.hot.rootWindow.innerWidth,top:0,bottom:this.hot.rootWindow.innerHeight};this.boundaries=e}setCallback(e){this.callback=e}check(e,n){let i=0,r=0;n<this.boundaries.top?r=n-this.boundaries.top:n>this.boundaries.bottom&&(r=n-this.boundaries.bottom),e<this.boundaries.left?i=e-this.boundaries.left:e>this.boundaries.right&&(i=e-this.boundaries.right),this.callback(i,r)}listen(){this.listening=!0}unlisten(){this.listening=!1}isListening(){return this.listening}registerEvents(){const{rootWindow:e}=this.hot;let n=e;for(;n;)this.eventManager.addEventListener(n.document,"contextmenu",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mouseup",()=>this.unlisten()),this.eventManager.addEventListener(n.document,"mousemove",i=>this.onMouseMove(i)),n=Zg(n)}unregisterEvents(){this.eventManager.clear()}onMouseMove(e){this.isListening()&&this.check(e.clientX,e.clientY)}destroy(){super.destroy()}}function nG(t){if(_d(t))return;const e=this.hot.view._wt.wtOverlays.topOverlay.mainTableScrollableElement;this.setBoundaries(e!==this.hot.rootWindow?e.getBoundingClientRect():void 0),this.setCallback((n,i)=>{var r,o;const a=(r=e.scrollLeft)!==null&&r!==void 0?r:e.scrollX,u=(o=e.scrollTop)!==null&&o!==void 0?o:e.scrollY;e.scroll(a+Math.sign(n)*50,u+Math.sign(i)*20)}),this.listen()}function xCe(t,e){f8(t,e),e.add(t)}function HCe(t,e,n){f8(t,e),e.set(t,n)}function f8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function PO(t,e,n){return(e=ICe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ICe(t){var e=PCe(t,"string");return typeof e=="symbol"?e:e+""}function PCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function NCe(t,e){return t.get(ws(t,e))}function g8(t,e,n){return t.set(ws(t,e),n),n}function ws(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("afterDropdownMenuDefaultOptions");He.getSingleton().register("beforeDropdownMenuShow");He.getSingleton().register("afterDropdownMenuShow");He.getSingleton().register("afterDropdownMenuHide");He.getSingleton().register("afterDropdownMenuExecute");const MC="dropdownMenu",DCe=230,Sw="changeType",NO=MC;var YR=new WeakMap,Qs=new WeakSet;class GR extends Dt{static get PLUGIN_KEY(){return MC}static get PLUGIN_PRIORITY(){return DCe}static get PLUGIN_DEPS(){return["plugin:AutoColumnSize"]}static get DEFAULT_ITEMS(){return[Xw,Zw,vt,Jw,vt,kR,vt,Qw,vt,vs]}constructor(e){super(e),xCe(this,Qs),PO(this,"commandExecutor",new t8(this.hot)),PO(this,"itemsFactory",null),PO(this,"menu",null),HCe(this,YR,!1),this.hot.addHook("afterGetColHeader",(n,i)=>ws(Qs,this,kCe).call(this,n,i))}isEnabled(){return this.hot.getSettings()[MC]}enablePlugin(){var e=this;if(this.enabled)return;this.itemsFactory=new n8(this.hot,GR.DEFAULT_ITEMS),this.addHook("beforeOnCellMouseDown",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return ws(Qs,e,jCe).call(e,...o)}),this.addHook("beforeViewportScrollHorizontally",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return ws(Qs,e,WCe).call(e,...o)}),this.addHook("beforeDialogShow",()=>this.close());const n=this.hot.getSettings()[MC],i={items:this.itemsFactory.getItems(n)};this.registerEvents(),typeof n.callback=="function"&&this.commandExecutor.setCommonCallback(n.callback),this.registerShortcuts(),super.enablePlugin(),this.callOnPluginsReady(()=>{this.hot.runHooks("afterDropdownMenuDefaultOptions",i),this.itemsFactory.setPredefinedItems(i.items);const r=this.itemsFactory.getItems(n);this.menu&&this.menu.destroy(),this.menu=new _m(this.hot,{className:"htDropdownMenu",keepInViewport:!0,container:n.uiContainer||this.hot.rootPortalElement}),this.hot.runHooks("beforeDropdownMenuSetItems",r),this.menu.setMenuItems(r),this.menu.addLocalHook("beforeOpen",()=>ws(Qs,this,$Ce).call(this)),this.menu.addLocalHook("afterOpen",()=>ws(Qs,this,VCe).call(this)),this.menu.addLocalHook("afterSubmenuOpen",o=>ws(Qs,this,BCe).call(this,o)),this.menu.addLocalHook("afterClose",()=>ws(Qs,this,FCe).call(this)),this.menu.addLocalHook("executeCommand",function(){for(var o=arguments.length,a=new Array(o),u=0;u<o;u++)a[u]=arguments[u];return e.executeCommand.call(e,...a)}),U(r,o=>this.commandExecutor.registerCommand(o.key,o))})}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.close(),this.menu&&this.menu.destroy(),this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){const e=this.hot.getShortcutManager().getContext("grid"),n=()=>{const{highlight:i}=this.hot.getSelectedRangeActive();if((i.isHeader()&&i.row===-1||i.isCell())&&i.col>=0){this.hot.selectColumns(i.col,i.col,-1);const{from:r}=this.hot.getSelectedRangeActive(),o=LR(this.menu.container,this.hot.rootDocument),a=this.hot.getCell(-1,r.col,!0).querySelector(`.${Sw}`),u=a.getBoundingClientRect();this.open({left:u.left+o.left,top:u.top+a.offsetHeight+o.top},{left:u.width,right:0,above:0,below:3}),this.menu.getNavigator().toFirstItem()}};e.addShortcuts([{keys:[["Shift","Alt","ArrowDown"],["Control/Meta","Enter"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isHeader()&&!this.menu.isOpened()},captureCtrl:!0,group:NO},{keys:[["Shift","Alt","ArrowDown"]],callback:n,runOnlyIf:()=>{var i;const r=(i=this.hot.getSelectedRangeActive())===null||i===void 0?void 0:i.highlight;return r&&this.hot.selection.isCellVisible(r)&&r.isCell()&&!this.menu.isOpened()},group:NO}])}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(NO)}registerEvents(){this.eventManager.addEventListener(this.hot.rootElement,"click",e=>ws(Qs,this,LCe).call(this,e))}open(e){var n;let i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{above:0,below:0,left:0,right:0};(n=this.menu)!==null&&n!==void 0&&n.isOpened()||(this.menu.open(),wt(i,(r,o)=>{this.menu.setOffset(o,r)}),this.menu.setPosition(e))}close(){var e;(e=this.menu)===null||e===void 0||e.close()}executeCommand(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];this.commandExecutor.execute(e,...i)}setListening(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.menu.isOpened()&&(e?this.menu.hotMenu.listen():this.menu.hotMenu.unlisten())}destroy(){this.close(),this.menu&&this.menu.destroy(),super.destroy()}}function m8(t){t.getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Control/Meta","A"]],callback:()=>!1}])}function LCe(t){if(Xe(t.target,Sw)){const e=LR(this.menu.container,this.hot.rootDocument),n=t.target.getBoundingClientRect();t.stopPropagation(),g8(YR,this,!1),this.open({left:n.left+e.left,top:n.top+t.target.offsetHeight+e.top},{left:n.width,right:0,above:0,below:3})}}function kCe(t,e){const n=e.parentNode;if(!n)return;const i=n.parentNode.childNodes,r=Array.prototype.indexOf.call(i,n);if(t<0||r!==i.length-1)return;const o=e.querySelector(`.${Sw}`);if(this.enabled&&o)return;if(!this.enabled){o&&o.parentNode.removeChild(o);return}const a=this.hot.rootDocument.createElement("button");a.className=Sw,a.type="button",a.tabIndex=-1,this.hot.getSettings().ariaTags&&(We(a,[Bd(),Bo(" ")]),We(e,[f4("menu")])),a.onclick=function(){return!1},e.firstChild.insertBefore(a,e.firstChild.firstChild)}function $Ce(){this.hot.runHooks("beforeDropdownMenuShow",this)}function VCe(){this.hot.runHooks("afterDropdownMenuShow",this),ws(Qs,this,m8).call(this,this.menu)}function BCe(t){ws(Qs,this,m8).call(this,t)}function FCe(){this.hot.listen(),this.hot.runHooks("afterDropdownMenuHide",this)}function WCe(t){return NCe(YR,this)?null:t}function jCe(t){Xe(t.target,Sw)&&g8(YR,this,!0)}GR.SEPARATOR={name:vt};function iG(t,e,n){return(e=zCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function zCe(t){var e=UCe(t,"string");return typeof e=="symbol"?e:e+""}function UCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class YCe{constructor(e){iG(this,"hot",void 0),iG(this,"options",{}),this.hot=e}setOptions(e){this.options=e}getData(){const{startRow:e,startCol:n,endRow:i,endCol:r}=this._getDataRange(),o=this.options,a=[];return ze(e,i,u=>{const h=[];!o.exportHiddenRows&&this._isHiddenRow(u)||(ze(n,r,d=>{!o.exportHiddenColumns&&this._isHiddenColumn(d)||h.push(this.hot.getDataAtCell(u,d))}),a.push(h))}),a}getRowHeaders(){const e=[];if(this.options.rowHeaders){const{startRow:n,endRow:i}=this._getDataRange(),r=this.hot.getRowHeader();ze(n,i,o=>{!this.options.exportHiddenRows&&this._isHiddenRow(o)||e.push(r[o])})}return e}getColumnHeaders(){const e=[];if(this.options.columnHeaders){const{startCol:n,endCol:i}=this._getDataRange(),r=this.hot.getColHeader();ze(n,i,o=>{!this.options.exportHiddenColumns&&this._isHiddenColumn(o)||e.push(r[o])})}return e}_getDataRange(){const e=this.hot.countCols()-1,n=this.hot.countRows()-1;let[i=0,r=0,o=n,a=e]=this.options.range;return i=Math.max(i,0),r=Math.max(r,0),o=Math.min(o,n),a=Math.min(a,e),{startRow:i,startCol:r,endRow:o,endCol:a}}_isHiddenRow(e){return this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(e))}_isHiddenColumn(e){return this.hot.columnIndexMapper.isHidden(this.hot.toPhysicalColumn(e))}}function rG(t,e,n){return(e=GCe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function GCe(t){var e=qCe(t,"string");return typeof e=="symbol"?e:e+""}function qCe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class cL{static get DEFAULT_OPTIONS(){return{mimeType:"text/plain",fileExtension:"txt",filename:"Handsontable [YYYY]-[MM]-[DD]",encoding:"utf-8",bom:!1,columnHeaders:!1,rowHeaders:!1,exportHiddenColumns:!1,exportHiddenRows:!1,range:[]}}constructor(e,n){rG(this,"dataProvider",void 0),rG(this,"options",void 0),this.dataProvider=e,this.options=this._mergeOptions(n),this.dataProvider.setOptions(this.options)}_mergeOptions(e){let n=il(this.constructor.DEFAULT_OPTIONS);const i=new Date;return n=Mi(il(cL.DEFAULT_OPTIONS),n),n=Mi(n,e),n.filename=SP(n.filename,{YYYY:i.getFullYear(),MM:`${i.getMonth()+1}`.padStart(2,"0"),DD:`${i.getDate()}`.padStart(2,"0")}),n}}function KCe(t,e){XCe(t,e),e.add(t)}function XCe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function oG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const p8="\r",ZCe='"',QCe=`
`,JCe="=",e0e="+",t0e="-",n0e="@",i0e="	";var DO=new WeakSet;class r0e extends cL{constructor(){super(...arguments),KCe(this,DO)}static get DEFAULT_OPTIONS(){return{mimeType:"text/csv",fileExtension:"csv",bom:!0,columnDelimiter:",",rowDelimiter:`\r
`,sanitizeValues:!1}}export(){const e=this.options,n=this.dataProvider.getData();let i=this.dataProvider.getColumnHeaders();const r=i.length>0,o=this.dataProvider.getRowHeaders(),a=o.length>0;let u=e.bom?"\uFEFF":"";return r&&(i=Vt(i,h=>this._escapeCell(h,{force:!0,sanitizeValue:e.sanitizeValues})),a&&(u+=e.columnDelimiter),u+=i.join(e.columnDelimiter),u+=e.rowDelimiter),U(n,(h,d)=>{d>0&&(u+=e.rowDelimiter),a&&(u+=this._escapeCell(o[d],{sanitizeValue:e.sanitizeValues}),u+=e.columnDelimiter);const g=h.map(m=>this._escapeCell(m,{sanitizeValue:e.sanitizeValues})).join(e.columnDelimiter);u+=g}),u}_escapeCell(e){let{force:n=!1,sanitizeValue:i=!1}=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},r=xn(e);return r===""||(i&&(n=!0),i instanceof RegExp?r=oG(DO,this,s0e).call(this,r,i):typeof i=="function"?r=i(r):i&&(r=oG(DO,this,o0e).call(this,r)),(n||r.indexOf(p8)>=0||r.indexOf(ZCe)>=0||r.indexOf(QCe)>=0||r.indexOf(this.options.columnDelimiter)>=0)&&(r=r.replace(new RegExp('"',"g"),'""'),r=`"${r}"`)),r}}function o0e(t){return t.startsWith(JCe)||t.startsWith(e0e)||t.startsWith(t0e)||t.startsWith(n0e)||t.startsWith(i0e)||t.startsWith(p8)?`'${t}`:t}function s0e(t,e){return e.test(t)?`'${t}`:t}const a0e="csv",hI={[a0e]:r0e};function l0e(t,e,n){return typeof hI[t]=="function"?new hI[t](e,n):null}const u0e="exportFile",c0e=240;class h0e extends Dt{static get PLUGIN_KEY(){return u0e}static get PLUGIN_PRIORITY(){return c0e}isEnabled(){return!0}exportAsString(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createTypeFormatter(e,n).export()}exportAsBlob(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this._createBlob(this._createTypeFormatter(e,n))}downloadFile(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};const{rootDocument:i,rootWindow:r}=this.hot,o=this._createTypeFormatter(e,n),a=this._createBlob(o),u=r.URL||r.webkitURL,h=i.createElement("a"),d=`${o.options.filename}.${o.options.fileExtension}`;if(h.download!==void 0){const g=u.createObjectURL(a);h.style.display="none",h.setAttribute("href",g),h.setAttribute("download",d),i.body.appendChild(h),h.dispatchEvent(new MouseEvent("click")),i.body.removeChild(h),setTimeout(()=>{u.revokeObjectURL(g)},100)}else navigator.msSaveOrOpenBlob&&navigator.msSaveOrOpenBlob(a,d)}_createTypeFormatter(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!hI[e])throw new Error(`Export format type "${e}" is not supported.`);return l0e(e,new YCe(this.hot),n)}_createBlob(e){let n=null;return typeof Blob<"u"&&(n=new Blob([e.export()],{type:`${e.options.mimeType};charset=${e.options.encoding}`})),n}}function Qf(t,e,n){return(e=d0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function d0e(t){var e=f0e(t,"string");return typeof e=="symbol"?e:e+""}function f0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ey{constructor(e,n){let{id:i,stateless:r=!0}=n;Qf(this,"hot",void 0),Qf(this,"id",void 0),Qf(this,"elements",[]),Qf(this,"hidden",!1),Qf(this,"stateId",""),Qf(this,"state",void 0),this.hot=e,this.id=i,this.stateId=`Filters.component.${this.id}`,this.state=r?null:this.hot.columnIndexMapper.registerMap(this.stateId,new _R)}getElements(){return this.elements}reset(){U(this.elements,e=>e.reset())}hide(){this.hidden=!0}show(){this.hidden=!1}isHidden(){return this.hot===null||this.hidden}restoreState(e){this.state&&this.setState(this.state.getValueAtIndex(e))}setState(){throw new Error("The state setting logic is not implemented")}saveState(e){this.state&&this.state.setValueAtIndex(e,this.getState())}getState(){throw new Error("The state gathering logic is not implemented")}destroy(){this.hot.columnIndexMapper.unregisterMap(this.stateId),this.clearLocalHooks(),U(this.elements,e=>e.destroy()),this.state=null,this.elements=null,this.hot=null}}en(ey,Fi);const bw={};function Vc(t,e){if(!bw[t])throw Error(`Filter condition "${t}" does not exist.`);const{condition:n,descriptor:i}=bw[t];let r=e;return i.inputValuesDecorator&&(r=i.inputValuesDecorator(r)),function(o){return n.apply(o.meta.instance,[].concat([o],[r]))}}function gd(t){if(!bw[t])throw Error(`Filter condition "${t}" does not exist.`);return bw[t].descriptor}function mi(t,e,n){n.key=t,bw[t]={condition:e,descriptor:n}}const Xi="none";function g0e(){return!0}mi(Xi,g0e,{name:MR,inputsCount:0,showOperators:!1});const Wv="empty";function m0e(t){return ni(t.value)}mi(Wv,m0e,{name:zN,inputsCount:0,showOperators:!0});const AC="not_empty";function p0e(t,e){return!Vc(Wv,e)(t)}mi(AC,p0e,{name:UN,inputsCount:0,showOperators:!0});const jv="eq";function v0e(t,e){let[n]=e;return xn(t.value).toLocaleLowerCase(t.meta.locale)===xn(n)}mi(jv,v0e,{name:YN,inputsCount:1,showOperators:!0});const OC="neq";function w0e(t,e){return!Vc(jv,e)(t)}mi(OC,w0e,{name:GN,inputsCount:1,showOperators:!0});const v8="gt";function y0e(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>i}mi(v8,y0e,{name:QN,inputsCount:1,showOperators:!0});const w8="gte";function S0e(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value>=i}mi(w8,S0e,{name:JN,inputsCount:1,showOperators:!0});const y8="lt";function b0e(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<i}mi(y8,b0e,{name:eD,inputsCount:1,showOperators:!0});const S8="lte";function C0e(t,e){let[n]=e,i=n;return t.meta.type==="numeric"&&(i=parseFloat(i,10)),t.value<=i}mi(S8,C0e,{name:tD,inputsCount:1,showOperators:!0});const hL="date_after";function R0e(t,e){let[n]=e;const i=Ce(t.value,t.meta.dateFormat),r=Ce(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)>=0}mi(hL,R0e,{name:rD,inputsCount:1,showOperators:!0});const dL="date_before";function E0e(t,e){let[n]=e;const i=Ce(t.value,t.meta.dateFormat),r=Ce(n,t.meta.dateFormat);return!i.isValid()||!r.isValid()?!1:i.diff(r)<=0}mi(dL,E0e,{name:oD,inputsCount:1,showOperators:!0});const b0="between";function T0e(t,e){let[n,i]=e,r=n,o=i;if(t.meta.type==="numeric"){const a=parseFloat(r,10),u=parseFloat(o,10);r=Math.min(a,u),o=Math.max(a,u)}else if(t.meta.type==="date"){const a=Vc(dL,[o]),u=Vc(hL,[r]);return a(t)&&u(t)}return t.value>=r&&t.value<=o}mi(b0,T0e,{name:nD,inputsCount:2,showOperators:!0});const b8="not_between";function _0e(t,e){return!Vc(b0,e)(t)}mi(b8,_0e,{name:iD,inputsCount:2,showOperators:!0});const C8="begins_with";function M0e(t,e){let[n]=e;return xn(t.value).toLocaleLowerCase(t.meta.locale).startsWith(xn(n))}mi(C8,M0e,{name:qN,inputsCount:1,showOperators:!0});const R8="ends_with";function A0e(t,e){let[n]=e;return xn(t.value).toLocaleLowerCase(t.meta.locale).endsWith(xn(n))}mi(R8,A0e,{name:KN,inputsCount:1,showOperators:!0});const fL="contains";function O0e(t,e){let[n]=e;return xn(t.value).toLocaleLowerCase(t.meta.locale).indexOf(xn(n))>=0}mi(fL,O0e,{name:XN,inputsCount:1,showOperators:!0});const E8="not_contains";function x0e(t,e){return!Vc(fL,e)(t)}mi(E8,x0e,{name:ZN,inputsCount:1,showOperators:!0});const T8="date_tomorrow";function H0e(t){const e=Ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ce().subtract(-1,"days").startOf("day"),"d"):!1}mi(T8,H0e,{name:aD,inputsCount:0});const _8="date_today";function I0e(t){const e=Ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ce().startOf("day"),"d"):!1}mi(_8,I0e,{name:sD,inputsCount:0});const M8="date_yesterday";function P0e(t){const e=Ce(t.value,t.meta.dateFormat);return e.isValid()?e.isSame(Ce().subtract(1,"days").startOf("day"),"d"):!1}mi(M8,P0e,{name:lD,inputsCount:0});Ase();function N0e(t,e){let n=t;return n===""&&(n=`(${e})`),n}function ty(t){const e=new Set(t);return function(n){return e.has(n)}}function gL(t){return t??""}function dI(t){return Array.from(new Set(t)).map(e=>gL(e)).sort((e,n)=>typeof e=="number"&&typeof n=="number"?e-n:e===n?0:e>n?1:-1)}function sG(t,e,n,i){const r=[],o=t===e;let a;return o||(a=ty(e)),t.forEach(u=>{let h=!1;(o||a(u))&&(h=!0);const d={checked:h,value:u,visualValue:N0e(u,n)};i&&i(d),r.push(d)}),r}const md="by_value";function D0e(t,e){let[n]=e;return n(t.value)}mi(md,D0e,{name:"By value",inputsCount:0,inputValuesDecorator(t){let[e]=t;return[ty(e)]},showOperators:!1});const Cw={};function L0e(t){if(!Cw[t])throw Error(`Operation with id "${t}" does not exist.`);const e=Cw[t].func;return function(n,i){return e(n,i)}}function k0e(t){return Cw[t].name}function mL(t,e,n){Cw[t]={name:e,func:n}}const kc="conjunction",$0e=hD;function V0e(t,e){return t.every(n=>n.func(e))}mL(kc,$0e,V0e);const C0="disjunction",B0e=AR;function F0e(t,e){return t.some(n=>n.func(e))}mL(C0,B0e,F0e);const pL="disjunctionWithExtraCondition",W0e=AR;function j0e(t,e){if(t.length<3)throw Error("Operation doesn't work on less then three conditions.");return t.slice(0,t.length-1).some(n=>n.func(e))&&t[t.length-1].func(e)}mL(pL,W0e,j0e);const z0e="numeric",A8="text",U0e="date",aG={[z0e]:[Xi,vt,Wv,AC,vt,jv,OC,vt,v8,w8,y8,S8,b0,b8],[A8]:[Xi,vt,Wv,AC,vt,jv,OC,vt,C8,R8,vt,fL,E8],[U0e]:[Xi,vt,Wv,AC,vt,jv,OC,vt,dL,hL,b0,vt,T8,_8,M8]};function Y0e(t){const e=[];let n=t;return aG[n]||(n=A8),U(aG[n],i=>{let r;i===vt?r={name:vt}:r=il(gd(i)),e.push(r)}),e}function sv(t,e,n){return(e=G0e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function G0e(t){var e=q0e(t,"string");return typeof e=="symbol"?e:e+""}function q0e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const LO="built",kO="building",lG=["click","input","keydown","keypress","keyup","focus","blur","change"];let la=class O8{static get DEFAULTS(){return il({className:"",value:"",tagName:"div",children:[],wrapIt:!0})}constructor(e,n){sv(this,"hot",void 0),sv(this,"eventManager",new da(this)),sv(this,"options",void 0),sv(this,"_element",void 0),sv(this,"buildState",void 0),this.hot=e,this.options=Mi(O8.DEFAULTS,n),this._element=this.hot.rootDocument.createElement(this.options.wrapIt?"div":this.options.tagName)}setValue(e){this.options.value=e,this.update()}getValue(){return this.options.value}get element(){return this.buildState===kO?this._element:this.buildState===LO?(this.update(),this._element):(this.buildState=kO,this.build(),this.buildState=LO,this._element)}isBuilt(){return this.buildState===LO}translateIfPossible(e){return typeof e=="string"&&e.startsWith(Dr)?this.hot.getTranslatedPhrase(e):e}build(){const e=(n,i)=>{this.eventManager.addEventListener(n,i,r=>this.runLocalHooks(i,r,this))};if(this.buildState||(this.buildState=kO),this._element.setAttribute("data-hot-input",!0),this.options.tabIndex!==void 0&&this._element.setAttribute("tabindex",this.options.tabIndex),this.options.role!==void 0&&this._element.setAttribute("role",this.options.role),this.options.className&&fe(this._element,this.options.className),this.options.children.length)U(this.options.children,n=>this._element.appendChild(n.element));else if(this.options.wrapIt){const n=this.hot.rootDocument.createElement(this.options.tagName);n.setAttribute("data-hot-input",!0),wt(this.options,(i,r)=>{n[r]!==void 0&&r!=="className"&&r!=="tagName"&&r!=="children"&&(n[r]=this.translateIfPossible(i))}),this._element.appendChild(n),U(lG,i=>e(n,i))}else U(lG,n=>e(this._element,n))}update(){}reset(){this.options.value="",this.update()}show(){this.element.style.display=""}hide(){this.element.style.display="none"}focus(){}destroy(){this.eventManager.destroy(),this.eventManager=null,this.hot=null,this._element.parentNode&&this._element.parentNode.removeChild(this._element),this._element=null}};en(la,Fi);function K0e(t,e){x8(t,e),e.add(t)}function X0e(t,e,n){x8(t,e),e.set(t,n)}function x8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vb(t,e){return t.get(vL(t,e))}function Z0e(t,e,n){return t.set(vL(t,e),n),n}function vL(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Jf=new WeakMap,uG=new WeakSet;class $c extends la{static get DEFAULTS(){return il({placeholder:"",type:"text",tagName:"input",tabIndex:-1})}constructor(e,n){super(e,Mi($c.DEFAULTS,n)),K0e(this,uG),X0e(this,Jf,void 0),this.registerHooks()}registerHooks(){this.addLocalHook("keyup",e=>vL(uG,this,Q0e).call(this,e))}build(){super.build();const e=this.hot.rootDocument.createElement("div");Z0e(Jf,this,this._element.firstChild),fe(this._element,"htUIInput"),fe(e,"htUIInputIcon"),this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(vb(Jf,this).type=this.options.type,vb(Jf,this).placeholder=this.translateIfPossible(this.options.placeholder),vb(Jf,this).value=this.translateIfPossible(this.options.value))}focus(){this.isBuilt()&&vb(Jf,this).focus()}}function Q0e(t){this.options.value=t.target.value}function J0e(t,e){H8(t,e),e.add(t)}function av(t,e,n){H8(t,e),e.set(t,n)}function H8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function eg(t,e,n){return t.set(zv(t,e),n),n}function Bn(t,e){return t.get(zv(t,e))}function zv(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Ni=new WeakMap,wb=new WeakMap,yb=new WeakMap,$O=new WeakMap,Sb=new WeakMap,bb=new WeakSet;class Rw extends la{static get DEFAULTS(){return il({className:"htUISelect",wrapIt:!1,tabIndex:-1})}constructor(e,n){super(e,Mi(Rw.DEFAULTS,n)),J0e(this,bb),av(this,Ni,null),av(this,wb,[]),av(this,yb,void 0),av(this,$O,void 0),av(this,Sb,void 0),this.registerHooks()}getMenu(){return Bn(Ni,this)}registerHooks(){this.addLocalHook("click",()=>zv(bb,this,nRe).call(this))}setItems(e){eg(wb,this,this.translateNames(e)),Bn(Ni,this)&&Bn(Ni,this).setMenuItems(Bn(wb,this))}translateNames(e){return U(e,n=>{n.name=this.translateIfPossible(n.name)}),e}build(){super.build(),eg(Ni,this,new _m(this.hot,{className:"htSelectUI htFiltersConditionsMenu",keepInViewport:!1,standalone:!0,container:this.options.menuContainer})),Bn(Ni,this).setMenuItems(Bn(wb,this));const e=new la(this.hot,{className:"htUISelectCaption"}),n=new la(this.hot,{className:"htUISelectDropdown"});eg(yb,this,e),eg($O,this,e.element),eg(Sb,this,n),this.hot.getSettings().ariaTags&&(We(n.element,[Bd()]),We(this._element,[d4()])),U([e,n],i=>this._element.appendChild(i.element)),Bn(Ni,this).addLocalHook("select",i=>zv(bb,this,eRe).call(this,i)),Bn(Ni,this).addLocalHook("afterClose",()=>zv(bb,this,tRe).call(this)),this.update()}update(){if(!this.isBuilt())return;let e;this.options.value?e=this.options.value.name:e=Bn(Ni,this).hot.getTranslatedPhrase(MR),Bn($O,this).textContent=e,super.update()}openOptions(){const e=this.element.getBoundingClientRect();Bn(Ni,this)&&(Bn(Ni,this).open(),Bn(Ni,this).setPosition({left:this.hot.isLtr()?e.left-5:e.left-31,top:e.top-1,width:e.width,height:e.height}),Bn(Ni,this).getNavigator().toFirstItem(),Bn(Ni,this).getKeyboardShortcutsCtrl().addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:n=>{this.closeOptions(),this.runLocalHooks("tabKeydown",n)}},{keys:[["Control/Meta","A"]],callback:()=>!1}]))}closeOptions(){Bn(Ni,this)&&Bn(Ni,this).close()}focus(){this.isBuilt()&&this.element.focus()}destroy(){Bn(Ni,this)&&(Bn(Ni,this).destroy(),eg(Ni,this,null)),Bn(yb,this)&&Bn(yb,this).destroy(),Bn(Sb,this)&&Bn(Sb,this).destroy(),super.destroy()}}function eRe(t){t.name!==vt&&(this.options.value=t,this.update(),this.runLocalHooks("select",this.options.value))}function tRe(){this.runLocalHooks("afterClose")}function nRe(){this.openOptions()}function iRe(t,e){rRe(t,e),e.add(t)}function rRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function cG(t,e,n){return(e=oRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oRe(t){var e=sRe(t,"string");return typeof e=="symbol"?e:e+""}function sRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function hG(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var VO=new WeakSet;class fI extends ey{constructor(e,n){super(e,{id:n.id,stateless:!1}),iRe(this,VO),cG(this,"name",""),cG(this,"addSeparator",!1),this.name=n.name,this.addSeparator=n.addSeparator,this.elements.push(new Rw(this.hot,{menuContainer:n.menuContainer})),this.elements.push(new $c(this.hot,{placeholder:vD})),this.elements.push(new $c(this.hot,{placeholder:wD})),this.registerHooks()}registerHooks(){this.getSelectElement().addLocalHook("select",e=>hG(VO,this,aRe).call(this,e)).addLocalHook("afterClose",()=>this.runLocalHooks("afterClose")).addLocalHook("tabKeydown",e=>this.runLocalHooks("selectTabKeydown",e)),U(this.getInputElements(),e=>{e.addLocalHook("keydown",n=>hG(VO,this,lRe).call(this,n))})}setState(e){if(this.reset(),!e)return;const n=il(e.command);n.name.startsWith(Yn)&&(n.name=this.hot.getTranslatedPhrase(n.name)),this.getSelectElement().setValue(n),U(e.args,(i,r)=>{if(r>n.inputsCount-1)return!1;const o=this.getInputElement(r);o.setValue(i),o[n.inputsCount>r?"show":"hide"](),r||this.hot._registerTimeout(()=>o.focus(),10)})}getState(){const e=this.getSelectElement().getValue()||gd(Xi),n=[];return U(this.getInputElements(),(i,r)=>{e.inputsCount>r&&n.push(i.getValue())}),{command:e,args:n}}updateState(e,n){const i=gd(e?e.name:Xi);this.state.setValueAtIndex(n,{command:i,args:e?e.args:[]}),e||U(this.getInputElements(),r=>r.setValue(null))}getSelectElement(){return this.elements.filter(e=>e instanceof Rw)[0]}getInputElement(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;return this.getInputElements()[e]}getInputElements(){return this.elements.filter(e=>e instanceof $c)}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,a)=>{fe(n.parentNode,"htFiltersMenuCondition"),this.addSeparator&&fe(n.parentNode,"border");const u=this.hot.rootDocument.createElement("div");return fe(u,"htFiltersMenuLabel"),u.textContent=a,n.appendChild(u),n.parentElement.hasAttribute("ghost-table")||U(this.elements,h=>n.appendChild(h.element)),n}}}reset(){const e=this.hot.getPlugin("filters").getSelectedColumn();let n=[gd(Xi)];if(e!==null){const{visualIndex:i}=e;n=Y0e(this.hot.getDataType(0,i,this.hot.countRows(),i))}U(this.getInputElements(),i=>i.hide()),this.getSelectElement().setItems(n),super.reset(),this.getSelectElement().setValue(n[0])}}function aRe(t){U(this.getInputElements(),(e,n)=>{e[t.inputsCount>n?"show":"hide"](),n===0&&this.hot._registerTimeout(()=>e.focus(),10)}),this.runLocalHooks("change",t)}function lRe(t){Ww(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ma(t))}function dG(t,e,n){uRe(t,e),e.set(t,n)}function uRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lv(t,e){return t.get(I8(t,e))}function fG(t,e,n){return t.set(I8(t,e),n),n}function I8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var tg=new WeakMap,BO=new WeakMap;class R0 extends la{static get DEFAULTS(){return il({type:"radio",tagName:"input",className:"htUIRadio",label:{}})}constructor(e,n){super(e,Mi(R0.DEFAULTS,n)),dG(this,tg,void 0),dG(this,BO,void 0)}build(){super.build();const e=this.hot.rootDocument.createElement("label");e.textContent=this.translateIfPossible(this.options.label.textContent),e.htmlFor=this.translateIfPossible(this.options.label.htmlFor),fG(BO,this,e),fG(tg,this,this._element.firstChild),lv(tg,this).checked=this.options.checked,this._element.appendChild(e),this.update()}update(){this.isBuilt()&&(lv(BO,this).textContent=this.translateIfPossible(this.options.label.textContent))}isChecked(){return this.isBuilt()?lv(tg,this).checked:!1}setChecked(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isBuilt()&&(lv(tg,this).checked=e)}focus(){this.isBuilt()&&lv(tg,this).focus()}}function cRe(t,e){hRe(t,e),e.add(t)}function hRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function dRe(t,e,n){return(e=fRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fRe(t){var e=gRe(t,"string");return typeof e=="symbol"?e:e+""}function gRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function mRe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gG=0;var mG=new WeakSet;class pRe extends ey{constructor(e,n){super(e,{id:n.id,stateless:!1}),cRe(this,mG),dRe(this,"name",""),this.name=n.name,this.buildOperatorsElement()}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(fe(n.parentNode,"htFiltersMenuOperators"),U(this.elements,i=>n.appendChild(i.element)),n)}}buildOperatorsElement(){const e=[kc,C0];U(e,n=>{const i=new R0(this.hot,{name:"operator",label:{htmlFor:n,textContent:k0e(n)},value:n,checked:n===e[gG],id:n});i.addLocalHook("change",r=>mRe(mG,this,vRe).call(this,r)),this.elements.push(i)})}setChecked(e){if(this.elements.length<e)throw Error(Ft`Radio button with index ${e} doesn't exist.`);U(this.elements,(n,i)=>{n.setChecked(i===e)})}getActiveOperationId(){const e=this.elements.find(n=>n instanceof R0&&n.isChecked());return e?e.getValue():kc}getState(){return this.getActiveOperationId()}setState(e){this.reset(),e&&this.getActiveOperationId()!==e&&U(this.elements,n=>{n.setChecked(n.getValue()===e)})}updateState(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:kc,n=arguments.length>1?arguments[1]:void 0,i=e;i===pL&&(i=C0),this.state.setValueAtIndex(n,i)}reset(){this.setChecked(gG)}}function vRe(t){this.setState(t.target.value)}function wRe(t,e,n){yRe(t,e),e.set(t,n)}function yRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function FO(t,e){return t.get(P8(t,e))}function SRe(t,e,n){return t.set(P8(t,e),n),n}function P8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var uv=new WeakMap;class Ew extends la{static get DEFAULTS(){return il({href:"#",tagName:"a",tabIndex:-1,role:"button"})}constructor(e,n){super(e,Mi(Ew.DEFAULTS,n)),wRe(this,uv,void 0)}build(){super.build(),SRe(uv,this,this._element.firstChild)}update(){this.isBuilt()&&(FO(uv,this).textContent=this.translateIfPossible(this.options.textContent))}focus(){this.isBuilt()&&FO(uv,this).focus()}activate(){FO(uv,this).click()}}function bRe(t,e){N8(t,e),e.add(t)}function ng(t,e,n){N8(t,e),e.set(t,n)}function N8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function lt(t,e){return t.get(Ig(t,e))}function zs(t,e,n){return t.set(Ig(t,e),n),n}function Ig(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const pG="multipleSelect.itemBox";var Js=new WeakMap,ui=new WeakMap,WO=new WeakMap,$l=new WeakMap,ac=new WeakMap,lc=new WeakMap,cv=new WeakSet;class Tw extends la{static get DEFAULTS(){return il({className:"htUIMultipleSelect",value:[]})}constructor(e,n){super(e,Mi(Tw.DEFAULTS,n)),bRe(this,cv),ng(this,Js,[]),ng(this,ui,void 0),ng(this,WO,void 0),ng(this,$l,void 0),ng(this,ac,void 0),ng(this,lc,void 0),zs($l,this,new $c(this.hot,{placeholder:pD,className:"htUIMultipleSelectSearch"})),zs(ac,this,new Ew(this.hot,{textContent:dD,className:"htUISelectAll"})),zs(lc,this,new Ew(this.hot,{textContent:fD,className:"htUIClearAll"})),this.registerHooks()}getItemsBox(){return lt(ui,this)}registerHooks(){lt($l,this).addLocalHook("keydown",e=>Ig(cv,this,RRe).call(this,e)),lt($l,this).addLocalHook("input",e=>Ig(cv,this,CRe).call(this,e)),lt(ac,this).addLocalHook("click",e=>Ig(cv,this,ERe).call(this,e)),lt(lc,this).addLocalHook("click",e=>Ig(cv,this,TRe).call(this,e))}setItems(e){var n;zs(Js,this,e),(n=lt(ui,this))===null||n===void 0||n.loadData(lt(Js,this))}setLocale(e){zs(WO,this,e)}getLocale(){return lt(WO,this)}getItems(){return[...lt(Js,this)]}getValue(){return MRe(lt(Js,this))}getSearchInputElement(){return lt($l,this)}getSelectAllElement(){return lt(ac,this)}getClearAllElement(){return lt(lc,this)}isSelectedAllValues(){return lt(Js,this).length===this.getValue().length}build(){super.build();const{rootDocument:e}=this.hot,n=e.createElement("div"),i=new la(this.hot,{className:"htUISelectionControls",children:[lt(ac,this),lt(lc,this)]});this._element.appendChild(lt($l,this).element),this._element.appendChild(i.element),this._element.appendChild(n);const r=o=>{var a;if(!this._element)return;(a=lt(ui,this))===null||a===void 0||a.destroy(),fe(o,"htUIMultipleSelectHot"),zs(ui,this,new this.hot.constructor(o,{data:lt(Js,this),columns:[{data:"checked",type:"checkbox",label:{property:"visualValue",position:"after"}}],beforeRenderer:(d,g,m,v,y,b)=>{d.title=b.instance.getDataAtRowProp(g,b.label.property)},afterListen:()=>{this.runLocalHooks("focus",this)},beforeOnCellMouseUp:()=>{lt(ui,this).listen()},modifyColWidth:d=>{const g=lt(ui,this).container.scrollWidth-_i(e);return d!==void 0&&d<g?g:d},maxCols:1,autoWrapCol:!0,height:110,copyPaste:!1,disableVisualSelection:"area",fillHandle:!1,fragmentSelection:"cell",tabMoves:{row:1,col:0},themeName:this.hot.getCurrentThemeName(),layoutDirection:this.hot.isRtl()?"rtl":"ltr"})),lt(ui,this).init();const h=lt(ui,this).getShortcutManager().getContext("grid");h.removeShortcutsByKeys(["Tab"]),h.removeShortcutsByKeys(["Shift","Tab"]),h.addShortcut({keys:[["Escape"]],callback:d=>{this.runLocalHooks("keydown",d,this)},group:pG}),h.addShortcut({keys:[["Tab"],["Shift","Tab"]],callback:d=>{lt(ui,this).deselectCell(),this.runLocalHooks("keydown",d,this),this.runLocalHooks("listTabKeydown",d,this)},group:pG})};r(n),this.hot._registerTimeout(()=>r(n),100)}focus(){this.isBuilt()&&lt(ui,this).listen()}reset(){lt($l,this).reset(),lt(ac,this).reset(),lt(lc,this).reset()}update(){this.isBuilt()&&(lt(ui,this).loadData(_Re(lt(Js,this),this.options.value)),super.update())}destroy(){var e;(e=lt(ui,this))===null||e===void 0||e.destroy(),lt($l,this).destroy(),lt(lc,this).destroy(),lt(ac,this).destroy(),zs($l,this,null),zs(lc,this,null),zs(ac,this,null),zs(ui,this,null),zs(Js,this,null),super.destroy()}}function CRe(t){const e=t.target.value.toLocaleLowerCase(this.getLocale());let n;e===""?n=[...lt(Js,this)]:n=lt(Js,this).filter(i=>`${i.value}`.toLocaleLowerCase(this.getLocale()).indexOf(e)>=0),lt(ui,this).loadData(n)}function RRe(t){this.runLocalHooks("keydown",t,this),N4(Ww,t.keyCode)("ARROW_DOWN")&&(t.preventDefault(),ma(t),lt(ui,this).listen(),lt(ui,this).selectCell(0,0))}function ERe(t){const e=[];t.preventDefault(),lt(ui,this).getSourceData().forEach((n,i)=>{n.checked=!0,e.push(f5(n,i)[0])}),lt(ui,this).setSourceDataAtCell(e)}function TRe(t){const e=[];t.preventDefault(),lt(ui,this).getSourceData().forEach((n,i)=>{n.checked=!1,e.push(f5(n,i)[0])}),lt(ui,this).setSourceDataAtCell(e)}function _Re(t,e){const n=ty(e);return t.map(i=>(i.checked=n(i.value),i))}function MRe(t){const e=[];return t.forEach(n=>{n.checked&&e.push(n.value)}),e}function ARe(t,e){ORe(t,e),e.add(t)}function ORe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function xRe(t,e,n){return(e=HRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function HRe(t){var e=IRe(t,"string");return typeof e=="symbol"?e:e+""}function IRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Cb(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var hv=new WeakSet;class PRe extends ey{constructor(e,n){super(e,{id:n.id,stateless:!1}),ARe(this,hv),xRe(this,"name",""),this.name=n.name,this.elements.push(new Tw(this.hot)),this.registerHooks()}registerHooks(){this.getMultipleSelectElement().addLocalHook("keydown",e=>Cb(hv,this,NRe).call(this,e)).addLocalHook("listTabKeydown",e=>this.runLocalHooks("listTabKeydown",e)),this.hot.addHook("modifyFiltersMultiSelectValue",(e,n)=>Cb(hv,this,DRe).call(this,e,n))}getElements(){const e=this.getMultipleSelectElement();return[e.getSearchInputElement(),e.getSelectAllElement(),e.getClearAllElement(),this.getMultipleSelectElement()]}setState(e){if(this.reset(),e&&e.command.key===md){const n=this.getMultipleSelectElement();n.setItems(e.itemsSnapshot),n.setValue(e.args[0]),n.setLocale(e.locale)}}getState(){const e=this.getMultipleSelectElement(),n=e.getItems();return{command:{key:e.isSelectedAllValues()||!n.length?Xi:md},args:[e.getValue()],itemsSnapshot:n}}updateState(e){const n=(i,r,o,a,u)=>{const[h]=Rd(r,m=>m.name===md),d={},g=this.hot.getTranslatedPhrase(t0);if(h){const m=a(i,u),v=Vt(m,A=>A.value),y=new Map(m.map(A=>[A.value,this.hot.getCellMeta(A.meta.visualRow,A.meta.visualCol)])),b=dI(v);o&&(h.args[0]=o);const C=[],T=sG(b,h.args[0],g,A=>{A.checked&&C.push(A.value),Cb(hv,this,vG).call(this,A,y)}),O=e.editedConditionStack.column;d.locale=this.hot.getCellMeta(0,O).locale,d.args=[C],d.command=gd(md),d.itemsSnapshot=T}else d.args=[],d.command=gd(Xi);this.state.setValueAtIndex(i,d)};n(e.editedConditionStack.column,e.editedConditionStack.conditions,e.conditionArgsChange,e.filteredRowsFactory),e.dependentConditionStacks.length&&n(e.dependentConditionStacks[0].column,e.dependentConditionStacks[0].conditions,e.conditionArgsChange,e.filteredRowsFactory,e.editedConditionStack)}getMultipleSelectElement(){return this.elements.filter(e=>e instanceof Tw)[0]}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n,i,r,o,a)=>{fe(n.parentNode,"htFiltersMenuValue");const u=this.hot.rootDocument.createElement("div");return fe(u,"htFiltersMenuLabel"),u.textContent=a,n.appendChild(u),n.parentElement.hasAttribute("ghost-table")||U(this.elements,h=>n.appendChild(h.element)),n}}}reset(){const e=this.hot.getTranslatedPhrase(t0),n=this._getColumnVisibleValues(),i=n.map(h=>h.value),r=new Map(n.map(h=>[h.value,h.meta])),o=dI(i),a=sG(o,o,e,h=>{Cb(hv,this,vG).call(this,h,r)});this.getMultipleSelectElement().setItems(a),super.reset(),this.getMultipleSelectElement().setValue(o);const u=this.hot.getPlugin("filters").getSelectedColumn();u!==null&&this.getMultipleSelectElement().setLocale(this.hot.getCellMeta(0,u.visualIndex).locale)}_getColumnVisibleValues(){const e=this.hot.getPlugin("filters").getSelectedColumn();return e===null?[]:Vt(this.hot.getDataAtCol(e.visualIndex),(n,i)=>({value:gL(n),meta:this.hot.getCellMeta(i,e.visualIndex)}))}}function NRe(t){Ww(t.keyCode,"ESCAPE")&&(this.runLocalHooks("cancel"),ma(t))}function vG(t,e){this.hot.hasHook("modifyFiltersMultiSelectValue")&&(t.visualValue=this.hot.runHooks("modifyFiltersMultiSelectValue",t.visualValue,e.get(t.value)))}function DRe(t,e){switch(e.type){case"numeric":return SK(t,e);default:return t}}var D8;function LRe(t,e){kRe(t,e),e.add(t)}function kRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $Re(t,e,n){return(e=VRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VRe(t){var e=BRe(t,"string");return typeof e=="symbol"?e:e+""}function BRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function FRe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var wG=new WeakSet;class _w extends ey{static get BUTTON_OK(){return"ok"}static get BUTTON_CANCEL(){return"cancel"}constructor(e,n){super(e,{id:n.id,stateless:!0}),LRe(this,wG),$Re(this,"name",""),this.name=n.name,this.elements.push(new $c(this.hot,{type:"button",value:gD,className:"htUIButton htUIButtonOK",identifier:_w.BUTTON_OK})),this.elements.push(new $c(this.hot,{type:"button",value:mD,className:"htUIButton htUIButtonCancel",identifier:_w.BUTTON_CANCEL})),this.registerHooks()}registerHooks(){U(this.elements,e=>{e.addLocalHook("click",(n,i)=>FRe(wG,this,WRe).call(this,n,i))})}getMenuItemDescriptor(){return{key:this.id,name:this.name,isCommand:!1,disableSelection:!0,hidden:()=>this.isHidden(),renderer:(e,n)=>(fe(n.parentNode,"htFiltersMenuActionBar"),U(this.elements,i=>n.appendChild(i.element)),n)}}accept(){this.runLocalHooks("accept")}cancel(){this.runLocalHooks("cancel")}}D8=_w;function WRe(t,e){e.options.identifier===D8.BUTTON_OK?this.accept():this.cancel()}function jO(t,e,n){return(e=jRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jRe(t){var e=zRe(t,"string");return typeof e=="symbol"?e:e+""}function zRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const yG="ConditionCollection.filteringStates";class wL{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;jO(this,"hot",void 0),jO(this,"isMapRegistrable",void 0),jO(this,"filteringStates",new _R),this.hot=e,this.isMapRegistrable=n,this.isMapRegistrable===!0?this.hot.columnIndexMapper.registerMap(yG,this.filteringStates):this.filteringStates.init(this.hot.columnIndexMapper.getNumberOfIndexes())}isEmpty(){return this.getFilteredColumns().length===0}isMatch(e,n){var i;const r=this.filteringStates.getValueAtIndex(n),o=(i=r?.conditions)!==null&&i!==void 0?i:[],a=r?.operation;return this.isMatchInConditions(o,e,a)}isMatchInConditions(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:kc;return e.length?L0e(i)(e,n):!0}addCondition(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:kc,r=arguments.length>3?arguments[3]:void 0;const o=this.hot.getCellMeta(0,e).locale,a=n.args.map(g=>typeof g=="string"?g.toLocaleLowerCase(o):g),u=n.name||n.command.key;this.runLocalHooks("beforeAdd",e);const h=this.getOperation(e);if(h){if(h!==i)throw Error(Ft`The column of index ${e} has been already applied with a \`${h}\`\x20
        filter operation. Use \`removeConditions\` to clear the current conditions and then add new ones.\x20
        Mind that you cannot mix different types of operations (for instance, if you use \`conjunction\`,\x20
        use it consequently for a particular column).`)}else if($n(Cw[i]))throw new Error(Ft`Unexpected operation named \`${i}\`. Possible ones are\x20
        \`disjunction\` and \`conjunction\`.`);const d=this.getConditions(e);d.length===0?this.filteringStates.setValueAtIndex(e,{operation:i,conditions:[{name:u,args:a,func:Vc(u,a)}]},r):d.push({name:u,args:a,func:Vc(u,a)}),this.runLocalHooks("afterAdd",e)}getConditions(e){var n,i;return(n=(i=this.filteringStates.getValueAtIndex(e))===null||i===void 0?void 0:i.conditions)!==null&&n!==void 0?n:[]}getOperation(e){var n;return(n=this.filteringStates.getValueAtIndex(e))===null||n===void 0?void 0:n.operation}getFilteredColumns(){return this.filteringStates.getEntries().map(e=>{let[n]=e;return n})}getColumnStackPosition(e){return this.getFilteredColumns().indexOf(e)}exportAllConditions(){return this.filteringStates.getEntries().reduce((e,n)=>{let[i,{operation:r,conditions:o}]=n;return e.push({column:i,operation:r,conditions:o.map(a=>{let{name:u,args:h}=a;return{name:u,args:[...h]}})}),e},[])}importAllConditions(e){this.clean(),e.forEach(n=>{n.conditions.forEach(i=>this.addCondition(n.column,i))})}removeConditions(e){this.runLocalHooks("beforeRemove",e),this.filteringStates.clearValue(e),this.runLocalHooks("afterRemove",e)}clean(){this.runLocalHooks("beforeClean"),this.filteringStates.clear(),this.runLocalHooks("afterClean")}hasConditions(e,n){const i=this.getConditions(e);return n?i.some(r=>r.name===n):i.length>0}destroy(){this.isMapRegistrable&&this.hot.columnIndexMapper.unregisterMap(yG),this.filteringStates=null,this.clearLocalHooks()}}en(wL,Fi);function SG(t,e,n){return(e=URe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function URe(t){var e=YRe(t,"string");return typeof e=="symbol"?e:e+""}function YRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class L8{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:()=>[];SG(this,"conditionCollection",void 0),SG(this,"columnDataFactory",void 0),this.conditionCollection=e,this.columnDataFactory=n}filter(){let e=[];return U(this.conditionCollection.getFilteredColumns(),(n,i)=>{let r=this.columnDataFactory(n);i&&(r=this._getIntersectData(r,e)),e=this.filterByColumn(n,r)}),e}filterByColumn(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=[];return U(n,r=>{r!==void 0&&this.conditionCollection.isMatch(r,e)&&i.push(r)}),i}_getIntersectData(e,n){const i=[];return U(n,r=>{const o=r.meta.visualRow;e[o]!==void 0&&(i[o]=e[o])}),i}}function GRe(t,e){qRe(t,e),e.add(t)}function qRe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ph(t,e,n){return(e=KRe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KRe(t){var e=XRe(t,"string");return typeof e=="symbol"?e:e+""}function XRe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function zO(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Rb=new WeakSet;class k8{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:()=>[];GRe(this,Rb),Ph(this,"hot",void 0),Ph(this,"conditionCollection",void 0),Ph(this,"columnDataFactory",void 0),Ph(this,"changes",[]),Ph(this,"grouping",!1),Ph(this,"latestEditedColumnPosition",-1),Ph(this,"latestOrderStack",[]),this.hot=e,this.conditionCollection=n,this.columnDataFactory=i,this.conditionCollection.addLocalHook("beforeRemove",r=>zO(Rb,this,ZRe).call(this,r)),this.conditionCollection.addLocalHook("afterRemove",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("afterAdd",r=>this.updateStatesAtColumn(r)),this.conditionCollection.addLocalHook("beforeClean",()=>zO(Rb,this,QRe).call(this)),this.conditionCollection.addLocalHook("afterClean",()=>zO(Rb,this,JRe).call(this))}groupChanges(){this.grouping=!0}flush(){this.grouping=!1,U(this.changes,e=>{this.updateStatesAtColumn(e)}),this.changes.length=0}updateStatesAtColumn(e,n){var i=this;if(this.grouping){this.changes.indexOf(e)===-1&&this.changes.push(e);return}const r=this.conditionCollection.exportAllConditions();let o=this.conditionCollection.getColumnStackPosition(e);o===-1&&(o=this.latestEditedColumnPosition);const a=r.slice(0,o),u=r.slice(o);u.length&&u[0].column===e&&u.shift();const h=Gse(function(g,m){let v=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[];const y=new wL(i.hot,!1),b=[].concat(g,v);y.importAllConditions(b);const C=i.columnDataFactory(m);let T;y.isEmpty()?T=C:T=new L8(y,A=>i.columnDataFactory(A)).filter(),T=Vt(T,A=>A.meta.visualRow);const O=ty(T);return y.destroy(),Rd(C,A=>O(A.meta.visualRow))})(a),d=[].concat(this.conditionCollection.getConditions(e));this.runLocalHooks("update",{editedConditionStack:{column:e,conditions:d},dependentConditionStacks:u,filteredRowsFactory:h,conditionArgsChange:n})}destroy(){this.clearLocalHooks(),wt(this,(e,n)=>{this[n]=null})}}function ZRe(t){this.latestEditedColumnPosition=this.conditionCollection.getColumnStackPosition(t)}function QRe(){this.latestOrderStack=this.conditionCollection.getFilteredColumns()}function JRe(){U(this.latestOrderStack,t=>{this.updateStatesAtColumn(t)})}en(k8,Fi);function eEe(t){return uL({initialPage:0,size:()=>t.length,onItemSelect:(n,i)=>{const r=t[n];if(r instanceof Tw)return i;if(r.element&&!Qg(r.element))return!1;r.focus()}})}const dv="filters";function tEe(t,e){let n=-1,i;const r=eEe(e),o=m=>()=>{i.isOpened()&&i.getKeyboardShortcutsCtrl().listen(dv),r.setCurrentPage(e.indexOf(m))};e.forEach(m=>{m instanceof la&&(m.addLocalHook("click",o(m)),m.addLocalHook("focus",o(m)),m.addLocalHook("afterClose",o(m)))}),h(t);function a(m){const v=i.getKeyboardShortcutsCtrl(),y=m.getKeyboardShortcutsCtrl();r.clear(),y.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],forwardToContext:v.getContext(dv),callback:()=>{m.isSubMenu()&&m.close(),v.listen(dv)}}]),!m.isSubMenu()&&v.addCustomShortcuts([{keys:[["Tab"],["Shift","Tab"]],callback:b=>{const C=i.getNavigator();C.getCurrentPage()>-1&&(n=C.getCurrentPage()),C.clear(),b.shiftKey?r.toPreviousItem():r.toNextItem()}},{keys:[["Escape"]],callback:()=>{i.close()}},{keys:[["Enter"],["Space"]],preventDefault:!1,callback:b=>{const C=e[r.getCurrentPage()];C instanceof Rw&&(C.openOptions(),b.preventDefault()),C instanceof Ew&&(C.activate(),b.preventDefault()),C instanceof la||b.preventDefault()}}],dv)}function u(){i.focus(),i.getKeyboardShortcutsCtrl().listen(dv)}function h(m){m.addLocalHook("afterSelectionChange",v=>{v.key.startsWith("filter_")||r.clear()}),m.addLocalHook("afterSubmenuOpen",a),m.addLocalHook("afterOpen",a),i=m}function d(){return i}function g(){return n}return{...r,listen:u,setMenu:h,getMenu:d,getLastMenuPage:g}}function nEe(t,e){$8(t,e),e.add(t)}function UO(t,e,n){$8(t,e),e.set(t,n)}function $8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function fv(t,e,n){return(e=iEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function iEe(t){var e=rEe(t,"string");return typeof e=="symbol"?e:e+""}function rEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function xC(t,e,n){return t.set(to(t,e),n),n}function ys(t,e){return t.get(to(t,e))}function to(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const gI="filters",oEe=250,bG=gI;var jl=new WeakMap,mI=new WeakMap,ad=new WeakMap,Ro=new WeakSet;class sEe extends Dt{static get PLUGIN_KEY(){return gI}static get PLUGIN_PRIORITY(){return oEe}static get PLUGIN_DEPS(){return["plugin:DropdownMenu","plugin:HiddenRows","cell-type:checkbox"]}constructor(e){var n;super(e),n=this,nEe(this,Ro),fv(this,"dropdownMenuPlugin",null),fv(this,"conditionCollection",null),fv(this,"conditionUpdateObserver",null),fv(this,"components",new Map([["filter_by_condition",null],["filter_operators",null],["filter_by_condition2",null],["filter_by_value",null],["filter_action_bar",null]])),fv(this,"filtersRowsMap",null),UO(this,jl,void 0),UO(this,mI,new WeakSet),UO(this,ad,[]),this.hot.addHook("afterGetColHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return to(Ro,n,fEe).call(n,...r)})}isEnabled(){return!!this.hot.getSettings()[gI]}enablePlugin(){var e=this;if(this.enabled)return;this.filtersRowsMap=this.hot.rowIndexMapper.registerMap(this.pluginName,new Uw),this.dropdownMenuPlugin=this.hot.getPlugin("dropdownMenu");const n=this.hot.getSettings().dropdownMenu,i=n&&n.uiContainer||this.hot.rootPortalElement,r=u=>(u.addLocalHook("accept",()=>to(Ro,this,CG).call(this,"accept")),u.addLocalHook("cancel",()=>to(Ro,this,CG).call(this,"cancel")),u.addLocalHook("change",h=>to(Ro,this,dEe).call(this,u,h)),u),o=()=>`${this.hot.getTranslatedPhrase(uD)}:`,a=()=>`${this.hot.getTranslatedPhrase(cD)}:`;if(!this.components.get("filter_by_condition")){const u=new fI(this.hot,{id:"filter_by_condition",name:o,addSeparator:!1,menuContainer:i});u.addLocalHook("afterClose",()=>to(Ro,this,RG).call(this)),this.components.set("filter_by_condition",r(u))}if(this.components.get("filter_operators")||this.components.set("filter_operators",new pRe(this.hot,{id:"filter_operators",name:"Operators"})),!this.components.get("filter_by_condition2")){const u=new fI(this.hot,{id:"filter_by_condition2",name:"",addSeparator:!0,menuContainer:i});u.addLocalHook("afterClose",()=>to(Ro,this,RG).call(this)),this.components.set("filter_by_condition2",r(u))}if(this.components.get("filter_by_value")||this.components.set("filter_by_value",r(new PRe(this.hot,{id:"filter_by_value",name:a}))),this.components.get("filter_action_bar")||this.components.set("filter_action_bar",r(new _w(this.hot,{id:"filter_action_bar",name:"Action bar"}))),this.conditionCollection||(this.conditionCollection=new wL(this.hot)),this.conditionUpdateObserver||(this.conditionUpdateObserver=new k8(this.hot,this.conditionCollection,u=>this.getDataMapAtColumn(u)),this.conditionUpdateObserver.addLocalHook("update",u=>to(Ro,this,gEe).call(this,u))),this.components.forEach(u=>u.show()),this.addHook("afterDropdownMenuDefaultOptions",function(){for(var u=arguments.length,h=new Array(u),d=0;d<u;d++)h[d]=arguments[d];return to(Ro,e,hEe).call(e,...h)}),this.addHook("beforeDropdownMenuShow",()=>to(Ro,this,cEe).call(this)),this.addHook("afterDropdownMenuShow",()=>to(Ro,this,lEe).call(this)),this.addHook("afterDropdownMenuHide",()=>to(Ro,this,uEe).call(this)),this.addHook("afterChange",u=>to(Ro,this,aEe).call(this,u)),this.hot.getSettings().dropdownMenu&&this.dropdownMenuPlugin&&(this.dropdownMenuPlugin.disablePlugin(),this.dropdownMenuPlugin.enablePlugin()),!ys(jl,this)&&this.dropdownMenuPlugin.enabled){const u=[{focus:()=>{const d=ys(jl,this).getMenu(),g=d.getNavigator(),m=ys(jl,this).getLastMenuPage();d.focus(),m>0?g.setCurrentPage(m):g.toFirstItem()}},...Array.from(this.components).map(d=>{let[,g]=d;return g.getElements()}).flat()];xC(jl,this,tEe(this.dropdownMenuPlugin.menu,u));const h=d=>{ys(jl,this).listen(),d.preventDefault(),Ww(d.keyCode,"TAB")&&(d.shiftKey?ys(jl,this).toPreviousItem():ys(jl,this).toNextItem())};this.components.get("filter_by_value").addLocalHook("listTabKeydown",h),this.components.get("filter_by_condition").addLocalHook("selectTabKeydown",h)}this.registerShortcuts(),super.enablePlugin()}disablePlugin(){if(this.enabled){var e;(e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled&&this.dropdownMenuPlugin.menu.clearLocalHooks(),this.components.forEach((n,i)=>{n.destroy(),this.components.set(i,null)}),this.conditionCollection.destroy(),this.conditionCollection=null,this.hot.rowIndexMapper.unregisterMap(this.pluginName)}this.unregisterShortcuts(),super.disablePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Alt","A"]],stopPropagation:!0,callback:()=>{const e=this.hot.getSelected();this.clearConditions(),this.filter(),e&&this.hot.selectCells(e)},group:bG})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(bG)}addCondition(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:kc;const o=this.hot.toPhysicalColumn(e);this.conditionCollection.addCondition(o,{command:{key:n},args:i},r)}removeConditions(e){const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}clearConditions(e){if(e===void 0)this.conditionCollection.clean();else{const n=this.hot.toPhysicalColumn(e);this.conditionCollection.removeConditions(n)}}importConditions(e){this.conditionCollection.importAllConditions(e)}exportConditions(){return this.conditionCollection.exportAllConditions()}filter(){const{navigableHeaders:e}=this.hot.getSettings(),n=this._createDataFilter(),i=!this.conditionCollection.isEmpty();let r=[];const o=this.exportConditions(),a=this.hot.runHooks("beforeFilter",o,ys(ad,this));if(a!==!1&&i){const u=[];this.hot.batchExecution(()=>{this.filtersRowsMap.clear(),r=Vt(n.filter(),d=>d.meta.visualRow);const h=ty(r);ze(this.hot.countSourceRows()-1,d=>{h(d)||u.push(d)}),U(u,d=>{this.filtersRowsMap.setValueAtIndex(d,!0)})},!0),!e&&!r.length&&this.hot.deselectCell(),xC(ad,this,this.exportConditions())}else a!==!1&&!i?(xC(ad,this,this.exportConditions()),this.filtersRowsMap.clear()):this.importConditions(ys(ad,this));this.hot.selection.isSelected()&&this.hot.selectCell(e?-1:0,this.hot.getSelectedRangeActive().highlight.col),a!==!1&&(this.hot.runHooks("afterFilter",o),this.hot.view.adjustElementsSize(),this.hot.render())}getSelectedColumn(){var e;const n=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return n?{visualIndex:n.col,physicalIndex:this.hot.toPhysicalColumn(n.col)}:null}getDataMapAtColumn(e){const n=this.hot.toVisualColumn(e),i=[];return U(this.hot.getSourceDataAtCol(n),(r,o)=>{var a;const{row:u,col:h,visualCol:d,visualRow:g,type:m,instance:v,dateFormat:y,locale:b}=this.hot.getCellMeta(o,n),C=(a=this.hot.getDataAtCell(this.hot.toVisualRow(o),n))!==null&&a!==void 0?a:r;i.push({meta:{row:u,col:h,visualCol:d,visualRow:g,type:m,instance:v,dateFormat:y,locale:b},value:gL(C)})}),i}updateValueComponentCondition(e){const n=this.hot.getDataAtCol(e),i=dI(n);this.conditionUpdateObserver.updateStatesAtColumn(e,i)}restoreComponents(e){var n;const i=(n=this.getSelectedColumn())===null||n===void 0?void 0:n.physicalIndex;e.forEach(r=>{r.isHidden()||r.restoreState(i)}),this.updateDependentComponentsVisibility()}getOperationBasedOnArguments(e,n,i,r){let o=e;return o===C0&&n.command.key!==Xi&&i.command.key!==Xi&&r.command.key!==Xi?o=pL:r.command.key!==Xi&&(n.command.key===Xi||i.command.key===Xi)&&(o=kc),o}setListeningDropdownMenu(){this.dropdownMenuPlugin&&this.dropdownMenuPlugin.setListening()}updateDependentComponentsVisibility(){const e=this.components.get("filter_by_condition"),{command:n}=e.getState(),i=[this.components.get("filter_by_condition2"),this.components.get("filter_operators")];n.showOperators?this.showComponents(...i):this.hideComponents(...i)}_createDataFilter(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.conditionCollection;return new L8(e,n=>this.getDataMapAtColumn(n))}getIndexesOfComponents(){const e=[];if(!this.dropdownMenuPlugin)return e;const n=this.dropdownMenuPlugin.menu;for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return U(r,a=>{U(n.menuItems,(u,h)=>{u.key===a.getMenuItemDescriptor().key&&e.push(h)})}),e}changeComponentsVisibility(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;if(!this.dropdownMenuPlugin)return;const i=this.dropdownMenuPlugin.menu.hotMenu,r=i.getPlugin("hiddenRows");for(var o=arguments.length,a=new Array(o>1?o-1:0),u=1;u<o;u++)a[u-1]=arguments[u];const h=this.getIndexesOfComponents(...a);e?r.showRows(h):r.hideRows(h),i.render()}hideComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!1,...n)}showComponents(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.changeComponentsVisibility(!0,...n)}destroy(){this.enabled&&(this.components.forEach((e,n)=>{e!==null&&(e.destroy(),this.components.set(n,null))}),this.conditionCollection.destroy(),this.conditionUpdateObserver.destroy(),this.hot.rowIndexMapper.unregisterMap(this.pluginName)),super.destroy()}}function aEe(t){t&&U(t,e=>{const[,n]=e,i=this.hot.propToCol(n);this.conditionCollection.hasConditions(i)&&this.updateValueComponentCondition(i)})}function lEe(){const t=this.dropdownMenuPlugin.menu;this.restoreComponents(Array.from(this.components.values())),t.updateMenuDimensions()}function uEe(){this.components.get("filter_by_condition").getSelectElement().closeOptions(),this.components.get("filter_by_condition2").getSelectElement().closeOptions()}function cEe(){const t=this.dropdownMenuPlugin.menu;ys(mI,this).has(t)||ys(jl,this).setMenu(t),ys(mI,this).add(t)}function hEe(t){t.items.push({name:vt}),this.components.forEach(e=>{t.items.push(e.getMenuItemDescriptor())})}function CG(t){var e;if(t==="accept"){const i=this.getSelectedColumn();if(i===null){var n;(n=this.dropdownMenuPlugin)===null||n===void 0||n.close();return}const{physicalIndex:r}=i,o=this.components.get("filter_by_condition").getState(),a=this.components.get("filter_by_condition2").getState(),u=this.components.get("filter_by_value").getState(),h=this.getOperationBasedOnArguments(this.components.get("filter_operators").getActiveOperationId(),o,a,u);this.conditionUpdateObserver.groupChanges();let d=this.conditionCollection.getColumnStackPosition(r);d===-1&&(d=void 0),this.conditionCollection.removeConditions(r),o.command.key!==Xi&&(this.conditionCollection.addCondition(r,o,h,d),a.command.key!==Xi&&this.conditionCollection.addCondition(r,a,h,d)),u.command.key!==Xi&&this.conditionCollection.addCondition(r,u,h,d),this.conditionUpdateObserver.flush(),this.components.forEach(g=>g.saveState(r)),this.filter()}(e=this.dropdownMenuPlugin)===null||e===void 0||e.close()}function dEe(t,e){const n=this.dropdownMenuPlugin.menu;this.updateDependentComponentsVisibility(),t.constructor===fI&&!e.inputsCount&&this.setListeningDropdownMenu(),n.updateMenuDimensions()}function RG(){this.setListeningDropdownMenu()}function fEe(t,e,n){const i=this.hot.toPhysicalColumn(t);this.enabled&&this.conditionCollection.hasConditions(i)&&n===this.hot.view.getColumnHeadersCount()-1?fe(e,"htFiltersActive"):Ve(e,"htFiltersActive")}function gEe(t){var e;if(!((e=this.dropdownMenuPlugin)!==null&&e!==void 0&&e.enabled))return;const{editedConditionStack:{conditions:n,column:i},conditionArgsChange:r}=t;Array.isArray(r)&&xC(ad,this,ys(ad,this).map(u=>(u.column===i&&n.length>0&&u.conditions.forEach(h=>{h.name==="by_value"&&(h.args=[[...r]])}),u)));const o=n.filter(u=>u.name===md),a=n.filter(u=>u.name!==md);if(o.length>=2||a.length>=3)_t(Ft`The filter conditions have been applied properly, but couldn’t be displayed visually.\x20
        The overall amount of conditions exceed the capability of the dropdown menu.\x20
        For more details see the documentation.`);else{const u=this.conditionCollection.getOperation(i);this.components.get("filter_by_condition").updateState(a[0],i),this.components.get("filter_by_condition2").updateState(a[1],i),this.components.get("filter_operators").updateState(u,i),this.components.get("filter_by_value").updateState(t)}}const V8="internal-use-in-handsontable",pI={licenseKey:V8,useArrayArithmetic:!0,useColumnIndex:!1,useStats:!1,evaluateNullToZero:!0,precisionEpsilon:1e-13,precisionRounding:14,smartRounding:!0,leapYear1900:!1,nullDate:{year:1899,month:12,day:30},nullYear:30,dateFormats:["DD/MM/YYYY","DD/MM/YY"],timeFormats:["hh:mm","hh:mm:ss.sss"],matchWholeCell:!0,useRegularExpressions:!1,useWildcards:!0,functionArgSeparator:",",thousandSeparator:"",decimalSeparator:".",language:"enGB"};function B8(t){var e;return{maxColumns:t.maxColumns,maxRows:t.maxRows,language:(e=t[mr])===null||e===void 0||(e=e.language)===null||e===void 0?void 0:e.langCode}}function F8(t){return Object.keys(t).reduce((e,n)=>(n!=="hyperformula"&&(e[n]=t[n]),e),{})}function mEe(t){var e;const n=t[mr],i=F8(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=B8(t);return{...pI,...i,...r}}function pEe(t){var e;const n=t[mr],i=F8(n!=null&&(e=n.engine)!==null&&e!==void 0&&e.hyperformula?n.engine:{}),r=B8(t);return{...i,...r}}function vEe(t,e){return Object.keys(e).some(n=>e[n]!==void 0&&e[n]!==t[n])}function qR(){const t="engine_relationship",e=Ps(mr);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function yL(){const t="shared_engine_usage",e=Ps(mr);return e.hasItem(t)||e.register(t,new Map),e.getItem(t)}function wEe(t){const e=t.getSettings(),n=e[mr],i=n?.engine;if(n===!0||$n(i))return null;if(typeof i.hyperformula=="function"||typeof i=="function"){var r;return yEe((r=i.hyperformula)!==null&&r!==void 0?r:i,e,t)}else if(typeof i=="object"&&$n(i.hyperformula)){const o=qR(),a=yL().get(i);return o.has(i)||o.set(i,[]),o.get(i).push(t),a&&a.push(t.guid),i.getConfig().licenseKey||i.updateConfig({licenseKey:V8}),(i.getConfig().leapYear1900!==pI.leapYear1900||pR(i.getConfig().nullDate,pI.nullDate)===!1)&&_t(Ft`If you use HyperFormula with Handsontable, keep the default \`leapYear1900\` and \`nullDate\` 
      settings. Otherwise, HyperFormula's dates may not sync correctly with Handsontable's dates.`),i}return null}function yEe(t,e,n){const i=e[mr],r=mEe(e),o=qR(),a=yL();SEe(t,i.functions),bEe(t,i.language);const u=t.buildEmpty(r);return o.set(u,[n]),a.set(u,[n.guid]),CEe(u,i.namedExpressions),u.on("sheetAdded",()=>{u.rebuildAndRecalculate()}),u.on("sheetRemoved",()=>{u.rebuildAndRecalculate()}),u}function EG(t){var e;const n=qR(),i=n.size===0?[]:Array.from((e=n.get(t))!==null&&e!==void 0?e:[]);return new Map(i.map(r=>[r.getPlugin("formulas").sheetId,r]))}function TG(t,e){if(t){const n=qR(),i=n.get(t),r=yL(),o=r.get(t);i&&i.includes(e)&&(i.splice(i.indexOf(e),1),i.length===0&&n.delete(t)),o&&o.includes(e.guid)&&(o.splice(o.indexOf(e.guid),1),o.length===0&&(r.delete(t),t.destroy()))}}function SEe(t,e){e&&e.forEach(n=>{const{name:i,plugin:r,translations:o}=n;try{t.registerFunction(i,r,o)}catch(a){_t(a.message)}})}function bEe(t,e){if(e){const{langCode:n}=e;try{t.registerLanguage(n,e)}catch(i){_t(i.message)}}}function CEe(t,e){e&&(t.suspendEvaluation(),e.forEach(n=>{const{name:i,expression:r,scope:o,options:a}=n;try{t.addNamedExpression(i,r,o,a)}catch(u){_t(u.message)}}),t.resumeEvaluation())}function REe(t,e){return($n(e)||!t.doesSheetExist(e))&&(e=t.addSheet(e)),e}const W8="DD/MM/YYYY";function EEe(t){return typeof t=="string"&&t.charAt(0)==="'"&&t.charAt(1)==="="}function TEe(t){return EEe(t)?t.substr(1):t}function _Ee(t){return typeof t=="string"&&t.startsWith("=")}function SL(t,e){return typeof t=="string"&&e==="date"}function j8(t,e){return Ce(t,e,!0).isValid()}function z8(t,e){return Ce(t,e,!0).format(W8)}function MEe(t,e){return Ce(t,W8,!0).format(e)}function U8(t,e){const i=new Date(Date.UTC(0,0,t+-1));return Ce(i).format(e)}function AEe(t,e,n){const i=Array.from(Array(n).keys()).filter(o=>t.includes(o)===!1);if(e===0){var r;return(r=i[e])!==null&&r!==void 0?r:0}return i[e-1]+1}function OEe(t,e){const n=[];return t.forEach(i=>{const r={from:i,to:e};n.forEach(o=>{const a=o.from>o.to,u=o.to<=r.from;o.from>r.from&&u&&a&&(r.from+=1)}),r.from>=e&&(e+=1),n.push(r)}),n}function xEe(t){return t.forEach((e,n)=>{t.slice(n+1).forEach(r=>{const o=r.from<r.to;r.from>e.from&&o&&(r.from-=1)})}),t}function bL(t,e,n){const i=OEe(t,AEe(t,e,n));return xEe(i)}function Nh(t,e,n){HEe(t,e),e.set(t,n)}function HEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function On(t,e){return t.get(Y8(t,e))}function uc(t,e,n){return t.set(Y8(t,e),n),n}function Y8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var gv=new WeakMap,cc=new WeakMap,Eo=new WeakMap,Eb=new WeakMap,YO=new WeakMap,GO=new WeakMap,Tb=new WeakMap;class _G{constructor(e,n,i){Nh(this,gv,void 0),Nh(this,cc,void 0),Nh(this,Eo,void 0),Nh(this,Eb,[]),Nh(this,YO,[]),Nh(this,GO,void 0),Nh(this,Tb,[]),uc(gv,this,e),uc(cc,this,n),uc(Eo,this,i)}setRemovedHfIndexes(e){return uc(Tb,this,e.map(n=>{const i=On(cc,this).getVisualFromPhysicalIndex(n);return this.getHfIndexFromVisualIndex(i)})),On(Tb,this)}getRemovedHfIndexes(){return On(Tb,this)}getHfIndexFromVisualIndex(e){const n=On(cc,this).getIndexesSequence(),i=On(cc,this).getNotTrimmedIndexes();return n.indexOf(i[e],e)}syncMoves(e){const i=`move${ha(On(gv,this))}s`;On(Eo,this).getEngine().batch(()=>{e.forEach(r=>{const o=r.from!==r.to,a=r.from+1!==r.to;o&&a&&On(Eo,this).getEngine()[i](On(Eo,this).getSheetId(),r.from,1,r.to)})})}storeMovesInformation(e,n,i){i!==!1&&(uc(YO,this,e.map(r=>this.getHfIndexFromVisualIndex(r))),uc(GO,this,this.getHfIndexFromVisualIndex(n)))}calculateAndSyncMoves(e,n){if(On(Eo,this).isPerformingUndoRedo()||e===!1||n===!1)return;const i=bL(On(YO,this),On(GO,this),On(cc,this).getNumberOfIndexes());On(Eo,this).getSheetId()===null?On(Eo,this).getPostponeAction(()=>this.syncMoves(i)):this.syncMoves(i)}getIndexesChangeSyncMethod(){const e=`set${ha(On(gv,this))}Order`;return n=>{if(On(Eo,this).isPerformingUndoRedo())return;const i=On(cc,this).getIndexesSequence();if(n==="update"&&i.length>0){const r=On(Eb,this).map(h=>i.indexOf(h)),o=On(Eo,this).getEngine().getSheetDimensions(On(Eo,this).getSheetId());let a;On(gv,this)==="row"?a=o.height:a=o.width;const u=r.length;for(let h=u;h<a;h+=1)r.push(h);On(Eo,this).getEngine()[e](On(Eo,this).getSheetId(),r)}uc(Eb,this,i)}}init(){uc(Eb,this,On(cc,this).getIndexesSequence())}}function Dh(t,e,n){IEe(t,e),e.set(t,n)}function IEe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Vl(t,e){return t.get(G8(t,e))}function Lh(t,e,n){return t.set(G8(t,e),n),n}function G8(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var _b=new WeakMap,Mb=new WeakMap,qO=new WeakMap,KO=new WeakMap,XO=new WeakMap,ZO=new WeakMap,QO=new WeakMap;class PEe{constructor(e,n,i){Dh(this,_b,void 0),Dh(this,Mb,void 0),Dh(this,qO,void 0),Dh(this,KO,!1),Dh(this,XO,!1),Dh(this,ZO,null),Dh(this,QO,null),Lh(_b,this,new _G("row",e,this)),Lh(Mb,this,new _G("column",n,this)),Lh(qO,this,i)}getForAxis(e){return e==="row"?Vl(_b,this):Vl(Mb,this)}setPerformUndo(e){Lh(KO,this,e)}setPerformRedo(e){Lh(XO,this,e)}isPerformingUndoRedo(){return Vl(KO,this)||Vl(XO,this)}getSheetId(){return Vl(QO,this)}getEngine(){return Vl(ZO,this)}getPostponeAction(){return Vl(qO,this)}setupSyncEndpoint(e,n){Lh(ZO,this,e),Lh(QO,this,n),Vl(_b,this).init(),Vl(Mb,this).init()}}function NEe(t,e){q8(t,e),e.add(t)}function kh(t,e,n){return(e=DEe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function DEe(t){var e=LEe(t,"string");return typeof e=="symbol"?e:e+""}function LEe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function JO(t,e,n){q8(t,e),e.set(t,n)}function q8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bc(t,e,n){return t.set(dt(t,e),n),n}function Cd(t,e){return t.get(dt(t,e))}function dt(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const mr="formulas",kEe=["maxRows","maxColumns","language"],$Ee=260;He.getSingleton().register("afterNamedExpressionAdded");He.getSingleton().register("afterNamedExpressionRemoved");He.getSingleton().register("afterSheetAdded");He.getSingleton().register("afterSheetRemoved");He.getSingleton().register("afterSheetRenamed");He.getSingleton().register("afterFormulasValuesUpdate");const Mm=t=>t==="UndoRedo.undo"||t==="UndoRedo.redo"||t==="auto";var mu=new WeakMap,KR=new WeakMap,mv=new WeakMap,mt=new WeakSet;class VEe extends Dt{constructor(){var e;super(...arguments),e=this,NEe(this,mt),JO(this,mu,!1),JO(this,KR,!1),JO(this,mv,[["valuesUpdated",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dt(mt,e,tTe).call(e,...i)}],["namedExpressionAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dt(mt,e,nTe).call(e,...i)}],["namedExpressionRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dt(mt,e,iTe).call(e,...i)}],["sheetAdded",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dt(mt,e,rTe).call(e,...i)}],["sheetRenamed",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dt(mt,e,oTe).call(e,...i)}],["sheetRemoved",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return dt(mt,e,sTe).call(e,...i)}]]),kh(this,"staticRegister",Ps("formulas")),kh(this,"engine",null),kh(this,"sheetId",null),kh(this,"sheetName",null),kh(this,"indexSyncer",null),kh(this,"rowAxisSyncer",null),kh(this,"columnAxisSyncer",null)}static get PLUGIN_KEY(){return mr}static get PLUGIN_PRIORITY(){return $Ee}static get SETTING_KEYS(){return[mr,...kEe]}isEnabled(){return!!this.hot.getSettings()[mr]}enablePlugin(){var e,n=this;if(!this.enabled){if(this.engine=(e=wEe(this.hot))!==null&&e!==void 0?e:this.engine,!this.engine){_t("Missing the required `engine` key in the Formulas settings. Please fill it with either an engine class or an engine instance.");return}if(this.sheetName!==null&&!this.engine.doesSheetExist(this.sheetName)){const i=this.addSheet(this.sheetName,dt(mt,this,Mw).call(this));i!==!1&&dt(mt,this,Uv).call(this,i)}this.addHook("beforeLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,MG).call(n,...r)}),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,AG).call(n,...r)}),this.addHook("beforeUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,MG).call(n,...r)}),this.addHook("afterUpdateData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,AG).call(n,...r)}),this.addHook("modifyData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,jEe).call(n,...r)}),this.addHook("modifySourceData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,zEe).call(n,...r)}),this.addHook("beforeValidate",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,BEe).call(n,...r)}),this.addHook("afterSetSourceDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,UEe).call(n,...r)}),this.addHook("afterSetDataAtCell",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,OG).call(n,...r)}),this.addHook("afterSetDataAtRowProp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,OG).call(n,...r)}),this.addHook("beforeCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,YEe).call(n,...r)}),this.addHook("beforeCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,GEe).call(n,...r)}),this.addHook("afterCreateRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,XEe).call(n,...r)}),this.addHook("afterCreateCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,ZEe).call(n,...r)}),this.addHook("beforeRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,qEe).call(n,...r)}),this.addHook("beforeRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,KEe).call(n,...r)}),this.addHook("afterRemoveRow",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,QEe).call(n,...r)}),this.addHook("afterRemoveCol",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,JEe).call(n,...r)}),this.indexSyncer=new PEe(this.hot.rowIndexMapper,this.hot.columnIndexMapper,i=>{this.hot.addHookOnce("init",()=>{i()})}),this.rowAxisSyncer=this.indexSyncer.getForAxis("row"),this.columnAxisSyncer=this.indexSyncer.getForAxis("column"),this.hot.addHook("afterRowSequenceChange",this.rowAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("afterColumnSequenceChange",this.columnAxisSyncer.getIndexesChangeSyncMethod()),this.hot.addHook("beforeRowMove",(i,r,o,a)=>{this.rowAxisSyncer.storeMovesInformation(i,r,a)}),this.hot.addHook("beforeColumnMove",(i,r,o,a)=>{this.columnAxisSyncer.storeMovesInformation(i,r,a)}),this.hot.addHook("afterRowMove",(i,r,o,a,u)=>{this.rowAxisSyncer.calculateAndSyncMoves(a,u)}),this.hot.addHook("afterColumnMove",(i,r,o,a,u)=>{this.columnAxisSyncer.calculateAndSyncMoves(a,u)}),this.hot.addHook("beforeColumnFreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart,r)}),this.hot.addHook("afterColumnFreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.hot.addHook("beforeColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.storeMovesInformation([i],this.hot.getSettings().fixedColumnsStart-1,r)}),this.hot.addHook("afterColumnUnfreeze",(i,r)=>{this.columnAxisSyncer.calculateAndSyncMoves(r,r)}),this.addHook("afterCellMetaReset",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,WEe).call(n,...r)}),this.addHook("beforeUndo",()=>{this.indexSyncer.setPerformUndo(!0),this.engine.undo()}),this.addHook("beforeRedo",()=>{this.indexSyncer.setPerformRedo(!0),this.engine.redo()}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformUndo(!1)}),this.addHook("afterUndo",()=>{this.indexSyncer.setPerformRedo(!1)}),this.addHook("afterDetachChild",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,eTe).call(n,...r)}),this.addHook("beforeAutofill",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return dt(mt,n,FEe).call(n,...r)}),Cd(mv,this).forEach(i=>{let[r,o]=i;return this.engine.on(r,o)}),super.enablePlugin()}}disablePlugin(){Cd(mv,this).forEach(e=>{let[n,i]=e;return this.engine.off(n,i)}),TG(this.engine,this.hot),this.engine=null,super.disablePlugin()}updatePlugin(e){const n=pEe(this.hot.getSettings());vEe(this.engine.getConfig(),n)&&this.engine.updateConfig(n);const i=this.hot.getSettings()[mr];if(Ne(i)&&Ne(i.sheetName)&&i.sheetName!==this.sheetName&&this.switchSheet(i.sheetName),!e.data&&this.sheetName===null){const r=this.hot.getSettings()[mr].sheetName;if(r&&this.engine.doesSheetExist(r))this.switchSheet(this.sheetName);else{const o=this.addSheet(r??void 0,dt(mt,this,Mw).call(this));dt(mt,this,Uv).call(this,o)}}super.updatePlugin(e)}destroy(){Cd(mv,this).forEach(e=>{var n;let[i,r]=e;return(n=this.engine)===null||n===void 0?void 0:n.off(i,r)}),Bc(mv,this,null),TG(this.engine,this.hot),this.engine=null,super.destroy()}addSheet(e,n){if(Ne(n)&&!nhe(n))return _t("The provided data should be an array of arrays."),!1;if(e!=null&&this.engine.doesSheetExist(e))return _t("Sheet with the provided name already exists."),!1;try{const i=this.engine.addSheet(e??void 0);return n&&this.engine.setSheetContent(this.engine.getSheetId(i),n),i}catch(i){return _t(i.message),!1}}switchSheet(e){if(!this.engine.doesSheetExist(e)){OP(`The sheet named \`${e}\` does not exist, switch aborted.`);return}dt(mt,this,Uv).call(this,e);const n=this.engine.getSheetSerialized(this.sheetId);n.length>0&&this.hot.loadData(n,`${ha(mr)}.switchSheet`)}getCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;const r=this.hot.toPhysicalRow(e),o=this.hot.toPhysicalColumn(n);return r!==null&&o!==null?this.engine.getCellType({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)}):"EMPTY"}isFormulaCellType(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.sheetId;return this.engine.doesCellHaveFormula({sheet:i,row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n)})}renderDependentSheets(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=new Set;e.forEach(r=>{var o;const a=r==null||(o=r.address)===null||o===void 0?void 0:o.sheet;a!==void 0&&(i.has(a)||i.add(a))}),EG(this.engine).forEach((r,o)=>{if((n||o!==this.sheetId)&&i.has(o)){var a;r.render(),(a=r.view)===null||a===void 0||a.adjustElementsSize()}})}validateDependentCells(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];const i=o=>{var a;const{row:u,col:h,sheet:d}=(a=o?.address)!==null&&a!==void 0?a:{};return Ne(d)?`${d}:${u}x${h}`:""},r=new Set(n.map(o=>i(o)));e.forEach(o=>{var a,u;const{row:h,col:d}=(a=o.address)!==null&&a!==void 0?a:{};if(Ne(h)===!1||Ne(d)===!1||h>=this.hot.countRows()||d>=this.hot.countCols())return;const g=o==null||(u=o.address)===null||u===void 0?void 0:u.sheet,m=i(o);if(g!==void 0&&!r.has(m)){const v=EG(this.engine).get(g);if(!v)return;v.validateCell(v.getDataAtCell(h,d),v.getCellMeta(h,d),()=>{})}})}syncChangeWithEngine(e,n,i){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(n),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(r)){_t(`Not possible to set cell data at ${JSON.stringify(r)}`);return}const o=this.hot.getCellMeta(e,n);return SL(i,o.type)&&(j8(i,o.dateFormat)?i=z8(i,o.dateFormat):_Ee(i)===!1&&(i=`'${i}`)),this.engine.setCellContents(r,i)}}function Uv(t){this.sheetName=t,this.sheetId=this.engine.getSheetId(this.sheetName)}function K8(t,e,n){if(Qe(n)&&n!==null){const i=this.hot.toVisualRow(t),r=this.hot.toVisualColumn(e),o=this.hot.getCellMeta(i,r).valueGetter;return o?o.call(this.hot,n):n.toString()}return n}function Mw(t,e,n,i){return this.hot.getSourceDataArray(t,e,n,i).map((r,o)=>r.map((a,u)=>dt(mt,this,K8).call(this,o,u,a)))}function BEe(t,e,n){const i=this.hot.propToCol(n);if(this.isFormulaCellType(e,i)){const r={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(e),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(i),sheet:this.sheetId},o=this.hot.getCellMeta(e,i);let a=this.engine.getCellValue(r);return o.type==="date"&&Hr(a)&&(a=U8(a,o.dateFormat)),typeof a=="object"&&a!==null?a.value:a}return t}function FEe(t,e,n){const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:a}=e.getBottomEndCorner(),{row:u,col:h}=n.getTopStartCorner(),{row:d,col:g}=n.getBottomEndCorner(),m={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(i),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(r),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(a),sheet:this.sheetId}},v={start:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(u),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId},end:{row:this.rowAxisSyncer.getHfIndexFromVisualIndex(d),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(g),sheet:this.sheetId}};if(this.engine.isItPossibleToSetCellContents(v)===!1)return!1;const y=this.engine.getFillRangeData(m,v),{row:b,col:C}=m.start,{row:T,col:O}=m.end,A=T-b+1,N=O-C+1;for(let x=0;x<y.length;x+=1)for(let $=0;$<y[x].length;$+=1){const L=y[x][$],P=b+x%A,Q=C+$%N,ue=this.hot.getCellMeta(P,Q);SL(L,ue.type)&&(L.startsWith("'")?y[x][$]=L.slice(1):this.isFormulaCellType(P,Q,this.sheetId)===!1&&(y[x][$]=MEe(L,ue.dateFormat)))}return y}function MG(t,e){(arguments.length>2&&arguments[2]!==void 0?arguments[2]:"").includes(ha(mr))||Bc(KR,this,$n(this.hot.getSettings().data))}function WEe(){if(Cd(KR,this)){this.switchSheet(this.sheetName);return}const t=dt(mt,this,Mw).call(this);t.forEach((n,i)=>{n.forEach((r,o)=>{const a=this.hot.getCellMeta(i,o,{skipMetaExtension:!0}),u=a.dateFormat;SL(r,a.type)&&(j8(r,u)?t[i][o]=z8(r,u):r.startsWith("=")||(t[i][o]=`'${r}`))})}),Bc(mu,this,!0);const e=this.engine.setSheetContent(this.sheetId,t);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(e),Bc(mu,this,!1)}function AG(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";if(n.includes(ha(mr)))return;const i=REe(this.engine,this.hot.getSettings()[mr].sheetName);if(dt(mt,this,Uv).call(this,i),n!=="updateSettings")if(Cd(KR,this))this.switchSheet(this.sheetName);else{const r=dt(mt,this,Mw).call(this);if(this.engine.isItPossibleToReplaceSheetContent(this.sheetId,r)){Bc(mu,this,!0);const o=this.engine.setSheetContent(this.sheetId,r);this.indexSyncer.setupSyncEndpoint(this.engine,this.sheetId),this.renderDependentSheets(o),Bc(mu,this,!1)}}}function jEe(t,e,n,i){if(i!=="get"||Cd(mu,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName)||t===null||e===null)return;const r=this.getCellType(t,e);if(r==="VALUE"||r==="EMPTY"){n.value=TEe(n.value);return}const o={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(t),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(e),sheet:this.sheetId};let a=this.engine.getCellValue(o);const u=this.hot.getCellMeta(t,e,{skipMetaExtension:!0});u.type==="date"&&Hr(a)&&(a=U8(a,u.dateFormat)),n.value=typeof a=="object"&&a!==null?a.value:a}function zEe(t,e,n,i){if(i!=="get"||Cd(mu,this)||this.sheetName===null||!this.engine.doesSheetExist(this.sheetName))return;const r=this.hot.toVisualRow(t),o=this.hot.propToCol(e);if(r===null||o===null)return;const a=this.getCellType(r,o);if(a==="VALUE"||a==="EMPTY")return;const u=this.engine.getSheetDimensions(this.engine.getSheetId(this.sheetName));if(u.width===0&&u.height===0)return;const h={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(r),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(o),sheet:this.sheetId};n.value=this.engine.getCellSerialized(h)}function OG(t,e){if(Mm(e))return;const n=[],i=[],r=this.engine.batch(()=>{t.forEach(o=>{let[a,u,,h]=o;const d=this.hot.propToCol(u),g=this.hot.toPhysicalRow(a),m=this.hot.toPhysicalColumn(d),v={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(a),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(d),sheet:this.sheetId};h=dt(mt,this,K8).call(this,g,m,h),g!==null&&m!==null?this.syncChangeWithEngine(a,d,h):n.push([a,d,h]),i.push({address:v})})});n.length&&this.hot.addHookOnce("afterChange",()=>{const o=this.engine.batch(()=>{n.forEach(a=>{let[u,h,d]=a;this.syncChangeWithEngine(u,h,d)})});this.renderDependentSheets(o,!0)}),this.renderDependentSheets(r),this.validateDependentCells(r,i)}function UEe(t,e){if(Mm(e))return;const n=[],i=[];t.forEach(r=>{let[o,a,,u]=r;const h=this.hot.propToCol(a);if(!Hr(h))return;const d={row:this.rowAxisSyncer.getHfIndexFromVisualIndex(o),col:this.columnAxisSyncer.getHfIndexFromVisualIndex(h),sheet:this.sheetId};if(!this.engine.isItPossibleToSetCellContents(d)){_t(`Not possible to set source cell data at ${JSON.stringify(d)}`);return}i.push({address:d}),n.push(...this.engine.setCellContents(d,u))}),this.renderDependentSheets(n),this.validateDependentCells(n,i)}function YEe(t,e){let n=this.rowAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countRows()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddRows(this.sheetId,[n,e]))return!1}function GEe(t,e){let n=this.columnAxisSyncer.getHfIndexFromVisualIndex(t);if(t>=this.hot.countCols()&&(n=t),this.sheetId===null||!this.engine.doesSheetExist(this.sheetName)||!this.engine.isItPossibleToAddColumns(this.sheetId,[n,e]))return!1}function qEe(t,e,n){return this.rowAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveRows(this.sheetId,[o,1]))===!1?!1:void 0}function KEe(t,e,n){return this.columnAxisSyncer.setRemovedHfIndexes(n).every(o=>this.engine.isItPossibleToRemoveColumns(this.sheetId,[o,1]))===!1?!1:void 0}function XEe(t,e,n){if(Mm(n))return;const i=this.engine.addRows(this.sheetId,[this.rowAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function ZEe(t,e,n){if(Mm(n))return;const i=this.engine.addColumns(this.sheetId,[this.columnAxisSyncer.getHfIndexFromVisualIndex(t),e]);this.renderDependentSheets(i)}function QEe(t,e,n,i){if(Mm(i))return;const r=this.rowAxisSyncer.getRemovedHfIndexes().sort((a,u)=>u-a),o=this.engine.batch(()=>{r.forEach(a=>{this.engine.removeRows(this.sheetId,[a,1])})});this.renderDependentSheets(o)}function JEe(t,e,n,i){if(Mm(i))return;const r=this.columnAxisSyncer.getRemovedHfIndexes().sort((a,u)=>u-a),o=this.engine.batch(()=>{r.forEach(a=>{this.engine.removeColumns(this.sheetId,[a,1])})});this.renderDependentSheets(o)}function eTe(t,e,n){var i;Bc(mu,this,!0);const r=dt(mt,this,Mw).call(this,n,0,n+(((i=e.__children)===null||i===void 0?void 0:i.length)||0),this.hot.countSourceCols());Bc(mu,this,!1),r.forEach((o,a)=>{o.forEach((u,h)=>{this.engine.setCellContents({col:h,row:n+a,sheet:this.sheetId},[[u]])})})}function tTe(t){this.hot.runHooks("afterFormulasValuesUpdate",t)}function nTe(t,e){this.hot.runHooks("afterNamedExpressionAdded",t,e)}function iTe(t,e){this.hot.runHooks("afterNamedExpressionRemoved",t,e)}function rTe(t){this.hot.runHooks("afterSheetAdded",t)}function oTe(t,e){dt(mt,this,Uv).call(this,e),this.hot.runHooks("afterSheetRenamed",t,e)}function sTe(t,e){this.hot.runHooks("afterSheetRemoved",t,e)}function aTe(t){return{key:"hidden_columns_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[,i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(BN,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),i=Math.max(Math.min(e.col,n.col),0),r=Math.max(e.col,n.col),o=[];for(let h=i;h<=r;h+=1)o.push(h);t.hideColumns(o);const a=o[o.length-1],u=this.columnIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(u)&&u>=0?this.selectColumns(u):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())}}}function lTe(t){const e=[];return{key:"hidden_columns_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(FN,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.columnIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.columnIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countCols()-1,t.showColumns(e),this.view.adjustElementsSize(),this.render(),o-r+1===this.countCols()||this.selectColumns(r,o)},disabled:!1,hidden(){const n=Vt(t.getHiddenColumns(),m=>this.toPhysicalColumn(m));if(!(this.selection.isSelectedByColumnHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeActive(),r=i.getTopStartCorner().col,o=i.getBottomEndCorner().col,a=this.columnIndexMapper,u=a.getRenderableFromVisualIndex(r),h=a.getRenderableFromVisualIndex(o),d=a.getNotTrimmedIndexes(),g=[];if(r!==o){const m=o-r+1,v=h-u+1;if(m>v){const y=d.slice(r,o+1);g.push(...y.filter(b=>n.includes(b)))}}else if(u===0&&u<r)g.push(...d.slice(0,r));else if(u===null)g.push(...d.slice(0,this.countCols()));else{const m=this.countCols()-1,v=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(m,-1));h===v&&m>o&&g.push(...d.slice(o+1))}return U(g,m=>{e.push(this.toVisualColumn(m))}),e.length===0}}}function uTe(t,e){X8(t,e),e.add(t)}function cTe(t,e,n){X8(t,e),e.set(t,n)}function X8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function $h(t,e){return t.get(bc(t,e))}function xG(t,e,n){return t.set(bc(t,e),n),n}function bc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeHideColumns");He.getSingleton().register("afterHideColumns");He.getSingleton().register("beforeUnhideColumns");He.getSingleton().register("afterUnhideColumns");const HG="hiddenColumns",hTe=310;var xa=new WeakMap,Vh=new WeakSet;class dTe extends Dt{constructor(){super(...arguments),uTe(this,Vh),cTe(this,xa,null)}static get PLUGIN_KEY(){return HG}static get PLUGIN_PRIORITY(){return hTe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,columns:[]}}isEnabled(){return!!this.hot.getSettings()[HG]}enablePlugin(){var e=this;this.enabled||(xG(xa,this,new TR),$h(xa,this).addLocalHook("init",()=>bc(Vh,this,wTe).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,$h(xa,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return bc(Vh,e,vTe).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>bc(Vh,this,gTe).call(this,n,i,r)),this.addHook("modifyColWidth",(n,i)=>bc(Vh,this,fTe).call(this,n,i),2),this.addHook("afterGetColHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return bc(Vh,e,pTe).call(e,...i)}),this.addHook("modifyCopyableRange",n=>bc(Vh,this,mTe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.columnIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;const o=$h(xa,this).getValues().slice(),a=e.length>0;if(i&&a){const h=e.map(d=>this.hot.toPhysicalColumn(d));U(h,d=>{o[d]=!1}),r=ho(o,(d,g,m)=>(g&&d.push(this.hot.toVisualColumn(m)),d),[])}this.hot.runHooks("beforeUnhideColumns",n,r,i&&a)!==!1&&(i&&a&&$h(xa,this).setValues(o),this.hot.view.adjustElementsSize(),this.hot.runHooks("afterUnhideColumns",n,r,i&&a,i&&r.length<n.length))}showColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showColumns(n)}hideColumns(e){const n=this.getHiddenColumns(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideColumns",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{U(e,a=>{$h(xa,this).setValueAtIndex(this.hot.toPhysicalColumn(a),!0)})},!0),this.hot.runHooks("afterHideColumns",n,r,i,i&&r.length>n.length))}hideColumn(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideColumns(n)}getHiddenColumns(){return Vt($h(xa,this).getHiddenIndexes(),e=>this.hot.toVisualColumn(e))}isHidden(e){return $h(xa,this).getValueAtIndex(this.hot.toPhysicalColumn(e))||!1}isValidConfig(e){const n=this.hot.countCols();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){U(this.hot.getCellsMeta(),e=>{e.skipColumnOnPaste=!1})}destroy(){xG(xa,this,null),super.destroy()}}function fTe(t,e){if(this.isHidden(e))return 0;if(this.getSetting("indicators")&&(this.isHidden(e+1)||this.isHidden(e-1))&&typeof t=="number"&&this.hot.hasColHeaders())return t+15}function gTe(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(e)&&(n.skipColumnOnPaste=!0),this.isHidden(e-1))n.className=n.className||"",n.className.indexOf("afterHiddenColumn")===-1&&(n.className+=" afterHiddenColumn");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenColumn");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function mTe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,a)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:a})};return U(t,i=>{let r=!0,o=0;ze(i.startCol,i.endCol,a=>{this.isHidden(a)?(r||n(i.startRow,i.endRow,o,a-1),r=!0):(r&&(o=a),a===i.endCol&&n(i.startRow,i.endRow,o,a),r=!1)})}),e}function pTe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenColumn"),t<this.hot.countCols()-1&&this.isHidden(t+1)&&n.push("beforeHiddenColumn"),fe(e,n)}function vTe(t){t.items.push({name:vt},aTe(this),lTe(this))}function wTe(){const t=this.getSetting("columns");Array.isArray(t)&&this.hideColumns(t)}function yTe(t){return{key:"hidden_rows_hide",name(){const e=this.getSelectedActive();let n=0;if(Array.isArray(e)){const[i,,r]=e;i-r!==0&&(n=1)}return this.getTranslatedPhrase(WN,n)},callback(){const{from:e,to:n}=this.getSelectedRangeActive(),i=Math.max(Math.min(e.row,n.row),0),r=Math.max(e.row,n.row),o=[];for(let h=i;h<=r;h+=1)o.push(h);t.hideRows(o);const a=o[o.length-1],u=this.rowIndexMapper.getNearestNotHiddenIndex(a,1,!0);Number.isInteger(u)&&u>=0?this.selectRows(u):this.deselectCell(),this.view.adjustElementsSize(),this.render()},disabled:!1,hidden(){return!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())}}}function STe(t){const e=[];return{key:"hidden_rows_show",name(){const n=e.length>1?1:0;return this.getTranslatedPhrase(jN,n)},callback(){var n,i;if(e.length===0)return;let r=e[0],o=e[e.length-1];r=(n=this.rowIndexMapper.getNearestNotHiddenIndex(r-1,-1))!==null&&n!==void 0?n:0,o=(i=this.rowIndexMapper.getNearestNotHiddenIndex(o+1,1))!==null&&i!==void 0?i:this.countRows()-1,t.showRows(e),this.view.adjustElementsSize(),this.render(),o-r+1===this.countRows()||this.selectRows(r,o)},disabled:!1,hidden(){const n=Vt(t.getHiddenRows(),m=>this.toPhysicalRow(m));if(!(this.selection.isSelectedByRowHeader()||this.selection.isSelectedByCorner())||n.length<1)return!0;e.length=0;const i=this.getSelectedRangeActive(),r=i.getTopStartCorner().row,o=i.getBottomEndCorner().row,a=this.rowIndexMapper,u=a.getRenderableFromVisualIndex(r),h=a.getRenderableFromVisualIndex(o),d=a.getNotTrimmedIndexes(),g=[];if(r!==o){const m=o-r+1,v=h-u+1;if(m>v){const y=d.slice(r,o+1);g.push(...y.filter(b=>n.includes(b)))}}else if(u===0&&u<r)g.push(...d.slice(0,r));else if(u===null)g.push(...d.slice(0,this.countRows()));else{const m=this.countRows()-1,v=a.getRenderableFromVisualIndex(a.getNearestNotHiddenIndex(m,-1));h===v&&m>o&&g.push(...d.slice(o+1))}return U(g,m=>{e.push(this.toVisualRow(m))}),e.length===0}}}function bTe(t,e){Z8(t,e),e.add(t)}function CTe(t,e,n){Z8(t,e),e.set(t,n)}function Z8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Bh(t,e){return t.get(Cc(t,e))}function IG(t,e,n){return t.set(Cc(t,e),n),n}function Cc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeHideRows");He.getSingleton().register("afterHideRows");He.getSingleton().register("beforeUnhideRows");He.getSingleton().register("afterUnhideRows");const PG="hiddenRows",RTe=320;var Ha=new WeakMap,Fh=new WeakSet;class ETe extends Dt{constructor(){super(...arguments),bTe(this,Fh),CTe(this,Ha,null)}static get PLUGIN_KEY(){return PG}static get PLUGIN_PRIORITY(){return RTe}static get DEFAULT_SETTINGS(){return{copyPasteEnabled:!0,indicators:!1,rows:[]}}isEnabled(){return!!this.hot.getSettings()[PG]}enablePlugin(){var e=this;this.enabled||(IG(Ha,this,new TR),Bh(Ha,this).addLocalHook("init",()=>Cc(Fh,this,xTe).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Bh(Ha,this)),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Cc(Fh,e,OTe).call(e,...i)}),this.addHook("afterGetCellMeta",(n,i,r)=>Cc(Fh,this,_Te).call(this,n,i,r)),this.addHook("modifyRowHeight",(n,i)=>Cc(Fh,this,TTe).call(this,n,i)),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Cc(Fh,e,ATe).call(e,...i)}),this.addHook("modifyCopyableRange",n=>Cc(Fh,this,MTe).call(this,n)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){super.disablePlugin(),this.hot.rowIndexMapper.unregisterMap(this.pluginName),this.resetCellsMeta()}showRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;const o=Bh(Ha,this).getValues().slice(),a=e.length>0;if(i&&a){const h=e.map(d=>this.hot.toPhysicalRow(d));U(h,d=>{o[d]=!1}),r=ho(o,(d,g,m)=>(g&&d.push(this.hot.toVisualRow(m)),d),[])}this.hot.runHooks("beforeUnhideRows",n,r,i&&a)!==!1&&(i&&a&&Bh(Ha,this).setValues(o),this.hot.runHooks("afterUnhideRows",n,r,i&&a,i&&r.length<n.length))}showRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.showRows(n)}hideRows(e){const n=this.getHiddenRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeHideRows",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{U(e,a=>{Bh(Ha,this).setValueAtIndex(this.hot.toPhysicalRow(a),!0)})},!0),this.hot.runHooks("afterHideRows",n,r,i,i&&r.length>n.length))}hideRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.hideRows(n)}getHiddenRows(){return Vt(Bh(Ha,this).getHiddenIndexes(),e=>this.hot.toVisualRow(e))}isHidden(e){return Bh(Ha,this).getValueAtIndex(this.hot.toPhysicalRow(e))||!1}isValidConfig(e){const n=this.hot.countRows();return Array.isArray(e)&&e.length>0?e.every(i=>Number.isInteger(i)&&i>=0&&i<n):!1}resetCellsMeta(){U(this.hot.getCellsMeta(),e=>{e.skipRowOnPaste=!1})}destroy(){IG(Ha,this,null),super.destroy()}}function TTe(t,e){return this.isHidden(e)?0:t}function _Te(t,e,n){if(this.getSetting("copyPasteEnabled")===!1&&this.isHidden(t)&&(n.skipRowOnPaste=!0),this.isHidden(t-1))n.className=n.className||"",n.className.indexOf("afterHiddenRow")===-1&&(n.className+=" afterHiddenRow");else if(n.className){const i=n.className.split(" ");if(i.length>0){const r=i.indexOf("afterHiddenRow");r>-1&&i.splice(r,1),n.className=i.join(" ")}}}function MTe(t){if(this.getSetting("copyPasteEnabled"))return t;const e=[],n=(i,r,o,a)=>{e.push({startRow:i,endRow:r,startCol:o,endCol:a})};return U(t,i=>{let r=!0,o=0;ze(i.startRow,i.endRow,a=>{this.isHidden(a)?(r||n(o,a-1,i.startCol,i.endCol),r=!0):(r&&(o=a),a===i.endRow&&n(o,a,i.startCol,i.endCol),r=!1)})}),e}function ATe(t,e){if(!this.getSetting("indicators")||t<0)return;const n=[];t>=1&&this.isHidden(t-1)&&n.push("afterHiddenRow"),t<this.hot.countRows()-1&&this.isHidden(t+1)&&n.push("beforeHiddenRow"),fe(e,n)}function OTe(t){t.items.push({name:vt},yTe(this),STe(this))}function xTe(){const t=this.getSetting("rows");Array.isArray(t)&&this.hideRows(t)}function HTe(t){return{key:"freeze_column",name(){return this.getTranslatedPhrase(pN)},callback(e,n){const[{start:{col:i}}]=n;t.freezeColumn(i),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col<=this.getSettings().fixedColumnsStart-1)&&(n=!0),n}}}function ITe(t){return{key:"unfreeze_column",name(){return this.getTranslatedPhrase(vN)},callback(e,n){const[{start:{col:i}}]=n;t.unfreezeColumn(i),this.view.adjustElementsSize(),this.render()},hidden(){const e=this.getSelectedRange();let n=!1;return(e===void 0||e.length>1||e[0].from.col!==e[0].to.col||e[0].from.col>=this.getSettings().fixedColumnsStart)&&(n=!0),n}}}function PTe(t,e){Q8(t,e),e.add(t)}function NTe(t,e,n){Q8(t,e),e.set(t,n)}function Q8(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vI(t,e){return t.get(E0(t,e))}function ex(t,e,n){return t.set(E0(t,e),n),n}function E0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeColumnFreeze");He.getSingleton().register("afterColumnFreeze");He.getSingleton().register("beforeColumnUnfreeze");He.getSingleton().register("afterColumnUnfreeze");const NG="manualColumnFreeze",DTe=110;var td=new WeakMap,tx=new WeakSet;class LTe extends Dt{constructor(){super(...arguments),PTe(this,tx),NTe(this,td,!1)}static get PLUGIN_KEY(){return NG}static get PLUGIN_PRIORITY(){return DTe}isEnabled(){return!!this.hot.getSettings()[NG]}enablePlugin(){this.enabled||(this.addHook("afterContextMenuDefaultOptions",e=>E0(tx,this,kTe).call(this,e)),this.addHook("beforeColumnMove",(e,n)=>E0(tx,this,$Te).call(this,e,n)),super.enablePlugin())}disablePlugin(){ex(td,this,!1),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}freezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart<this.hot.countCols()&&e>n.fixedColumnsStart-1;vI(td,this)||ex(td,this,!0),this.hot.runHooks("beforeColumnFreeze",e,i)!==!1&&(i&&(this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart),n._fixedColumnsStart+=1),this.hot.runHooks("afterColumnFreeze",e,i))}unfreezeColumn(e){const n=this.hot.getSettings(),i=n.fixedColumnsStart>0&&e<=n.fixedColumnsStart-1;vI(td,this)||ex(td,this,!0),this.hot.runHooks("beforeColumnUnfreeze",e,i)!==!1&&(i&&(n._fixedColumnsStart-=1,this.hot.columnIndexMapper.moveIndexes(e,n.fixedColumnsStart)),this.hot.runHooks("afterColumnUnfreeze",e,i))}}function kTe(t){t.items.push({name:"---------"},HTe(this),ITe(this))}function $Te(t,e){if(vI(td,this)){const n=this.hot.getSettings().fixedColumnsStart;if(e<n||t.some(i=>i<n))return!1}}function Ab(t,e,n){return(e=VTe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function VTe(t){var e=BTe(t,"string");return typeof e=="symbol"?e:e+""}function BTe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const nx=0,DG=1,LG=2,ig="px";let J8=class{constructor(e){Ab(this,"hot",void 0),Ab(this,"_element",null),Ab(this,"state",nx),Ab(this,"inlineProperty",void 0),this.hot=e,this.inlineProperty=e.isRtl()?"right":"left"}appendTo(e){e.appendChild(this._element),this.state=LG}build(){this.state===nx&&(this._element=this.hot.rootDocument.createElement("div"),this.state=DG)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=nx}isAppended(){return this.state===LG}isBuilt(){return this.state>=DG}setPosition(e,n){Hr(e)&&(this._element.style.top=e+ig),Hr(n)&&(this._element.style[this.inlineProperty]=n+ig)}getPosition(){const e=this._element.style;return{top:e.top?parseInt(e.top,10):0,start:e[this.inlineProperty]?parseInt(e[this.inlineProperty],10):0}}setSize(e,n){Hr(e)&&(this._element.style.width=e+ig),Hr(n)&&(this._element.style.height=n+ig)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){Hr(e)&&(this._element.style.marginTop=e+ig),Hr(n)&&(this._element.style[`margin${ha(this.inlineProperty)}`]=n+ig)}getOffset(){const e=this._element.style,n=`margin${ha(this.inlineProperty)}`;return{top:e.marginTop?parseInt(e.marginTop,10):0,start:e[n]?parseInt(e[n],10):0}}};const FTe="ht__manualColumnMove--backlight";let WTe=class extends J8{build(){super.build(),fe(this._element,FTe)}};const jTe="ht__manualColumnMove--guideline";let zTe=class extends J8{build(){super.build(),fe(this._element,jTe)}};function UTe(t,e){e9(t,e),e.add(t)}function Us(t,e,n){e9(t,e),e.set(t,n)}function e9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function so(t,e,n){return t.set(Rc(t,e),n),n}function Fe(t,e){return t.get(Rc(t,e))}function Rc(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeColumnMove");He.getSingleton().register("afterColumnMove");const ix="manualColumnMove",YTe=120,kG="ht__manualColumnMove",T0="show-ui",wI="on-moving--columns",yI="after-selection--columns";var Or=new WeakMap,Tc=new WeakMap,iu=new WeakMap,HC=new WeakMap,Pc=new WeakMap,Ar=new WeakMap,Ob=new WeakMap,gs=new WeakMap,Cg=new WeakMap,_0=new WeakMap,Yv=new WeakMap,Wh=new WeakSet;class GTe extends Dt{constructor(){super(...arguments),UTe(this,Wh),Us(this,Or,new WTe(this.hot)),Us(this,Tc,new zTe(this.hot)),Us(this,iu,[]),Us(this,HC,0),Us(this,Pc,!1),Us(this,Ar,{}),Us(this,Ob,void 0),Us(this,gs,void 0),Us(this,Cg,void 0),Us(this,_0,void 0),Us(this,Yv,void 0)}static get PLUGIN_KEY(){return ix}static get PLUGIN_PRIORITY(){return YTe}isEnabled(){return!!this.hot.getSettings()[ix]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rc(Wh,e,qTe).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rc(Wh,e,XTe).call(e,...i)}),this.addHook("afterScrollVertically",()=>Rc(Wh,this,QTe).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Rc(Wh,e,JTe).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),fe(this.hot.rootElement,kG),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ve(this.hot.rootElement,kG),this.unregisterEvents(),Fe(Or,this).destroy(),Fe(Tc,this).destroy(),super.disablePlugin()}moveColumn(e,n){return this.moveColumns([e],n)}moveColumns(e,n){const i=Fe(Ob,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeColumnMove",e,n,i,r);if(so(Ob,this,void 0),o===!1)return;r&&this.hot.columnIndexMapper.moveIndexes(e,n);const a=r&&this.isColumnOrderChanged(e,n);return this.hot.runHooks("afterColumnMove",e,n,i,r,a),a}dragColumn(e,n){return this.dragColumns([e],n)}dragColumns(e,n){const i=this.countFinalIndex(e,n);return so(Ob,this,n),this.moveColumns(e,i)}isMovePossible(e,n){const i=this.hot.columnIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,a=e.some(h=>h<0),u=e.some(h=>h>=i);return!(r||o||a||u)}isColumnOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=ho(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getColumnsWidth(e,n){const i=this.hot.columnIndexMapper;let r=0;for(let o=e;o<=n;o+=1){const a=i.getRenderableFromVisualIndex(o);o<0?r+=this.hot.view._wt.wtViewport.getRowHeaderWidth()||0:a!==null&&(r+=this.hot.view._wt.wtTable.getColumnWidth(a)||0)}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[ix];if(Array.isArray(e))this.moveColumns(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveColumns(n,0)}}isFixedColumnsStart(e){return e<this.hot.getSettings().fixedColumnsStart}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualColumnMove",this.hot.columnIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualColumnMove",e),e.value?e.value:[]}prepareColumnsToMoving(e,n){const i=[];return ze(e,n,r=>{i.push(r)}),i}refreshPositions(){const e=this.hot.view.getFirstFullyVisibleColumn();this.isFixedColumnsStart(Fe(gs,this))&&e>0&&this.hot.scrollViewportTo({col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(e-1,-1)});const n=this.hot.view._wt.wtTable,i=this.hot.view._wt.wtOverlays.scrollableElement,r=typeof i.scrollX=="number"?i.scrollX:i.scrollLeft;let o=this.hot.view.THEAD.offsetLeft+this.getColumnsWidth(0,Fe(gs,this)-1);const a=n.hider.offsetWidth,u=n.TBODY.offsetLeft,h=Fe(Or,this).getOffset().start,d=Fe(Or,this).getSize().width;let g=0,m=0;if(this.hot.isRtl()){const b=this.hot.rootWindow,C=hi(this.hot.rootElement),T=b.innerWidth-Fe(Cg,this)-C;m=b.innerWidth-Fe(Ar,this).eventPageX-T-(i.scrollX===void 0?r:0)}else m=Fe(Ar,this).eventPageX-(Fe(Cg,this)-(i.scrollX===void 0?r:0));if(Fe(_0,this)&&(g=this.hot.view._wt.wtOverlays.inlineStartOverlay.clone.wtTable.getColumnHeader(-1).offsetWidth),this.isFixedColumnsStart(Fe(gs,this))&&(o+=r),o+=g,Fe(gs,this)<0)Fe(Yv,this)>0?Fe(Ar,this).col=0:Fe(Ar,this).col=e>0?e-1:e;else if(Fe(Ar,this).TD.offsetWidth/2+o<=m){const b=Fe(gs,this)>=Fe(HC,this)?Fe(HC,this)-1:Fe(gs,this);Fe(Ar,this).col=b+1,o+=Fe(Ar,this).TD.offsetWidth}else Fe(Ar,this).col=Fe(gs,this);let v=m,y=o;m+d+h>=a?v=a-d-h:m+h<u+g&&(v=u+g+Math.abs(h)),o>=a-1?y=a-1:y===0?y=1:i.scrollX!==void 0&&Fe(gs,this)<Fe(Yv,this)&&(y-=Fe(Cg,this)<=i.scrollX?Fe(Cg,this):0),Fe(Or,this).setPosition(null,v),Fe(Tc,this).setPosition(null,y)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Rc(Wh,this,KTe).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Rc(Wh,this,ZTe).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){Fe(Or,this).build(),Fe(Tc,this).build()}destroy(){Fe(Or,this).destroy(),Fe(Tc,this).destroy(),super.destroy()}}function qTe(t,e,n,i){const r=this.hot.view._wt.wtTable,o=this.hot.selection.isSelectedByColumnHeader(),a=this.hot.getSelectedRangeActive(),u=Xe(t.target,"sortAction");if(!a||!o||Fe(Pc,this)||t.button!==0||u){so(Pc,this,!1),Fe(iu,this).length=0,Ve(this.hot.rootElement,[wI,T0]);return}const h=Fe(Tc,this).isBuilt()&&!Fe(Tc,this).isAppended(),d=Fe(Or,this).isBuilt()&&!Fe(Or,this).isAppended();h&&d&&(Fe(Tc,this).appendTo(r.hider),Fe(Or,this).appendTo(r.hider));const{from:g,to:m}=a,v=Math.min(g.col,m.col),y=Math.max(g.col,m.col);if(e.row<0&&e.col>=v&&e.col<=y){i.column=!0,so(Pc,this,!0);const b=n.firstChild?Qse(t,n.firstChild).x:t.offsetX;Fe(Ar,this).eventPageX=t.pageX,so(gs,this,e.col),Fe(Ar,this).TD=n,Fe(Ar,this).col=e.col,so(iu,this,this.prepareColumnsToMoving(v,y)),so(_0,this,!!this.hot.getSettings().rowHeaders),so(HC,this,this.hot.countCols()),so(Yv,this,this.hot.getSettings().fixedColumnsStart),so(Cg,this,pr(this.hot.rootElement).left);const C=Fe(_0,this)?-1:0,T=r.holder.scrollTop+r.getColumnHeaderHeight(0)+1,O=e.col<Fe(Yv,this),A=this.hot.view._wt.wtOverlays.inlineStartOverlay.getOverlayOffset(),N=Math.abs(b-(this.hot.isRtl()?n.offsetWidth:0)),x=this.getColumnsWidth(v,e.col-1)+N,$=this.getColumnsWidth(C,v-1)+(O?A:0)+x;Fe(Or,this).setPosition(T,$),Fe(Or,this).setSize(this.getColumnsWidth(v,y),r.hider.offsetHeight-T),Fe(Or,this).setOffset(null,-x),fe(this.hot.rootElement,wI)}else Ve(this.hot.rootElement,yI),so(Pc,this,!1),Fe(iu,this).length=0}function KTe(t){Fe(Pc,this)&&(Fe(Ar,this).eventPageX=t.pageX,this.refreshPositions())}function XTe(t,e,n,i){!this.hot.getSelectedRangeActive()||!Fe(Pc,this)||(Fe(iu,this).indexOf(e.col)>-1?Ve(this.hot.rootElement,T0):fe(this.hot.rootElement,T0),i.row=!0,i.column=!0,i.cell=!0,so(gs,this,e.col),Fe(Ar,this).TD=n)}function ZTe(){const t=Fe(Ar,this).col,e=Fe(iu,this).length;if(so(gs,this,void 0),so(Pc,this,!1),Ve(this.hot.rootElement,[wI,T0,yI]),this.hot.selection.isSelectedByColumnHeader()&&fe(this.hot.rootElement,yI),e<1||t===void 0)return;const n=Fe(iu,this)[0],i=this.hot.toPhysicalColumn(n),r=this.dragColumns(Fe(iu,this),t);if(Fe(iu,this).length=0,r===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualColumn(i),a=o+e-1;this.hot.selectColumns(o,a)}}function QTe(){const t=this.hot.view._wt.wtTable,e=t.getColumnHeaderHeight(0)+1,n=t.holder.scrollTop,i=e+n;Fe(Or,this).setPosition(i),Fe(Or,this).setSize(null,t.hider.offsetHeight-i)}function JTe(){this.moveBySettingsOrLoad()}function e_e(t,e){t9(t,e),e.add(t)}function ar(t,e,n){t9(t,e),e.set(t,n)}function t9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ei(t,e,n){return t.set(ea(t,e),n),n}function xe(t,e){return t.get(ea(t,e))}function ea(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const M0="manualColumnResize",t_e=130,$G="manualColumnWidths";var Kl=new WeakMap,xb=new WeakMap,Lo=new WeakMap,A0=new WeakMap,Qa=new WeakMap,n_e=new WeakMap,Yg=new WeakMap,Hb=new WeakMap,eo=new WeakMap,zl=new WeakMap,Hd=new WeakMap,O0=new WeakMap,Pg=new WeakMap,Gv=new WeakMap,$o=new WeakMap,qv=new WeakMap,Ia=new WeakSet;class i_e extends Dt{static get PLUGIN_KEY(){return M0}static get PLUGIN_PRIORITY(){return t_e}constructor(e){super(e),e_e(this,Ia),ar(this,Kl,null),ar(this,xb,null),ar(this,Lo,[]),ar(this,A0,null),ar(this,Qa,null),ar(this,n_e,null),ar(this,Yg,null),ar(this,Hb,null),ar(this,eo,this.hot.rootDocument.createElement("DIV")),ar(this,zl,this.hot.rootDocument.createElement("DIV")),ar(this,Hd,null),ar(this,O0,!1),ar(this,Pg,0),ar(this,Gv,null),ar(this,$o,void 0),ar(this,qv,void 0),fe(xe(eo,this),"manualColumnResizer"),fe(xe(zl,this),"manualColumnResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[M0]}enablePlugin(){var e=this;this.enabled||(ei($o,this,new Uc),xe($o,this).addLocalHook("init",()=>ea(Ia,this,r_e).call(this)),this.hot.columnIndexMapper.registerMap(this.pluginName,xe($o,this)),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ea(Ia,e,c_e).call(e,...i)},1),this.addHook("beforeStretchingColumnWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ea(Ia,e,h_e).call(e,...i)},1),this.addHook("beforeColumnResize",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return ea(Ia,e,d_e).call(e,...i)}),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){ei(qv,this,xe($o,this).getValues()),this.hot.columnIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualColumnWidths(){this.hot.runHooks("persistentStateSave",$G,xe($o,this).getValues())}loadManualColumnWidths(){const e={};return this.hot.runHooks("persistentStateLoad",$G,e),e.value}setManualSize(e,n){const i=Math.max(n,20),r=this.hot.toPhysicalColumn(e);return xe($o,this).setValueAtIndex(r,i),i}clearManualSize(e){const n=this.hot.toPhysicalColumn(e);xe($o,this).setValueAtIndex(n,null)}setupHandlePosition(e){if(!e.parentNode||xe(Pg,this)>1)return;ei(Kl,this,e);const{_wt:n}=this.hot.view,i=n.wtTable.getCoords(xe(Kl,this)),r=i.col;if(r<0)return;const o=Ti(xe(Kl,this)),a=xe(Kl,this).getBoundingClientRect(),u=r<n.getSetting("fixedColumnsStart");let h;u&&(h=n.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(xe(Kl,this),i.row,i.col)),h||(h=n.wtOverlays.topOverlay.getRelativeCellPosition(xe(Kl,this),i.row,i.col)),ei(xb,this,this.hot.columnIndexMapper.getVisualFromRenderableIndex(r)),ei(Lo,this,[]);const d=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByColumnHeader();if(this.hot.selection.isSelected()&&d){const g=this.hot.getSelectedRange();U(g,m=>{const v=m.getTopStartCorner().col,y=m.getBottomEndCorner().col;ze(v,y,b=>{xe(Lo,this).includes(b)||xe(Lo,this).push(b)})})}xe(Lo,this).includes(xe(xb,this))||ei(Lo,this,[xe(xb,this)]),ei(Hb,this,h.start-6),ei(Yg,this,parseInt(a.width,10)),xe(eo,this).style.top=`${h.top}px`,xe(eo,this).style[this.inlineDir]=`${xe(Hb,this)+xe(Yg,this)}px`,xe(eo,this).style.height=`${o}px`,this.hot.rootElement.appendChild(xe(eo,this))}refreshHandlePosition(){xe(eo,this).style[this.inlineDir]=`${xe(Hb,this)+xe(A0,this)}px`}setupGuidePosition(){const e=parseInt(Ti(xe(eo,this)),10),n=parseInt(xe(eo,this).style.top,10)+e,i=this.hot.view.getTableHeight();fe(xe(eo,this),"active"),fe(xe(zl,this),"active"),xe(zl,this).style.top=`${n}px`,this.refreshGuidePosition(),xe(zl,this).style.height=`${i-e}px`,this.hot.rootElement.appendChild(xe(zl,this))}refreshGuidePosition(){xe(zl,this).style[this.inlineDir]=xe(eo,this).style[this.inlineDir]}hideHandleAndGuide(){Ve(xe(eo,this),"active"),Ve(xe(zl,this),"active")}checkIfColumnHeader(e){const n=Ed(e,["THEAD"],this.hot.rootElement),{topOverlay:i,topInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.THEAD,r.clone.wtTable.THEAD].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(i,r)=>{const o=this.hot.runHooks("beforeColumnResize",xe(Qa,this),i,!0);o!==void 0&&ei(Qa,this,o),this.setManualSize(i,xe(Qa,this)),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",xe(Qa,this),i,!0),r&&e()};xe(Pg,this)>=2&&(xe(Lo,this).length>1?(U(xe(Lo,this),r=>{n(r)}),e()):U(xe(Lo,this),r=>{n(r,!0)})),ei(Pg,this,0),ei(Gv,this,null)}bindEvents(){const{rootWindow:e,rootElement:n}=this.hot;this.eventManager.addEventListener(n,"mouseover",i=>ea(Ia,this,o_e).call(this,i)),this.eventManager.addEventListener(n,"mousedown",i=>ea(Ia,this,s_e).call(this,i)),this.eventManager.addEventListener(e,"mousemove",i=>ea(Ia,this,a_e).call(this,i)),this.eventManager.addEventListener(e,"mouseup",()=>ea(Ia,this,l_e).call(this)),this.eventManager.addEventListener(xe(eo,this),"contextmenu",()=>ea(Ia,this,u_e).call(this))}destroy(){super.destroy()}}function r_e(){const t=this.hot.getSettings()[M0],e=this.loadManualColumnWidths();typeof e<"u"?this.hot.batchExecution(()=>{e.forEach((n,i)=>{xe($o,this).setValueAtIndex(i,n)})},!0):Array.isArray(t)?(this.hot.batchExecution(()=>{t.forEach((n,i)=>{xe($o,this).setValueAtIndex(i,n)})},!0),ei(qv,this,t)):t===!0&&Array.isArray(xe(qv,this))&&this.hot.batchExecution(()=>{xe(qv,this).forEach((n,i)=>{xe($o,this).setValueAtIndex(i,n)})},!0)}function o_e(t){if(!H4(t.target)&&xe(O0,this)!==!0&&this.checkIfColumnHeader(t.target)){const e=this.getClosestTHParent(t.target);if(!e)return;const n=e.getAttribute("colspan");e&&(n===null||n==="1")&&(xe(Hd,this)||this.setupHandlePosition(e))}}function s_e(t){t.target.parentNode===this.hot.rootElement&&Xe(t.target,"manualColumnResizer")&&(this.setupHandlePosition(xe(Kl,this)),this.setupGuidePosition(),ei(Hd,this,!0),xe(Gv,this)===null&&(ei(Gv,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(xe(Gv,this))),ei(Pg,this,xe(Pg,this)+1),this.startX=t.pageX,ei(Qa,this,xe(Yg,this)))}function a_e(t){if(xe(Hd,this)){const e=(t.pageX-this.startX)*this.hot.getDirectionFactor();ei(A0,this,xe(Yg,this)+e),U(xe(Lo,this),n=>{ei(Qa,this,this.setManualSize(n,xe(A0,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition()}}function l_e(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,i)=>{this.hot.runHooks("beforeColumnResize",xe(Qa,this),n,!1),i&&t(),this.saveManualColumnWidths(),this.hot.runHooks("afterColumnResize",xe(Qa,this),n,!1)};xe(Hd,this)&&(this.hideHandleAndGuide(),ei(Hd,this,!1),xe(Qa,this)!==xe(Yg,this)&&(xe(Lo,this).length>1?(U(xe(Lo,this),i=>{e(i)}),t()):U(xe(Lo,this),i=>{e(i,!0)})),this.setupHandlePosition(xe(Kl,this)))}function u_e(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(xe(eo,this)),this.hot.rootElement.removeChild(xe(zl,this)),ei(Hd,this,!1),ei(O0,this,!0),this.hot._registerImmediate(()=>{ei(O0,this,!1)})}function c_e(t,e){let n=t;if(this.enabled){const i=this.hot.toPhysicalColumn(e),r=xe($o,this).getValueAtIndex(i);this.hot.getSettings()[M0]&&r&&(n=r)}return n}function h_e(t,e){const n=xe($o,this).getValueAtIndex(this.hot.toPhysicalColumn(e));return typeof n=="number"?n:t}function d_e(){this.hot.view._wt.wtViewport.resetHasOversizedColumnHeadersMarked()}function rx(t,e,n){return(e=f_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function f_e(t){var e=g_e(t,"string");return typeof e=="symbol"?e:e+""}function g_e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const ox=0,VG=1,BG=2,rg="px";let n9=class{constructor(e){rx(this,"hot",void 0),rx(this,"_element",null),rx(this,"state",ox),this.hot=e}appendTo(e){e.appendChild(this._element),this.state=BG}build(){this.state===ox&&(this._element=this.hot.rootDocument.createElement("div"),this.state=VG)}destroy(){this.isAppended()&&this._element.parentElement.removeChild(this._element),this._element=null,this.state=ox}isAppended(){return this.state===BG}isBuilt(){return this.state>=VG}setPosition(e,n){e!==void 0&&(this._element.style.top=e+rg),n!==void 0&&(this._element.style.left=n+rg)}getPosition(){return{top:this._element.style.top?parseInt(this._element.style.top,10):0,left:this._element.style.left?parseInt(this._element.style.left,10):0}}setSize(e,n){e&&(this._element.style.width=e+rg),n&&(this._element.style.height=n+rg)}getSize(){return{width:this._element.style.width?parseInt(this._element.style.width,10):0,height:this._element.style.height?parseInt(this._element.style.height,10):0}}setOffset(e,n){e&&(this._element.style.marginTop=e+rg),n&&(this._element.style.marginLeft=n+rg)}getOffset(){return{top:this._element.style.marginTop?parseInt(this._element.style.marginTop,10):0,left:this._element.style.marginLeft?parseInt(this._element.style.marginLeft,10):0}}};const m_e="ht__manualRowMove--backlight";class p_e extends n9{build(){super.build(),fe(this._element,m_e)}}const v_e="ht__manualRowMove--guideline";class w_e extends n9{build(){super.build(),fe(this._element,v_e)}}function y_e(t,e){i9(t,e),e.add(t)}function og(t,e,n){i9(t,e),e.set(t,n)}function i9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function pd(t,e,n){return t.set(Ec(t,e),n),n}function rt(t,e){return t.get(Ec(t,e))}function Ec(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeRowMove");He.getSingleton().register("afterRowMove");const sx="manualRowMove",S_e=140,FG="ht__manualRowMove",x0="show-ui",SI="on-moving--rows",bI="after-selection--rows";var xr=new WeakMap,_c=new WeakMap,ru=new WeakMap,Nc=new WeakMap,ao=new WeakMap,Ib=new WeakMap,jh=new WeakSet;class b_e extends Dt{constructor(){super(...arguments),y_e(this,jh),og(this,xr,new p_e(this.hot)),og(this,_c,new w_e(this.hot)),og(this,ru,[]),og(this,Nc,void 0),og(this,ao,{}),og(this,Ib,void 0)}static get PLUGIN_KEY(){return sx}static get PLUGIN_PRIORITY(){return S_e}isEnabled(){return!!this.hot.getSettings()[sx]}enablePlugin(){var e=this;this.enabled||(this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ec(jh,e,C_e).call(e,...i)}),this.addHook("beforeOnCellMouseOver",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ec(jh,e,E_e).call(e,...i)}),this.addHook("afterScrollHorizontally",()=>Ec(jh,this,__e).call(this)),this.addHook("afterLoadData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Ec(jh,e,M_e).call(e,...i)}),this.buildPluginUI(),this.registerEvents(),fe(this.hot.rootElement,FG),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.moveBySettingsOrLoad(),super.updatePlugin()}disablePlugin(){Ve(this.hot.rootElement,FG),this.unregisterEvents(),rt(xr,this).destroy(),rt(_c,this).destroy(),super.disablePlugin()}moveRow(e,n){return this.moveRows([e],n)}moveRows(e,n){const i=rt(Ib,this),r=this.isMovePossible(e,n),o=this.hot.runHooks("beforeRowMove",e,n,i,r);if(pd(Ib,this,void 0),o===!1)return;r&&this.hot.rowIndexMapper.moveIndexes(e,n);const a=r&&this.isRowOrderChanged(e,n);return this.hot.runHooks("afterRowMove",e,n,i,r,a),a}dragRow(e,n){return this.dragRows([e],n)}dragRows(e,n){const i=this.countFinalIndex(e,n);return pd(Ib,this,n),this.moveRows(e,i)}isMovePossible(e,n){const i=this.hot.rowIndexMapper.getNotTrimmedIndexesLength(),r=e.length+n>i,o=n<0,a=e.some(h=>h<0),u=e.some(h=>h>=i);return!(r||o||a||u)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}countFinalIndex(e,n){const i=ho(e,(r,o)=>(o<n&&(r+=1),r),0);return n-i}getRowsHeight(e,n){const i=this.hot.rowIndexMapper;let r=0;for(let o=e;o<=n;o++){const a=i.getRenderableFromVisualIndex(o);a!==null&&(r+=this.hot.view._wt.wtTable.getRowHeight(a)||this.hot.stylesHandler.getDefaultRowHeight())}return r}moveBySettingsOrLoad(){const e=this.hot.getSettings()[sx];if(Array.isArray(e))this.moveRows(e,0);else if(e!==void 0){const n=this.persistentStateLoad();n.length&&this.moveRows(n,0)}}isFixedRowTop(e){return e<this.hot.getSettings().fixedRowsTop}isFixedRowBottom(e){return e>this.hot.countRows()-1-this.hot.getSettings().fixedRowsBottom}persistentStateSave(){this.hot.runHooks("persistentStateSave","manualRowMove",this.hot.rowIndexMapper.getIndexesSequence())}persistentStateLoad(){const e={};return this.hot.runHooks("persistentStateLoad","manualRowMove",e),e.value?e.value:[]}prepareRowsToMoving(){const e=this.hot.getSelectedRangeActive(),n=[];if(!e)return n;const{from:i,to:r}=e,o=Math.min(i.row,r.row),a=Math.max(i.row,r.row);return ze(o,a,u=>{n.push(u)}),n}refreshPositions(){const e=rt(ao,this).coords,n=this.hot.getFirstFullyVisibleRow(),i=this.hot.getLastFullyVisibleRow(),r=this.hot.countRows();this.isFixedRowTop(e.row)&&n>0&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(n-1,-1)),this.isFixedRowBottom(e.row)&&i<r&&this.hot.scrollViewportTo(this.hot.rowIndexMapper.getNearestNotHiddenIndex(i+1,1),void 0,!0);const o=this.hot.view._wt.wtTable,a=rt(ao,this).TD,u=this.hot.rootElement,h=pr(u),d=dw(u),g=o.holder.scrollTop,m=this.hot.rootWindow!==d?d.scrollTop:0,v=h.top-m,y=rt(ao,this).eventPageY-v+g,b=o.hider.offsetHeight,C=o.TBODY.offsetTop,T=rt(xr,this).getOffset().top,O=rt(xr,this).getSize().height,A=a.offsetHeight/2,N=a.offsetHeight;let x=this.hot.view.THEAD.offsetHeight+this.getRowsHeight(0,e.row-1);const $=y>=x+A;this.isFixedRowTop(e.row)&&(x+=this.hot.view._wt.wtOverlays.topOverlay.getOverlayOffset()),e.row<0?rt(ao,this).row=n>0?n-1:n:$?(rt(ao,this).row=e.row+1,x+=e.row===0?N-1:N):rt(ao,this).row=e.row;let L=y,P=x;y+O+T>=b?L=b-O-T:y+T<C&&(L=C+Math.abs(T)),x>=b-1&&(P=b-1),rt(xr,this).setPosition(L),rt(_c,this).setPosition(P)}registerEvents(){const{documentElement:e}=this.hot.rootDocument;this.eventManager.addEventListener(e,"mousemove",n=>Ec(jh,this,R_e).call(this,n)),this.eventManager.addEventListener(e,"mouseup",()=>Ec(jh,this,T_e).call(this))}unregisterEvents(){this.eventManager.clear()}buildPluginUI(){rt(xr,this).build(),rt(_c,this).build()}destroy(){rt(xr,this).destroy(),rt(_c,this).destroy(),super.destroy()}}function C_e(t,e,n,i){const{wtTable:r,wtViewport:o}=this.hot.view._wt,a=this.hot.selection.isSelectedByRowHeader(),u=this.hot.getSelectedRangeActive();if(!u||!a||rt(Nc,this)||t.button!==0){pd(Nc,this,!1),rt(ru,this).length=0,Ve(this.hot.rootElement,[SI,x0]);return}const h=rt(_c,this).isBuilt()&&!rt(_c,this).isAppended(),d=rt(xr,this).isBuilt()&&!rt(xr,this).isAppended();h&&d&&(rt(_c,this).appendTo(r.hider),rt(xr,this).appendTo(r.hider));const{from:g,to:m}=u,v=Math.min(g.row,m.row),y=Math.max(g.row,m.row);if(e.col<0&&e.row>=v&&e.row<=y){i.row=!0,pd(Nc,this,!0),rt(ao,this).eventPageY=t.pageY,rt(ao,this).coords=e,rt(ao,this).TD=n,pd(ru,this,this.prepareRowsToMoving());const b=r.holder.scrollLeft+o.getRowHeaderWidth(),C=this.getRowsHeight(v,e.row-1)+(t.clientY-n.getBoundingClientRect().top);rt(xr,this).setPosition(null,b),rt(xr,this).setSize(r.hider.offsetWidth-b,this.getRowsHeight(v,y)),rt(xr,this).setOffset(-C,null),fe(this.hot.rootElement,SI),this.refreshPositions()}else Ve(this.hot.rootElement,bI),pd(Nc,this,!1),rt(ru,this).length=0}function R_e(t){rt(Nc,this)&&(rt(ao,this).eventPageY=t.pageY,this.refreshPositions())}function E_e(t,e,n,i){!this.hot.getSelectedRangeActive()||!rt(Nc,this)||(rt(ru,this).indexOf(e.row)>-1?Ve(this.hot.rootElement,x0):fe(this.hot.rootElement,x0),i.row=!0,i.column=!0,i.cell=!0,rt(ao,this).coords=e,rt(ao,this).TD=n)}function T_e(){const t=rt(ao,this).row,e=rt(ru,this).length;if(pd(Nc,this,!1),Ve(this.hot.rootElement,[SI,x0,bI]),this.hot.selection.isSelectedByRowHeader()&&fe(this.hot.rootElement,bI),e<1||t===void 0)return;const n=rt(ru,this)[0],i=this.hot.toPhysicalRow(n),r=this.dragRows(rt(ru,this),t);if(rt(ru,this).length=0,r===!0){this.persistentStateSave(),this.hot.view.adjustElementsSize(),this.hot.render();const o=this.hot.toVisualRow(i),a=o+e-1;this.hot.selectRows(o,a)}}function __e(){const t=this.hot.view._wt.wtTable,e=this.hot.view._wt.wtViewport.getRowHeaderWidth(),n=t.holder.scrollLeft,i=e+n;rt(xr,this).setPosition(null,i),rt(xr,this).setSize(t.hider.offsetWidth-i)}function M_e(){this.moveBySettingsOrLoad()}function A_e(t,e){r9(t,e),e.add(t)}function lr(t,e,n){r9(t,e),e.set(t,n)}function r9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function jn(t,e,n){return t.set(Xl(t,e),n),n}function Oe(t,e){return t.get(Xl(t,e))}function Xl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const H0="manualRowResize",O_e=30,WG="manualRowHeights";var Ua=new WeakMap,Pb=new WeakMap,ko=new WeakMap,Kv=new WeakMap,Mc=new WeakMap,CL=new WeakMap,Gg=new WeakMap,Nb=new WeakMap,Er=new WeakMap,Wa=new WeakMap,Id=new WeakMap,I0=new WeakMap,Ng=new WeakMap,Xv=new WeakMap,ra=new WeakMap,Zv=new WeakMap,hc=new WeakSet;class x_e extends Dt{static get PLUGIN_KEY(){return H0}static get PLUGIN_PRIORITY(){return O_e}constructor(e){super(e),A_e(this,hc),lr(this,Ua,null),lr(this,Pb,null),lr(this,ko,[]),lr(this,Kv,null),lr(this,Mc,null),lr(this,CL,null),lr(this,Gg,null),lr(this,Nb,null),lr(this,Er,this.hot.rootDocument.createElement("DIV")),lr(this,Wa,this.hot.rootDocument.createElement("DIV")),lr(this,Id,!1),lr(this,I0,!1),lr(this,Ng,0),lr(this,Xv,null),lr(this,ra,void 0),lr(this,Zv,void 0),fe(Oe(Er,this),"manualRowResizer"),fe(Oe(Wa,this),"manualRowResizerGuide")}get inlineDir(){return this.hot.isRtl()?"right":"left"}isEnabled(){return this.hot.getSettings()[H0]}enablePlugin(){this.enabled||(jn(ra,this,new Uc),Oe(ra,this).addLocalHook("init",()=>Xl(hc,this,k_e).call(this)),this.hot.rowIndexMapper.registerMap(this.pluginName,Oe(ra,this)),this.addHook("modifyRowHeight",(e,n)=>Xl(hc,this,L_e).call(this,e,n)),this.bindEvents(),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){jn(Zv,this,Oe(ra,this).getValues()),this.hot.rowIndexMapper.unregisterMap(this.pluginName),super.disablePlugin()}saveManualRowHeights(){this.hot.runHooks("persistentStateSave",WG,Oe(ra,this).getValues())}loadManualRowHeights(){const e={};return this.hot.runHooks("persistentStateLoad",WG,e),e.value}setManualSize(e,n){const i=this.hot.toPhysicalRow(e),r=Math.max(n,this.hot.stylesHandler.getDefaultRowHeight());return Oe(ra,this).setValueAtIndex(i,r),r}getLastDesiredRowHeight(){return Oe(Kv,this)}setupHandlePosition(e){if(Oe(Ng,this)>1)return;jn(Ua,this,e);const{view:n}=this.hot,{_wt:i}=n,r=i.wtTable.getCoords(Oe(Ua,this)),o=r.row;if(o<0)return;const a=hi(Oe(Ua,this)),u=Oe(Ua,this).getBoundingClientRect(),h=o<i.getSetting("fixedRowsTop"),d=o>=n.countNotHiddenRowIndexes(0,1)-i.getSetting("fixedRowsBottom");let g;h?g=i.wtOverlays.topInlineStartCornerOverlay.getRelativeCellPosition(Oe(Ua,this),r.row,r.col):d&&(g=i.wtOverlays.bottomInlineStartCornerOverlay.getRelativeCellPosition(Oe(Ua,this),r.row,r.col)),g||(g=i.wtOverlays.inlineStartOverlay.getRelativeCellPosition(Oe(Ua,this),r.row,r.col)),jn(Pb,this,this.hot.rowIndexMapper.getVisualFromRenderableIndex(o)),jn(ko,this,[]);const m=this.hot.selection.isSelectedByCorner()||this.hot.selection.isSelectedByRowHeader();if(this.hot.selection.isSelected()&&m){const v=this.hot.getSelectedRange();U(v,y=>{const b=y.getTopStartCorner().row,C=y.getBottomStartCorner().row;ze(b,C,T=>{Oe(ko,this).includes(T)||Oe(ko,this).push(T)})})}Oe(ko,this).includes(Oe(Pb,this))||jn(ko,this,[Oe(Pb,this)]),jn(Nb,this,g.top-6),jn(Gg,this,parseInt(u.height,10)),Oe(Er,this).style.top=`${Oe(Nb,this)+Oe(Gg,this)}px`,Oe(Er,this).style[this.inlineDir]=`${g.start}px`,Oe(Er,this).style.width=`${a}px`,this.hot.rootElement.appendChild(Oe(Er,this))}refreshHandlePosition(){Oe(Er,this).style.top=`${Oe(Nb,this)+Oe(Kv,this)}px`}setupGuidePosition(){const e=parseInt(hi(Oe(Er,this)),10),n=parseInt(Oe(Er,this).style[this.inlineDir],10)+e,i=this.hot.view.getTableWidth();fe(Oe(Er,this),"active"),fe(Oe(Wa,this),"active"),Oe(Wa,this).style.top=Oe(Er,this).style.top,Oe(Wa,this).style[this.inlineDir]=`${n}px`,Oe(Wa,this).style.width=`${i-e}px`,this.hot.rootElement.appendChild(Oe(Wa,this))}refreshGuidePosition(){Oe(Wa,this).style.top=Oe(Er,this).style.top}hideHandleAndGuide(){Ve(Oe(Er,this),"active"),Ve(Oe(Wa,this),"active")}checkIfRowHeader(e){const n=Ed(e,["TBODY"],this.hot.rootElement),{inlineStartOverlay:i,topInlineStartCornerOverlay:r,bottomInlineStartCornerOverlay:o}=this.hot.view._wt.wtOverlays;return[i.clone.wtTable.TBODY,r.clone.wtTable.TBODY,o.clone.wtTable.TBODY].includes(n)}getClosestTHParent(e){return e.tagName!=="TABLE"?e.tagName==="TH"?e:this.getClosestTHParent(e.parentNode):null}getActualRowHeight(e){const n=this.hot.view._wt.wtTable.getRowHeight(e);return n!==void 0&&Oe(Mc,this)<n?n:Oe(Mc,this)}afterMouseDownTimeout(){const e=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},n=(i,r)=>{const o=this.hot.runHooks("beforeRowResize",this.getActualRowHeight(i),i,!0);o!==void 0&&jn(Mc,this,o),this.setManualSize(i,Oe(Mc,this)),this.hot.runHooks("afterRowResize",this.getActualRowHeight(i),i,!0),r&&e()};Oe(Ng,this)>=2&&(Oe(ko,this).length>1?(U(Oe(ko,this),r=>{n(r)}),e()):U(Oe(ko,this),r=>{n(r,!0)})),jn(Ng,this,0),jn(Xv,this,null)}bindEvents(){const{rootElement:e,rootWindow:n}=this.hot;this.eventManager.addEventListener(e,"mouseover",i=>Xl(hc,this,H_e).call(this,i)),this.eventManager.addEventListener(e,"mousedown",i=>Xl(hc,this,I_e).call(this,i)),this.eventManager.addEventListener(n,"mousemove",i=>Xl(hc,this,P_e).call(this,i)),this.eventManager.addEventListener(n,"mouseup",()=>Xl(hc,this,N_e).call(this)),this.eventManager.addEventListener(Oe(Er,this),"contextmenu",()=>Xl(hc,this,D_e).call(this))}destroy(){super.destroy()}}function H_e(t){if(!H4(t.target)&&Oe(I0,this)!==!0&&this.checkIfRowHeader(t.target)){const e=this.getClosestTHParent(t.target);e&&(Oe(Id,this)||this.setupHandlePosition(e))}}function I_e(t){Xe(t.target,"manualRowResizer")&&(this.setupHandlePosition(Oe(Ua,this)),this.setupGuidePosition(),jn(Id,this,!0),Oe(Xv,this)===null&&(jn(Xv,this,setTimeout(()=>this.afterMouseDownTimeout(),500)),this.hot._registerTimeout(Oe(Xv,this))),jn(Ng,this,Oe(Ng,this)+1),jn(CL,this,t.pageY),jn(Mc,this,Oe(Gg,this)))}function P_e(t){Oe(Id,this)&&(jn(Kv,this,Oe(Gg,this)+(t.pageY-Oe(CL,this))),U(Oe(ko,this),e=>{jn(Mc,this,this.setManualSize(e,Oe(Kv,this)))}),this.refreshHandlePosition(),this.refreshGuidePosition())}function N_e(){const t=()=>{this.hot.view.adjustElementsSize(),this.hot.render()},e=(n,i)=>{this.hot.runHooks("beforeRowResize",this.getActualRowHeight(n),n,!1),i&&t(),this.saveManualRowHeights(),this.hot.runHooks("afterRowResize",this.getActualRowHeight(n),n,!1)};Oe(Id,this)&&(this.hideHandleAndGuide(),jn(Id,this,!1),Oe(Mc,this)!==Oe(Gg,this)&&(Oe(ko,this).length>1?(U(Oe(ko,this),i=>{e(i)}),t()):U(Oe(ko,this),i=>{e(i,!0)})),this.setupHandlePosition(Oe(Ua,this)))}function D_e(){this.hideHandleAndGuide(),this.hot.rootElement.removeChild(Oe(Er,this)),this.hot.rootElement.removeChild(Oe(Wa,this)),jn(Id,this,!1),jn(I0,this,!0),this.hot._registerImmediate(()=>{jn(I0,this,!1)})}function L_e(t,e){let n=t;if(this.enabled){const r=this.hot.toPhysicalRow(e),o=Oe(ra,this).getValueAtIndex(r);if(this.hot.getSettings()[H0]&&o){var i;(i=this.hot.getPlugin("autoRowSize"))!==null&&i!==void 0&&i.isEnabled()?n=Math.max(o,n??0):n=o}}return n}function k_e(){const t=this.hot.getSettings()[H0],e=this.loadManualRowHeights();this.hot.batchExecution(()=>{typeof e<"u"?e.forEach((n,i)=>{Oe(ra,this).setValueAtIndex(i,n)}):Array.isArray(t)?(t.forEach((n,i)=>{Oe(ra,this).setValueAtIndex(i,n)}),jn(Zv,this,t)):t===!0&&Array.isArray(Oe(Zv,this))&&Oe(Zv,this).forEach((n,i)=>{Oe(ra,this).setValueAtIndex(i,n)})},!0)}var jG={},zG;function $_e(){if(zG)return jG;zG=1;var t=bR();return t("flatMap"),jG}$_e();var UG={},YG={},ax,GG;function V_e(){if(GG)return ax;GG=1;var t=Oi(),e=Hi(),n=ol(),i=YI();return ax=function(r,o){(!o||typeof r!="string")&&e(r);var a=i(r);return n(e(a!==void 0?t(a,r):r))},ax}var qG;function B_e(){if(qG)return YG;qG=1;var t=Cn(),e=Oi(),n=uo(),i=Hi(),r=ol(),o=V_e(),a=KI(),u=co(),h=Fc(),d=XI(),g=jc(),m=!h&&!d("flatMap",function(){}),v=!h&&!m&&g("flatMap",TypeError),y=h||m||v,b=a(function(){for(var C=this.iterator,T=this.mapper,O,A;;){if(A=this.inner)try{if(O=i(e(A.next,A.iterator)),!O.done)return O.value;this.inner=null}catch(N){u(C,"throw",N)}if(O=i(e(this.next,C)),this.done=!!O.done)return;try{this.inner=o(T(O.value,this.counter++),!1)}catch(N){u(C,"throw",N)}}});return t({target:"Iterator",proto:!0,real:!0,forced:y},{flatMap:function(T){i(this);try{n(T)}catch(O){u(this,"throw",O)}return v?e(v,this,T):new b(r(this),{mapper:T,inner:null})}}),YG}var KG;function F_e(){return KG||(KG=1,B_e()),UG}F_e();function W_e(t,e,n){j_e(t,e),e.set(t,n)}function j_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function zh(t,e,n){return(e=z_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function z_e(t){var e=U_e(t,"string");return typeof e=="symbol"?e:e+""}function U_e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XG(t,e){return t.get(o9(t,e))}function Db(t,e,n){return t.set(o9(t,e),n),n}function o9(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Uh=new WeakMap;class Ya{constructor(e,n,i,r,o,a){zh(this,"row",void 0),zh(this,"col",void 0),zh(this,"rowspan",void 0),zh(this,"colspan",void 0),zh(this,"removed",!1),zh(this,"cellCoordsFactory",void 0),zh(this,"cellRangeFactory",void 0),W_e(this,Uh,null),this.row=e,this.col=n,this.rowspan=i,this.colspan=r,this.cellCoordsFactory=o,this.cellRangeFactory=a}static NEGATIVE_VALUES_WARNING(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return Ft`The merged cell declared with {row: ${n}, col: ${i},\x20
      rowspan: ${r}, colspan: ${o}} contains negative values, which is\x20
      not supported. It will not be added to the collection.`}static IS_OUT_OF_BOUNDS_WARNING(e){let{row:n,col:i}=e;return Ft`The merged cell declared at [${n}, ${i}] is positioned\x20
      (or positioned partially) outside of the table range. It was not added to the table, please fix your setup.`}static IS_SINGLE_CELL(e){let{row:n,col:i}=e;return Ft`The merged cell declared at [${n}, ${i}] has both "rowspan"\x20
      and "colspan" declared as "1", which makes it a single cell. It cannot be added to the collection.`}static ZERO_SPAN_WARNING(e){let{row:n,col:i}=e;return Ft`The merged cell declared at [${n}, ${i}] has "rowspan"\x20
      or "colspan" declared as "0", which is not supported. It cannot be added to the collection.`}static containsNegativeValues(e){let{row:n,col:i,rowspan:r,colspan:o}=e;return n<0||i<0||r<0||o<0}static isSingleCell(e){let{rowspan:n,colspan:i}=e;return i===1&&n===1}static containsZeroSpan(e){let{rowspan:n,colspan:i}=e;return i===0||n===0}static isOutOfBounds(e,n,i){return e.row<0||e.col<0||e.row>=n||e.row+e.rowspan-1>=n||e.col>=i||e.col+e.colspan-1>=i}normalize(e){const n=e.countRows(),i=e.countCols();this.row<0?this.row=0:this.row>n-1&&(this.row=n-1),this.col<0?this.col=0:this.col>i-1&&(this.col=i-1),this.row+this.rowspan>n-1&&(this.rowspan=n-this.row),this.col+this.colspan>i-1&&(this.colspan=i-this.col),Db(Uh,this,null)}includes(e,n){return this.row<=e&&this.col<=n&&this.row+this.rowspan-1>=e&&this.col+this.colspan-1>=n}includesHorizontally(e){return this.col<=e&&this.col+this.colspan-1>=e}includesVertically(e){return this.row<=e&&this.row+this.rowspan-1>=e}shift(e,n){const i=e[0]||e[1],r=n+Math.abs(e[0]||e[1])-1,o=e[0]?"colspan":"rowspan",a=e[0]?"col":"row",u=Math.min(n,r),h=Math.max(n,r),d=this[a],g=this[a]+this[o]-1;if(d>=n&&(this[a]+=i),i>0)n<=g&&n>d&&(this[o]+=i);else if(i<0){if(u<=d&&h>=g)return this.removed=!0,Db(Uh,this,null),!1;if(d>=u&&d<=h){const m=h-d+1,v=Math.abs(i)-m;this[a]-=v+i,this[o]-=m}else if(d<=u&&g>=h)this[o]+=i;else if(d<=u&&g>=u&&g<h){const m=g-u+1;this[o]-=m}}return Db(Uh,this,null),!0}isFarther(e,n){return e?n==="down"?e.row+e.rowspan-1<this.row+this.rowspan-1:n==="up"?e.row>this.row:n==="right"?e.col+e.colspan-1<this.col+this.colspan-1:n==="left"?e.col>this.col:null:!0}getLastRow(){return this.row+this.rowspan-1}getLastColumn(){return this.col+this.colspan-1}getRange(){return XG(Uh,this)||Db(Uh,this,this.cellRangeFactory(this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.row,this.col),this.cellCoordsFactory(this.getLastRow(),this.getLastColumn()))),XG(Uh,this)}}function Y_e(t,e){G_e(t,e),e.add(t)}function G_e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Lb(t,e,n){return(e=q_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q_e(t){var e=K_e(t,"string");return typeof e=="symbol"?e:e+""}function K_e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Yh(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var dc=new WeakSet;class P0{constructor(e){Y_e(this,dc),Lb(this,"plugin",void 0),Lb(this,"mergedCells",[]),Lb(this,"mergedCellsMatrix",new Map),Lb(this,"hot",void 0),this.plugin=e,this.hot=e.hot}static IS_OVERLAPPING_WARNING(e){let{row:n,col:i}=e;return Ft`The merged cell declared at [${n}, ${i}], overlaps\x20
      with the other declared merged cell. The overlapping merged cell was not added to the table, please\x20
      fix your setup.`}get(e,n){var i;return this.mergedCellsMatrix.has(e)&&(i=this.mergedCellsMatrix.get(e).get(n))!==null&&i!==void 0?i:!1}getByRange(e){const{row:n,col:i}=e.getTopStartCorner(),{row:r,col:o}=e.getBottomEndCorner(),a=this.mergedCells.length;let u=!1;for(let h=0;h<a;h++){const d=this.mergedCells[h],{row:g,col:m,rowspan:v,colspan:y}=d;if(g>=n&&g+v-1<=r&&m>=i&&m+y-1<=o){u=d;break}}return u}filterOverlappingMergeCells(e){const n=new Set;return this.mergedCells.forEach(r=>{const{row:o,col:a,colspan:u,rowspan:h}=r;for(let d=o;d<o+h;d++)for(let g=a;g<a+u;g++)n.add(`r${d},c${g}`)}),e.filter(r=>{const{row:o,col:a,colspan:u,rowspan:h}=r,d=new Set;let g=!1;for(let m=o;m<o+h;m++){for(let v=a;v<a+u;v++){const y=`r${m},c${v}`;if(n.has(y)){_t(P0.IS_OVERLAPPING_WARNING(r)),g=!0;break}d.add(y)}if(g)break}return g||n.add(...d),!g})}getWithinRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const{row:i,col:r}=e.getTopStartCorner(),{row:o,col:a}=e.getBottomEndCorner(),u=[];for(let h=i;h<=o;h++)for(let d=r;d<=a;d++){const g=this.get(h,d);g&&(n||!n&&g.row===h&&g.col===d)&&u.push(g)}return u}add(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=e.row,r=e.col,o=e.rowspan,a=e.colspan,u=new Ya(i,r,o,a,this.hot._createCellCoords,this.hot._createCellRange),h=this.get(i,r),d=n?!1:this.isOverlapping(u);return!h&&!d?(this.hot&&u.normalize(this.hot),this.mergedCells.push(u),Yh(dc,this,ZG).call(this,u),u):(d&&_t(P0.IS_OVERLAPPING_WARNING(u)),!1)}remove(e,n){const i=this.get(e,n),r=i?this.mergedCells.indexOf(i):-1;return i&&r!==-1?(this.mergedCells.splice(r,1),Yh(dc,this,X_e).call(this,i),i):!1}clear(){U(this.mergedCells,e=>{let{row:n,col:i,rowspan:r,colspan:o}=e;ze(n,n+r,a=>{ze(i,i+o,u=>{const h=this.hot.getCell(a,u);h&&(h.removeAttribute("rowspan"),h.removeAttribute("colspan"),h.style.display="")})})}),this.mergedCells.length=0,this.mergedCellsMatrix=new Map}isOverlapping(e){const n=e.getRange();for(let i=0;i<this.mergedCells.length;i++)if(this.mergedCells[i].getRange().overlaps(n))return!0;return!1}isFirstRenderableMergedCell(e,n){const i=this.get(e,n);if(!i)return!1;const{row:r,col:o,rowspan:a,colspan:u}=i,h=this.hot.view.getActiveOverlayName(),d=["top","top_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleRow(),g=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(h)?0:this.hot.getFirstRenderedVisibleColumn(),m=St(d,r,r+a-1),v=St(g,o,o+u-1);return this.hot.rowIndexMapper.getNearestNotHiddenIndex(m,1)===e&&this.hot.columnIndexMapper.getNearestNotHiddenIndex(v,1)===n}getFirstRenderableCoords(e,n){const i=this.get(e,n);if(!i||this.isFirstRenderableMergedCell(e,n))return this.hot._createCellCoords(e,n);const r=this.hot.rowIndexMapper.getNearestNotHiddenIndex(i.row,1),o=this.hot.columnIndexMapper.getNearestNotHiddenIndex(i.col,1);return this.hot._createCellCoords(r,o)}getStartMostColumnIndex(e,n){const i=Yh(dc,this,kb).call(this,e,"col",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getEndMostColumnIndex(e,n){const i=Yh(dc,this,kb).call(this,e,"col",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}getTopMostRowIndex(e,n){const i=Yh(dc,this,kb).call(this,e,"row",-1);let r=n;for(let o=0;o<i.length;o++)if(i[o]<=n){r=i[o];break}return r}getBottomMostRowIndex(e,n){const i=Yh(dc,this,kb).call(this,e,"row",1);let r=n;for(let o=0;o<i.length;o++)if(i[o]>=n){r=i[o];break}return r}shiftCollections(e,n,i){const r=[0,0];switch(e){case"right":r[0]+=i;break;case"left":r[0]-=i;break;case"down":r[1]+=i;break;case"up":r[1]-=i;break}const o=[];this.mergedCells.forEach(a=>{a.shift(r,n),a.removed&&o.push(a)}),o.forEach(a=>{this.mergedCells.splice(this.mergedCells.indexOf(a),1)}),this.mergedCellsMatrix.clear(),this.mergedCells.forEach(a=>{Yh(dc,this,ZG).call(this,a)})}}function kb(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=new Map,r=n===1?t.getTopStartCorner():t.getBottomEndCorner(),o=n===1?t.getBottomEndCorner():t.getTopStartCorner();for(let a=r.row;n===1?a<=o.row:a>=o.row;a+=n)for(let u=r.col;n===1?u<=o.col:u>=o.col;u+=n){const h=e==="row"?a:u,d=this.get(a,u);let g=h;d&&(g=n===1?d[e]+d[`${e}span`]-1:d[e]),i.has(h)||i.set(h,new Set),i.get(h).add(g)}return Array.from(new Set(Array.from(i.entries()).filter(a=>{let[,u]=a;return u.size===1}).flatMap(a=>{let[,u]=a;return Array.from(u)})))}function ZG(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.has(e)||this.mergedCellsMatrix.set(e,new Map),this.mergedCellsMatrix.get(e).set(n,t)}function X_e(t){for(let e=t.row;e<t.row+t.rowspan;e++)for(let n=t.col;n<t.col+t.colspan;n++)this.mergedCellsMatrix.get(e).delete(n)}function lx(t,e,n){return(e=Z_e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Z_e(t){var e=Q_e(t,"string");return typeof e=="symbol"?e:e+""}function Q_e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class J_e{constructor(e){lx(this,"plugin",void 0),lx(this,"mergedCellsCollection",void 0),lx(this,"currentFillData",null),this.plugin=e,this.mergedCellsCollection=this.plugin.mergedCellsCollection}getDirection(e,n){let i=null;return n[0]===e[0]&&n[1]===e[1]&&n[3]===e[3]?i="down":n[2]===e[2]&&n[1]===e[1]&&n[3]===e[3]?i="up":n[1]===e[1]&&n[2]===e[2]?i="right":i="left",i}snapDragArea(e,n,i,r){const o=n.slice(0),a=this.getAutofillSize(e,n,i),[u,h,d,g]=e,v=["up","down"].indexOf(i)>-1?d-u+1:g-h+1,y=Math.floor(a/v)*v,b=a-y,C=this.getFarthestCollection(e,n,i,r);if(C){if(i==="down"){const T=C.row+C.rowspan-u-b;o[2]+T>=this.plugin.hot.countRows()?o[2]-=b:o[2]+=b?T:0}else if(i==="right"){const T=C.col+C.colspan-h-b;o[3]+T>=this.plugin.hot.countCols()?o[3]-=b:o[3]+=b?T:0}else if(i==="up"){const T=d-b-C.row+1;o[0]+T<0?o[0]+=b:o[0]-=b?T:0}else if(i==="left"){const T=g-b-C.col+1;o[1]+T<0?o[1]+=b:o[1]-=b?T:0}}return this.updateCurrentFillCache({baseArea:e,dragDirection:i,foundMergedCells:r,fillSize:a,dragArea:o,cycleLength:v}),o}updateCurrentFillCache(e){this.currentFillData||(this.currentFillData={}),Mi(this.currentFillData,e)}getAutofillSize(e,n,i){const[r,o,a,u]=e,[h,d,g,m]=n;switch(i){case"up":return r-h;case"down":return g-a;case"left":return o-d;case"right":return m-u;default:return null}}getDragArea(e,n,i){const[r,o,a,u]=e,[h,d,g,m]=n;switch(i){case"up":return[h,d,r-1,u];case"down":{const v=this.mergedCellsCollection.get(g,u),y=v?v.rowspan-1:0;return[a+1,o,g+y,u]}case"left":return[h,d,a,o-1];case"right":{const v=this.mergedCellsCollection.get(g,u),y=v?v.colspan-1:0;return[r,u+y,g,m]}default:return null}}getFarthestCollection(e,n,i,r){const[o,a,u,h]=e,d=["up","down"].indexOf(i)>-1,g=d?u:h,m=d?o:a,v=this.getAutofillSize(e,n,i),y=d?u-o+1:h-a+1,b=Math.floor(v/y)*y,C=v-b;let T=null,O=null,A=null;switch(i){case"up":T="includesVertically",A=g-C+1;break;case"left":T="includesHorizontally",A=g-C+1;break;case"down":T="includesVertically",A=m+C-1;break;case"right":T="includesHorizontally",A=m+C-1;break}return U(r,N=>{N[T](A)&&N.isFarther(O,i)&&(O=N)}),O}recreateAfterDataPopulation(e){if(!this.currentFillData)return;const n=this.getRangeFromChanges(e),i=this.currentFillData.foundMergedCells,r=this.currentFillData.dragDirection,o=(d,g)=>{switch(r){case"up":return d.row-g>=n.from.row;case"down":return d.row+d.rowspan-1+g<=n.to.row;case"left":return d.col-g>=n.from.column;case"right":return d.col+d.colspan-1+g<=n.to.column;default:return null}};let a=0,u=null,h=1;do for(let d=0;d<i.length;d+=1){if(u=i[d],a=h*this.currentFillData.cycleLength,o(u,a))switch(r){case"up":this.plugin.mergedCellsCollection.add({row:u.row-a,rowspan:u.rowspan,col:u.col,colspan:u.colspan},!0);break;case"down":this.plugin.mergedCellsCollection.add({row:u.row+a,rowspan:u.rowspan,col:u.col,colspan:u.colspan},!0);break;case"left":this.plugin.mergedCellsCollection.add({row:u.row,rowspan:u.rowspan,col:u.col-a,colspan:u.colspan},!0);break;case"right":this.plugin.mergedCellsCollection.add({row:u.row,rowspan:u.rowspan,col:u.col+a,colspan:u.colspan},!0);break}d===i.length-1&&(h+=1)}while(o(u,a));this.currentFillData=null,this.plugin.hot.render(),i.length>0&&this.plugin.ifChromeForceRepaint()}getRangeFromChanges(e){const n={min:null,max:null},i={min:null,max:null};return U(e,r=>{const o=r[0],a=this.plugin.hot.propToCol(r[1]);(n.min===null||o<n.min)&&(n.min=o),(n.max===null||o>n.max)&&(n.max=o),(i.min===null||a<i.min)&&(i.min=a),(i.max===null||a>i.max)&&(i.max=a)}),{from:{row:n.min,column:i.min},to:{row:n.max,column:i.max}}}dragAreaOverlapsCollections(e,n,i){const r=this.getDragArea(e,n,i),[o,a,u,h]=r,d=this.plugin.hot._createCellCoords(o,a),g=this.plugin.hot._createCellCoords(u,h),m=this.plugin.hot._createCellRange(d,d,g);if(this.mergedCellsCollection.getWithinRange(m,!0).length===0)return!1;const y=this.mergedCellsCollection.getWithinRange(m,!1);return y.length===0?!0:i==="up"||i==="down"?!y.every(b=>{let{colspan:C}=b;return C===m.getWidth()}):!y.every(b=>{let{rowspan:C}=b;return C===m.getHeight()})}}function ux(t,e,n){return(e=e1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function e1e(t){var e=t1e(t,"string");return typeof e=="symbol"?e:e+""}function t1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class n1e{constructor(e){ux(this,"plugin",void 0),ux(this,"hot",void 0),ux(this,"fullySelectedMergedCellClassName","fullySelectedMergedCell"),this.plugin=e,this.hot=e.hot}getSelectedMergedCellClassName(e,n,i,r){const o=Math.min(i[0],i[2]),a=Math.min(i[1],i[3]),u=Math.max(i[0],i[2]),h=Math.max(i[1],i[3]);if(r===void 0||!this.plugin.mergedCellsCollection.isFirstRenderableMergedCell(e,n))return;const g=this.plugin.mergedCellsCollection.get(e,n);if(!g)return;const m=g.getLastRow(),v=g.getLastColumn();if(o<=g.row&&a<=g.col&&u>=m&&h>=v)return`${this.fullySelectedMergedCellClassName}-${r}`;if(this.isMergeCellFullySelected(g,this.plugin.hot.getSelectedRange()))return`${this.fullySelectedMergedCellClassName}-multiple`}isMergeCellFullySelected(e,n){const i=[];if(!n||!e)return!1;for(let r=0;r<e.rowspan;r+=1)for(let o=0;o<e.colspan;o+=1)i.push(this.hot._createCellCoords(e.row+r,e.col+o));for(let r=0;r<i.length;r+=1){const o=[];for(let a=0;a<n.length;a+=1)o[a]=n[a].includes(i[r]);if(!o.includes(!0))return!1}return!0}getSelectedMergedCellClassNameToRemove(){const e=[];for(let n=0;n<=7;n+=1)e.push(`${this.fullySelectedMergedCellClassName}-${n}`);return e.push(`${this.fullySelectedMergedCellClassName}-multiple`),e}}function i1e(t){return{key:"mergeCells",name(){const e=this.getSelectedActive();if(e){const n=t.mergedCellsCollection.get(e[0],e[1]);if(n.row===e[0]&&n.col===e[1]&&n.row+n.rowspan-1===e[2]&&n.col+n.colspan-1===e[3])return this.getTranslatedPhrase(yN)}return this.getTranslatedPhrase(wN)},callback(){const e=this.getSelectedRangeActive();if(!e)return;e.setDirection(this.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;t.toggleMerge(e),this.selectCell(n.row,n.col,i.row,i.col,!1)},disabled(){const e=this.getSelectedActive();return e?Ya.isSingleCell({row:e[0],col:e[1],rowspan:e[2]-e[0]+1,colspan:e[3]-e[1]+1})||this.selection.isSelectedByCorner():!0},hidden:!1}}function Qv(t,e,n){return(e=r1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function r1e(t){var e=o1e(t,"string");return typeof e=="symbol"?e:e+""}function o1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class QG{constructor(e){Qv(this,"data",void 0),Qv(this,"next",null),Qv(this,"prev",null),this.data=e}}class $b{constructor(){Qv(this,"first",null),Qv(this,"last",null)}push(e){const n=new QG(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.last;this.last=n,n.prev=i,i.next=n}return n}unshift(e){const n=new QG(e);if(this.first===null)this.first=n,this.last=n;else{const i=this.first;this.first=n,n.next=i,i.prev=n}}inorder(e){let n=this.first;for(;n;){const i=e(n);if(n===this.last||i===!0)break;n=n.next}}remove(e){if(this.first===null)return!1;let n=this.first,i,r;for(;n;){if(n.data===e)return i=n.next,r=n.prev,i&&(i.prev=r),r&&(r.next=i),n===this.first&&(this.first=i),n===this.last&&(this.last=r),!0;n=n.next}return!1}hasCycle(){let e=this.first,n=this.first;for(;;){if(e===null||(e=e.next,e===null))return!1;if(e=e.next,n=n.next,e===n)return!0}}pop(){if(this.last===null)return null;const e=this.last;return this.last=this.last.prev,e}shift(){if(this.first===null)return null;const e=this.first;return this.first=this.first.next,e}recursiveReverse(){function e(i,r){r&&(e(r,r.next),r.next=i)}if(!this.first)return;e(this.first,this.first.next),this.first.next=null;const n=this.first;this.first=this.last,this.last=n}reverse(){if(!this.first||!this.first.next)return;let e=this.first.next,n=this.first,i;for(;e;)i=e.next,e.next=n,n.prev=e,n=e,e=i;this.first.next=null,this.last.prev=null,i=this.first,this.first=n,this.last=i}}function s1e(t,e){s9(t,e),e.add(t)}function Gh(t,e,n){s9(t,e),e.set(t,n)}function s9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zt(t,e){return t.get(N0(t,e))}function To(t,e,n){return t.set(N0(t,e),n),n}function N0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Pa=new WeakMap,Na=new WeakMap,Da=new WeakMap,La=new WeakMap,CI=new WeakMap,Vb=new WeakMap,Bb=new WeakMap,cx=new WeakSet;class a1e{constructor(e){let{mergedCellsGetter:n,rowIndexMapper:i,columnIndexMapper:r}=e;s1e(this,cx),Gh(this,Pa,new $b),Gh(this,Na,new $b),Gh(this,Da,null),Gh(this,La,null),Gh(this,CI,null),Gh(this,Vb,null),Gh(this,Bb,null),To(CI,this,n),To(Vb,this,i),To(Bb,this,r)}getCurrentVerticalNode(){return Zt(La,this).data}getFirstVerticalNode(){return Zt(Na,this).first.data}getNextVerticalNode(){return Zt(La,this).next.data}getPrevVerticalNode(){return Zt(La,this).prev.data}getCurrentHorizontalNode(){return Zt(Da,this).data}getFirstHorizontalNode(){return Zt(Pa,this).first.data}getNextHorizontalNode(){return Zt(Da,this).next.data}getPrevHorizontalNode(){return Zt(Da,this).prev.data}setPrevNodeAsActive(){To(La,this,Zt(La,this).prev),To(Da,this,Zt(Da,this).prev)}setNextNodeAsActive(){To(La,this,Zt(La,this).next),To(Da,this,Zt(Da,this).next)}buildFocusOrder(e){To(Pa,this,new $b),e.forEach((n,i)=>{const r=new WeakSet,o=n.getTopStartCorner(),a=n.getBottomEndCorner();for(let u=o.row;u<=a.row;u++)if(!Zt(Vb,this).isHidden(u))for(let h=o.col;h<=a.col;h++){if(Zt(Bb,this).isHidden(h))continue;const d=N0(cx,this,JG).call(this,{selectedRange:n,selectionLayer:i,listOrder:Zt(Pa,this),mergeCellsVisitor:r,row:u,column:h});d&&To(Da,this,d)}}),Zt(Pa,this).first&&(Zt(Pa,this).first.prev=Zt(Pa,this).last,Zt(Pa,this).last.next=Zt(Pa,this).first),To(Na,this,new $b),e.forEach((n,i)=>{const r=new WeakSet,o=n.getTopStartCorner(),a=n.getBottomEndCorner();for(let u=o.col;u<=a.col;u++)if(!Zt(Bb,this).isHidden(u))for(let h=o.row;h<=a.row;h++){if(Zt(Vb,this).isHidden(h))continue;const d=N0(cx,this,JG).call(this,{selectedRange:n,selectionLayer:i,listOrder:Zt(Na,this),mergeCellsVisitor:r,row:h,column:u});d&&To(La,this,d)}}),Zt(Na,this).first&&(Zt(Na,this).first.prev=Zt(Na,this).last,Zt(Na,this).last.next=Zt(Na,this).first)}setActiveNode(e,n,i){return Zt(Pa,this).inorder(r=>{const{selectionLayer:o,rowStart:a,rowEnd:u,colStart:h,colEnd:d}=r.data;if(o===i&&e>=a&&e<=u&&n>=h&&n<=d)return To(Da,this,r),!0}),Zt(Na,this).inorder(r=>{const{selectionLayer:o,rowStart:a,rowEnd:u,colStart:h,colEnd:d}=r.data;if(o===i&&e>=a&&e<=u&&n>=h&&n<=d)return To(La,this,r),!0}),this}}function JG(t){let{selectedRange:e,selectionLayer:n,listOrder:i,mergeCellsVisitor:r,row:o,column:a}=t;const u=e.getTopStartCorner(),h=e.getBottomEndCorner(),d=e.highlight.clone().normalize(),g=Zt(CI,this).call(this,o,a);if(g&&r.has(g))return null;const m={selectionLayer:n,colStart:a,colEnd:a,rowStart:o,rowEnd:o};if(g){if(r.add(g),g.row<u.row||g.row+g.rowspan-1>h.row||g.col<u.col||g.col+g.colspan-1>h.col)return null;m.colStart=g.col,m.colEnd=g.col+g.colspan-1,m.rowStart=g.row,m.rowEnd=g.row+g.rowspan-1}const v=i.push(m);return o===d.row&&a===d.col||g&&d.row>=g.row&&d.row<=g.row+g.rowspan-1&&d.col>=g.col&&d.col<=g.col+g.colspan-1?v:null}function a9(t,e,n){const{rowIndexMapper:i,stylesHandler:r}=t,o=r.getDefaultRowHeight();let a=0;for(let h=e;h<e+n;h++)if(!i.isHidden(h)){var u;a+=(u=t.getRowHeight(h))!==null&&u!==void 0?u:o,h===0&&!r.isClassicTheme()&&(a+=1)}return a}function l1e(t){const{hot:e}=t,{rowIndexMapper:n,columnIndexMapper:i}=e,r=new Map;function o(){}function a(u,h,d){const g=t.mergedCellsCollection.get(h,d);if(!Qe(g)){u.removeAttribute("rowspan"),u.removeAttribute("colspan"),r.has(h)&&!e.getSettings().rowHeaders&&(u.style.height=`${r.get(h)}px`,r.delete(h)),u.style.display="";return}const{row:m,col:v,colspan:y,rowspan:b}=g,[C,T]=t.translateMergedCellToRenderable(m,b,v,y),O=t.getSetting("virtualized");if(v===0&&!e.getSettings().rowHeaders){const X=e._getRowHeightFromSettings(h);if(X!==void 0){const re=e.stylesHandler.areCellsBorderBox()?0:1;r.set(h,X-re)}else if(vR()){const me=a9(e,m,b);r.set(h,me/b)}}const A=n.getRenderableFromVisualIndex(h),N=i.getRenderableFromVisualIndex(d),x=C-A+1,$=T-N+1;let L=n.getNearestNotHiddenIndex(m,1),P=i.getNearestNotHiddenIndex(v,1);if(O){const X=e.view.getActiveOverlayName();["top","top_inline_start_corner"].includes(X)||(L=Math.max(L,e.getFirstRenderedVisibleRow())),["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(X)||(P=Math.max(P,e.getFirstRenderedVisibleColumn()))}const Q=Math.min(b,x),ue=Math.min(y,$);L===h&&P===d?(u.setAttribute("rowspan",Q),u.setAttribute("colspan",ue)):(u.removeAttribute("rowspan"),u.removeAttribute("colspan"),u.style.display="none")}return{before:o,after:a}}function u1e(t,e){l9(t,e),e.add(t)}function Fb(t,e,n){l9(t,e),e.set(t,n)}function l9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function hx(t,e,n){return(e=c1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function c1e(t){var e=h1e(t,"string");return typeof e=="symbol"?e:e+""}function h1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Aw(t,e,n){return t.set(on(t,e),n),n}function Sn(t,e){return t.get(on(t,e))}function on(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}He.getSingleton().register("beforeMergeCells");He.getSingleton().register("afterMergeCells");He.getSingleton().register("beforeUnmergeCells");He.getSingleton().register("afterUnmergeCells");const RI="mergeCells",d1e=150,e3=RI;var Rs=new WeakMap,Es=new WeakMap,Ja=new WeakMap,t3=new WeakMap,fn=new WeakSet;class f1e extends Dt{constructor(){super(...arguments),u1e(this,fn),hx(this,"mergedCellsCollection",null),hx(this,"autofillCalculations",null),hx(this,"selectionCalculations",null),Fb(this,Rs,null),Fb(this,Es,{row:0,col:0}),Fb(this,Ja,new a1e({mergedCellsGetter:(e,n)=>this.mergedCellsCollection.get(e,n),rowIndexMapper:this.hot.rowIndexMapper,columnIndexMapper:this.hot.columnIndexMapper})),Fb(this,t3,l1e(this))}static get PLUGIN_KEY(){return RI}static get PLUGIN_PRIORITY(){return d1e}static get DEFAULT_SETTINGS(){return{[TK]:"cells",virtualized:!1,cells:[]}}isEnabled(){return!!this.hot.getSettings()[RI]}enablePlugin(){var e=this;this.enabled||(this.mergedCellsCollection=new P0(this),this.autofillCalculations=new J_e(this),this.selectionCalculations=new n1e(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,g1e).call(e,...i)}),this.addHook("modifyTransformFocus",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,p1e).call(e,...i)}),this.addHook("modifyTransformStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,v1e).call(e,...i)}),this.addHook("modifyTransformEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,w1e).call(e,...i)}),this.addHook("beforeSelectionHighlightSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,y1e).call(e,...i)}),this.addHook("beforeSetRangeStart",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,i3).call(e,...i)}),this.addHook("beforeSetRangeStartOnly",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,i3).call(e,...i)}),this.addHook("beforeSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,b1e).call(e,...i)}),this.addHook("afterSelectionFocusSet",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,C1e).call(e,...i)}),this.addHook("afterSelectionEnd",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,R1e).call(e,...i)}),this.addHook("modifyGetCellCoords",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,n3).call(e,...i)}),this.addHook("modifyGetCoordsElement",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,n3).call(e,...i)}),this.addHook("afterIsMultipleSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,m1e).call(e,...i)}),this.addHook("afterRenderer",function(){return Sn(t3,e).after(...arguments)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,S1e).call(e,...i)}),this.addHook("afterGetCellMeta",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,E1e).call(e,...i)}),this.addHook("afterViewportRowCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,T1e).call(e,...i)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,_1e).call(e,...i)}),this.addHook("modifyAutofillRange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,M1e).call(e,...i)}),this.addHook("afterCreateCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,A1e).call(e,...i)}),this.addHook("afterRemoveCol",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,O1e).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,x1e).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,H1e).call(e,...i)}),this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,I1e).call(e,...i)}),this.addHook("beforeDrawBorders",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,P1e).call(e,...i)}),this.addHook("afterDrawSelection",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,N1e).call(e,...i)}),this.addHook("beforeRemoveCellClassNames",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,D1e).call(e,...i)}),this.addHook("beforeBeginEditing",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,L1e).call(e,...i)}),this.addHook("modifyRowHeightByOverlayName",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return on(fn,e,k1e).call(e,...i)}),this.addHook("beforeUndoStackChange",(n,i)=>{if(i==="MergeCells")return!1}),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.clearCollections(),this.unregisterShortcuts(),this.hot.render(),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),this.generateFromSettings(),super.updatePlugin()}ifChromeForceRepaint(){if(!w4())return;const e=[];let n=[];this.mergedCellsCollection.mergedCells.forEach(i=>{const{row:r,rowspan:o}=i;for(let a=r+1;a<r+o;a++)n.push(a)}),n=[...new Set(n)],n.forEach(i=>{const r=this.hot.rowIndexMapper.getRenderableFromVisualIndex(i);this.hot.view._wt.wtOverlays.getOverlays(!0).map(o=>o?.name==="master"?o:o.clone.wtTable).forEach(o=>{const a=o.getRow(r);a&&(a.style.background=ZC(a,"backgroundColor").replace(")",", 0.99)"),e.push(a))})}),this.hot._registerTimeout(()=>{e.forEach(i=>{var r;i.style.background=(r=ZC(i,"backgroundColor"))===null||r===void 0?void 0:r.replace(", 0.99)",")")})},1)}validateSetting(e){return e?Ya.containsNegativeValues(e)?(_t(Ya.NEGATIVE_VALUES_WARNING(e)),!1):Ya.isOutOfBounds(e,this.hot.countRows(),this.hot.countCols())?(_t(Ya.IS_OUT_OF_BOUNDS_WARNING(e)),!1):Ya.isSingleCell(e)?(_t(Ya.IS_SINGLE_CELL(e)),!1):Ya.containsZeroSpan(e)?(_t(Ya.ZERO_SPAN_WARNING(e)),!1):!0:!1}generateFromSettings(){const e=this.getSetting("cells").filter(r=>this.validateSetting(r)),n=this.mergedCellsCollection.filterOverlappingMergeCells(e),i=[];n.forEach(r=>{const{row:o,col:a,rowspan:u,colspan:h}=r,d=this.hot._createCellCoords(o,a),g=this.hot._createCellCoords(o+u-1,a+h-1),m=this.hot._createCellRange(d,d,g);this.mergeRange(m,!0,!0);for(let v=o;v<o+u;v++)for(let y=a;y<a+h;y++)(v!==o||y!==a)&&i.push([v,y,null])}),i.length!==0&&this.hot.setDataAtCell(i,void 0,void 0,this.pluginName)}clearCollections(){this.mergedCellsCollection.clear()}canMergeRange(e){return(arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1)?!0:this.validateSetting(e)}mergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;e.setDirection(this.hot.isRtl()?"NE-SW":"NW-SE");const{from:n,to:i}=e;this.unmergeRange(e,!0),this.mergeRange(e),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}unmergeSelection(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.hot.getSelectedRangeActive();if(!e)return;const{from:n,to:i}=e;this.unmergeRange(e,!0),this.hot.selectCell(n.row,n.col,i.row,i.col,!1)}mergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=e.getTopStartCorner(),o=e.getBottomEndCorner(),a={row:r.row,col:r.col,rowspan:o.row-r.row+1,colspan:o.col-r.col+1},u=[];let h=null;return this.canMergeRange(a,n)?(this.hot.runHooks("beforeMergeCells",e,n),ze(0,a.rowspan-1,g=>{ze(0,a.colspan-1,m=>{let v=null;u[g]||(u[g]=[]),g===0&&m===0?v=this.hot.getSourceDataAtCell(this.hot.toPhysicalRow(a.row),this.hot.toPhysicalColumn(a.col)):this.hot.setCellMeta(a.row+g,a.col+m,"hidden",!0),u[g][m]=v})}),this.hot.setCellMeta(a.row,a.col,"spanned",!0),this.mergedCellsCollection.add(a,n)?(i?h=[a.row,a.col,u]:this.hot.populateFromArray(a.row,a.col,u,void 0,void 0,this.pluginName),n||this.ifChromeForceRepaint(),this.hot.runHooks("afterMergeCells",e,a,n),h):!0):!1}unmergeRange(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;const i=this.mergedCellsCollection.getWithinRange(e);i.length!==0&&(this.hot.runHooks("beforeUnmergeCells",e,n),U(i,r=>{this.mergedCellsCollection.remove(r.row,r.col),ze(0,r.rowspan-1,o=>{ze(0,r.colspan-1,a=>{this.hot.removeCellMeta(r.row+o,r.col+a,"hidden"),this.hot.removeCellMeta(r.row+o,r.col+a,"copyable")})}),this.hot.removeCellMeta(r.row,r.col,"spanned")}),this.hot.runHooks("afterUnmergeCells",e,n),this.hot.render())}toggleMerge(e){const{from:n,to:i}=e.clone().normalize(),r=this.mergedCellsCollection.get(n.row,n.col);r.row===n.row&&r.col===n.col&&r.row+r.rowspan-1===i.row&&r.col+r.colspan-1===i.col?this.unmergeRange(e):this.mergeSelection(e)}merge(e,n,i,r){const o=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(i,r);this.mergeRange(this.hot._createCellRange(o,o,a))}unmerge(e,n,i,r){const o=this.hot._createCellCoords(e,n),a=this.hot._createCellCoords(i,r);this.unmergeRange(this.hot._createCellRange(o,o,a))}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Control","m"]],callback:()=>{const i=this.hot.getSelectedRangeActive();i&&!i.isSingleHeader()&&(this.toggleMerge(i),this.hot.render())},runOnlyIf:i=>!i.altKey,group:e3})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(e3)}modifyViewportRowStart(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.startRow);for(let o=0;o<n;o+=1){const a=this.mergedCellsCollection.get(r,o);if(Qe(a)){const u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a.row,1));if(u<e.startRow){e.startRow=u,this.modifyViewportRowStart(e,n);return}}}}modifyViewportRowEnd(e,n){const i=this.hot.rowIndexMapper,r=i.getVisualFromRenderableIndex(e.endRow);for(let o=0;o<n;o+=1){const a=this.mergedCellsCollection.get(r,o);if(Qe(a)){const u=a.row+a.rowspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(h>e.endRow){e.endRow=h,this.modifyViewportRowEnd(e,n);return}}}}modifyViewportColumnStart(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.startColumn);for(let o=0;o<n;o+=1){const a=this.mergedCellsCollection.get(o,r);if(Qe(a)){const u=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(a.col,1));if(u<e.startColumn){e.startColumn=u,this.modifyViewportColumnStart(e,n);return}}}}modifyViewportColumnEnd(e,n){const i=this.hot.columnIndexMapper,r=i.getVisualFromRenderableIndex(e.endColumn);for(let o=0;o<n;o+=1){const a=this.mergedCellsCollection.get(o,r);if(Qe(a)){const u=a.col+a.colspan-1,h=i.getRenderableFromVisualIndex(i.getNearestNotHiddenIndex(u,-1));if(h>e.endColumn){e.endColumn=h,this.modifyViewportColumnEnd(e,n);return}}}}translateMergedCellToRenderable(e,n,i,r){const{rowIndexMapper:o,columnIndexMapper:a}=this.hot;let u,h;n===0?u=o.getNearestNotHiddenIndex(e,1):u=o.getNearestNotHiddenIndex(e+n-1,-1),r===0?h=a.getNearestNotHiddenIndex(i,1):h=a.getNearestNotHiddenIndex(i+r-1,-1);const d=e>=0?o.getRenderableFromVisualIndex(u):e,g=i>=0?a.getRenderableFromVisualIndex(h):i;return[d,g]}}function g1e(){this.generateFromSettings(),this.hot.render()}function m1e(t){if(t){const e=this.mergedCellsCollection.mergedCells,n=this.hot.getSelectedRangeActive(),i=n.getTopStartCorner(),r=n.getBottomEndCorner();for(let o=0;o<e.length;o+=1)if(i.row===e[o].row&&i.col===e[o].col&&r.row===e[o].row+e[o].rowspan-1&&r.col===e[o].col+e[o].colspan-1)return!1}return t}function p1e(t){Sn(Es,this).row=t.row,Sn(Es,this).col=t.col}function v1e(t){const e=this.hot.getSelectedRangeActive(),{highlight:n}=e,{columnIndexMapper:i,rowIndexMapper:r}=this.hot;Sn(Rs,this)&&(r.getRenderableFromVisualIndex(Sn(Rs,this).row)!==null&&(n.row=Sn(Rs,this).row),i.getRenderableFromVisualIndex(Sn(Rs,this).col)!==null&&(n.col=Sn(Rs,this).col),Aw(Rs,this,null));const o=this.mergedCellsCollection.get(n.row,n.col);if(!o)return;const a=o.col,u=o.col+o.colspan-1;if(t.col<0){const g=n.col>=a&&n.col<=u?a-1:u,m=i.getNearestNotHiddenIndex(g,-1);m===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,n.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(m,n.col)-1,1)}else if(t.col>0){const g=n.col>=a&&n.col<=u?u+1:a,m=i.getNearestNotHiddenIndex(g,1);m===null?t.col=this.hot.view.countRenderableColumnsInRange(n.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(n.col,m)-1,1)}const h=o.row,d=o.row+o.rowspan-1;if(t.row<0){const g=n.row>=h&&n.row<=d?h-1:d,m=r.getNearestNotHiddenIndex(g,-1);m===null?t.row=-this.hot.view.countRenderableRowsInRange(0,n.row):t.row=-Math.max(this.hot.view.countRenderableRowsInRange(m,n.row)-1,1)}else if(t.row>0){const g=n.row>=h&&n.row<=d?d+1:h,m=r.getNearestNotHiddenIndex(g,1);m===null?t.row=this.hot.view.countRenderableRowsInRange(n.row,this.hot.countRows()):t.row=Math.max(this.hot.view.countRenderableRowsInRange(n.row,m)-1,1)}}function w1e(t){const e=this.hot.getSelectedRangeActive(),n=e.clone(),{to:i}=e,{columnIndexMapper:r,rowIndexMapper:o}=this.hot,a=(u,h)=>{n.expand(this.hot._createCellCoords(u,h));for(let d=0;d<this.mergedCellsCollection.mergedCells.length;d+=1)n.expandByRange(this.mergedCellsCollection.mergedCells[d].getRange())};if(t.col<0){let u=this.mergedCellsCollection.getStartMostColumnIndex(e,i.col)+t.col;a(i.row,u),e.getHorizontalDirection()==="E-W"&&n.getHorizontalDirection()==="E-W"&&(u=n.getTopStartCorner().col);const h=r.getNearestNotHiddenIndex(u,1);h!==null&&(t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(h,i.col)-1,1))}else if(t.col>0){let u=this.mergedCellsCollection.getEndMostColumnIndex(e,i.col)+t.col;a(i.row,u),e.getHorizontalDirection()==="W-E"&&n.getHorizontalDirection()==="W-E"&&(u=n.getBottomEndCorner().col);const h=r.getNearestNotHiddenIndex(u,-1);h!==null&&(t.col=Math.max(this.hot.view.countRenderableColumnsInRange(i.col,h)-1,1))}if(t.row<0){let u=this.mergedCellsCollection.getTopMostRowIndex(e,i.row)+t.row;a(u,i.col),e.getVerticalDirection()==="S-N"&&n.getVerticalDirection()==="S-N"&&(u=n.getTopStartCorner().row);const h=o.getNearestNotHiddenIndex(u,1);h!==null&&(t.row=-Math.max(this.hot.view.countRenderableRowsInRange(h,i.row)-1,1))}else if(t.row>0){let u=this.mergedCellsCollection.getBottomMostRowIndex(e,i.row)+t.row;a(u,i.col),e.getVerticalDirection()==="N-S"&&n.getVerticalDirection()==="N-S"&&(u=n.getBottomStartCorner().row);const h=o.getNearestNotHiddenIndex(u,-1);h!==null&&(t.row=Math.max(this.hot.view.countRenderableRowsInRange(i.row,h)-1,1))}}function y1e(){const t=this.hot.getSelectedRangeLast(),{highlight:e}=t;if(this.hot.selection.isSelectedByColumnHeader()||this.hot.selection.isSelectedByRowHeader()){Aw(Rs,this,e.clone());return}for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);for(let i=0;i<this.mergedCellsCollection.mergedCells.length;i+=1)t.expandByRange(this.mergedCellsCollection.mergedCells[i].getRange(),!1);const n=this.mergedCellsCollection.get(e.row,e.col);Aw(Rs,this,e.clone()),n&&e.assign(n)}function n3(t,e,n,i){if(t<0||e<0)return;const r=this.mergedCellsCollection.get(t,e);if(!r)return;const{row:o,col:a,colspan:u,rowspan:h}=r,d=o,g=a,m=o+h-1,v=a+u-1;if(i==="render"&&this.getSetting("virtualized")){const y=this.hot.view.getActiveOverlayName(),b=["top","top_inline_start_corner"].includes(y)?0:this.hot.getFirstRenderedVisibleRow(),C=["inline_start","top_inline_start_corner","bottom_inline_start_corner"].includes(y)?0:this.hot.getFirstRenderedVisibleColumn();return[St(b,d,m),St(C,g,v),St(this.hot.getLastRenderedVisibleRow(),d,m),St(this.hot.getLastRenderedVisibleColumn(),g,v)]}return[d,g,m,v]}function S1e(t){t.items.push({name:"---------"},i1e(this))}function i3(){Aw(Rs,this,null)}function b1e(){if(Sn(Rs,this).isCell())return;const t=this.hot.getSelectedRangeActive(),e=t.getVerticalDirection(),n=t.getHorizontalDirection(),i=Sn(Rs,this).clone().normalize();Sn(Ja,this).setActiveNode(i.row,i.col),Sn(Es,this).row>0||Sn(Es,this).col>0?Sn(Ja,this).setPrevNodeAsActive():(n==="E-W"&&Sn(Es,this).col<0||e==="S-N"&&Sn(Es,this).row<0)&&Sn(Ja,this).setNextNodeAsActive()}function C1e(t,e){const{columnIndexMapper:n,rowIndexMapper:i}=this.hot;let r=this.hot.getActiveSelectionLayerIndex(),o=null,a=null;if(Sn(Es,this).col<0){const{rowEnd:u,colEnd:h,selectionLayer:d}=Sn(Ja,this).getPrevHorizontalNode();a=n.getNearestNotHiddenIndex(h,-1),o=i.getNearestNotHiddenIndex(u,-1),r=d}else if(Sn(Es,this).col>0){const{rowStart:u,colStart:h,selectionLayer:d}=Sn(Ja,this).getNextHorizontalNode();a=n.getNearestNotHiddenIndex(h,1),o=i.getNearestNotHiddenIndex(u,1),r=d}else if(Sn(Es,this).row<0){const{rowEnd:u,colEnd:h,selectionLayer:d}=Sn(Ja,this).getPrevVerticalNode();a=n.getNearestNotHiddenIndex(h,-1),o=i.getNearestNotHiddenIndex(u,-1),r=d}else if(Sn(Es,this).row>0){const{rowStart:u,colStart:h,selectionLayer:d}=Sn(Ja,this).getNextVerticalNode();a=n.getNearestNotHiddenIndex(h,1),o=i.getNearestNotHiddenIndex(u,1),r=d}if(o!==null||a!==null){this.hot.selection.setActiveSelectionLayerIndex(r);const u=this.hot.getSelectedRangeActive(),h=this.hot._createCellCoords(o,a),d=this.mergedCellsCollection.get(h.row,h.col),g=this.hot.selection.highlight.getFocus();t=h.row,e=h.col,d?u.highlight.assign({row:this.hot.rowIndexMapper.getNearestNotHiddenIndex(d.row,1),col:this.hot.columnIndexMapper.getNearestNotHiddenIndex(d.col,1)}):u.highlight.assign(h),g.clear(),g.add(h).commit()}Sn(Ja,this).setActiveNode(t,e,r),Aw(Es,this,{row:0,col:0})}function R1e(){Sn(Ja,this).buildFocusOrder(this.hot.getSelectedRange())}function E1e(t,e,n){const i=this.mergedCellsCollection.get(t,e);i&&(i.row!==t||i.col!==e?n.copyable=!1:(n.rowspan=i.rowspan,n.colspan=i.colspan))}function T1e(t){if(this.getSetting("virtualized"))return;const e=this.hot.countCols();this.modifyViewportRowStart(t,e),this.modifyViewportRowEnd(t,e)}function _1e(t){if(this.getSetting("virtualized"))return;const e=this.hot.countRows();this.modifyViewportColumnStart(t,e),this.modifyViewportColumnEnd(t,e)}function M1e(t,e){const n=this.autofillCalculations.getDirection(e,t);if(this.autofillCalculations.dragAreaOverlapsCollections(e,t,n))return e;const i=this.hot._createCellCoords(e[0],e[1]),r=this.hot._createCellCoords(e[2],e[3]),o=this.hot._createCellRange(i,i,r),a=this.mergedCellsCollection.getWithinRange(o);return a.length===0?t:this.autofillCalculations.snapDragArea(e,t,n,a)}function A1e(t,e){this.mergedCellsCollection.shiftCollections("right",t,e)}function O1e(t,e){this.mergedCellsCollection.shiftCollections("left",t,e)}function x1e(t,e,n){n!=="auto"&&this.mergedCellsCollection.shiftCollections("down",t,e)}function H1e(t,e){this.mergedCellsCollection.shiftCollections("up",t,e)}function I1e(t,e){e==="Autofill.fill"&&this.autofillCalculations.recreateAfterDataPopulation(t)}function P1e(t,e){if(e&&e==="area"){const n=this.hot.getSelectedRangeActive(),i=this.mergedCellsCollection.getWithinRange(n);U(i,r=>{n.getBottomEndCorner().row===r.getLastRow()&&n.getBottomEndCorner().col===r.getLastColumn()&&(t[2]=r.row,t[3]=r.col)})}}function N1e(t,e,n,i){if(n)return this.selectionCalculations.getSelectedMergedCellClassName(t,e,n,i)}function D1e(){return this.selectionCalculations.getSelectedMergedCellClassNameToRemove()}function L1e(t,e,n,i){if(!(i instanceof MouseEvent))return;const r=this.hot.getSelectedRangeActive(),o=this.mergedCellsCollection.getByRange(r);if(!o)return;const a=this.hot._createCellCoords(o.row,o.col),u=this.hot._createCellCoords(o.row+o.rowspan-1,o.col+o.colspan-1);return this.hot.selection.getLayerLevel()===0&&r.isEqual(this.hot._createCellRange(a,a,u))}function k1e(t,e,n){if(this.hot.getSettings().rowHeaders||n==="bottom"||n==="bottom_inline_start_corner")return t;let i,r;if(n==="master")i=this.hot.getFirstRenderedVisibleColumn(),r=this.hot.getLastRenderedVisibleColumn();else{const v=this.hot.view.getOverlayByName(n);i=this.hot.columnIndexMapper.getVisualFromRenderableIndex(v.clone.wtTable.getFirstRenderedColumn()),r=this.hot.columnIndexMapper.getVisualFromRenderableIndex(v.clone.wtTable.getLastRenderedColumn())}if(!this.mergedCellsCollection.get(e,i))return t;const a=this.hot._createCellCoords(e,i),u=this.hot._createCellCoords(e,r),h=this.hot._createCellRange(a,a,u),d=this.mergedCellsCollection.getWithinRange(h,!0),g=d.reduce((v,y)=>{let{rowspan:b}=y;return Math.max(v,b)},1);let m=0;return d.length>1&&d[0].rowspan<g&&(m=g-d[0].rowspan),d.forEach(v=>{let{rowspan:y}=v,b=0;n==="top"||n==="top_inline_start_corner"?b=Math.min(g,this.hot.view.countNotHiddenFixedRowsTop()-e):b=y-m,t=Math.max(t??0,a9(this.hot,e,b))}),t}function $1e(t,e){return function(n,i){const[,...r]=n,[,...o]=i;return(function a(u){const h=t[u],d=e[u],g=r[u],m=o[u],v=d.multiColumnSorting,b=(v.compareFunctionFactory?v.compareFunctionFactory:kK(d.type))(h,d,v)(g,m);if(b===tl){const C=u+1;if(typeof e[C]<"u")return a(C)}return b})(0)}}const u9="sort";function V1e(t,e,n){const i=[];return n===!1||t.isColumnSorted(e)&&t.getNumberOfSortedColumns()>1&&i.push(`${u9}-${t.getIndexOfColumnInSortQueue(e)+1}`),i}function B1e(t){const e=t.className.split(" "),n=new RegExp(`^${u9}-[0-9]{1,2}$`);return e.filter(i=>n.test(i))}function F1e(t,e,n){return(e=W1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function W1e(t){var e=j1e(t,"string");return typeof e=="symbol"?e:e+""}function j1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const D0="multiColumnSorting",z1e=170,r3=D0;LK(D0,$1e);class U1e extends YK{constructor(){super(...arguments),F1e(this,"pluginKey",D0)}static get PLUGIN_KEY(){return D0}static get PLUGIN_PRIORITY(){return z1e}isEnabled(){return!!this.hot.getSettings()[this.pluginKey]}enablePlugin(){super.enablePlugin()}disablePlugin(){super.disablePlugin()}registerShortcuts(){super.registerShortcuts(),this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Shift","Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive();return e.row===-1&&e.col>=0&&this.sort(this.getNextSortConfig(e.col,m0)),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.isHeader()},relativeToGroup:Yc,position:"before",group:r3})}unregisterShortcuts(){super.unregisterShortcuts(),this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(r3)}sort(e){super.sort(e)}clearSort(){super.clearSort()}isSorted(){return super.isSorted()}getSortConfig(e){return super.getSortConfig(e)}setSortConfig(e){super.setSortConfig(e)}getNormalizedSortConfigs(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];return Array.isArray(e)?e:[e]}updateHeaderClasses(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];super.updateHeaderClasses(e,...i),Ve(e,B1e(e)),this.enabled!==!1&&fe(e,V1e(...i))}onAfterOnCellMouseDown(e,n){aL(n.row,n.col,e)!==!1&&this.wasClickableHeaderClicked(e,n.col)&&(this.hot.getShortcutManager().isCtrlPressed()?(this.hot.deselectCell(),this.hot.selectColumns(n.col),this.sort(this.getNextSortConfig(n.col,m0))):this.sort(this.getColumnNextConfig(n.col)))}}function o3(t,e,n){return(e=Y1e(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Y1e(t){var e=G1e(t,"string");return typeof e=="symbol"?e:e+""}function G1e(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const q1e="multipleSelectionHandles",K1e=160;class X1e extends Dt{constructor(){super(...arguments),o3(this,"dragged",[]),o3(this,"lastSetCell",null)}static get PLUGIN_KEY(){return q1e}static get PLUGIN_PRIORITY(){return K1e}isEnabled(){return el()}enablePlugin(){this.enabled||(this.registerListeners(),super.enablePlugin())}registerListeners(){const e=this,{rootElement:n}=this.hot;function i(r){if(e.dragged.length===1)return e.dragged.splice(0,e.dragged.length),!0;const o=e.dragged.indexOf(r);if(o===-1)return!1;o===0?e.dragged=e.dragged.slice(0,1):o===1&&(e.dragged=e.dragged.slice(-1))}this.eventManager.addEventListener(n,"touchstart",r=>{let o;if(Xe(r.target,"topSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("top"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1;if(Xe(r.target,"bottomSelectionHandle-HitArea"))return o=e.hot.getSelectedRangeActive(),e.dragged.push("bottom"),e.touchStartRange={width:o.getWidth(),height:o.getHeight(),direction:o.getDirection()},r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchend",r=>{if(Xe(r.target,"topSelectionHandle-HitArea"))return i.call(e,"top"),e.touchStartRange=void 0,r.preventDefault(),!1;if(Xe(r.target,"bottomSelectionHandle-HitArea"))return i.call(e,"bottom"),e.touchStartRange=void 0,r.preventDefault(),!1}),this.eventManager.addEventListener(n,"touchmove",r=>{const{rootDocument:o}=this.hot;let a,u,h,d,g,m;if(e.dragged.length===0)return;const v=o.elementFromPoint(r.touches[0].clientX,r.touches[0].clientY);!v||v===e.lastSetCell||((v.nodeName==="TD"||v.nodeName==="TH")&&(a=e.hot.getCoords(v),a.col===-1&&(a.col=0),u=e.hot.getSelectedRangeActive(),h=u.getWidth(),d=u.getHeight(),g=u.getDirection(),h===1&&d===1&&e.hot.selection.setRangeEnd(a),m=e.getCurrentRangeCoords(u,a,e.touchStartRange.direction,g,e.dragged[0]),m.start!==null&&e.hot.selection.setRangeStart(m.start),e.hot.selection.setRangeEnd(m.end),e.lastSetCell=v),r.preventDefault())})}getCurrentRangeCoords(e,n,i,r,o){const a=e.getTopStartCorner(),u=e.getBottomEndCorner(),h=e.getBottomStartCorner(),d=e.getTopEndCorner();let g={start:null,end:null};switch(i){case"NE-SW":switch(r){case"NE-SW":case"NW-SE":o==="top"?g={start:this.hot._createCellCoords(n.row,e.highlight.col),end:this.hot._createCellCoords(h.row,n.col)}:g={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,a.col)};break;case"SE-NW":o==="bottom"&&(g={start:this.hot._createCellCoords(u.row,n.col),end:this.hot._createCellCoords(n.row,a.col)});break}break;case"NW-SE":switch(r){case"NE-SW":o==="top"?g={start:n,end:h}:g.end=n;break;case"NW-SE":o==="top"?g={start:n,end:u}:g.end=n;break;case"SE-NW":o==="top"?g={start:n,end:a}:g.end=n;break;case"SW-NE":o==="top"?g={start:n,end:d}:g.end=n;break}break;case"SW-NE":switch(r){case"NW-SE":o==="bottom"?g={start:this.hot._createCellCoords(n.row,a.col),end:this.hot._createCellCoords(h.row,n.col)}:g={start:this.hot._createCellCoords(a.row,n.col),end:this.hot._createCellCoords(n.row,u.col)};break;case"SW-NE":o==="top"?g={start:this.hot._createCellCoords(e.highlight.row,n.col),end:this.hot._createCellCoords(n.row,u.col)}:g={start:this.hot._createCellCoords(n.row,a.col),end:this.hot._createCellCoords(a.row,n.col)};break;case"SE-NW":o==="bottom"?g={start:this.hot._createCellCoords(n.row,d.col),end:this.hot._createCellCoords(a.row,n.col)}:o==="top"&&(g={start:h,end:n});break}break;case"SE-NW":switch(r){case"NW-SE":case"NE-SW":case"SW-NE":o==="top"&&(g.end=n);break;case"SE-NW":o==="top"?g.end=n:g={start:n,end:a};break}break}return g}isDragged(){return this.dragged.length>0}}function EI(){let{label:t="",colspan:e=1,origColspan:n=1,collapsible:i=!1,crossHiddenColumns:r=[],isCollapsed:o=!1,isHidden:a=!1,isRoot:u=!1,isPlaceholder:h=!1,headerClassNames:d=[]}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};return{label:t,colspan:e,origColspan:n,collapsible:i,isCollapsed:o,crossHiddenColumns:r,isHidden:a,isRoot:u,isPlaceholder:h,headerClassNames:d}}function c9(){return{label:"",isPlaceholder:!0}}function Z1e(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:1/0;const n=[];if(e===0)return n;U(t,r=>{const o=[];let a=0;n.push(o),U(r,u=>{const h=EI();if(Qe(u)){const{label:g,colspan:m,headerClassName:v}=u;h.label=xn(g),typeof m=="number"&&m>1&&(h.colspan=m,h.origColspan=m),typeof v=="string"&&(h.headerClassNames=[...v.split(" ")])}else h.label=xn(u);a+=h.origColspan;let d=!1;if(a>=e&&(h.colspan=h.origColspan-(a-e),h.origColspan=h.colspan,d=!0),o.push(h),h.colspan>1)for(let g=0;g<h.colspan-1;g++)o.push(c9());return!d})});const i=Math.max(...Vt(n,r=>r.length));return U(n,r=>{if(r.length<i){const o=Vt(new Array(i-r.length),()=>EI());r.splice(r.length,0,...o)}}),n}function dx(t,e,n){Q1e(t,e),e.set(t,n)}function Q1e(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ys(t,e){return t.get(h9(t,e))}function pv(t,e,n){return t.set(h9(t,e),n),n}function h9(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const s3=["label","collapsible"];var Bl=new WeakMap,qh=new WeakMap,fx=new WeakMap;class J1e{constructor(){dx(this,Bl,[]),dx(this,qh,0),dx(this,fx,1/0)}setColumnsLimit(e){pv(fx,this,e)}setData(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[];pv(Bl,this,Z1e(e,Ys(fx,this))),pv(qh,this,Ys(Bl,this).length)}getData(){return Ys(Bl,this)}mergeWith(e){U(e,n=>{let{row:i,col:r,...o}=n;const a=this.getHeaderSettings(i,r);a!==null&&Mi(a,o,s3)})}map(e){U(Ys(Bl,this),n=>{U(n,i=>{const r=e({...i});Qe(r)&&Mi(i,r,s3)})})}getHeaderSettings(e,n){var i;if(e>=Ys(qh,this)||e<0)return null;const r=Ys(Bl,this)[e];return Array.isArray(r)===!1||n>=r.length?null:(i=r[n])!==null&&i!==void 0?i:null}getHeadersSettings(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const r=[];if(e>=Ys(qh,this)||e<0)return r;const o=Ys(Bl,this)[e];let a=0;for(let u=n;u<o.length;u++){const h=o[u];if(h.isPlaceholder)throw new Error("The first column settings cannot overlap the other header layers");if(a+=h.colspan,r.push(h),h.colspan>1&&(u+=h.colspan-1),a===i)break;if(a>i)throw new Error("The last column settings cannot overlap the other header layers")}return r}getLayersCount(){return Ys(qh,this)}getColumnsCount(){return Ys(qh,this)>0?Ys(Bl,this)[0].length:0}clear(){pv(Bl,this,[]),pv(qh,this,0)}}function gx(t,e,n){return(e=eMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eMe(t){var e=tMe(t,"string");return typeof e=="symbol"?e:e+""}function tMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}const d9="DF-pre-order";function f9(t,e){let n=t.call(e,this);for(let i=0;i<this.childs.length;i++){if(n===!1)return!1;n=f9.call(this.childs[i],t,e)}return n}const nMe="DF-post-order";function g9(t,e){for(let n=0;n<this.childs.length;n++)if(g9.call(this.childs[n],t,e)===!1)return!1;return t.call(e,this)}const m9="BF";function iMe(t,e){const n=[this];function i(){if(n.length===0)return;const r=n.shift();n.push(...r.childs),t.call(e,r)!==!1&&i()}i()}const rMe=m9,a3=new Map([[d9,f9],[nMe,g9],[m9,iMe]]);class L0{constructor(e){gx(this,"data",{}),gx(this,"parent",null),gx(this,"childs",[]),this.data=e}addChild(e){e.parent=this,this.childs.push(e)}cloneTree(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this;const n=new L0({...e.data});for(let i=0;i<e.childs.length;i++)n.addChild(this.cloneTree(e.childs[i]));return n}replaceTreeWith(e){this.data={...e.data},this.childs=[];for(let n=0;n<e.childs.length;n++)this.addChild(e.childs[n])}walkDown(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:rMe;if(!a3.has(n))throw new Error(`Traversal strategy "${n}" does not exist`);a3.get(n).call(this,e,this)}walkUp(e){const n=this,i=r=>{e.call(n,r)!==!1&&r.parent!==null&&i(r.parent)};i(this)}}function mx(t,e,n){oMe(t,e),e.set(t,n)}function oMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rr(t,e){return t.get(p9(t,e))}function sMe(t,e,n){return t.set(p9(t,e),n),n}function p9(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var sg=new WeakMap,Kh=new WeakMap,ag=new WeakMap;class aMe{constructor(e){mx(this,sg,new Map),mx(this,Kh,new Map),mx(this,ag,null),sMe(ag,this,e)}getRoots(){return Array.from(Rr(sg,this).values())}getRootByColumn(e){let n;return Rr(Kh,this).has(e)&&(n=Rr(sg,this).get(Rr(Kh,this).get(e))),n}getNode(e,n){const i=this.getRootByColumn(n);if(!i)return;const r=n-Rr(Kh,this).get(n);let o=0,a;return i.walkDown(u=>{const{data:{origColspan:h,headerLevel:d}}=u;if(e===d){if(r>=o&&r<=o+h-1)return a=u,a.data.isRoot=n===a.data.columnIndex,!1;o+=h}}),a}rebuildTreeIndex(){let e=0;Rr(Kh,this).clear(),U(Rr(sg,this),n=>{let[,{data:{colspan:i}}]=n;for(let r=e;r<e+i;r++)Rr(Kh,this).set(r,e);e+=i})}buildTree(){this.clear();const e=Rr(ag,this).getColumnsCount();let n=0;for(;n<e;){const i=Rr(ag,this).getHeaderSettings(0,n),r=new L0;Rr(sg,this).set(n,r),this.buildLeaves(r,n,0,i.origColspan),n+=i.origColspan}this.rebuildTreeIndex()}buildLeaves(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:1;const o=Rr(ag,this).getHeadersSettings(i,n,r);i+=1,U(o,a=>{const u={...a,headerLevel:i-1,columnIndex:n};let h;i===1?(e.data=u,h=e):(h=new L0(u),e.addChild(h)),i<Rr(ag,this).getLayersCount()&&this.buildLeaves(h,n,i,a.origColspan),n+=a.origColspan})}clear(){Rr(sg,this).clear(),Rr(Kh,this).clear()}}function v9(t,e){t.walkDown(n=>{let{data:i,childs:r}=n;if(!i.isHidden&&(e(i.columnIndex),r.length===0))for(let o=1;o<i.colspan;o++)e(i.columnIndex+o)})}function k0(t,e){let{childs:n}=t;if(n.length!==0)return n[0].data[e]}function $0(t){return k0(t,"origColspan")===t.data.origColspan}function RL(t){const{data:e,childs:n}=t;if(!e.isCollapsed||e.isHidden||e.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if($0(t))return RL(n[0]);e.isCollapsed=!1;const r=n.slice(1),o=new Set;let a=0;if(r.length>0)U(r,u=>{u.replaceTreeWith(u.data.clonedTree),u.data.clonedTree=null;const h=u.data;a+=h.colspan,v9(u,d=>{o.add(d)})});else{const{colspan:u,origColspan:h,columnIndex:d}=e;a=h-u;for(let g=1;g<h;g++)o.add(d+g)}return t.walkUp(u=>{const{data:h}=u;h.colspan+=a,h.colspan>=h.origColspan?(h.colspan=h.origColspan,h.isCollapsed=!1):$0(u)&&(h.isCollapsed=k0(u,"isCollapsed"))}),{rollbackModification:()=>EL(t),affectedColumns:Array.from(o),colspanCompensation:a}}function EL(t){var e;const{data:n,childs:i}=t;if(n.isCollapsed||n.isHidden||n.origColspan<=1)return{rollbackModification:()=>{},affectedColumns:[],colspanCompensation:0};if($0(t))return EL(i[0]);n.isCollapsed=!0;const o=i.slice(1),a=new Set;if(o.length>0)U(o,h=>{v9(h,d=>{a.add(d)}),h.data.clonedTree=h.cloneTree(),h.walkDown(d=>{let{data:g}=d;g.isHidden=!0})});else{const{origColspan:h,columnIndex:d}=n;for(let g=1;g<h;g++){const m=d+g;a.add(m)}}const u=n.colspan-((e=k0(t,"colspan"))!==null&&e!==void 0?e:1);return t.walkUp(h=>{const{data:d}=h;d.colspan-=u,d.colspan<=1?(d.colspan=1,d.isCollapsed=!0):$0(h)&&(d.isCollapsed=k0(h,"isCollapsed"))}),{rollbackModification:()=>RL(t),affectedColumns:Array.from(a),colspanCompensation:u}}function lMe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ft`The passed node is not the last node on the tree. Only for\x20
the last node, the hide column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.push(e),o.colspan>1?o.colspan-=1:o.isHidden=!0})}function uMe(t,e){if(!Number.isInteger(e))throw new Error("The passed gridColumnIndex argument has invalid type.");if(t.childs.length>0)throw new Error(Ft`The passed node is not the last node on the tree. Only for\x20
the last node, the show column modification can be applied.`);const{crossHiddenColumns:n}=t.data;if(!n.includes(e))return;let i=!1;t.walkUp(r=>{const{data:{collapsible:o}}=r;if(o)return i=!0,!1}),!i&&t.walkUp(r=>{const{data:o}=r;o.crossHiddenColumns.splice(o.crossHiddenColumns.indexOf(e),1),!o.isHidden&&o.colspan<o.origColspan&&(o.colspan+=1),o.isHidden=!1})}const l3=new Map([["collapse",EL],["expand",RL],["hide-column",lMe],["show-column",uMe]]);function cMe(t,e,n){if(!l3.has(t))throw new Error(`The node modifier action ("${t}") does not exist.`);return l3.get(t)(e,n)}function Wb(t){const e=[];return U(t,n=>{n.walkDown(i=>{const r=i.data,{origColspan:o,columnIndex:a,headerLevel:u,crossHiddenColumns:h}=r,d=dMe(e,u);let g=!1;for(let m=a;m<a+o;m++)if(h.includes(m)||g)d.push(c9());else{const y=hMe(r);y.isRoot=!0,d.push(y),g=!0}})}),e}function hMe(t){const{crossHiddenColumns:e,...n}=EI(t);return n}function dMe(t,e){let n;return Array.isArray(t[e])?n=t[e]:(n=[],t[e]=n),n}function px(t,e,n){fMe(t,e),e.set(t,n)}function fMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vv(t,e,n){return t.set(w9(t,e),n),n}function Fn(t,e){return t.get(w9(t,e))}function w9(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var ka=new WeakMap,Qr=new WeakMap,Xh=new WeakMap;class gMe{constructor(){px(this,ka,new J1e),px(this,Qr,new aMe(Fn(ka,this))),px(this,Xh,[[]])}setState(e){Fn(ka,this).setData(e);let n=!1;try{Fn(Qr,this).buildTree()}catch{Fn(Qr,this).clear(),Fn(ka,this).clear(),n=!0}return vv(Xh,this,Wb(Fn(Qr,this).getRoots())),n}setColumnsLimit(e){Fn(ka,this).setColumnsLimit(e)}mergeStateWith(e){const n=Vt(e,i=>{let{row:r,...o}=i;return{row:r<0?this.rowCoordsToLevel(r):r,...o}});Fn(ka,this).mergeWith(n),Fn(Qr,this).buildTree(),vv(Xh,this,Wb(Fn(Qr,this).getRoots()))}mapState(e){Fn(ka,this).map(e),Fn(Qr,this).buildTree(),vv(Xh,this,Wb(Fn(Qr,this).getRoots()))}mapNodes(e){return ho(Fn(Qr,this).getRoots(),(n,i)=>(i.walkDown(r=>{const o=e(r.data);o!==void 0&&n.push(o)}),n),[])}triggerNodeModification(e,n,i){n<0&&(n=this.rowCoordsToLevel(n));const r=Fn(Qr,this).getNode(n,i);let o;return r&&(o=cMe(e,r,i),vv(Xh,this,Wb(Fn(Qr,this).getRoots()))),o}triggerColumnModification(e,n){return this.triggerNodeModification(e,-1,n)}rowCoordsToLevel(e){if(e>=0)return null;const n=e+Math.max(this.getLayersCount(),1);return n<0?null:n}levelToRowCoords(e){if(e<0)return null;const n=e-Math.max(this.getLayersCount(),1);return n>=0?null:n}getHeaderSettings(e,n){var i,r;return e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount()?null:(i=(r=Fn(Xh,this)[e])===null||r===void 0?void 0:r[n])!==null&&i!==void 0?i:null}getHeaderTreeNodeData(e,n){const i=this.getHeaderTreeNode(e,n);return i?{...i.data}:null}getHeaderTreeNode(e,n){if(e<0&&(e=this.rowCoordsToLevel(e)),e===null||e>=this.getLayersCount())return null;const i=Fn(Qr,this).getNode(e,n);return i||null}findTopMostEntireHeaderLevel(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:e;const i=n-e+1;let r=!1,o=null;for(let a=e;a<=n;a++){const u=Fn(Qr,this).getRootByColumn(a);if(!u)break;r=!0,u.walkDown(h=>{const{columnIndex:d,headerLevel:g,origColspan:m,isHidden:v}=h.data;v||m<=i&&d>=e&&d+m-1<=n&&(o===null||g<o)&&(o=g)},d9)}return r&&o===null?-1:this.levelToRowCoords(o??0)}findLeftMostColumnIndex(e,n){var i;const{isRoot:r}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0};if(r)return n;let o=n-1;for(;o>=0;){var a;const{isRoot:u}=(a=this.getHeaderSettings(e,o))!==null&&a!==void 0?a:{isRoot:!0};if(u)break;o-=1}return o}findRightMostColumnIndex(e,n){var i;const{isRoot:r,origColspan:o}=(i=this.getHeaderSettings(e,n))!==null&&i!==void 0?i:{isRoot:!0,origColspan:1};if(r)return n+o-1;let a=n+1;for(;a<this.getColumnsCount();){var u;const{isRoot:h}=(u=this.getHeaderSettings(e,a))!==null&&u!==void 0?u:{isRoot:!0};if(h)break;a+=1}return a-1}getLayersCount(){return Fn(ka,this).getLayersCount()}getColumnsCount(){return Fn(ka,this).getColumnsCount()}clear(){vv(Xh,this,[]),Fn(ka,this).clear(),Fn(Qr,this).clear()}}function wv(t,e,n){return(e=mMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mMe(t){var e=pMe(t,"string");return typeof e=="symbol"?e:e+""}function pMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class vMe{constructor(e,n){wv(this,"hot",void 0),wv(this,"nestedHeaderSettingsGetter",void 0),wv(this,"layersCount",0),wv(this,"container",void 0),wv(this,"widthsMap",void 0),this.hot=e,this.nestedHeaderSettingsGetter=n,this.widthsMap=this.hot.columnIndexMapper.createAndRegisterIndexMap("nestedHeaders.widthsMap","physicalIndexToValue")}setLayersCount(e){return this.layersCount=e,this}getWidth(e){return this.widthsMap.getValueAtIndex(this.hot.toPhysicalColumn(e))}buildWidthsMap(){const e=this.hot.getCurrentThemeName();this.container=this.hot.rootDocument.createElement("div"),this.container.classList.add("handsontable","htGhostTable","htAutoSize"),e&&this.container.classList.add(e),this._buildGhostTable(this.container),this.hot.rootDocument.body.appendChild(this.container);const n=this.container.querySelectorAll("tr:last-of-type th"),i=n.length;this.widthsMap.clear();for(let r=0;r<i;r++){const o=this.hot.columnIndexMapper.getVisualFromRenderableIndex(r),a=this.hot.toPhysicalColumn(o);this.widthsMap.setValueAtIndex(a,n[r].offsetWidth)}this.container.parentNode.removeChild(this.container),this.container=null}_buildGhostTable(e){const{rootDocument:n,columnIndexMapper:i}=this.hot,r=n.createDocumentFragment(),o=n.createElement("table"),a=!!this.hot.getSettings().dropdownMenu,u=i.getRenderableIndexesLength();for(let h=0;h<this.layersCount;h++){const d=n.createElement("tr");for(let g=0;g<u;g++){let m=i.getVisualFromRenderableIndex(g);m===null&&(m=g);const v=n.createElement("th"),y=this.nestedHeaderSettingsGetter(h,m);if(y&&(!y.isPlaceholder||y.isHidden)){let b=y.label;a&&(b+='<button class="changeType"></button>'),Fd(v,b),v.colSpan=y.colspan,d.appendChild(v)}}o.appendChild(d)}r.appendChild(o),e.appendChild(r)}clear(){this.widthsMap.clear(),this.container=null}}function wMe(t,e){y9(t,e),e.add(t)}function u3(t,e,n){return(e=yMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yMe(t){var e=SMe(t,"string");return typeof e=="symbol"?e:e+""}function SMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function lg(t,e,n){y9(t,e),e.set(t,n)}function y9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function ou(t,e,n){return t.set(Di(t,e),n),n}function ut(t,e){return t.get(Di(t,e))}function Di(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const c3="nestedHeaders",bMe=280;var an=new WeakMap,fc=new WeakMap,Jv=new WeakMap,XR=new WeakMap,V0=new WeakMap,Zh=new WeakMap,Yi=new WeakSet;class CMe extends Dt{constructor(){super(...arguments),wMe(this,Yi),lg(this,an,new gMe),lg(this,fc,null),lg(this,Jv,null),lg(this,XR,!1),lg(this,V0,null),u3(this,"ghostTable",new vMe(this.hot,(e,n)=>this.getHeaderSettings(e,n))),u3(this,"detectedOverlappedHeaders",!1),lg(this,Zh,()=>{var e;const n=(e=this.hot)===null||e===void 0?void 0:e.getSelectedRangeActive();if(!n)return;const{highlight:i}=n;if(i.isHeader()&&i.col>=0){const o=ut(an,this).findLeftMostColumnIndex(i.row,i.col),a=this.hot.selection.highlight.getFocus();a.visualCellRange.highlight.col=o,a.visualCellRange.from.col=o,a.visualCellRange.to.col=o,a.commit()}})}static get PLUGIN_KEY(){return c3}static get PLUGIN_PRIORITY(){return bMe}isEnabled(){return!!this.hot.getSettings()[c3]}enablePlugin(){var e=this;if(this.enabled)return;const{nestedHeaders:n}=this.hot.getSettings();(!Array.isArray(n)||!Array.isArray(n[0]))&&_t(Ft`Your Nested Headers plugin configuration is invalid. The settings has to be\x20
                        passed as an array of arrays e.q. [['A1', { label: 'A2', colspan: 2 }]]`),this.addHook("init",()=>Di(Yi,this,$Me).call(this)),this.addHook("afterLoadData",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,VMe).call(e,...r)}),this.addHook("beforeOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,_Me).call(e,...r)}),this.addHook("afterOnCellMouseDown",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,MMe).call(e,...r)}),this.addHook("beforeOnCellMouseOver",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,AMe).call(e,...r)}),this.addHook("beforeOnCellMouseUp",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,OMe).call(e,...r)}),this.addHook("beforeSelectionHighlightSet",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,xMe).call(e,...r)}),this.addHook("modifyTransformStart",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,HMe).call(e,...r)}),this.addHook("afterSelection",()=>ut(Zh,this).call(this)),this.addHook("afterSelectionFocusSet",()=>ut(Zh,this).call(this)),this.addHook("beforeViewportScrollHorizontally",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,RMe).call(e,...r)}),this.addHook("afterGetColumnHeaderRenderers",i=>Di(Yi,this,PMe).call(this,i)),this.addHook("modifyColWidth",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,DMe).call(e,...r)}),this.addHook("modifyColumnHeaderValue",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,LMe).call(e,...r)}),this.addHook("beforeHighlightingColumnHeader",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,EMe).call(e,...r)}),this.addHook("beforeCopy",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,TMe).call(e,...r)}),this.addHook("beforeSelectColumns",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,IMe).call(e,...r)}),this.addHook("afterViewportColumnCalculatorOverride",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,NMe).call(e,...r)}),this.addHook("modifyFocusedElement",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return Di(Yi,e,kMe).call(e,...r)}),this.hot.columnIndexMapper.addLocalHook("cacheUpdated",ut(Zh,this)),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",ut(Zh,this)),super.enablePlugin(),this.updatePlugin()}updatePlugin(){if(!this.hot.view)return;const{nestedHeaders:e}=this.hot.getSettings();ut(an,this).setColumnsLimit(this.hot.countCols()),Array.isArray(e)&&(this.detectedOverlappedHeaders=ut(an,this).setState(e)),this.detectedOverlappedHeaders&&_t(Ft`Your Nested Headers plugin setup contains overlapping headers. This kind of configuration\x20
                        is currently not supported.`),this.enabled&&this.hot.columnIndexMapper.hidingMapsCollection.getMergedValues().forEach((n,i)=>{const r=n===!0?"hide-column":"show-column";ut(an,this).triggerColumnModification(r,i)}),!ut(fc,this)&&this.enabled&&ou(fc,this,this.hot.columnIndexMapper.createChangesObserver("hiding").subscribe(n=>{n.forEach(i=>{let{op:r,index:o,newValue:a}=i;if(r==="replace"){const u=a===!0?"hide-column":"show-column";ut(an,this).triggerColumnModification(u,o)}}),this.ghostTable.buildWidthsMap()})),this.ghostTable.setLayersCount(this.getLayersCount()).buildWidthsMap(),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",ut(Zh,this)),this.hot.columnIndexMapper.removeLocalHook("cacheUpdated",ut(Zh,this)),this.clearColspans(),ut(an,this).clear(),ut(fc,this).unsubscribe(),ou(fc,this,null),this.ghostTable.clear(),super.disablePlugin()}getStateManager(){return ut(an,this)}getLayersCount(){return ut(an,this).getLayersCount()}getHeaderSettings(e,n){return ut(an,this).getHeaderSettings(e,n)}clearColspans(){if(!this.hot.view)return;const{_wt:e}=this.hot.view,n=e.getSetting("columnHeaders").length,i=e.wtTable.THEAD,r=e.wtOverlays.topOverlay.clone.wtTable.THEAD,o=e.wtOverlays.topInlineStartCornerOverlay?e.wtOverlays.topInlineStartCornerOverlay.clone.wtTable.THEAD:null;for(let a=0;a<n;a++){const u=i.childNodes[a];if(!u)break;const h=r.childNodes[a],d=o?o.childNodes[a]:null;for(let g=0,m=u.childNodes.length;g<m;g++)u.childNodes[g].removeAttribute("colspan"),Ve(u.childNodes[g],"hiddenHeader"),h&&h.childNodes[g]&&(h.childNodes[g].removeAttribute("colspan"),Ve(h.childNodes[g],"hiddenHeader")),o&&d&&d.childNodes[g]&&(d.childNodes[g].removeAttribute("colspan"),Ve(d.childNodes[g],"hiddenHeader"))}}headerRendererFactory(e){var n=this;const i=this.hot.view._wt.getSetting("fixedColumnsStart");return(r,o)=>{var a;const{columnIndexMapper:u,view:h}=this.hot;let d=u.getVisualFromRenderableIndex(r);d===null&&(d=r),o.removeAttribute("colspan"),Ve(o,"hiddenHeader"),Ve(o,"hiddenHeaderText");const{colspan:g,isHidden:m,isPlaceholder:v,headerClassNames:y}=(a=ut(an,this).getHeaderSettings(e,d))!==null&&a!==void 0?a:{};if(v||m)fe(o,"hiddenHeader");else if(g>1){var b,C,T;const{wtOverlays:O}=h._wt,A=(b=O.topInlineStartCornerOverlay)===null||b===void 0?void 0:b.clone.wtTable.THEAD.contains(o),N=(C=O.inlineStartOverlay)===null||C===void 0?void 0:C.clone.wtTable.THEAD.contains(o);((T=O.topOverlay)===null||T===void 0?void 0:T.clone.wtTable.THEAD.contains(o))&&d<i&&fe(o,"hiddenHeaderText");const $=A||N?Math.min(g,i-r):g;$>1&&o.setAttribute("colspan",$)}if(this.hot.view.appendColHeader(d,o,function(){return n.getColumnHeaderValue(...arguments)},e),!v&&!m){const O=o.querySelector("div.relative");O&&y&&y.length>0&&(Ve(O,this.hot.getColumnMeta(d).headerClassName),fe(O,y))}}}getColumnHeaderValue(e,n){var i;const{isHidden:r,isPlaceholder:o}=(i=ut(an,this).getHeaderSettings(n,e))!==null&&i!==void 0?i:{};return o||r?"":this.hot.getColHeader(e,n)}destroy(){ou(an,this,null),ut(fc,this)!==null&&(ut(fc,this).unsubscribe(),ou(fc,this,null)),super.destroy()}_getHeaderTreeNodeDataByCoords(e){if(!(e.row>=0||e.col<0))return ut(an,this).getHeaderTreeNodeData(e.row,e.col)}}function RMe(t,e){var n;const i=this.hot.getSelectedRangeActive();if(!i)return t;const{highlight:r}=i,{navigableHeaders:o}=this.hot.getSettings(),a=this.hot.selection.isSelectedByColumnHeader(),u=o?r.row:(n=ut(V0,this))===null||n===void 0?void 0:n.row,h=a?t:r.col,d=u<0&&h>=0;if(ou(V0,this,null),!d)return t;const g=this.hot.getFirstFullyVisibleColumn(),m=this.hot.getLastFullyVisibleColumn(),v=m-g+1,y=ut(an,this).findLeftMostColumnIndex(u,h),b=ut(an,this).findRightMostColumnIndex(u,h),C=b-y+1;if(y<g&&b>m)return y;if(a){let T=null;return y>=g&&b>m?C>v?(e.value="start",T=y):(e.value="end",T=b):y<g&&b<=m&&(C>v?(e.value="end",T=b):(e.value="start",T=y)),T}return y<=g?y:b}function EMe(t,e,n){const i=ut(an,this).getHeaderTreeNodeData(e,t);if(!i)return t;const{columnCursor:r,selectionType:o,selectionWidth:a}=n,{isRoot:u,colspan:h}=ut(an,this).getHeaderSettings(e,t);if(o===VP){if(!u)return i.columnIndex}else if(o===s5&&(h>a-r||!u))return null;return t}function TMe(t,e,n){let{columnHeadersCount:i}=n;if(i!==0)for(let o=0;o<e.length;o++){const{startRow:a,startCol:u,endRow:h,endCol:d}=e[o],g=h-a+1,m=u-d+1;if(a>=0||m===1)break;for(let v=u;v<=d;v++)for(let y=a;y<=h;y++){var r;const b=g+y,C=v-u;if(C===0)continue;((r=ut(an,this).getHeaderTreeNodeData(y,v))===null||r===void 0?void 0:r.isRoot)===!1&&(t[b][C]="")}}}function _Me(t,e,n,i){this._getHeaderTreeNodeDataByCoords(e)&&(i.column=!0)}function MMe(t,e){const n=this._getHeaderTreeNodeDataByCoords(e);if(!n)return;ou(Jv,this,e.clone()),ou(XR,this,!0);const{selection:i}=this.hot,r=i.isSelected()?i.getSelectedRange().current():null,o=[],{columnIndex:a,origColspan:u}=n,h=!i.inInSelection(e);t.shiftKey&&r?e.col<r.from.col?o.push(r.getTopEndCorner().col,a,e.row):e.col>r.from.col?o.push(r.getTopStartCorner().col,a+u-1,e.row):o.push(a,a+u-1,e.row):(AP(t)||_d(t)&&h||Zse(t))&&o.push(a,a+u-1,e.row),i.selectColumns(...o)}function AMe(t,e,n,i){if(!this.hot.view.isMouseDown()||i.column)return;const r=this._getHeaderTreeNodeDataByCoords(e);if(!r)return;const{columnIndex:o,origColspan:a}=r,u=this.hot.getSelectedRangeActive(),h=u.getTopStartCorner(),d=u.getBottomEndCorner(),{from:g}=u;i.column=!0,i.cell=!0;const m=[],v=St(e.row,-1/0,-1);e.col<g.col?m.push(d.col,o,v):e.col>g.col?m.push(h.col,o+a-1,v):m.push(o,o+a-1,v),this.hot.selection.selectColumns(...m)}function OMe(){ou(XR,this,!1)}function xMe(){const{navigableHeaders:t}=this.hot.getSettings();if(!this.hot.view.isMouseDown()||!ut(XR,this)||!t)return;const e=this.hot.getSelectedRangeLast(),n=e.getTopStartCorner().col,i=e.getBottomEndCorner().col,{columnIndex:r,origColspan:o}=ut(an,this).getHeaderTreeNodeData(ut(Jv,this).row,ut(Jv,this).col);if(e.setHighlight(ut(Jv,this)),o>e.getWidth()||r<n||r+o-1>i){const a=ut(an,this).findTopMostEntireHeaderLevel(St(n,r,r+o-1),St(i,r,r+o-1));e.highlight.row=a,e.highlight.col=e.from.col}}function HMe(t){const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.hot._createCellCoords(e.row+t.row,e.col+t.col);if(!(n.isHeader()&&n.col>=0))return;const r=ut(an,this).findLeftMostColumnIndex(n.row,n.col),o=ut(an,this).findRightMostColumnIndex(n.row,n.col);if(t.col<0){const a=e.col>=r&&e.col<=o?r-1:o,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,-1);u===null?t.col=-this.hot.view.countRenderableColumnsInRange(0,e.col):t.col=-Math.max(this.hot.view.countRenderableColumnsInRange(u,e.col)-1,1)}else if(t.col>0){const a=e.col>=r&&e.col<=o?o+1:r,u=this.hot.columnIndexMapper.getNearestNotHiddenIndex(a,1);u===null?t.col=this.hot.view.countRenderableColumnsInRange(e.col,this.hot.countCols()):t.col=Math.max(this.hot.view.countRenderableColumnsInRange(e.col,u)-1,1)}}function IMe(t,e,n){const i=t.row,r=this._getHeaderTreeNodeDataByCoords({row:i,col:t.col}),o=this._getHeaderTreeNodeDataByCoords({row:i,col:e.col});ou(V0,this,n.clone()),e.col<t.col?(r&&(t.col=r.columnIndex+r.origColspan-1),o&&(e.col=o.columnIndex)):e.col>=t.col&&(r&&(t.col=r.columnIndex),o&&(e.col=o.columnIndex+o.origColspan-1))}function PMe(t){if(ut(an,this).getLayersCount()>0){t.length=0;for(let e=0;e<ut(an,this).getLayersCount();e++)t.push(this.headerRendererFactory(e))}}function NMe(t){const e=ut(an,this).getLayersCount();let n=t.startColumn,i=!!e;for(let r=0;r<e;r++){const o=ut(an,this).findLeftMostColumnIndex(r,t.startColumn),a=this.hot.columnIndexMapper.getRenderableFromVisualIndex(o);if(o>=0&&(i=!1),Hr(a)&&a<t.startColumn){n=a;break}}t.startColumn=i?ut(an,this).getHeaderTreeNodeData(0,n).columnIndex:n}function DMe(t,e){const n=this.ghostTable.getWidth(e);return t>n?t:n}function LMe(t,e,n){var i;const{label:r}=(i=ut(an,this).getHeaderTreeNodeData(n,e))!==null&&i!==void 0?i:{label:""};return r}function kMe(t,e){if(t<0)return this.hot.getCell(t,ut(an,this).findLeftMostColumnIndex(t,e),!0)}function $Me(){this.updatePlugin()}function VMe(t,e){e||this.updatePlugin()}function yv(t,e,n){return(e=BMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function BMe(t){var e=FMe(t,"string");return typeof e=="symbol"?e:e+""}function FMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class WMe{constructor(e,n){yv(this,"hot",void 0),yv(this,"data",null),yv(this,"plugin",void 0),yv(this,"parentReference",new WeakMap),yv(this,"cache",{levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap}),this.hot=n,this.plugin=e}setData(e){this.data=e}getData(){return this.data}getRawSourceData(){let e=null;return this.plugin.disableCoreAPIModifiers(),e=this.hot.getSourceData(),this.plugin.enableCoreAPIModifiers(),e}updateWithData(e){this.setData(e),this.rewriteCache()}rewriteCache(){this.cache={levels:[],levelCount:0,rows:[],nodeInfo:new WeakMap},ze(0,this.data.length-1,e=>{this.cacheNode(this.data[e],0,null)})}cacheNode(e,n,i){this.cache.levels[n]||(this.cache.levels[n]=[],this.cache.levelCount+=1),this.cache.levels[n].push(e),this.cache.rows.push(e),this.cache.nodeInfo.set(e,{parent:i,row:this.cache.rows.length-1,level:n}),this.hasChildren(e)&&U(e.__children,r=>{this.cacheNode(r,n+1,e)})}getDataObject(e){return e==null?null:this.cache.rows[e]}readTreeNodes(e,n,i,r){let o=!1,a=n;if(isNaN(a)&&a.end)return a;let u=e;return u||(u={__children:this.data},o=!0,a-=1),i!=null&&a===i?{result:u,end:!0}:r!=null&&u===r?{result:a,end:!0}:(a+=1,u.__children&&U(u.__children,h=>{if(this.parentReference.set(h,o?null:u),a=this.readTreeNodes(h,a,i,r),isNaN(a)&&a.end)return!1}),a)}mockParent(){const e=this.mockNode();return e.__children=this.data,e}mockNode(){const e={};return wt(this.data[0],(n,i)=>{e[i]=null}),e}getRowIndex(e){return e==null?null:this.cache.nodeInfo.get(e).row}getRowIndexWithinParent(e){let n=null;isNaN(e)?n=e:n=this.getDataObject(e);const i=this.getRowParent(e);return i==null?this.data.indexOf(n):i.__children.indexOf(n)}countAllRows(){const e={__children:this.data};return this.countChildren(e)}countChildren(e){let n=0,i=e;return isNaN(i)||(i=this.getDataObject(i)),!i||!i.__children?0:(U(i.__children,r=>{n+=1,r.__children&&(n+=this.countChildren(r))}),n)}getRowParent(e){let n;return isNaN(e)?n=e:n=this.getDataObject(e),this.getRowObjectParent(n)}getRowObjectParent(e){return!e||typeof e!="object"?null:this.cache.nodeInfo.get(e).parent}getRowLevel(e){let n=null;return isNaN(e)?n=e:n=this.getDataObject(e),n?this.getRowObjectLevel(n):null}getRowObjectLevel(e){return e==null?null:this.cache.nodeInfo.get(e).level}hasChildren(e){let n=e;return isNaN(n)||(n=this.getDataObject(n)),!!(n.__children&&n.__children.length)}isChild(e){return this.getRowParent(e)!==null}getChild(e,n){var i;return((i=e.__children)===null||i===void 0?void 0:i[n])||null}isRowHighestLevel(e){return!this.isChild(e)}isParent(e){var n;let i=e;return isNaN(i)||(i=this.getDataObject(i)),i&&!!i.__children&&((n=i.__children)===null||n===void 0?void 0:n.length)!==0}addChild(e,n){let i=n;this.hot.runHooks("beforeAddChild",e,i);let r=null;e&&(r=this.getRowIndex(e)),this.hot.runHooks("beforeCreateRow",r+this.countChildren(e)+1,1);let o=e;e||(o=this.mockParent()),o.__children||(o.__children=[]),i||(i=this.mockNode()),o.__children.push(i),this.rewriteCache();const a=this.getRowIndex(i);this.hot.rowIndexMapper.insertIndexes(a,1),this.hot.runHooks("afterCreateRow",a,1),this.hot.runHooks("afterAddChild",e,i)}addChildAtIndex(e,n,i){let r=i,o;if(r||(r=this.mockNode()),this.hot.runHooks("beforeAddChild",e,r,n),e){const u=this.getRowIndex(e)+n+1;this.hot.runHooks("beforeCreateRow",u,1),e.__children.splice(n,null,r),this.rewriteCache(),this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(e),"__children",e.__children,"NestedRows.addChildAtIndex"),this.hot.rowIndexMapper.insertIndexes(u,1),this.plugin.enableCoreAPIModifiers(),this.hot.runHooks("afterCreateRow",u,1),o=u}else this.plugin.disableCoreAPIModifiers(),this.hot.alter("insert_row_above",n,1,"NestedRows.addChildAtIndex"),this.plugin.enableCoreAPIModifiers(),o=this.getRowIndex(this.data[n]);r=this.getDataObject(o),this.hot.runHooks("afterAddChild",e,r,n)}addSibling(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"below";const i=this.translateTrimmedRow(e),r=this.getRowParent(i),o=this.getRowIndexWithinParent(i);switch(n){case"below":this.addChildAtIndex(r,o+1,null);break;case"above":this.addChildAtIndex(r,o,null);break}}detachFromParent(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=null;const r=[];Array.isArray(e)?(ze(e[0],e[2],v=>{const y=this.translateTrimmedRow(v);r.push(this.getDataObject(y))}),ze(0,r.length-2,v=>{this.detachFromParent(r[v],!1)}),i=r[r.length-1]):i=e;const o=this.getRowIndex(i),a=this.countChildren(i),u=this.getRowIndexWithinParent(i),h=this.getRowParent(i),d=this.getRowParent(h),g=this.getRowIndex(d);let m=null;if(this.hot.runHooks("beforeDetachChild",h,i),u!=null){const v=Array.from(new Array(o+a+1).keys()).splice(-1*(a+1));if(this.hot.runHooks("beforeRemoveRow",o,a+1,v,this.plugin.pluginName),h.__children.splice(u,1),this.rewriteCache(),this.hot.runHooks("afterRemoveRow",o,a+1,v,this.plugin.pluginName),d){m=g+this.countChildren(d);const y=this.getChild(d,this.countChildren(d)-1),b=this.getRowIndex(y);this.hot.runHooks("beforeCreateRow",b+1,a+1,this.plugin.pluginName),d.__children.push(i)}else m=this.hot.countRows()+1,this.hot.runHooks("beforeCreateRow",m-2,a+1,this.plugin.pluginName),this.data.push(i)}this.rewriteCache(),this.hot.runHooks("afterCreateRow",m-2,a+1,this.plugin.pluginName),this.hot.runHooks("afterDetachChild",h,i,this.getRowIndex(i)),n&&this.hot.render()}filterData(e,n,i){const r=[];U(i,o=>{r.push(this.getDataObject(o))}),U(r,o=>{const a=this.getRowIndexWithinParent(o),u=this.getRowParent(o);u===null?this.data.splice(a,1):u.__children.splice(a,1)}),this.rewriteCache()}spliceData(e,n,i){const r=this.getDataObject(e-1);let o=null,a=e;r&&r.__children&&r.__children.length===0?(o=r,a=0):e<this.countAllRows()&&(o=this.getRowParent(e),a=this.getRowIndexWithinParent(e)),o?i?o.__children.splice(a,n,...i):o.__children.splice(a,n):i?this.data.splice(a,n,...i):this.data.splice(a,n),this.rewriteCache()}syncRowWithRawSource(e){let n=e,i=n;do i=this.getRowParent(i),i!==null&&(n=i);while(i!==null);this.plugin.disableCoreAPIModifiers(),this.hot.setSourceDataAtCell(this.getRowIndexWithinParent(n),"__children",n.__children,"NestedRows.syncRowWithRawSource"),this.plugin.enableCoreAPIModifiers()}moveRow(e,n,i,r){const o=n===this.hot.countRows(),a=this.getRowParent(e),u=this.getRowIndexWithinParent(e),h=a.__children.slice(u,u+1),d=e>n;let g=o?this.getRowParent(n-1):this.getRowParent(n);g==null&&(g=this.getRowParent(n-1)),g==null&&(g=this.getDataObject(n-1)),g?g.__children||(g.__children=[]):(g=this.getDataObject(n),g.__children=[]);const m=o||i||r?g.__children.length:this.getRowIndexWithinParent(n),v=a===g;g.__children.splice(m,0,h[0]),a.__children.splice(u+(d&&v?1:0),1),this.syncRowWithRawSource(a),v||this.syncRowWithRawSource(g)}translateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.translateTrimmedRow(e):e}untranslateTrimmedRow(e){return this.plugin.collapsingUI?this.plugin.collapsingUI.untranslateTrimmedRow(e):e}}function h3(t,e,n){return(e=jMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function jMe(t){var e=zMe(t,"string");return typeof e=="symbol"?e:e+""}function zMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class TL{constructor(e,n){h3(this,"hot",void 0),h3(this,"plugin",void 0),this.hot=n,this.plugin=e}}class qa extends TL{static get CSS_CLASSES(){return{indicatorContainer:"ht_nestingLevels",parent:"ht_nestingParent",indicator:"ht_nestingLevel",emptyIndicator:"ht_nestingLevel_empty",button:"ht_nestingButton",expandButton:"ht_nestingExpand",collapseButton:"ht_nestingCollapse"}}constructor(e,n){super(e,n),this.dataManager=this.plugin.dataManager,this.collapsingUI=this.plugin.collapsingUI,this.rowHeaderWidthCache=null}appendLevelIndicators(e,n){const i=this.hot.toPhysicalRow(e),r=this.dataManager.getDataObject(i);if(!r)return;const o=this.dataManager.getRowLevel(i),a=n.getElementsByTagName("DIV")[0],u=a.querySelector("span.rowHeader"),h=a.querySelectorAll('[class^="ht_nesting"]'),d=this.hot.getSettings().ariaTags;if(U(h,g=>{g&&a.removeChild(g)}),fe(n,qa.CSS_CLASSES.indicatorContainer),o){const{rootDocument:g}=this.hot,m=u.cloneNode(!0);a.innerHTML="",ze(0,o-1,()=>{const v=g.createElement("SPAN");fe(v,qa.CSS_CLASSES.emptyIndicator),a.appendChild(v)}),a.appendChild(m)}if(this.dataManager.hasChildren(r)){const g=this.hot.rootDocument.createElement("DIV");d&&We(g,[Bd()]),fe(n,qa.CSS_CLASSES.parent),this.collapsingUI.areChildrenCollapsed(i)?(fe(g,`${qa.CSS_CLASSES.button} ${qa.CSS_CLASSES.expandButton}`),d&&We(n,[Ts(!1)])):(fe(g,`${qa.CSS_CLASSES.button} ${qa.CSS_CLASSES.collapseButton}`),d&&We(n,[Ts(!0)])),a.appendChild(g)}}updateRowHeaderWidth(e){let n=e;n||(n=this.dataManager.cache.levelCount);let i=11;this.hot.stylesHandler.isClassicTheme()||(i=this.hot.stylesHandler.getCSSVariableValue("cell-horizontal-padding")*2),this.rowHeaderWidthCache=Math.max(50,i+10*n+25),this.hot.render()}}class UMe extends TL{constructor(e,n){var i;super(e,n),i=this,this.dataManager=this.plugin.dataManager,this.collapsedRows=[],this.collapsedRowsStash={stash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1;i.lastCollapsedRows=i.collapsedRows.slice(0),i.expandMultipleChildren(i.lastCollapsedRows,r)},shiftStash:function(r,o){let a=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;o==null&&(o=1/0),U(i.lastCollapsedRows,(u,h)=>{u>=r&&u<o&&(i.lastCollapsedRows[h]=u+a)})},applyStash:function(){let r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;i.collapseMultipleChildren(i.lastCollapsedRows,r),i.lastCollapsedRows=void 0},trimStash:(r,o)=>{ze(r,r+o-1,a=>{const u=this.lastCollapsedRows.indexOf(a);u>-1&&this.lastCollapsedRows.splice(u,1)})}}}collapseChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,a=null,u=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(o)):(o=this.dataManager.getDataObject(e),a=e),this.dataManager.hasChildren(o)&&U(o.__children,h=>{r.push(this.dataManager.getRowIndex(h))}),u=this.collapseRows(r,!0,!1),i&&this.trimRows(u),n&&this.renderAndAdjust(),this.collapsedRows.indexOf(a)===-1&&this.collapsedRows.push(a),u}collapseMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];U(e,o=>{r.push(...this.collapseChildren(o,!1,!1))}),i&&this.trimRows(r),n&&this.renderAndAdjust()}collapseRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.collapseRows([e],n)}collapseRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return U(e,o=>{r.push(o),n&&this.collapseChildRows(o,r)}),i&&this.trimRows(r),r}collapseChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);U(r.__children,o=>{const a=this.dataManager.getRowIndex(o);n.push(a),this.collapseChildRows(a,n)})}i&&this.trimRows(n)}expandRow(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;this.expandRows([e],n)}expandRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;const r=[];return U(e,o=>{r.push(o),n&&this.expandChildRows(o,r)}),i&&this.untrimRows(r),r}expandChildRows(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;if(this.dataManager.hasChildren(e)){const r=this.dataManager.getDataObject(e);U(r.__children,o=>{if(!this.isAnyParentCollapsed(o)){const a=this.dataManager.getRowIndex(o);n.push(a),this.expandChildRows(a,n)}})}i&&this.untrimRows(n)}expandChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];let o=null,a=null,u=null;return isNaN(e)?(o=e,a=this.dataManager.getRowIndex(e)):(o=this.dataManager.getDataObject(e),a=e),this.collapsedRows.splice(this.collapsedRows.indexOf(a),1),this.dataManager.hasChildren(o)&&U(o.__children,h=>{const d=this.dataManager.getRowIndex(h);r.push(d)}),u=this.expandRows(r,!0,!1),i&&this.untrimRows(u),n&&this.renderAndAdjust(),u}expandMultipleChildren(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0,i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0;const r=[];U(e,o=>{r.push(...this.expandChildren(o,!1,!1))}),i&&this.untrimRows(r),n&&this.renderAndAdjust()}collapseAll(){const e=this.dataManager.getData(),n=[];U(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.collapseMultipleChildren(n),this.renderAndAdjust()}expandAll(){const e=this.dataManager.getData(),n=[];U(e,i=>{this.dataManager.hasChildren(i)&&n.push(i)}),this.expandMultipleChildren(n),this.renderAndAdjust()}trimRows(e){this.hot.batchExecution(()=>{U(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!0)})},!0)}untrimRows(e){this.hot.batchExecution(()=>{U(e,n=>{this.plugin.collapsedRowsMap.setValueAtIndex(n,!1)})},!0)}areChildrenCollapsed(e){let n=isNaN(e)?e:this.dataManager.getDataObject(e),i=!0;return n===null&&(n={__children:this.dataManager.data}),this.dataManager.hasChildren(n)&&U(n.__children,r=>{const o=this.dataManager.getRowIndex(r);if(!this.plugin.collapsedRowsMap.getValueAtIndex(o))return i=!1,!1}),i}isAnyParentCollapsed(e){let n=e;for(;n!==null;){n=this.dataManager.getRowParent(n);const i=this.dataManager.getRowIndex(n);if(this.collapsedRows.indexOf(i)>-1)return!0}return!1}toggleState(e,n){if(n.col>=0)return;const i=this.translateTrimmedRow(n.row);Xe(e.target,qa.CSS_CLASSES.button)&&(this.areChildrenCollapsed(i)?this.expandChildren(i):this.collapseChildren(i),ma(e))}translateTrimmedRow(e){return this.hot.toPhysicalRow(e)}untranslateTrimmedRow(e){return this.hot.toVisualRow(e)}renderAndAdjust(){this.hot.view.adjustElementsSize(),this.hot.render()}}function YMe(t,e,n){GMe(t,e),e.set(t,n)}function GMe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function qMe(t,e,n){return(e=KMe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function KMe(t){var e=XMe(t,"string");return typeof e=="symbol"?e:e+""}function XMe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function ZMe(t,e){return t.get(QMe(t,e))}function QMe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var d3=new WeakMap;class JMe extends TL{constructor(){super(...arguments),qMe(this,"dataManager",this.plugin.dataManager),YMe(this,d3,{row_above:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"above")},row_below:(e,n)=>{const i=n[n.length-1];this.dataManager.addSibling(i.start.row,"below")}})}appendOptions(e){const n=[{key:"add_child",name(){return this.getTranslatedPhrase($N)},callback:()=>{const i=this.dataManager.translateTrimmedRow(this.hot.getSelectedActive()[0]),r=this.dataManager.getDataObject(i);this.dataManager.addChild(r)},disabled:()=>{const i=this.hot.getSelectedActive();return!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{key:"detach_from_parent",name(){return this.getTranslatedPhrase(VN)},callback:()=>{this.dataManager.detachFromParent(this.hot.getSelectedActive())},disabled:()=>{const i=this.hot.getSelectedActive(),r=this.dataManager.translateTrimmedRow(i[0]);return!this.dataManager.getRowParent(r)||!i||i[0]<0||this.hot.selection.isSelectedByColumnHeader()||this.hot.countRows()>=this.hot.getSettings().maxRows}},{name:"---------"}];return ze(0,e.items.length-1,i=>{if(i===0)return U(n,(r,o)=>{e.items.splice(i+o,0,r)}),!1}),this.modifyRowInsertingOptions(e)}modifyRowInsertingOptions(e){return ze(0,e.items.length-1,n=>{const i=ZMe(d3,this)[e.items[n].key];i!=null&&(e.items[n].callback=i)}),e}}function jb(t,e,n){return(e=eAe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function eAe(t){var e=tAe(t,"string");return typeof e=="symbol"?e:e+""}function tAe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class nAe{constructor(e){jb(this,"plugin",void 0),jb(this,"hot",void 0),jb(this,"dataManager",void 0),jb(this,"collapsingUI",void 0),this.plugin=e,this.hot=e.hot,this.dataManager=e.dataManager,this.collapsingUI=e.collapsingUI}onBeforeRowMove(e,n,i,r){if(this.displayAPICompatibilityWarning({rows:e,finalIndex:n,dropIndex:i,movePossible:r}))return!1;this.movedToCollapsed=!1;const a=i===this.hot.countRows(),u=a?this.hot.countSourceRows():this.dataManager.translateTrimmedRow(i);let h=!0;const d=e.map(b=>{if(!h)return!1;const C=this.dataManager.translateTrimmedRow(b);return h=this.shouldAllowMoving(C,u),C}),g=d.indexOf(u)===-1;if(!h||!g)return!1;const m=this.getBaseParent(d),v=this.getTargetParent(a,u),y=m===v;return this.movedToCollapsed=this.collapsingUI.areChildrenCollapsed(v),this.collapsingUI.collapsedRowsStash.stash(),this.shiftCollapsibleParentsLocations(d,u,y),this.moveRows(d,u,v),this.dataManager.rewriteCache(),this.moveCellsMeta(d,u),this.collapsingUI.collapsedRowsStash.applyStash(!1),this.hot.runHooks("afterRowMove",e,n,i,r,r&&this.isRowOrderChanged(e,n)),this.hot.render(),this.selectCells(e,i),!1}displayAPICompatibilityWarning(e){const{rows:n,finalIndex:i,dropIndex:r,movePossible:o}=e;let a=!1;return $n(r)&&(_t(Ft`Since version 8.0.0 of the Handsontable the 'moveRows' method isn't used for moving rows\x20
      when the NestedRows plugin is enabled. Please use the 'dragRows' method instead.`),this.hot.runHooks("afterRowMove",n,i,r,o,!1),a=!0),a}shouldAllowMoving(e,n){return!(this.dataManager.isParent(e)||this.dataManager.isRowHighestLevel(e)||e===n||n===0)}getBaseParent(e){return this.dataManager.getRowParent(e[0])}getTargetParent(e,n){let i=this.dataManager.getRowParent(e?n-1:n);return i==null&&(i=this.dataManager.getRowParent(n-1)),i}shiftCollapsibleParentsLocations(e,n,i){i||(Math.max(...e)<=n?this.collapsingUI.collapsedRowsStash.shiftStash(e[0],n,-1*e.length):this.collapsingUI.collapsedRowsStash.shiftStash(n,e[0],e.length))}moveRows(e,n,i){const r=n===this.dataManager.getRowIndex(i)+this.dataManager.countChildren(i)+1;this.hot.batchRender(()=>{e.forEach(o=>{this.dataManager.moveRow(o,n,this.movedToCollapsed,r)})})}moveCellsMeta(e,n){const i=[],r=Math.max(...e)<n;e.forEach(o=>{i.push(this.hot.getCellMetaAtRow(o))}),this.hot.spliceCellsMeta(e[0],e.length),this.hot.spliceCellsMeta(n-(r?i.length:0),0,...i)}selectCells(e,n){const i=e.length;let r=0,o=0;if(this.movedToCollapsed){let a=null;e[i-1]<n?a=this.dataManager.translateTrimmedRow(n-i):a=this.dataManager.translateTrimmedRow(n);const u=this.dataManager.getRowParent(a===null?this.hot.countSourceRows()-1:a-1),h=this.dataManager.getRowIndex(u);r=this.dataManager.untranslateTrimmedRow(h),o=r}else e[i-1]<n?(o=n-1,r=o-i+1):(r=n,o=r+i-1);this.hot.selectCells([[r,0,o,this.hot.countCols()-1]],!1)}isRowOrderChanged(e,n){return e.some((i,r)=>i-r!==n)}}function iAe(t,e){S9(t,e),e.add(t)}function f3(t,e,n){S9(t,e),e.set(t,n)}function S9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function vx(t,e,n){return(e=rAe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function rAe(t){var e=oAe(t,"string");return typeof e=="symbol"?e:e+""}function oAe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function IC(t,e){return t.get(Li(t,e))}function B0(t,e,n){return t.set(Li(t,e),n),n}function Li(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const F0="nestedRows",sAe=300,g3=F0,aAe="The Nested Rows plugin requires an Array of Objects as a dataset to be provided. The plugin has been disabled.";var ZR=new WeakMap,ug=new WeakMap,Gi=new WeakSet;class lAe extends Dt{constructor(){super(...arguments),iAe(this,Gi),vx(this,"dataManager",null),vx(this,"headersUI",null),vx(this,"collapsedRowsMap",null),f3(this,ZR,!1),f3(this,ug,!1)}static get PLUGIN_KEY(){return F0}static get PLUGIN_PRIORITY(){return sAe}isEnabled(){return!!this.hot.getSettings()[F0]}enablePlugin(){var e=this;this.enabled||(this.collapsedRowsMap=this.hot.rowIndexMapper.registerMap("nestedRows",new Uw),this.dataManager=new WMe(this,this.hot),this.collapsingUI=new UMe(this,this.hot),this.headersUI=new qa(this,this.hot),this.contextMenuUI=new JMe(this,this.hot),this.rowMoveController=new nAe(this),this.addHook("afterInit",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,CAe).call(e,...i)}),this.addHook("beforeViewRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,RAe).call(e,...i)}),this.addHook("modifyRowData",function(){return e.onModifyRowData(...arguments)}),this.addHook("modifySourceLength",function(){return e.onModifySourceLength(...arguments)}),this.addHook("beforeDataSplice",function(){return e.onBeforeDataSplice(...arguments)}),this.addHook("filterData",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,hAe).call(e,...i)}),this.addHook("afterContextMenuDefaultOptions",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,dAe).call(e,...i)}),this.addHook("afterGetRowHeader",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,fAe).call(e,...i)}),this.addHook("beforeOnCellMouseDown",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,cAe).call(e,...i)}),this.addHook("beforeRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,pAe).call(e,...i)}),this.addHook("afterRemoveRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,mAe).call(e,...i)}),this.addHook("beforeAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,vAe).call(e,...i)}),this.addHook("afterAddChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,wAe).call(e,...i)}),this.addHook("beforeDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,yAe).call(e,...i)}),this.addHook("afterDetachChild",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,SAe).call(e,...i)}),this.addHook("modifyRowHeaderWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,gAe).call(e,...i)}),this.addHook("afterCreateRow",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,bAe).call(e,...i)}),this.addHook("beforeRowMove",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Li(Gi,e,uAe).call(e,...i)}),this.addHook("beforeLoadData",n=>Li(Gi,this,m3).call(this,n)),this.addHook("beforeUpdateData",n=>Li(Gi,this,m3).call(this,n)),this.registerShortcuts(),super.enablePlugin())}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("nestedRows"),this.unregisterShortcuts(),super.disablePlugin()}updatePlugin(){this.disablePlugin();const e=this.dataManager.getData();this.enablePlugin(),this.dataManager.updateWithData(e),super.updatePlugin()}registerShortcuts(){this.hot.getShortcutManager().getContext("grid").addShortcut({keys:[["Enter"]],callback:()=>{const{highlight:e}=this.hot.getSelectedRangeActive(),n=this.collapsingUI.translateTrimmedRow(e.row);return this.collapsingUI.areChildrenCollapsed(n)?this.collapsingUI.expandChildren(n):this.collapsingUI.collapseChildren(n),!1},runOnlyIf:()=>{var e,n;const i=(e=this.hot.getSelectedRangeActive())===null||e===void 0?void 0:e.highlight;return i&&((n=this.hot.getSelectedRangeActive())===null||n===void 0?void 0:n.isSingle())&&this.hot.selection.isCellVisible(i)&&i.col===-1&&i.row>=0},group:g3,relativeToGroup:Yc,position:"before"})}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(g3)}disableCoreAPIModifiers(){B0(ug,this,!0)}enableCoreAPIModifiers(){B0(ug,this,!1)}onModifyRowData(e){if(!IC(ug,this))return this.dataManager.getDataObject(e)}onModifySourceLength(){if(!IC(ug,this))return this.dataManager.countAllRows()}onBeforeDataSplice(e,n,i){return IC(ug,this)||this.dataManager.isRowHighestLevel(e)?!0:(this.dataManager.spliceData(e,n,i),!1)}destroy(){super.destroy()}}function uAe(t,e,n,i){return this.rowMoveController.onBeforeRowMove(t,e,n,i)}function cAe(t,e,n){this.collapsingUI.toggleState(t,e,n)}function hAe(t,e,n){return this.collapsingUI.collapsedRowsStash.stash(),this.collapsingUI.collapsedRowsStash.trimStash(n[0],e),this.collapsingUI.collapsedRowsStash.shiftStash(n[0],null,-1*e),this.dataManager.filterData(t,e,n),B0(ZR,this,!0),this.dataManager.getData().slice()}function dAe(t){return this.contextMenuUI.appendOptions(t)}function fAe(t,e){this.headersUI.appendLevelIndicators(t,e)}function gAe(t){return Math.max(this.headersUI.rowHeaderWidthCache,t)}function mAe(t,e,n,i){i!==this.pluginName&&this.hot._registerTimeout(()=>{B0(ZR,this,!1),this.headersUI.updateRowHeaderWidth(),this.collapsingUI.collapsedRowsStash.applyStash()})}function pAe(t,e,n){const i=Array.from(n.reduce((r,o)=>{if(this.dataManager.isParent(o)){const a=this.dataManager.getDataObject(o).__children;return r.add(o),Array.isArray(a)&&a.forEach(u=>r.add(this.dataManager.getRowIndex(u))),r}return r.add(o)},new Set));n.length=0,n.push(...i)}function vAe(){this.collapsingUI.collapsedRowsStash.stash()}function wAe(t,e){this.collapsingUI.collapsedRowsStash.shiftStash(this.dataManager.getRowIndex(e)),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function yAe(){this.collapsingUI.collapsedRowsStash.stash()}function SAe(t,e,n){this.collapsingUI.collapsedRowsStash.shiftStash(n,null,-1),this.collapsingUI.collapsedRowsStash.applyStash(),this.headersUI.updateRowHeaderWidth()}function bAe(){this.dataManager.rewriteCache()}function CAe(){this.headersUI.updateRowHeaderWidth()}function RAe(t,e){IC(ZR,this)&&(e.skipRender=!0)}function m3(t){if(!ihe(t)){OP(aAe),this.hot.getSettings()[F0]=!1,this.disablePlugin();return}this.dataManager.setData(t),this.dataManager.rewriteCache()}function EAe(t,e){b9(t,e),e.add(t)}function gc(t,e,n){b9(t,e),e.set(t,n)}function b9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Rt(t,e){return t.get(ew(t,e))}function $a(t,e,n){return t.set(ew(t,e),n),n}function ew(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TAe=`
<div data-ref="container" class="ht-pagination handsontable">
  <div class="ht-pagination__inner">
    <div data-ref="pageSizeSection" class="ht-page-size-section">
      <span data-ref="pageSizeLabel" class="ht-page-size-section__label"></span>
      <div class="ht-page-size-section__select-wrapper">
        <select data-ref="pageSizeSelect" name="pageSize" data-hot-input></select>
      </div>
    </div>
    <div data-ref="pageCounterSection" class="ht-page-counter-section"></div>
    <nav data-ref="pageNavSection" class="ht-page-navigation-section">
      <button data-ref="first" class="ht-page-navigation-section__button ht-page-first"></button>
      <button data-ref="prev" class="ht-page-navigation-section__button ht-page-prev"></button>
      <span data-ref="pageNavLabel" class="ht-page-navigation-section__label"></span>
      <button data-ref="next" class="ht-page-navigation-section__button ht-page-next"></button>
      <button data-ref="last" class="ht-page-navigation-section__button ht-page-last"></button>
    </nav>
  </div>
</div>
`;var Dg=new WeakMap,nd=new WeakMap,wx=new WeakMap,ur=new WeakMap,cg=new WeakMap,hs=new WeakMap,yx=new WeakMap,Sx=new WeakMap,zb=new WeakSet;class C9{constructor(e){let{rootElement:n,uiContainer:i,isRtl:r,themeName:o,phraseTranslator:a,shouldHaveBorder:u,a11yAnnouncer:h}=e;EAe(this,zb),gc(this,Dg,void 0),gc(this,nd,void 0),gc(this,wx,!1),gc(this,ur,void 0),gc(this,cg,void 0),gc(this,hs,void 0),gc(this,yx,void 0),gc(this,Sx,void 0),$a(Dg,this,n),$a(nd,this,i),$a(wx,this,r),$a(cg,this,o),$a(hs,this,a),$a(yx,this,u),$a(Sx,this,h),this.install()}install(){var e;if((e=Rt(ur,this))!==null&&e!==void 0&&e.container)return;const n=a4`${TAe}`,{container:i,first:r,prev:o,next:a,last:u,pageSizeSelect:h}=n.refs;$a(ur,this,n.refs),i.setAttribute("dir",Rt(wx,this)?"rtl":"ltr");const d=m=>m.currentTarget.disabled,g=(m,v,y)=>{v.addEventListener(m,b=>{d(b)||y()})};g("click",r,()=>this.runLocalHooks("firstPageClick")),g("focus",r,()=>this.runLocalHooks("focus",r)),g("click",o,()=>this.runLocalHooks("prevPageClick")),g("focus",o,()=>this.runLocalHooks("focus",o)),g("click",a,()=>this.runLocalHooks("nextPageClick")),g("focus",a,()=>this.runLocalHooks("focus",a)),g("click",u,()=>this.runLocalHooks("lastPageClick")),g("focus",u,()=>this.runLocalHooks("focus",u)),g("focus",h,()=>this.runLocalHooks("focus",h)),h.addEventListener("change",()=>{const m=h.value==="auto"?"auto":Number.parseInt(h.value,10);this.runLocalHooks("pageSizeChange",m)}),this.setCounterSectionVisibility(!1),this.setNavigationSectionVisibility(!1),this.setPageSizeSectionVisibility(!1),Rt(nd,this)?(Rt(nd,this).appendChild(n.fragment),fe(i,[Rt(cg,this),"handsontable"])):Rt(Dg,this).after(n.fragment)}getContainer(){return Rt(ur,this).container}getFocusableElements(){const{first:e,prev:n,next:i,last:r,pageSizeSelect:o}=Rt(ur,this);return[o,e,n,i,r].filter(a=>!a.disabled)}updateWidth(e){return Rt(ur,this).container.style.width=`${e}px`,this}updateTheme(e){if($a(cg,this,e),Rt(nd,this)){const{container:n}=Rt(ur,this);Ve(n,/ht-theme-.*/g),Rt(cg,this)&&fe(n,Rt(cg,this))}return this}getHeight(){return Rt(ur,this).container.offsetHeight}refreshBorderState(){const{container:e}=Rt(ur,this);return Rt(nd,this)||Rt(yx,this).call(this)?fe(e,"ht-pagination--bordered"):Ve(e,"ht-pagination--bordered"),this}updateState(e){let{currentPage:n,totalPages:i,firstVisibleRowIndex:r,lastVisibleRowIndex:o,totalRenderedRows:a,pageSizeList:u,pageSize:h,autoPageSize:d}=e;const{first:g,prev:m,next:v,last:y,pageCounterSection:b,pageNavSection:C,pageNavLabel:T,pageSizeSelect:O,pageSizeLabel:A}=Rt(ur,this),N=Rt(hs,this).call(this,bD,{start:r+1,end:o+1,total:a}),x=Rt(hs,this).call(this,CD,{currentPage:n,totalPages:i}),$=Rt(hs,this).call(this,n0);b.textContent=N,T.textContent=x,O.textContent="",A.textContent=`${$}:`,We(C,[Bo(Rt(hs,this).call(this,yD))]),We(O,[Bo(Rt(hs,this).call(this,n0)),lo(-1)]),Rt(Sx,this).call(this,x),this.refreshBorderState(),u.forEach(Q=>{const ue=Q==="auto"?Rt(hs,this).call(this,SD):Q,X=new Option(ue,Q);(d&&Q==="auto"||!d&&Q===h)&&(X.selected=!0),O.add(X)});const L=n===1,P=n===i;if(C.style.display!=="none"){const Q=Rt(Dg,this).ownerDocument.activeElement;L?(fe(g,"ht-page-navigation-section__button--disabled"),fe(m,"ht-page-navigation-section__button--disabled"),g.disabled=!0,m.disabled=!0):(Ve(g,"ht-page-navigation-section__button--disabled"),Ve(m,"ht-page-navigation-section__button--disabled"),g.disabled=!1,m.disabled=!1),P?(fe(v,"ht-page-navigation-section__button--disabled"),fe(y,"ht-page-navigation-section__button--disabled"),v.disabled=!0,y.disabled=!0):(Ve(v,"ht-page-navigation-section__button--disabled"),Ve(y,"ht-page-navigation-section__button--disabled"),v.disabled=!1,y.disabled=!1),[g,m,v,y].includes(Q)&&(m.disabled?v.focus():v.disabled&&m.focus())}return We(g,[Bo(Rt(hs,this).call(this,RD)),Ev(L),lo(-1)]),We(m,[Bo(Rt(hs,this).call(this,ED)),Ev(L),lo(-1)]),We(v,[Bo(Rt(hs,this).call(this,TD)),Ev(P),lo(-1)]),We(y,[Bo(Rt(hs,this).call(this,_D)),Ev(P),lo(-1)]),this}setPageSizeSectionVisibility(e){const{pageSizeSection:n,pageSizeSelect:i}=Rt(ur,this);return n.style.display=e?"":"none",i.disabled=!e,ew(zb,this,bx).call(this),this}setCounterSectionVisibility(e){return Rt(ur,this).pageCounterSection.style.display=e?"":"none",ew(zb,this,bx).call(this),this}setNavigationSectionVisibility(e){const{pageNavSection:n,first:i,prev:r,next:o,last:a}=Rt(ur,this);return n.style.display=e?"":"none",i.disabled=!e,r.disabled=!e,o.disabled=!e,a.disabled=!e,ew(zb,this,bx).call(this),this}destroy(){var e;(e=Rt(ur,this))===null||e===void 0||e.container.remove(),$a(ur,this,null)}}function bx(){const{container:t,pageSizeSection:e,pageCounterSection:n,pageNavSection:i}=Rt(ur,this),r=e.style.display!=="none"||n.style.display!=="none"||i.style.display!=="none";Rt(nd,this)||(r?fe(Rt(Dg,this).querySelector(".ht-wrapper"),"htPagination"):Ve(Rt(Dg,this).querySelector(".ht-wrapper"),"htPagination")),t.style.display=r?"":"none"}en(C9,Fi);const _Ae=["nestedRows","mergeCells","fixedRowsTop","fixedRowsBottom"];function MAe(t){return _Ae.some(e=>{const n=!!t[e];return n&&_t(Ft`The \`pagination\` plugin cannot be used with the \`${e}\` option.\x20
                        This combination is not supported. The plugin will remain disabled.`),n})}function Cx(t,e,n){return(e=AAe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function AAe(t){var e=OAe(t,"string");return typeof e=="symbol"?e:e+""}function OAe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xAe{constructor(){Cx(this,"pageSize",1),Cx(this,"totalItems",0),Cx(this,"totalPages",0)}calculate(e){let{pageSize:n,totalItems:i}=e;this.pageSize=Math.max(n,1),this.totalItems=i,this.totalPages=Math.max(1,Math.ceil(this.totalItems/this.pageSize))}getTotalPages(){return this.totalPages}getState(e){if(e-=1,e<0||e>=this.getTotalPages())return;const n=e*this.pageSize,i=Math.max(0,Math.min(n+this.pageSize-1,this.totalItems-1));return{startIndex:n,endIndex:i,pageSize:this.pageSize}}}function HAe(t,e,n){return(e=IAe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function IAe(t){var e=PAe(t,"string");return typeof e=="symbol"?e:e+""}function PAe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NAe{constructor(){HAe(this,"pages",[])}calculate(e){let{itemsSizeProvider:n,viewportSizeProvider:i}=e;const r=n(),o=i(),a=[];let u=0,h=1,d=0;for(let g=0;g<r.length;g++){const m=r[g];d>0&&h+m>=o&&(a.push({startIndex:u,endIndex:g-1,pageSize:d}),u=g,h=1,d=0),h+=m,d+=1}a.push({startIndex:u,endIndex:Math.max(0,r.length-1),pageSize:d}),this.pages=a}getTotalPages(){return this.pages.length}getState(e){if(e-=1,!(e<0||e>=this.getTotalPages()))return this.pages[e]}}const p3=new Map([["fixed",xAe],["auto",NAe]]);function v3(t){if(!p3.has(t))throw new Error(`Unknown pagination strategy type: ${t}`);const e=p3.get(t);return new e}function DAe(t){let{focusableElements:e}=t;return uL({initialPage:0,size:()=>e().length,onItemSelect:i=>{e()[i].focus()}})}function LAe(t,e){R9(t,e),e.add(t)}function Va(t,e,n){R9(t,e),e.set(t,n)}function R9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ie(t,e){return t.get(Ut(t,e))}function $i(t,e,n){return t.set(Ut(t,e),n),n}function Ut(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const Lg="pagination",kAe=900,E9=Lg,am=`plugin:${Lg}`,w3=Ft`The \`auto\` page size setting requires the \`autoRowSize\`\x20
  plugin to be enabled. Set the \`autoRowSize: true\` in the configuration to ensure correct behavior.`;var tw=new WeakMap,gr=new WeakMap,ta=new WeakMap,Dn=new WeakMap,Ss=new WeakMap,W0=new WeakMap,PC=new WeakMap,Fo=new WeakMap,oa=new WeakMap,Jt=new WeakSet,Rx=new WeakMap;class $Ae extends Dt{constructor(){super(...arguments),LAe(this,Jt),Va(this,tw,null),Va(this,gr,1),Va(this,ta,10),Va(this,Dn,null),Va(this,Ss,null),Va(this,W0,!1),Va(this,PC,!1),Va(this,Fo,null),Va(this,oa,null),Va(this,Rx,()=>{var e;!Ie(W0,this)&&(e=this.hot)!==null&&e!==void 0&&e.view&&Ut(Jt,this,vd).call(this)})}static get PLUGIN_KEY(){return Lg}static get PLUGIN_PRIORITY(){return kAe}static get DEFAULT_SETTINGS(){return{pageSize:10,pageSizeList:["auto",5,10,20,50,100],initialPage:1,showPageSize:!0,showCounter:!0,showNavigation:!0,uiContainer:null}}isEnabled(){return!!this.hot.getSettings()[Lg]}enablePlugin(){var e,n=this;if(MAe(this.hot.getSettings())){this.hot.getSettings()[Lg]=!1;return}if(this.enabled)return;const i=this.hot.getSettings()[Lg];i?.initialPage!==void 0&&$i(gr,this,this.getSetting("initialPage")),i?.pageSize!==void 0&&$i(ta,this,this.getSetting("pageSize")),$i(tw,this,this.hot.rowIndexMapper.createAndRegisterIndexMap(this.pluginName,"hiding",!1)),Ie(ta,this)==="auto"&&!((e=this.hot.getPlugin("autoRowSize"))!==null&&e!==void 0&&e.enabled)&&_t(w3),$i(Ss,this,v3(Ie(ta,this)==="auto"?"auto":"fixed")),Ie(Dn,this)||($i(Dn,this,new C9({rootElement:this.hot.rootGridElement,uiContainer:this.getSetting("uiContainer"),isRtl:this.hot.isRtl(),themeName:this.hot.getSettings().themeName,phraseTranslator:function(){return n.hot.getTranslatedPhrase(...arguments)},shouldHaveBorder:()=>Ut(Jt,this,WAe).call(this),a11yAnnouncer:r=>_ge(r)})),Ut(Jt,this,y3).call(this),Ie(Dn,this).addLocalHook("firstPageClick",()=>this.firstPage()).addLocalHook("prevPageClick",()=>this.prevPage()).addLocalHook("nextPageClick",()=>this.nextPage()).addLocalHook("lastPageClick",()=>this.lastPage()).addLocalHook("pageSizeChange",r=>this.setPageSize(r)).addLocalHook("focus",r=>{Ie(Fo,this).setCurrentPage(Ie(Dn,this).getFocusableElements().indexOf(r)),this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName(am),this.hot.listen(),Ie(oa,this).deactivate()})),Ie(Fo,this)||$i(Fo,this,DAe({focusableElements:()=>Ie(Dn,this).getFocusableElements()})),Ie(oa,this)||$i(oa,this,DD(this.hot,Ie(Dn,this).getContainer(),{onFocus:r=>{this.hot.getShortcutManager().setActiveContextName(am),this.hot.listen(),r==="from_above"?Ie(Fo,this).toFirstItem():Ie(Fo,this).toLastItem(),Ie(oa,this).deactivate()}})),Ut(Jt,this,VAe).call(this),Ut(Jt,this,BAe).call(this),this.addHook("init",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,XAe).call(n,...o)},-1),this.addHook("beforeSelectAll",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,S3).call(n,...o)}),this.addHook("beforeSelectColumns",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,S3).call(n,...o)}),this.addHook("beforeSetRangeEnd",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,jAe).call(n,...o)}),this.addHook("beforeSelectionHighlightSet",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,zAe).call(n,...o)}),this.addHook("beforePaste",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,UAe).call(n,...o)}),this.addHook("afterViewRender",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,GAe).call(n,...o)}),this.addHook("afterRender",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,qAe).call(n,...o)}),this.addHook("afterScrollVertically",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,ZAe).call(n,...o)}),this.addHook("afterLanguageChange",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,QAe).call(n,...o)}),this.addHook("modifyRowHeight",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,YAe).call(n,...o)}),this.addHook("beforeHeightChange",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,KAe).call(n,...o)}),this.addHook("afterSetTheme",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,JAe).call(n,...o)}),this.addHook("afterDialogShow",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,eOe).call(n,...o)}),this.addHook("beforeDialogHide",function(){for(var r=arguments.length,o=new Array(r),a=0;a<r;a++)o[a]=arguments[a];return Ut(Jt,n,tOe).call(n,...o)}),this.hot.rowIndexMapper.addLocalHook("cacheUpdated",Ie(Rx,this)),super.enablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),Ut(Jt,this,vd).call(this),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.removeLocalHook("cacheUpdated",Ie(Rx,this)).unregisterMap(this.pluginName),Ie(Dn,this).destroy(),$i(Dn,this,null),Ut(Jt,this,FAe).call(this),super.disablePlugin()}getPaginationData(){const e=Ie(Ss,this).getTotalPages();let n=-1,i=-1;const{pageSize:r,startIndex:o}=Ie(Ss,this).getState(Ie(gr,this)),a=this.hot.countRows();let u=0;for(let h=o;u<r&&!(h>=a);h++)this.hot.rowIndexMapper.isHidden(this.hot.toPhysicalRow(h))||(n===-1&&(n=h),i=h,u+=1);return{currentPage:Ie(gr,this),totalPages:e,pageSize:r,pageSizeList:[...this.getSetting("pageSizeList")],autoPageSize:Ie(ta,this)==="auto",numberOfRenderedRows:this.hot.rowIndexMapper.getRenderableIndexesLength(),firstVisibleRowIndex:n,lastVisibleRowIndex:i}}setPage(e){const n=Ie(gr,this);this.hot.runHooks("beforePageChange",n,e)!==!1&&($i(gr,this,e),Ut(Jt,this,vd).call(this),this.hot.scrollViewportTo({row:0}),this.hot.runHooks("afterPageChange",n,Ie(gr,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPage(){this.setPage(this.getSetting("initialPage"))}setPageSize(e){var n;const i=Ie(ta,this);this.hot.runHooks("beforePageSizeChange",i,e)!==!1&&(e==="auto"&&!((n=this.hot.getPlugin("autoRowSize"))!==null&&n!==void 0&&n.enabled)&&_t(w3),$i(Ss,this,v3(e==="auto"?"auto":"fixed")),$i(ta,this,e),Ut(Jt,this,vd).call(this),this.hot.runHooks("afterPageSizeChange",i,Ie(ta,this)),this.hot.view.adjustElementsSize(),this.hot.render())}resetPageSize(){this.setPageSize(this.getSetting("pageSize"))}resetPagination(){this.resetPage(),this.resetPageSize(),Ut(Jt,this,y3).call(this)}nextPage(){this.setPage(Ie(gr,this)+1)}prevPage(){this.setPage(Ie(gr,this)-1)}firstPage(){this.setPage(1)}lastPage(){this.setPage(Ie(Ss,this).getTotalPages())}hasPreviousPage(){return Ie(gr,this)>1}hasNextPage(){return Ie(gr,this)<Ie(Ss,this).getTotalPages()}getCurrentPageData(){const{firstVisibleRowIndex:e,lastVisibleRowIndex:n}=this.getPaginationData();return e===-1||n===-1?[]:this.hot.getData(e,0,n,this.hot.countCols()-1)}showPageSizeSection(){Ie(Dn,this).setPageSizeSectionVisibility(!0),this.hot.runHooks("afterPageSizeVisibilityChange",!0)}hidePageSizeSection(){Ie(Dn,this).setPageSizeSectionVisibility(!1),this.hot.runHooks("afterPageSizeVisibilityChange",!1)}showPageCounterSection(){Ie(Dn,this).setCounterSectionVisibility(!0),this.hot.runHooks("afterPageCounterVisibilityChange",!0)}hidePageCounterSection(){Ie(Dn,this).setCounterSectionVisibility(!1),this.hot.runHooks("afterPageCounterVisibilityChange",!1)}showPageNavigationSection(){Ie(Dn,this).setNavigationSectionVisibility(!0),this.hot.runHooks("afterPageNavigationVisibilityChange",!0)}hidePageNavigationSection(){Ie(Dn,this).setNavigationSectionVisibility(!1),this.hot.runHooks("afterPageNavigationVisibilityChange",!1)}destroy(){var e;$i(tw,this,null),$i(Ss,this,null),(e=Ie(Dn,this))===null||e===void 0||e.destroy(),$i(Dn,this,null),super.destroy()}}function VAe(){this.eventManager.addEventListener(this.hot.rootDocument,"mouseup",t=>{!Ie(Dn,this).getContainer().contains(t.target)&&this.hot.getShortcutManager().getActiveContextName()===am&&(Ie(oa,this).activate(),Ie(Fo,this).clear(),this.hot.getShortcutManager().setActiveContextName("grid"))})}function BAe(){var t;const e=this.hot.getShortcutManager();((t=e.getContext(am))!==null&&t!==void 0?t:e.addContext(am,"global")).addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:i=>{let r=Ie(Fo,this).getCurrentPage();if(i.shiftKey){Ie(Fo,this).toPreviousItem();const o=Ie(Fo,this).getCurrentPage();if(o>=r){Ut(Jt,this,b3).call(this);return}r=o}else{Ie(Fo,this).toNextItem();const o=Ie(Fo,this).getCurrentPage();if(o<=r){Ut(Jt,this,b3).call(this);return}r=o}i.preventDefault()},group:E9})}function FAe(){this.hot.getShortcutManager().getContext(am).removeShortcutsByGroup(E9)}function y3(){this.getSetting("showPageSize")?this.showPageSizeSection():this.hidePageSizeSection(),this.getSetting("showCounter")?this.showPageCounterSection():this.hidePageCounterSection(),this.getSetting("showNavigation")?this.showPageNavigationSection():this.hidePageNavigationSection()}function vd(){$i(W0,this,!0),Ie(tw,this).clear();const t=this.hot.rowIndexMapper.getRenderableIndexes(),e=t.length,{stylesHandler:n}=this.hot;Ie(Ss,this).calculate({pageSize:Ie(ta,this),totalItems:e,viewportSizeProvider:()=>{const{view:o}=this.hot;if(o.isVerticallyScrollableByWindow()){const u=getComputedStyle(this.hot.rootDocument.body),h=Number.parseInt(u.marginTop,10)+Number.parseInt(u.marginBottom,10),d=this.hot.hasColHeaders()?o._wt.wtTable.getColumnHeaderHeight():0,g=Ie(Dn,this).getHeight();return o.getWorkspaceHeight()-g-d-h}const a=o.hasHorizontalScroll()?_i():0;return o.getViewportHeight()-a},itemsSizeProvider:()=>{const o=n.getDefaultRowHeight();return this.hot.rowIndexMapper.getRenderableIndexes().map(u=>{var h;return(h=this.hot.getRowHeight(this.hot.toVisualRow(u)))!==null&&h!==void 0?h:o})}});const i=Ie(Ss,this).getTotalPages();if($i(gr,this,St(Ie(gr,this),1,i)),t.length>0){const{startIndex:o,pageSize:a}=Ie(Ss,this).getState(Ie(gr,this));t.splice(o,a)}t.length>0?this.hot.batchExecution(()=>{t.forEach(o=>Ie(tw,this).setValueAtIndex(o,!0))},!0):this.hot.rowIndexMapper.updateCache(!0),$i(W0,this,!1);const r=this.getPaginationData();Ie(Dn,this).updateState({...r,totalRenderedRows:e}),(this.getSetting("showPageSize")||this.getSetting("showNavigation"))&&r.totalPages>1?Ie(oa,this).activate():Ie(oa,this).deactivate()}function WAe(){if(!this.hot.view)return!0;const{view:t}=this.hot;if(t.isVerticallyScrollableByWindow())return!1;if(t.hasHorizontalScroll()||t.getTableHeight()<t.getWorkspaceHeight())return!0;const{lastVisibleRowIndex:e}=this.getPaginationData();return t.getLastFullyVisibleRow()!==e}function S3(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:i}=this.getPaginationData();(Ie(gr,this)>1||t.row>=0)&&(t.row=n),e.row=i}function jAe(t){if(this.hot.selection.isSelectedByColumnHeader()){const{lastVisibleRowIndex:e}=this.getPaginationData();t.row=e}}function zAe(){if(!this.hot.getSettings().navigableHeaders)return;const t=this.hot.getSelectedRangeLast();if(!t.isSingle()){const{highlight:e}=t;e.row=St(e.row,t.getTopStartCorner().row,t.getBottomEndCorner().row)}}function UAe(t,e){const{firstVisibleRowIndex:n,lastVisibleRowIndex:i}=this.getPaginationData();if(n===-1||i===-1)return!1;e.forEach(r=>{let{startRow:o}=r;if(t.length===0)return;const a=Math.min(t.length-(i-o+1),t.length);t.splice(0,a)})}function YAe(t,e){if(t===void 0||!Ie(Ss,this).getState(Ie(gr,this)))return;const{firstVisibleRowIndex:n}=this.getPaginationData();return e!==0&&e===n&&(t+=1),t}function GAe(){if(Ie(ta,this)!=="auto"||Ie(PC,this)){$i(PC,this,!1);return}Ut(Jt,this,vd).call(this),$i(PC,this,!0),this.hot.view.adjustElementsSize(),this.hot.render()}function qAe(){const{view:t}=this.hot,e=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();Ie(Dn,this).updateWidth(e).refreshBorderState()}function KAe(t){return this.getSetting("uiContainer")||!(typeof t=="number"||typeof t=="string"&&/^\d+$/.test(t)||typeof t=="string"&&t.endsWith("px"))?t:`calc(${typeof t=="string"&&t.endsWith("px")?t:`${t}px`} - ${Ie(Dn,this).getHeight()}px)`}function XAe(){Ie(ta,this)!=="auto"&&Ut(Jt,this,vd).call(this)}function ZAe(){Ie(Dn,this).refreshBorderState()}function QAe(){Ut(Jt,this,vd).call(this)}function JAe(t){Ie(Dn,this).updateTheme(t)}function b3(){Ie(oa,this).activate(),Ie(Fo,this).clear(),this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName("grid")}function eOe(){Ie(oa,this).deactivate()}function tOe(){Ie(oa,this).activate()}function Ex(t,e,n){return(e=nOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function nOe(t){var e=iOe(t,"string");return typeof e=="symbol"?e:e+""}function iOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class rOe{constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:window;Ex(this,"rootWindow",void 0),Ex(this,"prefix",void 0),Ex(this,"savedKeys",[]),this.rootWindow=n,this.prefix=e,this.loadSavedKeys()}saveValue(e,n){this.rootWindow.localStorage.setItem(`${this.prefix}_${e}`,JSON.stringify(n)),this.savedKeys.indexOf(e)===-1&&(this.savedKeys.push(e),this.saveSavedKeys())}loadValue(e,n){const i=typeof e>"u"?n:e,r=this.rootWindow.localStorage.getItem(`${this.prefix}_${i}`);return r===null?void 0:JSON.parse(r)}reset(e){this.rootWindow.localStorage.removeItem(`${this.prefix}_${e}`)}resetAll(){U(this.savedKeys,(e,n)=>{this.rootWindow.localStorage.removeItem(`${this.prefix}_${this.savedKeys[n]}`)}),this.clearSavedKeys()}loadSavedKeys(){const e=this.rootWindow.localStorage.getItem(`${this.prefix}__persistentStateKeys`),n=typeof e=="string"?JSON.parse(e):void 0;this.savedKeys=n||[]}saveSavedKeys(){this.rootWindow.localStorage.setItem(`${this.prefix}__persistentStateKeys`,JSON.stringify(this.savedKeys))}clearSavedKeys(){this.savedKeys.length=0,this.saveSavedKeys()}}function oOe(t,e,n){return(e=sOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function sOe(t){var e=aOe(t,"string");return typeof e=="symbol"?e:e+""}function aOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}He.getSingleton().register("persistentStateSave");He.getSingleton().register("persistentStateLoad");He.getSingleton().register("persistentStateReset");const C3="persistentState",lOe=0,R3=new WeakSet;class uOe extends Dt{constructor(){super(...arguments),oOe(this,"storage",void 0)}static get PLUGIN_KEY(){return C3}static get PLUGIN_PRIORITY(){return lOe}isEnabled(){return!!this.hot.getSettings()[C3]}enablePlugin(){this.enabled||(R3.has(this.hot)||(R3.add(this.hot),L4("The PersistentState plugin is deprecated and will be removed in version 17.0. Please update your settings to ensure compatibility with future versions.")),this.storage||(this.storage=new rOe(this.hot.rootContainer.id||this.hot.rootElement.id,this.hot.rootWindow)),this.addHook("persistentStateSave",(e,n)=>this.saveValue(e,n)),this.addHook("persistentStateLoad",(e,n)=>this.loadValue(e,n)),this.addHook("persistentStateReset",()=>this.resetValue()),super.enablePlugin())}disablePlugin(){this.storage=void 0,super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}loadValue(e,n){n.value=this.storage.loadValue(e)}saveValue(e,n){this.storage.saveValue(e,n)}resetValue(e){typeof e>"u"?this.storage.resetAll():this.storage.reset(e)}destroy(){super.destroy()}}function cOe(t,e){hOe(t,e),e.add(t)}function hOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Tx(t,e,n){return(e=dOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function dOe(t){var e=fOe(t,"string");return typeof e=="symbol"?e:e+""}function fOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function E3(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const _x="search",gOe=190,mOe="htSearchResult",pOe=function(t,e,n,i,r){t.getCellMeta(e,n).isSearchResult=r},vOe=function(t,e,n){return $n(t)||t===null||!t.toLocaleLowerCase||t.length===0||$n(e)||e===null?!1:e.toString().toLocaleLowerCase(n.locale).indexOf(t.toLocaleLowerCase(n.locale))!==-1};var Mx=new WeakSet;class wOe extends Dt{constructor(){super(...arguments),cOe(this,Mx),Tx(this,"callback",pOe),Tx(this,"queryMethod",vOe),Tx(this,"searchResultClass",mOe)}static get PLUGIN_KEY(){return _x}static get PLUGIN_PRIORITY(){return gOe}isEnabled(){return this.hot.getSettings()[_x]}enablePlugin(){var e=this;if(this.enabled)return;const n=this.hot.getSettings()[_x];this.updatePluginSettings(n),this.addHook("beforeRenderer",function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return E3(Mx,e,T3).call(e,...r)}),super.enablePlugin()}disablePlugin(){var e=this;const n=function(){for(var i=arguments.length,r=new Array(i),o=0;o<i;o++)r[o]=arguments[o];return E3(Mx,e,T3).call(e,...r)};this.hot.addHook("beforeRenderer",n),this.hot.addHookOnce("afterViewRender",()=>{this.hot.removeHook("beforeRenderer",n)}),super.disablePlugin()}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}query(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.getCallback(),i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.getQueryMethod();const r=this.hot.countRows(),o=this.hot.countCols(),a=[],u=this.hot;return ze(0,r-1,h=>{ze(0,o-1,d=>{const g=this.hot.getDataAtCell(h,d),m=this.hot.getCellMeta(h,d),v=m.search.callback||n,b=(m.search.queryMethod||i)(e,g,m);if(b){const C={row:h,col:d,data:g};a.push(C)}v&&v(u,h,d,g,b)})}),a}getCallback(){return this.callback}setCallback(e){this.callback=e}getQueryMethod(){return this.queryMethod}setQueryMethod(e){this.queryMethod=e}getSearchResultClass(){return this.searchResultClass}setSearchResultClass(e){this.searchResultClass=e}updatePluginSettings(e){Qe(e)&&(e.searchResultClass&&this.setSearchResultClass(e.searchResultClass),e.queryMethod&&this.setQueryMethod(e.queryMethod),e.callback&&this.setCallback(e.callback))}destroy(){super.destroy()}}function T3(t,e,n,i,r,o){const a=o.className||[];let u=[];typeof a=="string"?u=a.split(" "):u.push(...a),this.isEnabled()&&o.isSearchResult?u.includes(this.searchResultClass)||u.push(`${this.searchResultClass}`):u.includes(this.searchResultClass)&&u.splice(u.indexOf(this.searchResultClass),1),o.className=u.join(" ")}function Ub(t,e,n){return(e=yOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function yOe(t){var e=SOe(t,"string");return typeof e=="symbol"?e:e+""}function SOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class T9{constructor(e){Ub(this,"viewportWidth",void 0),Ub(this,"overwriteColumnWidthFn",void 0),Ub(this,"baseWidths",new Map),Ub(this,"stretchedWidths",new Map),this.overwriteColumnWidthFn=e}prepare(e){let{viewportWidth:n}=e;this.viewportWidth=n,this.baseWidths.clear(),this.stretchedWidths.clear()}setColumnBaseWidth(e,n){this.baseWidths.set(e,n)}calculate(){}getWidths(){return Array.from(this.stretchedWidths)}}class bOe extends T9{calculate(){const e=Array.from(this.baseWidths).reduce((m,v)=>{let[,y]=v;return m+y},0);if(this.viewportWidth-e<0){this.stretchedWidths.clear();return}const i=this.viewportWidth/e,r=[],o=[];let a=this.viewportWidth,u=0;if(this.baseWidths.forEach((m,v)=>{const y=Math.round(m*i),b=this.overwriteColumnWidthFn(y,v);y===b&&y>=Jg?(r.push([v,b]),u+=b):y!==b&&(r.push([v,b]),o.push(v),a-=b)}),a<=Jg){this.stretchedWidths.clear();return}const h=a/u;let d=-1,g=0;r.forEach((m,v)=>{let[y,b]=m,C=b;o.includes(y)||(C=Math.round(b*h)),this.stretchedWidths.set(y,C),d=y,v<r.length-1&&(g+=C)}),this.stretchedWidths.size>1&&this.stretchedWidths.set(d,Math.round(this.viewportWidth-g))}}function _3(t,e,n){COe(t,e),e.set(t,n)}function COe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ax(t,e){return t.get(_9(t,e))}function Yb(t,e,n){return t.set(_9(t,e),n),n}function _9(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var Gb=new WeakMap,Sv=new WeakMap;class ROe extends T9{constructor(){super(...arguments),_3(this,Gb,0),_3(this,Sv,-1)}prepare(e){super.prepare(e),Yb(Gb,this,0),Yb(Sv,this,-1)}setColumnBaseWidth(e,n){super.setColumnBaseWidth(e,n),Yb(Sv,this,e),Yb(Gb,this,n)}calculate(){if(Ax(Sv,this)===-1)return;const e=Array.from(this.baseWidths).reduce((i,r)=>{let[,o]=r;return i+o},0),n=Math.max(this.viewportWidth-e+Ax(Gb,this),0);this.stretchedWidths.set(Ax(Sv,this),n)}}function EOe(t,e){M9(t,e),e.add(t)}function qb(t,e,n){M9(t,e),e.set(t,n)}function M9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ln(t,e){return t.get(kg(t,e))}function Ox(t,e,n){return t.set(kg(t,e),n),n}function kg(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const TOe="stretchColumns";var Ki=new WeakMap,hg=new WeakMap,xx=new WeakMap,Kb=new WeakMap,bv=new WeakSet;class _Oe{constructor(e){EOe(this,bv),qb(this,Ki,void 0),qb(this,hg,void 0),qb(this,xx,new Map([["all",new bOe(kg(bv,this,M3).bind(this))],["last",new ROe(kg(bv,this,M3).bind(this))]])),qb(this,Kb,"none"),Ox(Ki,this,e),Ox(hg,this,Ln(Ki,this).columnIndexMapper.createAndRegisterIndexMap(TOe,"physicalIndexToValue"))}useStrategy(e){Ox(Kb,this,Ln(xx,this).has(e)?e:"none")}refreshStretching(){if(Ln(Kb,this)==="none"){Ln(hg,this).clear();return}Ln(Ki,this).batchExecution(()=>{Ln(hg,this).clear();const e=Ln(xx,this).get(Ln(Kb,this));let i=Ln(Ki,this).view.getViewportWidth();kg(bv,this,MOe).call(this)&&(i-=_i(Ln(Ki,this).rootDocument)),e.prepare({viewportWidth:i});for(let r=0;r<Ln(Ki,this).countCols();r++)Ln(Ki,this).columnIndexMapper.isHidden(Ln(Ki,this).toPhysicalColumn(r))||e.setColumnBaseWidth(r,kg(bv,this,AOe).call(this,r));e.calculate(),e.getWidths().forEach(r=>{let[o,a]=r;Ln(hg,this).setValueAtIndex(Ln(Ki,this).toPhysicalColumn(o),a)})},!0)}getStretchedWidth(e){return Ln(hg,this).getValueAtIndex(Ln(Ki,this).toPhysicalColumn(e))}}function MOe(){const{view:t,stylesHandler:e}=Ln(Ki,this);if(t.isVerticallyScrollableByWindow())return!1;const n=t.getViewportHeight(),i=Ln(Ki,this).countRows(),r=e.getDefaultRowHeight();let o=0,a=!1;for(let h=0;h<i;h++){var u;if(!Ln(Ki,this).rowIndexMapper.isHidden(Ln(Ki,this).toPhysicalRow(h))&&(o+=((u=Ln(Ki,this).getRowHeight(h))!==null&&u!==void 0?u:r)+(h===0?1:0),o>n)){a=!0;break}}return a}function AOe(t){var e;return(e=Ln(Ki,this).getColWidth(t,"StretchColumns"))!==null&&e!==void 0?e:Jg}function M3(t,e){return Ln(Ki,this).runHooks("beforeStretchingColumnWidth",t,e)}function OOe(t,e){A9(t,e),e.add(t)}function Hx(t,e,n){A9(t,e),e.set(t,n)}function A9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ix(t,e,n){return t.set(j0(t,e),n),n}function Ul(t,e){return t.get(j0(t,e))}function j0(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const xOe="stretchColumns",HOe=155;var Rg=new WeakMap,Xb=new WeakMap,Cv=new WeakMap,Px=new WeakSet;class IOe extends Dt{constructor(){super(...arguments),OOe(this,Px),Hx(this,Rg,new _Oe(this.hot)),Hx(this,Xb,null),Hx(this,Cv,new ResizeObserver(e=>{requestAnimationFrame(()=>{var n;(n=this.hot)!==null&&n!==void 0&&n.view.isHorizontallyScrollableByWindow()&&e.forEach(i=>{let{contentRect:r}=i;Ul(Xb,this)!==null&&Ul(Xb,this)!==r.width&&(this.hot.view.adjustElementsSize(),this.hot.refreshDimensions()),Ix(Xb,this,r.width)})})}))}static get PLUGIN_KEY(){return xOe}static get PLUGIN_PRIORITY(){return HOe}static get SETTING_KEYS(){return!0}isEnabled(){return["all","last"].includes(this.hot.getSettings().stretchH)}enablePlugin(){var e=this;this.enabled||(Ul(Rg,this).useStrategy(this.hot.getSettings().stretchH),Ul(Cv,this).observe(this.hot.rootElement),this.addHook("beforeRender",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return j0(Px,e,NOe).call(e,...i)}),this.addHook("modifyColWidth",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return j0(Px,e,POe).call(e,...i)},10),super.enablePlugin())}updatePlugin(){Ul(Rg,this).useStrategy(this.hot.getSettings().stretchH),super.updatePlugin()}disablePlugin(){super.disablePlugin(),Ul(Cv,this).unobserve(this.hot.rootElement)}getColumnWidth(e){return Ul(Rg,this).getStretchedWidth(e)}destroy(){Ul(Cv,this).disconnect(),Ix(Cv,this,null),Ix(Rg,this,null),super.destroy()}}function POe(t,e,n){if(n===this.pluginName)return;const i=this.getColumnWidth(e);return typeof i=="number"?i:t}function NOe(t){t&&Ul(Rg,this).refreshStretching()}function DOe(t,e){LOe(t,e),e.add(t)}function LOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Zb(t,e,n){return(e=kOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function kOe(t){var e=$Oe(t,"string");return typeof e=="symbol"?e:e+""}function $Oe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Nx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const VOe="touchScroll",BOe=200;var Qb=new WeakSet;class FOe extends Dt{constructor(){super(...arguments),DOe(this,Qb),Zb(this,"scrollbars",[]),Zb(this,"clones",[]),Zb(this,"lockedCollection",!1),Zb(this,"freezeOverlays",!1)}static get PLUGIN_KEY(){return VOe}static get PLUGIN_PRIORITY(){return BOe}static get SETTING_KEYS(){return!0}isEnabled(){return v4()}enablePlugin(){this.enabled||(this.addHook("afterViewRender",()=>Nx(Qb,this,WOe).call(this)),this.registerEvents(),super.enablePlugin())}updatePlugin(){this.lockedCollection=!1,super.updatePlugin()}disablePlugin(){super.disablePlugin()}registerEvents(){this.addHook("beforeTouchScroll",()=>Nx(Qb,this,jOe).call(this)),this.addHook("afterMomentumScroll",()=>Nx(Qb,this,zOe).call(this))}}function WOe(){if(this.lockedCollection)return;const{topOverlay:t,bottomOverlay:e,inlineStartOverlay:n,topInlineStartCornerOverlay:i,bottomInlineStartCornerOverlay:r}=this.hot.view._wt.wtOverlays;this.lockedCollection=!0,this.scrollbars.length=0,this.scrollbars.push(t),e.clone&&this.scrollbars.push(e),this.scrollbars.push(n),i&&this.scrollbars.push(i),r&&r.clone&&this.scrollbars.push(r),this.clones=[],t.needFullRender&&this.clones.push(t.clone.wtTable.holder.parentNode),e.needFullRender&&this.clones.push(e.clone.wtTable.holder.parentNode),n.needFullRender&&this.clones.push(n.clone.wtTable.holder.parentNode),i&&this.clones.push(i.clone.wtTable.holder.parentNode),r&&r.clone&&this.clones.push(r.clone.wtTable.holder.parentNode)}function jOe(){this.freezeOverlays=!0,U(this.clones,t=>{fe(t,"hide-tween")})}function zOe(){this.freezeOverlays=!1,U(this.clones,t=>{Ve(t,"hide-tween"),fe(t,"show-tween")}),this.hot._registerTimeout(()=>{U(this.clones,t=>{Ve(t,"show-tween")})},400),U(this.scrollbars,t=>{t.refresh(),t.resetFixedPosition()}),this.hot.view._wt.wtOverlays.syncScrollWithMaster()}function UOe(t,e){YOe(t,e),e.add(t)}function YOe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function GOe(t,e,n){return(e=qOe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function qOe(t){var e=KOe(t,"string");return typeof e=="symbol"?e:e+""}function KOe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function XOe(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const NC="trimRows",ZOe=330;var A3=new WeakSet;class QOe extends Dt{constructor(){super(...arguments),UOe(this,A3),GOe(this,"trimmedRowsMap",null)}static get PLUGIN_KEY(){return NC}static get PLUGIN_PRIORITY(){return ZOe}isEnabled(){return!!this.hot.getSettings()[NC]}enablePlugin(){this.enabled||(this.trimmedRowsMap=this.hot.rowIndexMapper.registerMap("trimRows",new Uw),this.trimmedRowsMap.addLocalHook("init",()=>XOe(A3,this,JOe).call(this)),super.enablePlugin())}updatePlugin(){const e=this.hot.getSettings()[NC];Array.isArray(e)&&this.hot.batchExecution(()=>{this.trimmedRowsMap.clear(),U(e,n=>{this.trimmedRowsMap.setValueAtIndex(n,!0)})},!0),super.updatePlugin()}disablePlugin(){this.hot.rowIndexMapper.unregisterMap("trimRows"),super.disablePlugin()}getTrimmedRows(){return this.trimmedRowsMap.getTrimmedIndexes()}trimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;i&&(r=Array.from(new Set(n.concat(e)))),this.hot.runHooks("beforeTrimRow",n,r,i)!==!1&&(i&&this.hot.batchExecution(()=>{U(e,a=>{this.trimmedRowsMap.setValueAtIndex(a,!0)})},!0),this.hot.runHooks("afterTrimRow",n,r,i,i&&r.length>n.length))}trimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.trimRows(n)}untrimRows(e){const n=this.getTrimmedRows(),i=this.isValidConfig(e);let r=n;const o=this.trimmedRowsMap.getValues().slice(),a=e.length>0;i&&a&&(U(e,h=>{o[h]=!1}),r=ho(o,(h,d,g)=>(d&&h.push(g),h),[])),this.hot.runHooks("beforeUntrimRow",n,r,i&&a)!==!1&&(i&&a&&this.trimmedRowsMap.setValues(o),this.hot.runHooks("afterUntrimRow",n,r,i&&a,i&&r.length<n.length))}untrimRow(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];this.untrimRows(n)}isTrimmed(e){return this.trimmedRowsMap.getValueAtIndex(e)||!1}untrimAll(){this.untrimRows(this.getTrimmedRows())}isValidConfig(e){const n=this.hot.countSourceRows();return e.every(i=>Number.isInteger(i)&&i>=0&&i<n)}destroy(){super.destroy()}}function JOe(){const t=this.hot.getSettings()[NC];Array.isArray(t)&&this.hot.batchExecution(()=>{U(t,e=>{this.trimmedRowsMap.setValueAtIndex(e,!0)})},!0)}function exe(t,e,n){return(e=txe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function txe(t){var e=nxe(t,"string");return typeof e=="symbol"?e:e+""}function nxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class Ns{constructor(e){exe(this,"actionType",""),this.actionType=e}undo(){throw new Error("Not implemented")}redo(){throw new Error("Not implemented")}}function Jb(t,e,n){return(e=ixe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function ixe(t){var e=rxe(t,"string");return typeof e=="symbol"?e:e+""}function rxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class _L extends Ns{constructor(e){let{stateBefore:n,range:i,type:r,alignment:o}=e;super("cell_alignment"),Jb(this,"stateBefore",void 0),Jb(this,"range",void 0),Jb(this,"type",void 0),Jb(this,"alignment",void 0),this.stateBefore=n,this.range=i,this.type=r,this.alignment=o}static startRegisteringEvents(e,n){e.addHook("beforeCellAlignment",(i,r,o,a)=>{n.done(()=>new _L({stateBefore:i,range:r,type:o,alignment:a}))})}undo(e,n){U(this.range,i=>{i.forAll((r,o)=>{r>=0&&o>=0&&e.setCellMeta(r,o,"className",this.stateBefore[r][o]||" htLeft")})}),e.addHookOnce("afterViewRender",n),e.render()}redo(e,n){yc(this.range,this.type,this.alignment,(i,r)=>e.getCellMeta(i,r),(i,r,o,a)=>e.setCellMeta(i,r,o,a)),e.addHookOnce("afterViewRender",n),e.render()}}function O3(t,e,n){return(e=oxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function oxe(t){var e=sxe(t,"string");return typeof e=="symbol"?e:e+""}function sxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class ML extends Ns{constructor(e){let{columns:n,finalIndex:i}=e;super("col_move"),O3(this,"columns",void 0),O3(this,"finalColumnIndex",void 0),this.columns=n.slice(),this.finalColumnIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnMove",(i,r)=>{i!==!1&&n.done(()=>new ML({columns:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),bL(this.columns,this.finalColumnIndex,e.columnIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:a,to:u}=o;a<u&&(u-=1),i.moveColumn(u,a)}),e.render(),e.deselectCell(),e.selectColumns(this.columns[0],this.columns[0]+this.columns.length-1)}redo(e,n){const i=e.getPlugin("manualColumnMove");e.addHookOnce("afterViewRender",n),i.moveColumns(this.columns.slice(),this.finalColumnIndex),e.render(),e.deselectCell(),e.selectColumns(this.finalColumnIndex,this.finalColumnIndex+this.columns.length-1)}}function x3(t,e,n){return(e=axe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function axe(t){var e=lxe(t,"string");return typeof e=="symbol"?e:e+""}function lxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class AL extends Ns{constructor(e){let{currentSortState:n,newSortState:i}=e;super("col_sort"),x3(this,"previousSortState",void 0),x3(this,"nextSortState",void 0),this.previousSortState=n,this.nextSortState=i}static startRegisteringEvents(e,n){e.addHook("beforeColumnSort",(i,r,o)=>{o&&n.done(()=>new AL({currentSortState:i,newSortState:r}))})}undo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting"),o=r.isEnabled()?r:i;this.previousSortState.length?o.sort(this.previousSortState):o.clearSort(),n()}redo(e,n){const i=e.getPlugin("columnSorting"),r=e.getPlugin("multiColumnSorting");(r.isEnabled()?r:i).sort(this.nextSortState),n()}}function H3(t,e,n){return(e=uxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function uxe(t){var e=cxe(t,"string");return typeof e=="symbol"?e:e+""}function cxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class OL extends Ns{constructor(e){let{index:n,amount:i}=e;super("insert_col"),H3(this,"index",void 0),H3(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateCol",(i,r,o)=>{n.done(()=>new OL({index:i,amount:r}),o)})}undo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateCol",n),e.alter("insert_col_start",this.index,this.amount,"UndoRedo.redo")}}function I3(t,e,n){return(e=hxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function hxe(t){var e=dxe(t,"string");return typeof e=="symbol"?e:e+""}function dxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class xL extends Ns{constructor(e){let{index:n,amount:i}=e;super("insert_row"),I3(this,"index",void 0),I3(this,"amount",void 0),this.index=n,this.amount=i}static startRegisteringEvents(e,n){e.addHook("afterCreateRow",(i,r,o)=>{n.done(()=>new xL({index:i,amount:r}),o)})}undo(e,n){const i=e.countRows(),r=e.getSettings().minSpareRows;this.index>=i&&this.index-r<i&&(this.index-=r),e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",this.index,this.amount,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterCreateRow",n),e.alter("insert_row_above",this.index,this.amount,"UndoRedo.redo")}}function eC(t,e,n){return(e=fxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function fxe(t){var e=gxe(t,"string");return typeof e=="symbol"?e:e+""}function gxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class HL extends Ns{constructor(e){let{changes:n,selected:i,countCols:r,countRows:o}=e;super("change"),eC(this,"changes",void 0),eC(this,"selected",void 0),eC(this,"countCols",void 0),eC(this,"countRows",void 0),this.changes=n,this.selected=i,this.countCols=r,this.countRows=o}static startRegisteringEvents(e,n){e.addHook("beforeChange",function(i,r){const o=i&&i.length;if(!o||!i.find(h=>{const[,,d,g]=h;return d!==g}))return;const u=()=>{const h=i.reduce((g,m)=>(g.push([...m]),g),[]);h.forEach(g=>{g[1]=e.propToCol(g[1])});const d=o>1?this.getSelected():[[h[0][0],h[0][1]]];return new HL({changes:h,selected:d,countCols:e.countCols(),countRows:e.countRows()})};n.done(u,r)})}undo(e,n){const i=Nr(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(3,1);e.addHookOnce("afterChange",()=>{const r=e.countRows()-this.countRows;r>0&&e.alter("remove_row",null,r,"UndoRedo.undo");const o=e.countCols()-this.countCols;o>0&&e.isColumnModificationAllowed()&&e.alter("remove_col",null,o,"UndoRedo.undo"),e.scrollToFocusedCell(),e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(i,null,null,"UndoRedo.undo")}redo(e,n){const i=Nr(this.changes);for(let r=0,o=i.length;r<o;r++)i[r].splice(2,1);e.addHookOnce("afterChange",()=>{e.selectCells(this.selected,!1,!1),n()}),e.setDataAtCell(i,null,null,"UndoRedo.redo")}}function P3(t,e,n){return(e=mxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function mxe(t){var e=pxe(t,"string");return typeof e=="symbol"?e:e+""}function pxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class IL extends Ns{constructor(e){let{conditionsStack:n,previousConditionsStack:i}=e;super("filter"),P3(this,"conditionsStack",void 0),P3(this,"previousConditionsStack",void 0),this.conditionsStack=n,this.previousConditionsStack=i}static startRegisteringEvents(e,n){e.addHook("beforeFilter",(i,r)=>{n.done(()=>new IL({conditionsStack:i,previousConditionsStack:r}))})}undo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.previousConditionsStack),i.filter()}redo(e,n){const i=e.getPlugin("filters");e.addHookOnce("afterViewRender",n),i.importConditions(this.conditionsStack),i.filter()}}function vxe(t,e,n){return(e=wxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function wxe(t){var e=yxe(t,"string");return typeof e=="symbol"?e:e+""}function yxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class PL extends Ns{constructor(e){let{data:n,cellRange:i}=e;super("merge_cells"),vxe(this,"cellRange",void 0),this.cellRange=i,this.data=n}static startRegisteringEvents(e,n){e.addHook("beforeMergeCells",(i,r)=>{if(r)return;const o=i.getTopStartCorner(),a=i.getBottomEndCorner(),u=e.getData(o.row,o.col,a.row,a.col);n.done(()=>new PL({data:u,cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0);const r=this.cellRange.getTopStartCorner();e.populateFromArray(r.row,r.col,this.data,void 0,void 0,"MergeCells")}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange)}}function O9(t,e,n,i,r){const o=["visualRow","visualCol","row","col","prop"],a=o.length,u=[];return ze(i,r,h=>{ze(e,n,d=>{const g=t.getCellMeta(d,h);if(Object.keys(g).length!==a){const m=Object.fromEntries(Object.entries(g).filter(v=>{let[y]=v;return o.includes(y)===!1}));u.push([g.visualRow,g.visualCol,m])}})}),u}function Fl(t,e,n){return(e=Sxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Sxe(t){var e=bxe(t,"string");return typeof e=="symbol"?e:e+""}function bxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class NL extends Ns{constructor(e){let{index:n,indexes:i,data:r,amount:o,headers:a,columnPositions:u,rowPositions:h,fixedColumnsStart:d,removedCellMetas:g}=e;super("remove_col"),Fl(this,"index",void 0),Fl(this,"indexes",void 0),Fl(this,"data",void 0),Fl(this,"amount",void 0),Fl(this,"headers",void 0),Fl(this,"columnPositions",void 0),Fl(this,"rowPositions",void 0),Fl(this,"fixedColumnsStart",void 0),Fl(this,"removedCellMetas",void 0),this.index=n,this.indexes=i,this.data=r,this.amount=o,this.headers=a,this.columnPositions=u.slice(0),this.rowPositions=h.slice(0),this.fixedColumnsStart=d,this.removedCellMetas=g}static startRegisteringEvents(e,n){e.addHook("beforeRemoveCol",(i,r,o,a)=>{const u=()=>{const h=e.getSourceDataArray(),d=(e.countCols()+i)%e.countCols(),g=d+r-1,m=[],v=[],y=[];return ze(h.length-1,b=>{const C=[],T=h[b];ze(d,g,O=>{C.push(T[e.toPhysicalColumn(O)])}),m.push(C)}),ze(r-1,b=>{y.push(e.toPhysicalColumn(d+b))}),Array.isArray(e.getSettings().colHeaders)&&ze(r-1,b=>{v.push(e.getSettings().colHeaders[e.toPhysicalColumn(d+b)]||null)}),new NL({index:d,indexes:y,data:m,amount:r,headers:v,columnPositions:e.columnIndexMapper.getIndexesSequence(),rowPositions:e.rowIndexMapper.getIndexesSequence(),fixedColumnsStart:e.getSettings().fixedColumnsStart,removedCellMetas:O9(e,0,e.countRows(),d,g)})};n.done(u,a)})}undo(e,n){const i=e.getSettings();i.fixedColumnsStart=this.fixedColumnsStart;const r=this.indexes.slice(0).sort(),o=(g,m,v)=>v[this.indexes.indexOf(r[m])],a=this.data.length,u=[];for(let g=0;g<a;g++)u.push(Vt(this.data[g],o));const h=Vt(this.headers,o),d=[];e.columnIndexMapper.setIndexesSequence(this.columnPositions),e.alter("insert_col_start",e.toVisualColumn(this.indexes[0]),this.indexes.length,"UndoRedo.undo"),e.batchExecution(()=>{e.rowIndexMapper.setIndexesSequence(this.rowPositions),e.columnIndexMapper.setIndexesSequence(this.columnPositions)},!0),U(e.getSourceDataArray(),(g,m)=>{U(r,(v,y)=>{g[v]=u[m][y],d.push([m,v,g[v]])})}),typeof this.headers<"u"&&U(h,(g,m)=>{e.getSettings().colHeaders[r[m]]=g}),this.removedCellMetas.forEach(g=>{let[m,v,y]=g;e.setCellMetaObject(m,v,y)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(d,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveCol",n),e.alter("remove_col",this.index,this.amount,"UndoRedo.redo")}}function dg(t,e,n){return(e=Cxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Cxe(t){var e=Rxe(t,"string");return typeof e=="symbol"?e:e+""}function Rxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class DL extends Ns{constructor(e){let{index:n,data:i,fixedRowsBottom:r,fixedRowsTop:o,rowIndexesSequence:a,removedCellMetas:u}=e;super("remove_row"),dg(this,"index",void 0),dg(this,"data",void 0),dg(this,"fixedRowsBottom",void 0),dg(this,"fixedRowsTop",void 0),dg(this,"rowIndexesSequence",void 0),dg(this,"removedCellMetas",void 0),this.index=n,this.data=i,this.fixedRowsBottom=r,this.fixedRowsTop=o,this.rowIndexesSequence=a,this.removedCellMetas=u}static startRegisteringEvents(e,n){e.addHook("beforeRemoveRow",(i,r,o,a)=>{const u=()=>{const h=e.toPhysicalRow(i),d=h+r-1,g=Nr(e.getSourceData(h,0,h+r-1,e.countSourceCols()-1));return new DL({index:h,data:g,fixedRowsBottom:e.getSettings().fixedRowsBottom,fixedRowsTop:e.getSettings().fixedRowsTop,rowIndexesSequence:e.rowIndexMapper.getIndexesSequence(),removedCellMetas:O9(e,h,d,0,e.countCols()-1)})};n.done(u,a)})}undo(e,n){const i=e.getSettings(),r=[];i.fixedRowsBottom=this.fixedRowsBottom,i.fixedRowsTop=this.fixedRowsTop,this.data.forEach((o,a)=>{Object.keys(o).forEach(u=>{const h=parseInt(u,10);r.push([this.index+a,isNaN(h)?u:h,o[u]])})}),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),e.alter("insert_row_above",e.toVisualRow(this.index),this.data.length,"UndoRedo.undo"),e.rowIndexMapper.setIndexesSequence(this.rowIndexesSequence),this.removedCellMetas.forEach(o=>{let[a,u,h]=o;e.setCellMetaObject(a,u,h)}),e.addHookOnce("afterViewRender",n),e.setSourceDataAtCell(r,null,null,"UndoRedo.undo")}redo(e,n){e.addHookOnce("afterRemoveRow",n),e.alter("remove_row",e.toVisualRow(this.index),this.data.length,"UndoRedo.redo")}}function N3(t,e,n){return(e=Exe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Exe(t){var e=Txe(t,"string");return typeof e=="symbol"?e:e+""}function Txe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class LL extends Ns{constructor(e){let{rows:n,finalIndex:i}=e;super("row_move"),N3(this,"rows",void 0),N3(this,"finalRowIndex",void 0),this.rows=n.slice(),this.finalRowIndex=i}static startRegisteringEvents(e,n){e.addHook("beforeRowMove",(i,r)=>{i!==!1&&n.done(()=>new LL({rows:i,finalIndex:r}))})}undo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),bL(this.rows,this.finalRowIndex,e.rowIndexMapper.getNumberOfIndexes()).reverse().forEach(o=>{let{from:a,to:u}=o;a<u&&(u-=1),i.moveRow(u,a)}),e.render(),e.deselectCell(),e.selectRows(this.rows[0],this.rows[0]+this.rows.length-1)}redo(e,n){const i=e.getPlugin("manualRowMove");e.addHookOnce("afterViewRender",n),i.moveRows(this.rows.slice(),this.finalRowIndex),e.render(),e.deselectCell(),e.selectRows(this.finalRowIndex,this.finalRowIndex+this.rows.length-1)}}function _xe(t,e,n){return(e=Mxe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Mxe(t){var e=Axe(t,"string");return typeof e=="symbol"?e:e+""}function Axe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}class kL extends Ns{constructor(e){let{cellRange:n}=e;super("unmerge_cells"),_xe(this,"cellRange",void 0),this.cellRange=n}static startRegisteringEvents(e,n){e.addHook("afterUnmergeCells",(i,r)=>{r||n.done(()=>new kL({cellRange:i}))})}undo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.mergeRange(this.cellRange,!0)}redo(e,n){const i=e.getPlugin("mergeCells");e.addHookOnce("afterViewRender",n),i.unmergeRange(this.cellRange,!0),e.render()}}function Oxe(t,e){[_L,ML,AL,OL,xL,HL,IL,PL,NL,DL,LL,kL].forEach(n=>n.startRegisteringEvents(t,e))}function xxe(t,e){Hxe(t,e),e.add(t)}function Hxe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Dx(t,e,n){return(e=Ixe(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function Ixe(t){var e=Pxe(t,"string");return typeof e=="symbol"?e:e+""}function Pxe(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e);if(typeof i!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Lx(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const D3="undoRedo",Nxe="undoRedo",Dxe=1e3;He.getSingleton().register("beforeUndo");He.getSingleton().register("afterUndo");He.getSingleton().register("beforeRedo");He.getSingleton().register("afterRedo");const L3=new Set;var tC=new WeakSet;class Lxe extends Dt{static get PLUGIN_KEY(){return Nxe}static get PLUGIN_PRIORITY(){return Dxe}static get SETTING_KEYS(){return!0}constructor(e){super(e),xxe(this,tC),Dx(this,"doneActions",[]),Dx(this,"undoneActions",[]),Dx(this,"ignoreNewActions",!1),Oxe(e,this)}isEnabled(){return!!this.hot.getSettings().undo}enablePlugin(){var e=this;this.enabled||(this.addHook("afterChange",function(){for(var n=arguments.length,i=new Array(n),r=0;r<n;r++)i[r]=arguments[r];return Lx(tC,e,kxe).call(e,...i)}),this.registerShortcuts(),Lx(tC,this,$xe).call(this),super.enablePlugin())}disablePlugin(){super.disablePlugin(),this.clear(),this.unregisterShortcuts(),Lx(tC,this,Vxe).call(this)}registerShortcuts(){const n=this.hot.getShortcutManager().getContext("grid"),r={runOnlyIf:o=>!o.altKey,group:D3};n.addShortcuts([{keys:[["Control/Meta","z"]],callback:()=>{this.undo()}},{keys:[["Control/Meta","y"],["Control/Meta","Shift","z"]],callback:()=>{this.redo()}}],r)}unregisterShortcuts(){this.hot.getShortcutManager().getContext("grid").removeShortcutsByGroup(D3)}done(e,n){if(this.ignoreNewActions||n==="UndoRedo.undo"||n==="UndoRedo.redo"||n==="auto")return;const r=this.doneActions.slice();if(this.hot.runHooks("beforeUndoStackChange",r,n)===!1)return;const a=e(),u=this.undoneActions.slice();this.doneActions.push(a),this.hot.runHooks("afterUndoStackChange",r,this.doneActions.slice()),this.hot.runHooks("beforeRedoStackChange",u),this.undoneActions.length=0,this.hot.runHooks("afterRedoStackChange",u,this.undoneActions.slice())}undo(){if(!this.isUndoAvailable())return;const e=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",e);const n=this.doneActions.pop();this.hot.runHooks("afterUndoStackChange",e,this.doneActions.slice());const i=Nr(n);if(this.hot.runHooks("beforeUndo",i)===!1)return;this.ignoreNewActions=!0;const o=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",o),n.undo(this.hot,()=>{this.ignoreNewActions=!1,this.undoneActions.push(n)}),this.hot.runHooks("afterRedoStackChange",o,this.undoneActions.slice()),this.hot.runHooks("afterUndo",i)}redo(){if(!this.isRedoAvailable())return;const e=this.undoneActions.slice();this.hot.runHooks("beforeRedoStackChange",e);const n=this.undoneActions.pop();this.hot.runHooks("afterRedoStackChange",e,this.undoneActions.slice());const i=Nr(n);if(this.hot.runHooks("beforeRedo",i)===!1)return;this.ignoreNewActions=!0;const o=this.doneActions.slice();this.hot.runHooks("beforeUndoStackChange",o),n.redo(this.hot,()=>{this.ignoreNewActions=!1,this.doneActions.push(n)}),this.hot.runHooks("afterUndoStackChange",o,this.doneActions.slice()),this.hot.runHooks("afterRedo",i)}isUndoAvailable(){return this.doneActions.length>0}isRedoAvailable(){return this.undoneActions.length>0}clear(){this.doneActions.length=0,this.undoneActions.length=0}destroy(){this.clear(),this.doneActions=null,this.undoneActions=null,super.destroy()}}function kxe(t,e){e==="loadData"&&this.clear()}function $xe(){const t=e=>{L3.has(e)||(_t(Ft`The "${e}" method is deprecated and it will be removed\x20
          from the Core API in the future. Please use the method from the UndoRedo plugin\x20
          (e.g. \`hotInstance.getPlugin("undoRedo").${e}()\`).`),L3.add(e))};this.hot.undo=()=>{t("undo"),this.undo()},this.hot.redo=()=>{t("redo"),this.redo()},this.hot.isUndoAvailable=()=>(t("isUndoAvailable"),this.isUndoAvailable()),this.hot.isRedoAvailable=()=>(t("isRedoAvailable"),this.isRedoAvailable()),this.hot.clearUndo=()=>{t("clear"),this.clear()},this.hot.undoRedo=this}function Vxe(){delete this.hot.undo,delete this.hot.redo,delete this.hot.isUndoAvailable,delete this.hot.isRedoAvailable,delete this.hot.clearUndo,delete this.hot.undoRedo}function kx(t,e,n){Bxe(t,e),e.set(t,n)}function Bxe(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function _o(t,e){return t.get(x9(t,e))}function nC(t,e,n){return t.set(x9(t,e),n),n}function x9(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const ms="ht-dialog",Fxe=`
<div data-ref="dialogElement" class="${ms}">
  <div data-ref="contentWrapperElement" class="${ms}__content-wrapper">
    <div data-ref="contentElement" class="${ms}__content"></div>
  </div>
</div>
`;var $x=new WeakMap,Jr=new WeakMap,Vx=new WeakMap;class H9{constructor(e){let{rootElement:n,isRtl:i}=e;kx(this,$x,void 0),kx(this,Jr,void 0),kx(this,Vx,!1),nC($x,this,n),nC(Vx,this,i),this.install()}install(){var e;if((e=_o(Jr,this))!==null&&e!==void 0&&e.dialogElement)return;const n=a4`${Fxe}`;nC(Jr,this,n.refs);const{dialogElement:i}=_o(Jr,this);i.addEventListener("click",()=>this.runLocalHooks("clickDialogElement")),We(i,[Rse(),lo(-1),["dir",_o(Vx,this)?"rtl":"ltr"]]),_o($x,this).after(n.fragment)}getDialogElement(){return _o(Jr,this).dialogElement}isInsideDialog(e){return _o(Jr,this).dialogElement.contains(e)}updateDialog(e){let{isVisible:n,content:i,customClassName:r,background:o,contentBackground:a,animation:u,a11y:h}=e;const{dialogElement:d,contentElement:g}=_o(Jr,this),m=r?` ${r}`:"",v=o?` ${ms}--background-${o}`:"",y=u?` ${ms}--animation`:"",b=n?` ${ms}--show`:"";d.className=`${ms}${m}${v}${y}${b}`,We(d,[h.role==="alertdialog"?lse():ase()]),h.ariaLabel&&!h.ariaLabelledby?We(d,[h.ariaLabel?Bo(h.ariaLabel):void 0]):uu(d,"aria-label"),h.ariaLabelledby?We(d,[dse(h.ariaLabelledby)]):uu(d,"aria-labelledby"),h.ariaDescribedby?We(d,[fse(h.ariaDescribedby)]):uu(d,"aria-describedby");const C=a?` ${ms}__content--background`:"";return g.className=`${ms}__content${C}`,g.innerHTML="",typeof i=="string"?Fd(g,i):(i instanceof HTMLElement||i instanceof DocumentFragment)&&g.appendChild(i),this}showDialog(e){const{dialogElement:n}=_o(Jr,this);return n.style.display="block",e&&n.offsetHeight,fe(n,`${ms}--show`),this}hideDialog(e){const{dialogElement:n}=_o(Jr,this);return Ve(n,`${ms}--show`),e?n.addEventListener("transitionend",()=>{Xe(n,`${ms}--show`)||(n.style.display="none")},{once:!0}):n.style.display="none",this}focusDialog(){_o(Jr,this).dialogElement.focus()}updateWidth(e){return _o(Jr,this).dialogElement.style.width=`${e}px`,this}updateHeight(e){return _o(Jr,this).dialogElement.style.height=`calc(100% - ${e}px)`,this}destroyDialog(){var e;(e=_o(Jr,this))===null||e===void 0||e.dialogElement.remove(),nC(Jr,this,null)}}en(H9,Fi);function Wxe(t,e){I9(t,e),e.add(t)}function iC(t,e,n){I9(t,e),e.set(t,n)}function I9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ba(t,e,n){return t.set(Zl(t,e),n),n}function Vi(t,e){return t.get(Zl(t,e))}function Zl(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const z0="dialog",jxe=360,TI=z0,lm=`plugin:${z0}`;var Mr=new WeakMap,Eg=new WeakMap,qg=new WeakMap,fg=new WeakMap,mc=new WeakSet;class zxe extends Dt{constructor(){super(...arguments),Wxe(this,mc),iC(this,Mr,null),iC(this,Eg,!1),iC(this,qg,null),iC(this,fg,null)}static get PLUGIN_KEY(){return z0}static get PLUGIN_PRIORITY(){return jxe}static get DEFAULT_SETTINGS(){return{content:"",customClassName:"",background:"solid",contentBackground:!1,animation:!0,closable:!1,a11y:{role:"dialog",ariaLabel:"Dialog",ariaLabelledby:"",ariaDescribedby:""}}}static get SETTINGS_VALIDATORS(){return{content:e=>typeof e=="string"||typeof HTMLElement<"u"&&e instanceof HTMLElement||typeof DocumentFragment<"u"&&e instanceof DocumentFragment,customClassName:e=>typeof e=="string",background:e=>["solid","semi-transparent"].includes(e),contentBackground:e=>typeof e=="boolean",animation:e=>typeof e=="boolean",closable:e=>typeof e=="boolean",a11y:e=>Qe(e)&&(typeof e?.role>"u"||["dialog","alertdialog"].includes(e?.role))&&(typeof e?.ariaLabel>"u"||typeof e?.ariaLabel=="string")&&(typeof e?.ariaLabelledby>"u"||typeof e?.ariaLabelledby=="string")&&(typeof e?.ariaDescribedby>"u"||typeof e?.ariaDescribedby=="string")}}isEnabled(){return!!this.hot.getSettings()[z0]}enablePlugin(){this.enabled||(Vi(Mr,this)||(Ba(Mr,this,new H9({rootElement:this.hot.rootGridElement,isRtl:this.hot.isRtl()})),Vi(Mr,this).addLocalHook("clickDialogElement",()=>Zl(mc,this,qxe).call(this)),Ba(qg,this,DD(this.hot,Vi(Mr,this).getDialogElement(),{onFocus:e=>{this.hot.getShortcutManager().setActiveContextName(lm),this.hot.listen(),this.hot.runHooks("afterDialogFocus",`tab_${e}`)}}))),Zl(mc,this,Uxe).call(this),this.addHook("modifyFocusOnTabNavigation",e=>Zl(mc,this,Gxe).call(this,e),1),this.addHook("afterViewRender",()=>Zl(mc,this,Zxe).call(this)),this.addHook("afterListen",()=>Zl(mc,this,Kxe).call(this)),this.addHook("afterUnlisten",()=>Zl(mc,this,Xxe).call(this)),super.enablePlugin())}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),Zl(mc,this,Yxe).call(this),super.disablePlugin()}isVisible(){return Vi(Eg,this)}show(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.enabled)return;if(this.isVisible()){this.update(e);return}this.hot.runHooks("beforeDialogShow"),this.update(e),Vi(Mr,this).showDialog(this.getSetting("animation")),Ba(Eg,this,!0),Ba(fg,this,this.hot.selection.exportSelection()),this.hot.deselectCell(),this.hot.runHooks("afterDialogShow");const{activeElement:n}=this.hot.rootDocument;(this.hot.rootWrapperElement.contains(n)||this.hot.rootPortalElement.contains(n))&&(this.hot.unlisten(),this.hot.getShortcutManager().setActiveContextName(lm),this.hot.listen(),Vi(Mr,this).focusDialog(),this.hot.runHooks("afterDialogFocus","show"))}hide(){this.isVisible()&&(this.hot.runHooks("beforeDialogHide"),Vi(Mr,this).hideDialog(this.getSetting("animation")),this.hot.getShortcutManager().setActiveContextName("grid"),Ba(Eg,this,!1),Vi(fg,this)?(this.hot.selection.importSelection(Vi(fg,this)),this.hot.view.render(),Ba(fg,this,null)):this.hot.selectCell(0,0),this.hot.runHooks("afterDialogHide"))}update(e){this.enabled&&(this.updatePluginSettings(e),Vi(Mr,this).updateDialog({isVisible:this.isVisible(),content:this.getSetting("content"),customClassName:this.getSetting("customClassName"),background:this.getSetting("background"),contentBackground:this.getSetting("contentBackground"),animation:this.getSetting("animation"),a11y:this.getSetting("a11y")}))}focus(){Vi(Mr,this).focusDialog()}destroy(){var e;(e=Vi(Mr,this))===null||e===void 0||e.destroyDialog(),Ba(Mr,this,null),Ba(Eg,this,!1),Ba(qg,this,null),Ba(fg,this,null),super.destroy()}}function Uxe(){var t;const e=this.hot.getShortcutManager(),n=(t=e.getContext(lm))!==null&&t!==void 0?t:e.addContext(lm);n.addShortcut({keys:[["Escape"]],callback:()=>{this.hide()},runOnlyIf:()=>Vi(Eg,this)&&this.getSetting("closable"),group:TI}),n.addShortcut({keys:[["Shift","Tab"],["Tab"]],preventDefault:!1,callback:i=>{this.hot._registerTimeout(()=>{const{activeElement:r}=this.hot.rootDocument;if(!Vi(Mr,this).isInsideDialog(r)){this.hot.unlisten();return}i.shiftKey?this.hot.runHooks("dialogFocusPreviousElement"):this.hot.runHooks("dialogFocusNextElement")},0)},group:TI})}function Yxe(){this.hot.getShortcutManager().getContext(lm).removeShortcutsByGroup(TI)}function Gxe(t){if(this.isVisible())return Vi(qg,this).focus(t),!1}function qxe(){this.isVisible()&&!this.hot.isListening()&&(this.hot.getShortcutManager().setActiveContextName(lm),this.hot.runHooks("afterDialogFocus","click")),this.hot.listen()}function Kxe(){Vi(qg,this).deactivate()}function Xxe(){Vi(qg,this).activate()}function Zxe(){const{view:t,rootWrapperElement:e,rootWindow:n}=this.hot,i=t.isHorizontallyScrollableByWindow()?t.getTotalTableWidth():t.getWorkspaceWidth();Vi(Mr,this).updateWidth(i);const r=e.querySelector(".hot-display-license-info");if(r){const o=r.offsetHeight,a=parseFloat(n.getComputedStyle(r).marginTop);Vi(Mr,this).updateHeight(o+a)}}function Qxe(t){let{id:e,icon:n,title:i,description:r}=t;return`
    <div class="${ld}__content">
      <i class="${ld}__icon">${n}</i>
      <div class="${ld}__text">
        <h2 id="${e}-${wd}-title" class="${ld}__title">${i}</h2>
        ${r?`<p id="${e}-${wd}-description" class="${ld}__description">${r}</p>`:""}
      </div>
    </div>
  `}function Jxe(t,e){P9(t,e),e.add(t)}function eHe(t,e,n){P9(t,e),e.set(t,n)}function P9(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function k3(t,e,n){return t.set($L(t,e),n),n}function Oo(t,e){return t.get($L(t,e))}function $L(t,e,n){if(typeof t=="function"?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}const wd="loading",tHe=350,ld=`ht-${wd}`;var cr=new WeakMap,$3=new WeakSet;class nHe extends Dt{constructor(){super(...arguments),Jxe(this,$3),eHe(this,cr,null)}static get PLUGIN_KEY(){return wd}static get PLUGIN_PRIORITY(){return tHe}static get DEFAULT_SETTINGS(){return{icon:`<svg class="${ld}__icon-svg" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 16 16"><path stroke="currentColor" stroke-width="2" d="M15 8a7 7 0 1 1-3.5-6.062"></path></svg>`,title:void 0,description:""}}static get SETTINGS_VALIDATORS(){return{icon:e=>typeof e=="string",title:e=>typeof e=="string",description:e=>typeof e=="string"}}isEnabled(){return!!this.hot.getSettings()[wd]}enablePlugin(){if(!this.enabled){if(Oo(cr,this)===null){var e;k3(cr,this,this.hot.getPlugin("dialog")),(e=Oo(cr,this))!==null&&e!==void 0&&e.isEnabled()||(this.hot.getSettings().dialog=!0),this.hot.addHook("afterDialogFocus",()=>$L($3,this,iHe).call(this))}super.enablePlugin()}}updatePlugin(){this.disablePlugin(),this.enablePlugin(),super.updatePlugin()}disablePlugin(){this.hide(),super.disablePlugin()}isVisible(){var e,n;return(e=(n=Oo(cr,this))===null||n===void 0?void 0:n.isVisible())!==null&&e!==void 0?e:!1}show(){var e;let n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!this.isEnabled()||!Oo(cr,this)||!((e=Oo(cr,this))!==null&&e!==void 0&&e.isEnabled()))return;if(this.isVisible()){this.update(n);return}this.hot.runHooks("beforeLoadingShow")!==!1&&(this.update(n),Oo(cr,this).show(),this.hot.runHooks("afterLoadingShow"))}hide(){var e;!Oo(cr,this)||!((e=Oo(cr,this))!==null&&e!==void 0&&e.isEnabled())||!this.isVisible()||this.hot.runHooks("beforeLoadingHide")===!1||(Oo(cr,this).hide(),this.hot.runHooks("afterLoadingHide"))}update(e){var n,i;if(!this.isEnabled()||!Oo(cr,this)||!((n=Oo(cr,this))!==null&&n!==void 0&&n.isEnabled()))return;this.updatePluginSettings(e);const r=this.hot.guid,o=this.getSetting("icon"),a=(i=this.getSetting("title"))!==null&&i!==void 0?i:this.hot.getTranslatedPhrase(xD),u=this.getSetting("description"),h=Qxe({id:r,icon:o,title:a,description:u});Oo(cr,this).update({content:h,customClassName:ld,background:this.hot.countSourceRows()===0?"solid":"semi-transparent",a11y:{role:"alertdialog",ariaLabelledby:`${r}-${wd}-title`,ariaDescribedby:u?`${r}-${wd}-description`:void 0}})}destroy(){k3(cr,this,null),super.destroy()}}function iHe(){Oo(cr,this).focus()}function rHe(){Ht(Bv),Ht(wwe),Ht(Fv),Ht(Zwe),Ht(oye),Ht(YK),Ht(tSe),Ht(FSe),Ht(zR),Ht(Kbe),Ht(bCe),Ht(OCe),Ht(GR),Ht(h0e),Ht(sEe),Ht(VEe),Ht(dTe),Ht(ETe),Ht(LTe),Ht(GTe),Ht(i_e),Ht(b_e),Ht(x_e),Ht(f1e),Ht(U1e),Ht(X1e),Ht(CMe),Ht(lAe),Ht($Ae),Ht(uOe),Ht(wOe),Ht(IOe),Ht(FOe),Ht(QOe),Ht(Lxe),Ht(zxe),Ht(nHe)}function oHe(){Vme(),lve(),vve(),Fve(),rHe()}oHe();function sHe(){const t=Ee.useRef(null),[e,n]=Ee.useState({intervals:[],totalTime:"0h 0m"}),i=[["","","","",""]],r=["S.No","Name","UserId","Date","Time"],o=(h,d)=>{const[g,m,v]=h.split("-");return new Date(`${v}-${m}-${g} ${d}`)},a=h=>{const d=h.sort((b,C)=>o(b.Date,b.Time)-o(C.Date,C.Time));let g=0;const m=[];for(let b=0;b<d.length;b+=2){const C=d[b],T=d[b+1];if(!T)break;const O=o(C.Date,C.Time),N=o(T.Date,T.Time)-O;g+=N;const x=Math.floor(N/(1e3*60*60)),$=Math.floor(N%(1e3*60*60)/(1e3*60));m.push({in:C.Time,out:T.Time,duration:`${x}h ${$}m`})}const v=Math.floor(g/(1e3*60*60)),y=Math.floor(g%(1e3*60*60)/(1e3*60));return{intervals:m,totalTime:`${v}h ${y}m`}},u=()=>{const g=t.current.hotInstance.getData().map(v=>r.reduce((y,b,C)=>(y[b]=v[C],y),{})),m=a(g);n(m)};return Io.jsxs("div",{className:"p-5",children:[Io.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"Attendance Dashboard"}),Io.jsx(nK,{ref:t,data:i,colHeaders:r,rowHeaders:!0,width:"100%",height:"300",licenseKey:"non-commercial-and-evaluation",stretchH:"all",contextMenu:!0,className:"border border-gray-300 rounded-lg"}),Io.jsx("button",{onClick:u,className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Calculate Working Time"}),Io.jsxs("div",{className:"mt-5",children:[Io.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Intervals"}),Io.jsx("ul",{className:"list-disc list-inside",children:e.intervals.map((h,d)=>Io.jsxs("li",{children:["In: ",h.in," | Out: ",h.out," → Duration: ",h.duration]},d))}),Io.jsxs("h3",{className:"text-lg font-semibold mt-3",children:["Total Working Time: ",e.totalTime]})]})]})}function aHe(){const t=nee.defaultAlgorithm;return Io.jsx(dm,{theme:{algorithm:t,token:{colorPrimary:"#177ddc"}},children:Io.jsx(sHe,{})})}QX.createRoot(document.getElementById("root")).render(Io.jsx(Ee.StrictMode,{children:Io.jsx(aHe,{})}))});export default lHe();
